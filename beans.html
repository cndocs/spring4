<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>5.&nbsp;IoC &#23481;&#22120;</title><link rel="stylesheet" type="text/css" href="css/manual-multipage.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><link rel="home" href="index.html" title="Spring Framework Reference Documentation"><link rel="up" href="spring-core.html" title="Part&nbsp;III.&nbsp;&#26680;&#24515;&#25216;&#26415;"><link rel="prev" href="spring-core.html" title="Part&nbsp;III.&nbsp;&#26680;&#24515;&#25216;&#26415;"><link rel="next" href="resources.html" title="6.&nbsp;Resources"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">5.&nbsp;IoC &#23481;&#22120;</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="spring-core.html">Prev</a>&nbsp;</td><th width="60%" align="center">Part&nbsp;III.&nbsp;&#26680;&#24515;&#25216;&#26415;</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="resources.html">Next</a></td></tr></table><hr></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a name="beans" href="#beans"></a>5.&nbsp;IoC &#23481;&#22120;</h2></div></div></div>

<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="beans-introduction" href="#beans-introduction"></a>5.1&nbsp;Spring IoC&#23481;&#22120;&#21644;Bean&#27010;&#36848;</h2></div></div></div>

<p>&#26412;&#31456;&#20171;&#32461;&#20102;Spring&#26694;&#26550;&#23454;&#29616;&#25511;&#21046;&#21453;&#36716;&#65288;IoC&#65289; <a href="#ftn.d5e956" class="footnote" name="d5e956"><sup class="footnote">[1]</sup></a> &#30340;&#21407;&#29702;&#12290;IoC&#20063;&#34987;&#31216;&#20316; <span class="emphasis"><em>&#20381;&#36182;&#27880;&#20837;</em></span> (DI)&#12290;&#23427;&#26159;&#19968;&#20010;&#22788;&#29702;&#23545;&#35937;&#20381;&#36182;&#39033;&#30340;&#36807;&#31243;&#65292;&#20063;&#23601;&#26159;&#35828;&#65292;&#21644;&#20182;&#20204;&#19968;&#36215;&#24037;&#20316;&#30340;&#20854;&#20182;&#30340;&#23545;&#35937;&#65292;&#21482;&#26377;&#36890;&#36807;&#26500;&#36896;&#21442;&#25968;&#12289;&#24037;&#21378;&#26041;&#27861;&#21442;&#25968;&#25110;&#32773;&#65288;&#23646;&#24615;&#27880;&#20837;&#65289;&#36890;&#36807;&#26500;&#36896;&#21442;&#25968;&#23454;&#20363;&#21270;&#25110;&#36890;&#36807;&#24037;&#21378;&#26041;&#27861;&#36820;&#22238;&#23545;&#35937;&#21518;&#20877;&#35774;&#32622;&#23646;&#24615;&#12290;&#24403;&#21019;&#24314;bean&#21518;&#65292;IoC&#23481;&#22120;&#20877;&#23558;&#36825;&#20123;&#20381;&#36182;&#39033;&#27880;&#20837;&#36827;&#21435;&#12290;&#36825;&#20010;&#36807;&#31243;&#22522;&#26412;&#19978;&#26159;&#21453;&#36716;&#30340;&#65292;&#22240;&#27492;&#24471;&#21517; <span class="emphasis"><em>&#25511;&#21046;&#21453;&#36716;</em></span> &#65288;IoC&#65289;&#65292;
This process is fundamentally
the inverse, hence the name <span class="emphasis"><em>Inversion of Control</em></span> (IoC), of the bean itself
controlling the instantiation or location of its dependencies by using direct
construction of classes, or a mechanism such as the <span class="emphasis"><em>Service Locator</em></span> pattern.</p>
<p><code class="literal">org.springframework.beans</code>&#21644;<code class="literal">org.springframework.context</code>&#21253;&#26159;Spring&#26694;&#26550;IoC&#23481;&#22120;&#30340;&#22522;&#30784;&#12290;
<a class="ulink" href="http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/beans/factory/BeanFactory.html" target="_top"><code class="literal">BeanFactory</code></a>&#25509;&#21475;&#25552;&#20379;&#20102;&#19968;&#20010;&#20808;&#36827;&#30340;&#37197;&#32622;&#26426;&#21046;&#33021;&#22815;&#31649;&#29702;&#20219;&#20309;&#31867;&#22411;&#30340;&#23545;&#35937;&#12290;
<a class="ulink" href="http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/context/ApplicationContext.html" target="_top"><code class="literal">ApplicationContext</code>(&#24212;&#29992;&#19978;&#19979;&#25991;)</a> &#26159;<code class="literal">BeanFactory</code>&#30340;&#19968;&#20010;&#23376;&#25509;&#21475;&#12290;&#23427;&#22686;&#21152;&#20102;&#26356;&#26041;&#20415;&#30340;&#38598;&#25104;Spring&#30340;AOP&#21151;&#33021;&#12289;&#28040;&#24687;&#36164;&#28304;&#22788;&#29702;&#65288;&#20351;&#29992;&#22269;&#38469;&#21270;&#65289;&#12289;&#20107;&#20214;&#21457;&#24067;&#21644;&#29305;&#23450;&#30340;&#24212;&#29992;&#23618;&#65292;&#22914;&#22312;web&#24212;&#29992;&#23618;&#20013;&#20351;&#29992;&#30340;<code class="literal">WebApplicationContext</code>&#12290;</p>
<p>&#24635;&#20043;&#65292;<code class="literal">BeanFactory</code>&#25552;&#20379;&#20102;&#37197;&#32622;&#26694;&#26550;&#21644;&#22522;&#26412;&#21151;&#33021;&#65292;<code class="literal">ApplicationContext</code>&#21017;&#28155;&#21152;&#20102;&#26356;&#22810;&#30340;&#20225;&#19994;&#29305;&#23450;&#30340;&#21151;&#33021;&#12290;<code class="literal">ApplicationContext</code>&#26159;<code class="literal">BeanFactory</code>&#30340;&#19968;&#20010;&#23436;&#25972;&#30340;&#36229;&#38598;&#65292;&#24182;&#19988;&#22312;&#26412;&#31456;&#19987;&#38376;&#29992;&#20110;&#25351;&#20195;Spring&#23481;&#22120;&#12290;&#20851;&#20110;&#26356;&#22810;&#20351;&#29992;<code class="literal">BeanFactory</code>&#26367;&#20195;<code class="literal">ApplicationContext</code>&#30340;&#20449;&#24687;&#65292;&#21442;&#32771;<a class="xref" href="beans.html#beans-beanfactory" title="5.16&nbsp;The BeanFactory">Section&nbsp;5.16, &#8220;The BeanFactory&#8221;</a>&#12290;</p>
<p>&#22312;Spring&#20013;&#65292;&#34987;Spring IoC <span class="emphasis"><em>&#23481;&#22120;</em></span> &#31649;&#29702;&#30340;&#36825;&#20123;&#26469;&#33258;&#20110;&#24212;&#29992;&#20027;&#24178;&#30340;&#36825;&#20123;&#23545;&#35937;&#31216;&#20316; <span class="emphasis"><em>beans</em></span> &#12290;bean&#26159;&#19968;&#20010;&#30001;Spring IoC&#23481;&#22120;&#36827;&#34892;&#23454;&#20363;&#21270;&#12289;&#35013;&#37197;&#21644;&#31649;&#29702;&#30340;&#23545;&#35937;&#12290;&#27492;&#22806;&#65292;bean&#21482;&#26159;&#20320;&#24212;&#29992;&#20013;&#35768;&#22810;&#23545;&#35937;&#20013;&#30340;&#19968;&#20010;&#12290;Beans&#20197;&#21450;&#20182;&#20204;&#20043;&#38388;&#30340; <span class="emphasis"><em>&#20381;&#36182;&#20851;&#31995;</em></span> &#26159;&#36890;&#36807;&#23481;&#22120;&#20351;&#29992; <span class="emphasis"><em>&#37197;&#32622;&#20803;&#25968;&#25454;</em></span> &#21453;&#24212;&#20986;&#26469;&#12290;</p>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="beans-basics" href="#beans-basics"></a>5.2&nbsp;&#23481;&#22120;&#27010;&#36848;</h2></div></div></div>

<p><code class="literal">org.springframework.context.ApplicationContext</code>&#25509;&#21475;&#20195;&#34920;&#20102;Spring
IoC&#23481;&#22120;&#65292;&#24182;&#19988;&#36127;&#36131;&#19978;&#38754;&#25552;&#21040;&#30340;Beans&#30340;&#23454;&#20363;&#21270;&#12289;&#37197;&#32622;&#21644;&#35013;&#37197;&#12290;&#23481;&#22120;&#36890;&#36807;&#35835;&#21462;&#37197;&#32622;&#20803;&#25968;&#25454;&#33719;&#21462;&#23545;&#35937;&#22914;&#20309;&#23454;&#20363;&#21270;&#12289;&#37197;&#32622;&#21644;&#35013;&#37197;&#30340;&#25351;&#31034;&#12290;&#37197;&#32622;&#20803;&#25968;&#25454;&#21487;&#20197;&#29992;XML&#12289;Java&#27880;&#35299;&#25110;Java&#20195;&#30721;&#26469;&#25551;&#36848;&#12290;&#23427;&#20801;&#35768;&#20320;&#34920;&#31034;&#32452;&#25104;&#20320;&#24212;&#29992;&#30340;&#23545;&#35937;&#65292;&#20197;&#21450;&#23545;&#35937;&#38388;&#20016;&#23500;&#30340;&#20381;&#36182;&#20851;&#31995;&#12290;</p>
<p>Spring&#25552;&#20379;&#20102;&#20960;&#20010;&#24320;&#31665;&#21363;&#29992;&#30340;<code class="literal">ApplicationContext</code>&#25509;&#21475;&#30340;&#23454;&#29616;&#12290;&#22312;&#29420;&#31435;&#30340;&#24212;&#29992;&#31243;&#24207;&#20013;&#65292;&#36890;&#24120;&#21019;&#24314;
<a class="ulink" href="http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/context/support/ClassPathXmlApplicationContext.html" target="_top"><code class="literal">ClassPathXmlApplicationContext</code></a>
&#25110;
<a class="ulink" href="http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/context/support/FileSystemXmlApplicationContexthttp://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/context/support/FileSystemXmlApplicationContext.html" target="_top"><code class="literal">FileSystemXmlApplicationContext</code></a>&#30340;&#23454;&#20363;&#12290;
&#34429;&#28982;XML&#26159;&#23450;&#20041;&#37197;&#32622;&#20803;&#25968;&#25454;&#30340;&#20256;&#32479;&#26684;&#24335;&#65292;&#20294;&#26159;&#20320;&#21487;&#20197;&#25351;&#31034;&#23481;&#22120;&#20351;&#29992;Java&#27880;&#35299;&#25110;&#32773;&#20195;&#30721;&#20316;&#20026;&#20803;&#25968;&#25454;&#26684;&#24335;&#65292;&#20320;&#38656;&#35201;&#36890;&#36807;&#25552;&#20379;&#23569;&#37327;XML&#37197;&#32622;&#22768;&#26126;&#25903;&#25345;&#36825;&#20123;&#39069;&#22806;&#30340;&#20803;&#25968;&#25454;&#26684;&#24335;&#12290;</p>
<p>&#22312;&#22823;&#22810;&#25968;&#30340;&#24212;&#29992;&#22330;&#26223;&#65292;&#19981;&#38656;&#35201;&#26174;&#24335;&#30340;&#20195;&#30721;&#26469;&#23454;&#20363;&#21270;&#19968;&#20010;&#25110;&#22810;&#20010;Spring IoC&#23481;&#22120;&#12290;&#20363;&#23376;&#65292;&#22312;wei&#24212;&#29992;&#20013;&#65292;&#22312;&#24212;&#29992;&#30340;<code class="literal">web.xml</code>&#25991;&#20214;&#20013;&#65292;&#31616;&#21333;&#30340;8&#34892;&#26679;&#26495;&#24335;&#30340;xml&#37197;&#32622;&#25991;&#20214;&#23601;&#36275;&#22815;&#20102;&#12290;&#22914;&#26524;&#20320;&#20351;&#29992; <a class="ulink" href="https://spring.io/tools/sts" target="_top">Spring Tool Suite</a> &#30340;Eclipse&#24320;&#21457;&#29615;&#22659;&#65292;&#20320;&#21482;&#38656;&#35201;&#28857;&#20960;&#19979;&#40736;&#26631;&#25110;&#32773;&#38190;&#30424;&#23601;&#21487;&#20197;&#36731;&#26494;&#30340;&#21019;&#24314;&#36825;&#20010;&#37197;&#32622;&#12290;</p>
<p>&#19979;&#38754;&#30340;&#22270;&#34920;&#26159;&#19968;&#20010;Spring&#24037;&#20316;&#30340;&#39640;&#32423;&#21035;&#35270;&#22270;&#12290;&#20320;&#30340;&#24212;&#29992;&#31243;&#24207;&#31867;&#37117;&#36890;&#36807;&#37197;&#32622;&#20803;&#25968;&#25454;&#36827;&#34892;&#20851;&#32852;&#65292;&#25152;&#20197;&#22312;<code class="literal">ApplicationContext</code>&#21019;&#24314;&#21644;&#21021;&#22987;&#21270;&#21518;&#65292;&#20320;&#23601;&#26377;&#20102;&#19968;&#20010;&#23436;&#20840;&#37197;&#32622;&#21644;&#21487;&#25191;&#34892;&#30340;&#31995;&#32479;&#25110;&#24212;&#29992;&#31243;&#24207;&#12290;</p>
<div class="figure"><a name="d5e1000" href="#d5e1000"></a><p class="title"><b>Figure&nbsp;5.1.&nbsp;Spring IoC&#23481;&#22120;</b></p><div class="figure-contents">

  <div class="mediaobject"><img src="images/container-magic.png" alt="container magic"></div>
</div></div><br class="figure-break">

<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="beans-factory-metadata" href="#beans-factory-metadata"></a>5.2.1&nbsp;&#37197;&#32622;&#20803;&#25968;&#25454;</h3></div></div></div>

<p>&#22914;&#19978;&#22270;&#25152;&#31034;&#65292;Spring IoC&#23481;&#22120;&#20351;&#29992;&#20102;&#19968;&#31181; <span class="emphasis"><em>&#37197;&#32622;&#20803;&#25968;&#25454;</em></span> &#30340;&#24418;&#24335;&#65292;&#36825;&#20123;&#37197;&#32622;&#20803;&#25968;&#25454;&#20195;&#34920;&#20102;&#20320;&#20316;&#20026;&#19968;&#20010;&#24212;&#29992;&#24320;&#21457;&#32773;&#21578;&#35785;Spring&#23481;&#22120;&#22914;&#20309;&#21435;&#23454;&#20363;&#21270;&#12289;&#37197;&#32622;&#21644;&#35013;&#22791;&#20320;&#24212;&#29992;&#20013;&#30340;&#23545;&#35937;&#12290;</p>
<p>&#37197;&#32622;&#20803;&#25968;&#25454;&#36890;&#24120;&#20351;&#29992;&#19968;&#20010;&#31616;&#21333;&#21644;&#30452;&#35266;&#30340;XML&#26684;&#24335;&#65292;&#26412;&#31456;&#22823;&#37096;&#20998;&#37117;&#20351;&#29992;&#36825;&#31181;&#26684;&#24335;&#26469;&#34920;&#36798;Spring IoC&#23481;&#22120;&#27010;&#24565;&#21644;&#29305;&#24615;&#12290;</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p>&#22522;&#20110;XML&#37197;&#32622;&#30340;&#20803;&#25968;&#25454; <span class="emphasis"><em>&#19981;&#26159;</em></span> &#21807;&#19968;&#20801;&#35768;&#29992;&#26469;&#37197;&#32622;&#20803;&#25968;&#25454;&#30340;&#19968;&#31181;&#24418;&#24335;&#12290;Spring IoC&#23481;&#22120;&#26412;&#36523;&#26159; <span class="emphasis"><em>&#23436;&#20840;</em></span> &#21644;&#20803;&#25968;&#25454;&#37197;&#32622;&#20070;&#20889;&#30340;&#24418;&#24335;&#35299;&#32806;&#30340;&#12290;&#36825;&#20123;&#22825;&#65292;&#35768;&#22810;&#24320;&#21457;&#32773;&#22312;&#20182;&#20204;&#30340;Spring&#24212;&#29992;&#20013;&#36873;&#25321;&#20351;&#29992;<a class="link" href="beans.html#beans-java" title="5.12&nbsp;&#22522;&#20110;Java&#65288;Java-based&#65289;&#30340;&#23481;&#22120;&#37197;&#32622;">&#22522;&#20110;Java&#30340;&#37197;&#32622;</a>&#30340;&#20803;&#25968;&#25454;&#24418;&#24335;&#12290;</p>
</td></tr></table></div>

<p>&#26356;&#22810;&#26377;&#20851;&#22312;Spring&#23481;&#22120;&#20013;&#20351;&#29992;&#20854;&#20182;&#24418;&#24335;&#30340;&#20803;&#25968;&#25454;&#30340;&#20869;&#23481;&#65292;&#35831;&#26597;&#38405;&#65306;</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="beans.html#beans-annotation-config" title="5.9&nbsp;Annotation-based container configuration">&#22522;&#20110;&#27880;&#35299;&#30340;&#37197;&#32622;</a>: Spring 2.5&#24341;&#20837;&#22522;&#20110;&#27880;&#35299;&#30340;&#37197;&#32622;&#20803;&#25968;&#25454;&#12290;
</li><li class="listitem">
<a class="link" href="beans.html#beans-java" title="5.12&nbsp;&#22522;&#20110;Java&#65288;Java-based&#65289;&#30340;&#23481;&#22120;&#37197;&#32622;">&#22522;&#20110;Java&#30340;&#37197;&#32622;</a>: &#20174;Spring 3.0&#24320;&#22987;&#65292;&#30001;Spring
JavaConfig&#25552;&#20379;&#30340;&#35768;&#22810;&#21151;&#33021;&#24050;&#32463;&#25104;&#20026;Spring&#26694;&#26550;&#30340;&#19968;&#37096;&#20998;&#12290;&#22240;&#27492;&#65292;&#20320;&#21487;&#20197;&#36890;&#36807;Java&#32780;&#19981;&#26159;XML&#25991;&#20214;&#26469;&#23450;&#20041;&#22806;&#37096;&#24212;&#29992;&#31243;&#24207;&#30340;bean&#31867;&#12290;&#20351;&#29992;&#36825;&#20123;&#26032;&#30340;&#21151;&#33021;&#65292;&#35831;&#30475;<code class="literal">@Configuration</code>&#12289;<code class="literal">@Bean</code>&#12289;<code class="literal">@Import</code>&#21644;<code class="literal">@DependsOn</code> &#27880;&#35299;&#12290;
</li></ul></div>

<p>Spring&#37197;&#32622;&#21253;&#25324;&#33267;&#23569;&#19968;&#20010;&#19988;&#36890;&#24120;&#22810;&#20010;&#30001;&#23481;&#22120;&#31649;&#29702;&#30340;bean&#23450;&#20041;&#12290;&#22312;&#22522;&#20110;XML&#37197;&#32622;&#30340;&#20803;&#25968;&#25454;&#20013;&#65292;&#36825;&#20123;beans&#37197;&#32622;&#25104;&#19968;&#20010;<code class="literal">&lt;bean/&gt;</code>&#20803;&#32032;&#65292;&#36825;&#20123;<code class="literal">&lt;bean/&gt;</code>&#20803;&#32032;&#23450;&#20041;&#22312;&#39030;&#32423;&#20803;&#32032;<code class="literal">&lt;beans/&gt;</code>&#30340;&#37324;&#38754;&#12290;&#22312;Java&#37197;&#32622;&#20013;&#36890;&#24120;&#22312;&#19968;&#20010;<code class="literal">@Configuration</code>&#27880;&#35299;&#30340;&#31867;&#20013;&#65292;&#22312;&#26041;&#27861;&#19978;&#20351;&#29992;<code class="literal">@Bean</code>&#27880;&#35299;&#12290;</p>
<p>&#36825;&#20123;bean&#23450;&#20041;&#23545;&#24212;&#30340;&#23454;&#38469;&#23545;&#35937;&#32452;&#25104;&#20102;&#20320;&#30340;&#24212;&#29992;&#12290;&#36890;&#24120;&#20320;&#20250;&#23450;&#20041;&#26381;&#21153;&#23618;&#23545;&#35937;&#12289;&#25968;&#25454;&#35775;&#38382;&#23618;&#23545;&#35937;&#65288;DAO&#65289;&#65292;&#23637;&#29616;&#23618;&#23545;&#35937;&#22914;Struts&#30340;<code class="literal">Action</code>&#23454;&#20363;&#65292;&#24213;&#23618;&#23545;&#35937;&#22914;Hibernate&#30340;<code class="literal">SessionFactories</code>&#65292;JMS&#30340;<code class="literal">Queues</code>&#31561;&#31561;&#12290;&#19968;&#33324;&#24456;&#23569;&#20250;&#22312;&#23481;&#22120;&#20013;&#37197;&#32622;&#32454;&#31890;&#24230;&#30340;&#39046;&#22495;&#23545;&#35937;&#65292;&#22240;&#20026;&#36890;&#24120;&#26159;DAO&#21644;&#19994;&#21153;&#36923;&#36753;&#36127;&#36131;&#21019;&#24314;&#21644;&#21152;&#36733;&#39046;&#22495;&#23545;&#35937;&#12290;&#20294;&#26159;&#20320;&#21487;&#20197;&#20351;&#29992;Spring&#38598;&#25104;AspectJ&#26469;&#37197;&#32622;IoC&#23481;&#22120;&#20043;&#22806;&#21019;&#24314;&#30340;&#23545;&#35937;&#12290;&#26597;&#30475;<a class="link" href="aop.html#aop-atconfigurable" title="9.8.1&nbsp;Using AspectJ to dependency inject domain objects with Spring">&#22312;Spring&#20013;&#20351;&#29992;AspectJ&#20381;&#36182;&#27880;&#20837;&#39046;&#22495;&#23545;&#35937;</a>&#12290;</p>
<p>&#19979;&#38754;&#30340;&#20363;&#23376;&#28436;&#31034;&#20102;&#22522;&#20110;XML&#30340;&#37197;&#32622;&#20803;&#25968;&#25454;&#30340;&#22522;&#30784;&#32467;&#26500;&#65306;</p>
<pre class="programlisting"><span class="hl-directive" style="color: maroon">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="hl-tag">&lt;beans</span> <span class="hl-attribute">xmlns</span>=<span class="hl-value">"http://www.springframework.org/schema/beans"</span>
    <span class="hl-attribute">xmlns:xsi</span>=<span class="hl-value">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hl-attribute">xsi:schemaLocation</span>=<span class="hl-value">"http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd"</span><span class="hl-tag">&gt;</span>

    <span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"..."</span> <span class="hl-attribute">class</span>=<span class="hl-value">"..."</span><span class="hl-tag">&gt;</span>
        <span class="hl-comment">&lt;!-- &#22312;&#36825;&#37324;&#20889; bean &#30340;&#37197;&#32622;&#21644;&#30456;&#20851;&#24341;&#29992; --&gt;</span>
    <span class="hl-tag">&lt;/bean&gt;</span>

    <span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"..."</span> <span class="hl-attribute">class</span>=<span class="hl-value">"..."</span><span class="hl-tag">&gt;</span>
        <span class="hl-comment">&lt;!-- &#22312;&#36825;&#37324;&#20889; bean &#30340;&#37197;&#32622;&#21644;&#30456;&#20851;&#24341;&#29992; --&gt;</span>
    <span class="hl-tag">&lt;/bean&gt;</span>

    <span class="hl-comment">&lt;!-- &#26356;&#22810;bean&#30340;&#23450;&#20041;&#20889;&#22312;&#36825;&#37324; --&gt;</span>

<span class="hl-tag">&lt;/beans&gt;</span></pre>

<p><code class="literal">id</code>&#23646;&#24615;&#26159;&#19968;&#20010;&#29992;&#26469;&#35782;&#21035;&#27599;&#19968;&#20010;&#29420;&#31435;bean&#23450;&#20041;&#30340;&#23383;&#31526;&#20018;&#12290;<code class="literal">class</code>&#23646;&#24615;&#23450;&#20041;&#20102;bean&#30340;&#31867;&#22411;&#65292;&#36825;&#20010;&#23646;&#24615;&#38656;&#35201;&#20351;&#29992;bean&#31867;&#30340;&#20840;&#38480;&#23450;&#21517;&#31216;&#12290;id&#23646;&#24615;&#30340;&#20540;&#21487;&#20197;&#34987;&#20854;&#20182;&#30340;bean&#23545;&#35937;&#24341;&#29992;&#12290;&#36825;&#20010;&#20363;&#23376;&#20013;&#27809;&#26377;&#24341;&#29992;&#20854;&#20182;bean&#65292;&#26597;&#30475;<a class="link" href="beans.html#beans-dependencies" title="5.4&nbsp;&#20381;&#36182;">bean&#20381;&#36182;</a>&#33719;&#21462;&#26356;&#22810;&#20449;&#24687;&#12290;</p>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="beans-factory-instantiation" href="#beans-factory-instantiation"></a>5.2.2&nbsp;&#23454;&#20363;&#21270;&#23481;&#22120;</h3></div></div></div>

<p>&#23454;&#20363;&#21270;Spring IoC&#23481;&#22120;&#24456;&#23481;&#26131;&#12290;&#23558;&#19968;&#20010;&#25110;&#22810;&#20010;&#20301;&#32622;&#36335;&#24452;&#25552;&#20379;&#32473;<code class="literal">ApplicationContext</code>&#30340;&#26500;&#36896;&#26041;&#27861;&#23601;&#21487;&#20197;&#35753;&#23481;&#22120;&#21152;&#36733;&#37197;&#21046;&#20803;&#25968;&#25454;&#65292;&#21487;&#20197;&#20174;&#22810;&#31181;&#22806;&#37096;&#36164;&#28304;&#36827;&#34892;&#33719;&#21462;&#65292;&#20363;&#22914;&#25991;&#20214;&#31995;&#32479;&#12289;Java&#30340;<code class="literal">CLASSPATH</code>&#31561;&#31561;&#12290;</p>
<pre class="programlisting">ApplicationContext context =
    <span class="hl-keyword">new</span> ClassPathXmlApplicationContext(<span class="hl-keyword">new</span> String[] {<span class="hl-string">"services.xml"</span>, <span class="hl-string">"daos.xml"</span>});</pre>

<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p>&#22312;&#20320;&#20102;&#35299;Spring&#30340;IoC&#23481;&#22120;&#20043;&#21518;&#65292;&#20320;&#21487;&#33021;&#24819;&#30693;&#36947;&#26356;&#22810;&#26377;&#20851;Spring&#30340;<code class="literal">Resource</code>&#30340;&#26356;&#22810;&#20869;&#23481;&#65292;&#23427;&#30340;&#20171;&#32461;&#22312;<a class="xref" href="resources.html" title="6.&nbsp;Resources">Chapter&nbsp;6, <i>Resources</i></a>&#65292;&#23427;&#25552;&#20379;&#20102;&#19968;&#20010;&#26041;&#20415;&#30340;&#26426;&#21046;&#26469;&#35835;&#21462;URI&#20013;&#30340;InputStream&#12290;<code class="literal">Resource</code>&#36335;&#24452;&#26159;&#29992;&#26469;&#26500;&#24314;&#24212;&#29992;&#31243;&#24207;&#19978;&#19979;&#25991;&#30340;&#65292;&#35814;&#32454;&#20869;&#23481;&#35831;&#30475;<a class="xref" href="resources.html#resources-app-ctx" title="6.7&nbsp;&#24212;&#29992;&#19978;&#19979;&#25991;&#21644;&#36164;&#28304;&#36335;&#24452;">Section&nbsp;6.7, &#8220;&#24212;&#29992;&#19978;&#19979;&#25991;&#21644;&#36164;&#28304;&#36335;&#24452;&#8221;</a>&#12290;</p>
</td></tr></table></div>

<p>&#19979;&#38754;&#30340;&#20363;&#23376;&#26159;&#26381;&#21153;&#23618;&#23545;&#35937;<code class="literal">(services.xml)</code>&#30340;&#37197;&#32622;&#25991;&#20214;&#65306;</p>
<pre class="programlisting"><span class="hl-directive" style="color: maroon">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="hl-tag">&lt;beans</span> <span class="hl-attribute">xmlns</span>=<span class="hl-value">"http://www.springframework.org/schema/beans"</span>
    <span class="hl-attribute">xmlns:xsi</span>=<span class="hl-value">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hl-attribute">xsi:schemaLocation</span>=<span class="hl-value">"http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd"</span><span class="hl-tag">&gt;</span>

    <span class="hl-comment">&lt;!-- services --&gt;</span>

    <span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"petStore"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"org.springframework.samples.jpetstore.services.PetStoreServiceImpl"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"accountDao"</span> <span class="hl-attribute">ref</span>=<span class="hl-value">"accountDao"</span><span class="hl-tag">/&gt;</span>
        <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"itemDao"</span> <span class="hl-attribute">ref</span>=<span class="hl-value">"itemDao"</span><span class="hl-tag">/&gt;</span>
        <span class="hl-comment">&lt;!-- &#22312;&#36825;&#37324;&#20889;&#39069;&#22806;&#30340;bean&#30340;&#37197;&#32622;&#21644;&#30456;&#20851;&#24341;&#29992; --&gt;</span>
    <span class="hl-tag">&lt;/bean&gt;</span>

    <span class="hl-comment">&lt;!-- &#26356;&#22810;Service&#23618;&#30340;bean&#23450;&#20041;&#20889;&#22312;&#36825;&#37324; --&gt;</span>

<span class="hl-tag">&lt;/beans&gt;</span></pre>

<p>&#19979;&#38754;&#30340;&#20363;&#23376;&#26159;&#25968;&#25454;&#35775;&#38382;&#23618;<code class="literal">daos.xml</code>&#25991;&#20214;:</p>
<pre class="programlisting"><span class="hl-directive" style="color: maroon">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="hl-tag">&lt;beans</span> <span class="hl-attribute">xmlns</span>=<span class="hl-value">"http://www.springframework.org/schema/beans"</span>
    <span class="hl-attribute">xmlns:xsi</span>=<span class="hl-value">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hl-attribute">xsi:schemaLocation</span>=<span class="hl-value">"http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd"</span><span class="hl-tag">&gt;</span>

    <span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"accountDao"</span>
        <span class="hl-attribute">class</span>=<span class="hl-value">"org.springframework.samples.jpetstore.dao.jpa.JpaAccountDao"</span><span class="hl-tag">&gt;</span>
        <span class="hl-comment">&lt;!-- &#22312;&#36825;&#37324;&#20889;&#39069;&#22806;&#30340;bean&#30340;&#37197;&#32622;&#21644;&#30456;&#20851;&#24341;&#29992; --&gt;</span>
    <span class="hl-tag">&lt;/bean&gt;</span>

    <span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"itemDao"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"org.springframework.samples.jpetstore.dao.jpa.JpaItemDao"</span><span class="hl-tag">&gt;</span>
        <span class="hl-comment">&lt;!-- &#22312;&#36825;&#37324;&#20889;&#39069;&#22806;&#30340;bean&#30340;&#37197;&#32622;&#21644;&#30456;&#20851;&#24341;&#29992; --&gt;</span>
    <span class="hl-tag">&lt;/bean&gt;</span>

    <span class="hl-comment">&lt;!-- &#26356;&#22810;&#25968;&#25454;&#35775;&#38382;&#23618;&#30340;bean&#23450;&#20041;&#20889;&#22312;&#36825;&#37324; --&gt;</span>

<span class="hl-tag">&lt;/beans&gt;</span></pre>

<p>&#22312;&#19978;&#38754;&#30340;&#20363;&#23376;&#20013;&#65292;&#26381;&#21153;&#23618;&#21253;&#21547;&#20102;<code class="literal">PetStoreServiceImpl</code>&#31867;&#21644;&#20004;&#20010;&#31867;&#22411;&#20026;<code class="literal">JpaAccountDao</code>&#21644;<code class="literal">JpaItemDao</code>&#65288;&#22522;&#20110;JPA&#23545;&#35937;/&#20851;&#31995;&#26144;&#23556;&#26631;&#20934;&#65289;&#30340;&#25968;&#25454;&#35775;&#38382;&#23545;&#35937;&#12290;<code class="literal">property name</code>&#20803;&#32032;&#25351;&#20195;JavaBean&#23646;&#24615;&#30340;&#21517;&#31216;&#65292;<code class="literal">ref</code>&#20803;&#32032;&#24341;&#29992;&#20102;&#21478;&#19968;&#20010;bean&#23450;&#20041;&#30340;&#21517;&#31216;&#12290;<code class="literal">id</code>&#21644;<code class="literal">ref</code>&#30452;&#25509;&#30340;&#36825;&#31181;&#20851;&#31995;&#34920;&#36798;&#20986;&#20102;&#36825;&#20004;&#20010;&#21512;&#20316;&#23545;&#35937;&#38388;&#30340;&#20381;&#36182;&#20851;&#31995;&#12290;&#37197;&#32622;&#23545;&#35937;&#30452;&#25509;&#20381;&#36182;&#20851;&#31995;&#30340;&#35814;&#32454;&#20449;&#24687;&#65292;&#35831;&#21442;&#35265;<a class="link" href="beans.html#beans-dependencies" title="5.4&nbsp;&#20381;&#36182;">&#20381;&#36182;&#20851;&#31995;</a>&#12290;</p>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-factory-xml-import" href="#beans-factory-xml-import"></a>&#32534;&#20889;&#22522;&#20110;XML&#30340;&#37197;&#32622;&#20803;&#25968;&#25454;</h4></div></div></div>

<p>bean&#23450;&#20041;&#21487;&#20197;&#36328;&#36234;&#22810;&#20010;XML&#25991;&#20214;&#26159;&#38750;&#24120;&#26377;&#29992;&#30340;&#12290;&#36890;&#24120;&#27599;&#20010;&#29420;&#31435;&#30340;XML&#37197;&#32622;&#25991;&#20214;&#34920;&#31034;&#19968;&#20010;&#36923;&#36753;&#23618;&#25110;&#32773;&#26159;&#20320;&#26550;&#26500;&#20013;&#30340;&#19968;&#20010;&#27169;&#22359;&#12290;</p>
<p>&#20320;&#21487;&#20197;&#20351;&#29992;&#24212;&#29992;&#19978;&#19979;&#25991;&#30340;&#26500;&#36896;&#26041;&#27861;&#20174;&#22810;&#20010;XML&#29255;&#27573;&#20013;&#21152;&#36733;bean&#30340;&#23450;&#20041;&#12290;&#20687;&#19978;&#38754;&#20363;&#23376;&#20013;&#20986;&#29616;&#36807;&#30340;&#19968;&#26679;&#65292;&#26500;&#36896;&#26041;&#27861;&#21487;&#20197;&#25509;&#25910;&#22810;&#20010;<code class="literal">Resource</code>&#20301;&#32622;&#12290;&#25110;&#32773;&#21487;&#20197;&#22312;bean&#23450;&#20041;&#20013;&#20351;&#29992;&#19968;&#20010;&#25110;&#22810;&#20010;<code class="literal">&lt;import/&gt;</code>&#20174;&#20854;&#20182;&#30340;&#37197;&#32622;&#25991;&#20214;&#24341;&#20837;bean&#23450;&#20041;&#12290;&#20363;&#22914;&#65306;</p>
<pre class="programlisting"><span class="hl-tag">&lt;beans&gt;</span>
    <span class="hl-tag">&lt;import</span> <span class="hl-attribute">resource</span>=<span class="hl-value">"services.xml"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;import</span> <span class="hl-attribute">resource</span>=<span class="hl-value">"resources/messageSource.xml"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;import</span> <span class="hl-attribute">resource</span>=<span class="hl-value">"/resources/themeSource.xml"</span><span class="hl-tag">/&gt;</span>

    <span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"bean1"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"..."</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"bean2"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"..."</span><span class="hl-tag">/&gt;</span>
<span class="hl-tag">&lt;/beans&gt;</span></pre>

<p>&#19978;&#38754;&#30340;&#20363;&#23376;&#20013;&#65292;&#22806;&#37096;&#30340;bean&#23450;&#20041;&#20174;<code class="literal">services.xml</code>&#12289;<code class="literal">messageSource.xml</code>&#21644;<code class="literal">themeSource.xml</code>&#36825;&#19977;&#20010;&#25991;&#20214;&#20013;&#21152;&#36733;&#12290;&#25152;&#26377;&#30340;&#20301;&#32622;&#36335;&#24452;&#37117;&#26159;&#30456;&#23545;&#20110;&#23450;&#20041;&#25191;&#34892;&#23548;&#20837;&#30340;&#25991;&#20214;&#65292;&#25152;&#20197; <code class="literal">services.xml</code>&#24517;&#39035;&#21644;&#24403;&#21069;&#23450;&#20041;&#23548;&#20837;&#30340;&#25991;&#20214;&#22312;&#30456;&#21516;&#30340;&#36335;&#24452;&#19979;&#12290;&#32780;<code class="literal">messageSource.xml</code>&#21644;<code class="literal">themeSource.xml</code>&#24517;&#39035;&#22312;&#24403;&#21069;&#23450;&#20041;&#23548;&#20837;&#30340;&#25991;&#20214;&#36335;&#24452;&#19979;&#30340;<code class="literal">resources</code>&#36335;&#24452;&#19979;&#12290;&#20320;&#21487;&#20197;&#30475;&#21040;&#65292;&#36825;&#37324;&#24573;&#30053;&#20102;&#21453;&#26012;&#26464;&#65292;&#30001;&#20110;&#36825;&#37324;&#30340;&#36335;&#24452;&#26159;&#30456;&#23545;&#30340;&#65292;&#22240;&#27492;&#24314;&#35758; <span class="strong"><strong>&#19981;&#20351;&#29992;&#21453;&#26012;&#26464;</strong></span>&#12290;&#36825;&#20123;&#34987;&#24341;&#20837;&#25991;&#20214;&#30340;&#20869;&#23481;&#20250;&#34987;&#23548;&#20837;&#36827;&#26469;&#65292;&#21253;&#21547;&#39030;&#23618;&#30340;<code class="literal">&lt;beans/&gt;</code>&#20803;&#32032;&#65292;&#23427;&#24517;&#39035;&#26159;&#19968;&#20010;&#31526;&#21512;Spring&#26550;&#26500;&#30340;&#26377;&#25928;&#30340;XML bean&#23450;&#20041;&#12290;</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p>&#20351;&#29992;&#19968;&#20010;&#30456;&#23545;"../"&#36335;&#24452;&#24341;&#29992;&#29238;&#30446;&#24405;&#20013;&#30340;&#37197;&#32622;&#26159;&#20801;&#35768;&#30340;&#65292;&#20294;&#26159;&#19981;&#25512;&#33616;&#36825;&#20040;&#20570;&#12290;&#22914;&#26524;&#36825;&#20040;&#20570;&#23601;&#20135;&#29983;&#20102;&#19968;&#20010;&#24403;&#21069;&#24212;&#29992;&#22806;&#30340;&#24341;&#29992;&#20381;&#36182;&#12290;&#29305;&#21035;&#19981;&#25512;&#33616;&#22312;&#20351;&#29992;"classpath:"&#36335;&#24452;&#30340;&#26102;&#20505;&#65292;&#22312;&#36816;&#34892;&#30340;&#26102;&#20505;&#35299;&#26512;&#36873;&#25321;&#8220;&#26368;&#36817;&#8221;&#30340;classpath&#36319;&#36335;&#24452;&#65292;&#28982;&#21518;&#22312;&#25214;&#29238;&#30446;&#24405;&#12290;Classpath&#37197;&#32622;&#30340;&#26356;&#25913;&#21487;&#33021;&#20250;&#23548;&#33268;&#36873;&#25321;&#19968;&#20010;&#19981;&#21516;&#30340;&#12289;&#38169;&#35823;&#30340;&#30446;&#24405;&#12290;</p>
<p>&#36890;&#24120;&#24773;&#20917;&#19979;&#65292;&#20320;&#21487;&#20197;&#20351;&#29992;&#23436;&#20840;&#38480;&#23450;&#30340;&#36164;&#28304;&#20301;&#32622;&#26469;&#20195;&#26367;&#30456;&#23545;&#36335;&#24452;&#65292;&#20363;&#22914;&#65306;"file:C:/config/services.xml"&#25110;"classpath:/config/services.xml"&#12290;&#20294;&#26159;&#35831;&#27880;&#24847;&#65292;&#20320;&#30340;&#24212;&#29992;&#21487;&#33021;&#21644;&#19968;&#20010;&#29305;&#23450;&#30340;&#32477;&#23545;&#36335;&#24452;&#32806;&#21512;&#20102;&#12290;&#36890;&#24120;&#26356;&#21512;&#36866;&#30340;&#26041;&#24335;&#26159;&#36890;&#36807;&#38388;&#25509;&#30340;&#26041;&#24335;&#26469;&#20351;&#29992;&#32477;&#23545;&#36335;&#24452;&#65292;&#20363;&#22914;&#36890;&#36807;"${&#8230;}"&#21344;&#20301;&#31526;&#65292;&#22312;&#36816;&#34892;&#26102;&#35299;&#26512;JVM&#30340;&#31995;&#32479;&#23646;&#24615;&#12290;</p>
</td></tr></table></div>

</div>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="beans-factory-client" href="#beans-factory-client"></a>5.2.3&nbsp;&#20351;&#29992;&#23481;&#22120;</h3></div></div></div>

<p><code class="literal">ApplicationContext</code>&#26159;&#26234;&#33021;&#30340;&#24037;&#21378;&#25509;&#21475;&#65292;&#23427;&#33021;&#22815;&#32500;&#25252;&#27880;&#20876;&#19981;&#21516;beans&#21644;&#23427;&#20204;&#30340;&#20381;&#36182;&#12290;&#36890;&#36807;&#20351;&#29992; <code class="literal">T getBean(String
name, Class&lt;T&gt; requiredType)</code> &#26041;&#27861;&#65292;&#20320;&#21487;&#20197;&#21462;&#24471;&#36825;&#20123;beans&#30340;&#23454;&#20363;&#12290;</p>
<p>'ApplicationContext`&#20351;&#24744;&#21487;&#20197;&#35835;&#21462;&#30340;bean&#23450;&#20041;&#21644;&#20687;&#19979;&#38754;&#36825;&#26679;&#20351;&#29992;&#65306;</p>
<pre class="programlisting"><span class="hl-comment">// &#21019;&#24314;&#24182;&#37197;&#32622;beans</span>
ApplicationContext context =
    <span class="hl-keyword">new</span> ClassPathXmlApplicationContext(<span class="hl-keyword">new</span> String[] {<span class="hl-string">"services.xml"</span>, <span class="hl-string">"daos.xml"</span>});

<span class="hl-comment">// &#21462;&#24471;&#37197;&#32622;&#30340;&#23454;&#20363;</span>
PetStoreService service = context.getBean(<span class="hl-string">"petStore"</span>, PetStoreService.<span class="hl-keyword">class</span>);

<span class="hl-comment">// &#20351;&#29992;&#23454;&#20363;</span>
List&lt;String&gt; userList = service.getUsernameList();</pre>

<p>&#20351;&#29992;<code class="literal">getBean()</code>&#26469;&#33719;&#21462;&#24744;beans&#30340;&#23454;&#20363;&#65292;<code class="literal">ApplicationContext</code>&#25509;&#21475;&#36824;&#26377;&#20960;&#20010;&#20854;&#20182;&#30340;&#21487;&#20197;&#33719;&#21462;beans&#30340;&#26041;&#27861;&#65292;&#20294;&#26159;&#29702;&#24819;&#24773;&#20917;&#19979;&#65292;&#20320;&#26368;&#22909;&#19981;&#35201;&#20351;&#29992;&#36825;&#20123;&#26041;&#27861;&#12290;
&#20107;&#23454;&#19978;&#65292;&#24744;&#30340;&#24212;&#29992;&#31243;&#24207;&#20195;&#30721;&#19981;&#24212;&#35843;&#29992;<span class="emphasis"><em>getBean()</em></span>&#25152;&#26377;&#26041;&#27861;&#65292;&#22240;&#32780;&#19981;&#20250;&#21644;Spring&#30340;&#25509;&#21475;&#20135;&#29983;&#20381;&#36182;&#12290;
&#20363;&#22914;&#65292;Spring&#30340;&#19982;web&#26694;&#26550;&#30340;&#38598;&#25104;&#25552;&#20379;&#20102;&#23545;&#21508;&#31181;web&#26694;&#26550;&#31867;&#30340;&#20381;&#36182;&#27880;&#20837;&#65292;&#22914;&#25511;&#21046;&#22120;&#21644;JSF&#31649;&#29702;&#30340;bean&#12290;</p>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="beans-definition" href="#beans-definition"></a>5.3&nbsp;Bean&#27010;&#36848;</h2></div></div></div>

<p>&#19968;&#20010;Spring IoC&#23481;&#22120;&#31649;&#29702;&#20102;&#19968;&#20010;&#25110;&#32773;&#22810;&#20010; <span class="emphasis"><em>beans</em></span>&#12290;&#36825;&#20123;beans&#36890;&#36807;&#20320;&#25552;&#20379;&#32473;&#23481;&#22120;&#30340;&#37197;&#32622;&#20803;&#25968;&#25454;&#36827;&#34892;&#21019;&#24314;&#65292;&#20363;&#22914;&#36890;&#36807;XML&#24418;&#24335;&#30340;<code class="literal">&lt;bean/&gt;</code>&#23450;&#20041;&#12290;</p>
<p>&#22312;&#23481;&#22120;&#20869;&#26412;&#36523;&#65292;&#36825;&#20123;bean&#23450;&#20041;&#34920;&#31034;&#20026;<code class="literal">BeanDefinition</code>&#23545;&#35937;&#65292;&#23427;&#21253;&#21547;&#20102;&#22914;&#19979;&#30340;&#20803;&#25968;&#25454;&#65306;</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="emphasis"><em>&#21253;&#38480;&#23450;&#30340;&#31867;&#21517;&#65306;</em></span> &#36890;&#24120;&#26159;bean&#23450;&#20041;&#30340;&#23454;&#29616;&#31867;&#12290;
</li><li class="listitem">
Bean&#34892;&#20026;&#37197;&#32622;&#20803;&#32032;&#65292;&#36825;&#20123;&#29366;&#24577;&#25351;&#31034;bean&#22312;&#23481;&#22120;&#20013;&#30340;&#34892;&#20026;&#65288;&#33539;&#22260;&#65292;&#29983;&#21629;&#21608;&#26399;&#22238;&#35843;&#20989;&#25968;&#65292;&#31561;&#31561;&#65289;&#12290;
</li><li class="listitem">
bean&#24037;&#20316;&#38656;&#35201;&#24341;&#29992;&#30340;&#20854;&#20182;beans&#65307;&#36825;&#20123;&#24341;&#29992;&#20063;&#31216;&#20026; <span class="emphasis"><em>&#21327;&#20316;&#32773;</em></span> &#25110; <span class="emphasis"><em>&#20381;&#36182;&#32773;</em></span>&#12290;
</li><li class="listitem">
&#20854;&#20182;&#37197;&#32622;&#35774;&#32622;&#24212;&#29992;&#20110;&#26032;&#21019;&#24314;&#30340;&#23545;&#35937;&#20013;&#35774;&#32622;&#65292;&#20363;&#22914;&#36830;&#25509;&#27744;&#20013;&#30340;&#36830;&#25509;&#25968;&#25110;&#32773;&#36830;&#25509;&#27744;&#30340;&#22823;&#23567;&#38480;&#21046;&#12290;
</li></ul></div>

<p>&#36825;&#20123;&#20803;&#25968;&#25454;&#36716;&#25442;&#25104;&#32452;&#25104;&#27599;&#20010;bean&#23450;&#20041;&#30340;&#19968;&#32452;&#23646;&#24615;&#12290;</p>
<div class="table"><a name="beans-factory-bean-definition-tbl" href="#beans-factory-bean-definition-tbl"></a><p class="title"><b>Table&nbsp;5.1.&nbsp;bean&#23450;&#20041;</b></p><div class="table-contents">

  <table summary="bean&#23450;&#20041;" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="col_1"><col class="col_2"></colgroup><thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&#23646;&#24615;&#21517;</th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top">&#35828;&#26126;&#8230;</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>class</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p><a class="xref" href="beans.html#beans-factory-class" title="5.3.2&nbsp;&#23454;&#20363;&#21270;bean">Section&nbsp;5.3.2, &#8220;&#23454;&#20363;&#21270;bean&#8221;</a></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>name</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p><a class="xref" href="beans.html#beans-beanname" title="5.3.1&nbsp;bean&#30340;&#21629;&#21517;">Section&nbsp;5.3.1, &#8220;bean&#30340;&#21629;&#21517;&#8221;</a></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>scope</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p><a class="xref" href="beans.html#beans-factory-scopes" title="5.5&nbsp;Bean&#20316;&#29992;&#22495;">Section&nbsp;5.5, &#8220;Bean&#20316;&#29992;&#22495;&#8221;</a></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>constructor arguments</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p><a class="xref" href="beans.html#beans-factory-collaborators" title="5.4.1&nbsp;&#20381;&#36182;&#27880;&#20837;">Section&nbsp;5.4.1, &#8220;&#20381;&#36182;&#27880;&#20837;&#8221;</a></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>properties</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p><a class="xref" href="beans.html#beans-factory-collaborators" title="5.4.1&nbsp;&#20381;&#36182;&#27880;&#20837;">Section&nbsp;5.4.1, &#8220;&#20381;&#36182;&#27880;&#20837;&#8221;</a></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>autowiring mode</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p><a class="xref" href="beans.html#beans-factory-autowire" title="5.4.5&nbsp;&#33258;&#21160;&#35013;&#37197;&#21327;&#20316;&#32773;">Section&nbsp;5.4.5, &#8220;&#33258;&#21160;&#35013;&#37197;&#21327;&#20316;&#32773;&#8221;</a></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>lazy-initialization mode</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p><a class="xref" href="beans.html#beans-factory-lazy-init" title="5.4.4&nbsp;&#24310;&#36831;&#21021;&#22987;&#21270;bean">Section&nbsp;5.4.4, &#8220;&#24310;&#36831;&#21021;&#22987;&#21270;bean&#8221;</a></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>initialization method</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p><a class="xref" href="beans.html#beans-factory-lifecycle-initializingbean" title="&#21021;&#22987;&#21270;&#22238;&#35843;&#20989;&#25968;">the section called &#8220;&#21021;&#22987;&#21270;&#22238;&#35843;&#20989;&#25968;&#8221;</a></p></td></tr><tr><td style="border-right: 0.5pt solid ; " align="left" valign="top"><p>destruction method</p></td><td style="" align="left" valign="top"><p><a class="xref" href="beans.html#beans-factory-lifecycle-disposablebean" title="&#26512;&#26500;&#22238;&#35843;&#20989;&#25968;">the section called &#8220;&#26512;&#26500;&#22238;&#35843;&#20989;&#25968;&#8221;</a></p></td></tr></tbody></table>
</div></div><br class="table-break">

<p>&#38500;&#20102;bean&#23450;&#20041;&#22806;&#65292;&#23427;&#36824;&#21253;&#21547;&#26377;&#20851;&#22914;&#20309;&#21019;&#24314;&#29305;&#23450;bean&#30340;&#20449;&#24687;&#65292;<code class="literal">ApplicationContext</code>&#23454;&#29616;&#36824;&#20801;&#35768;&#30001;&#29992;&#25143;&#22312;&#23481;&#22120;&#22806;&#21019;&#24314;&#27880;&#20876;&#29616;&#26377;&#30340;&#23545;&#35937;&#12290;
&#36825;&#26159;&#36890;&#36807;&#35775;&#38382;ApplicationContext&#30340;&#24037;&#21378;&#26041;&#27861;&#65292;&#36890;&#36807;<code class="literal">getBeanFactory()</code>&#36820;&#22238;<code class="literal">DefaultListableBeanFactory</code>&#24037;&#21378;&#26041;&#27861;&#30340;&#23454;&#29616;&#12290;
<code class="literal">DefaultListableBeanFactory</code>&#25903;&#25345;&#36890;&#36807;<code class="literal">registerSingleton(..)</code>&#26041;&#27861;&#21644;<code class="literal">registerBeanDefinition(..)</code>&#26041;&#27861;&#36827;&#34892;&#27880;&#20876;&#12290;
&#28982;&#32780;&#65292;&#20856;&#22411;&#30340;&#24212;&#29992;&#31243;&#24207;&#30340;&#24037;&#20316;&#20165;&#20165;&#36890;&#36807;&#20803;&#25968;&#25454;&#23450;&#20041;&#30340;bean&#23450;&#20041;beans&#12290;</p>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="beans-beanname" href="#beans-beanname"></a>5.3.1&nbsp;bean&#30340;&#21629;&#21517;</h3></div></div></div>

<p>&#27599;&#20010;bean&#37117;&#26377;&#19968;&#20010;&#25110;&#22810;&#20010;&#26631;&#35782;&#31526;&#65292;&#36825;&#20123;bean&#30340;&#26631;&#35782;&#31526;&#22312;&#23427;&#25152;&#22312;&#30340;&#23481;&#22120;&#20013;&#24517;&#39035;&#21807;&#19968;&#12290;
&#19968;&#20010;bean&#36890;&#24120;&#21482;&#26377;&#19968;&#20010;&#26631;&#35782;&#31526;&#65292;&#20294;&#22914;&#26524;&#23427;&#26377;&#19968;&#20010;&#20197;&#19978;&#30340;<code class="literal">id</code>&#26631;&#35782;&#31526;&#65292;&#22810;&#20313;&#30340;&#26631;&#35782;&#31526;&#23558;&#34987;&#35748;&#20026;&#26159;&#21035;&#21517;&#12290;</p>
<p>&#22522;&#20110;xml&#30340;&#37197;&#32622;&#20803;&#25968;&#25454;&#20013;&#65292;&#20320;&#21487;&#20197;&#20351;&#29992;<code class="literal">id</code> &#25110;&#65288;&#21644;&#65289; <code class="literal">name</code> &#23646;&#24615;&#26469;&#25351;&#23450;bean&#30340;&#26631;&#35782;&#31526;&#12290;
<code class="literal">id</code>&#23646;&#24615;&#20801;&#35768;&#24744;&#21482;&#25351;&#23450;&#19968;&#20010;id&#12290;&#36890;&#24120;&#36825;&#20123;&#21517;&#23383;&#26159;&#23383;&#27597;&#25968;&#23383;&#32452;&#25104;&#30340;&#65288;<span class="emphasis"><em>myBean</em></span>,<span class="emphasis"><em>fooService</em></span>&#31561;&#31561;&#65289;&#65292;&#20294;&#20063;&#21487;&#33021;&#21253;&#21547;&#29305;&#27530;&#23383;&#31526;&#12290;
&#22914;&#26524;&#20320;&#24819;&#32473;bean&#28155;&#21152;&#20854;&#20182;&#30340;&#21035;&#21517;&#65292;&#20320;&#21487;&#20197;&#36890;&#36807;<code class="literal">name</code>&#23646;&#24615;&#26469;&#25351;&#23450;&#36825;&#20123;&#21035;&#21517;&#65292;&#21487;&#20197;&#20351;&#29992;&#36887;&#21495;(<code class="literal">,</code>)&#65292;&#20998;&#21495;(<code class="literal">;</code>)&#25110;&#32773;&#31354;&#26684;&#26469;&#20998;&#21106;&#36825;&#20123;&#21035;&#21517;&#12290;
&#36825;&#37324;&#38656;&#35201;&#29305;&#21035;&#27880;&#24847;&#30340;&#26159;&#65292;&#22312;Spring3.1&#29256;&#26412;&#20197;&#21069;&#65292;<code class="literal">id</code>&#23646;&#24615;&#34987;&#23450;&#20041;&#25104;<code class="literal">xsd:ID</code>&#31867;&#22411;&#65288;&#21487;&#20197;&#36890;&#36807;xml&#35268;&#21017;&#38480;&#21046;&#21807;&#19968;&#65289;&#65292;
&#22312;Spring3.1&#20197;&#21450;&#20197;&#21518;&#30340;&#29256;&#26412;&#20013;&#65292;<code class="literal">id</code>&#34987;&#23450;&#20041;&#25104;&#20102;<code class="literal">xsd:string</code>&#31867;&#22411;&#65292;<code class="literal">id</code>&#23646;&#24615;&#19981;&#22312;&#36890;&#36807;XML&#35299;&#26512;&#22120;&#38480;&#21046;&#20026;&#21807;&#19968;&#65292;&#32780;&#26159;&#36890;&#36807;&#23481;&#22120;&#24378;&#21046;&#38480;&#21046;&#20026;&#21807;&#19968;&#12290;</p>
<p>bean&#30340;id&#21644;name&#19981;&#26159;&#24517;&#39035;&#30340;&#12290;&#22914;&#26524;&#27809;&#26377;&#26126;&#30830;&#30340;name&#25110;&#32773;id&#65292;&#23481;&#26131;&#20250;&#32473;bean&#29983;&#25104;&#19968;&#20010;&#21807;&#19968;&#30340;&#21517;&#23383;&#12290;
&#20294;&#26159;&#65292;&#22914;&#26524;&#20320;&#24819;&#36890;&#36807;&#21517;&#31216;&#24341;&#29992;&#36825;&#20010;bean&#65292;&#36890;&#36807;&#20351;&#29992;<code class="literal">ref</code>&#20803;&#32032;&#25110;<a class="link" href="beans.html#beans-servicelocator" title="5.16.2&nbsp;Glue code and the evil singleton">&#26381;&#21153;&#23450;&#20301;&#22120;&#27169;&#24335;</a> &#26597;&#25214;&#65292;&#20320;&#23601;&#24517;&#39035;&#25552;&#20379;&#19968;&#20010;&#21517;&#23383;&#12290;</p>
<p>&#19981;&#25552;&#20379;&#21517;&#31216;&#30340;&#21407;&#22240;&#21644;<a class="link" href="beans.html#beans-inner-beans" title="&#20869;&#37096;bean">&#20869;&#37096;beans</a>&#21644;<a class="link" href="beans.html#beans-factory-autowire" title="5.4.5&nbsp;&#33258;&#21160;&#35013;&#37197;&#21327;&#20316;&#32773;">&#33258;&#21160;&#35013;&#37197;</a>&#26377;&#20851;&#12290;</p>
<div class="sidebar"><div class="titlepage"><div><div><p class="title"><b>Bean&#21629;&#21517;&#32422;&#23450;</b></p></div></div></div>

<p>&#35813;&#20844;&#32422;&#20351;&#29992;&#26631;&#20934;&#30340;Java&#23454;&#20363;&#23383;&#27573;&#21517;&#31216;&#21629;&#21517;beans&#12290;&#20063;&#23601;&#26159;&#35828;bean&#21517;&#23383;&#30001;&#19968;&#20010;&#23567;&#20889;&#23383;&#27597;&#24320;&#22836;&#65292;&#21518;&#38754;&#37319;&#29992;&#39548;&#23792;&#24335;&#21629;&#21517;&#35268;&#21017;&#12290;
&#36825;&#31181;&#21517;&#23383;&#22914;&#65288;&#19981;&#21253;&#21547;&#24341;&#21495;&#65289;&#65306;<code class="literal">'accountManager'</code>&#12289;
<code class="literal">'accountService'</code>&#12289;<code class="literal">'userDao'</code>&#12289;<code class="literal">'loginController'</code>&#31561;&#31561;&#12290;</p>
<p>&#19968;&#33268;&#30340;beans&#21629;&#21517;&#21487;&#20197;&#35753;&#24744;&#30340;&#37197;&#32622;&#23481;&#26131;&#38405;&#35835;&#21644;&#29702;&#35299;&#65292;&#22914;&#26524;&#20320;&#27491;&#22312;&#20351;&#29992;Spring AOP&#65292;&#24403;&#20320;&#36890;&#36807;beans&#21517;&#31216;&#24212;&#29992;&#21040;advice&#26102;&#65292;&#36825;&#20250;&#23545;&#20320;&#24110;&#21161;&#24456;&#22823;&#12290;</p>
</div>

<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-beanname-alias" href="#beans-beanname-alias"></a>bean&#30340;&#21035;&#21517;</h4></div></div></div>

<p>&#22312;&#23545;bean&#23450;&#20041;&#26102;&#65292;&#38500;&#20102;&#20351;&#29992;<code class="literal">id</code>&#23646;&#24615;&#25351;&#23450;&#19968;&#20010;&#21807;&#19968;&#30340;&#21517;&#31216;&#22806;&#65292;&#20026;&#20102;&#25552;&#20379;&#22810;&#20010;&#21517;&#31216;&#65292;&#38656;&#35201;&#36890;&#36807;<code class="literal">name</code>&#23646;&#24615;&#21152;&#20197;&#25351;&#23450;&#65292;&#25152;&#26377;&#36825;&#20010;&#21517;&#31216;&#37117;&#25351;&#21521;&#21516;&#19968;&#20010;bean&#65292;&#22312;&#26576;&#20123;&#24773;&#20917;&#19979;&#25552;&#20379;&#21035;&#21517;&#38750;&#24120;&#26377;&#29992;&#65292;&#27604;&#22914;&#20026;&#20102;&#35753;&#24212;&#29992;&#27599;&#19968;&#20010;&#32452;&#20214;&#37117;&#33021;&#26356;&#23481;&#26131;&#30340;&#23545;&#20844;&#20849;&#32452;&#20214;&#36827;&#34892;&#24341;&#29992;&#12290;&#28982;&#32780;&#65292;&#22312;&#23450;&#20041;bean&#26102;&#23601;&#25351;&#23450;&#25152;&#26377;&#30340;&#21035;&#21517;&#24182;&#19981;&#24635;&#26159;&#24456;&#24688;&#24403;&#12290;&#26377;&#26102;&#25105;&#20204;&#26399;&#26395;&#33021;&#22815;&#22312;&#24403;&#21069;&#20301;&#32622;&#20026;&#37027;&#20123;&#22312;&#21035;&#22788;&#23450;&#20041;&#30340;bean&#24341;&#20837;&#21035;&#21517;&#12290;&#22312;XML&#37197;&#32622;&#25991;&#20214;&#20013;&#65292;&#21487;&#20197;&#36890;&#36807;<code class="literal">&lt;alias/&gt;</code>&#20803;&#32032;&#26469;&#23436;&#25104;bean&#21035;&#21517;&#30340;&#23450;&#20041;&#65292;&#20363;&#22914;&#65306;</p>
<pre class="programlisting"><span class="hl-tag">&lt;alias</span> <span class="hl-attribute">name</span>=<span class="hl-value">"fromName"</span> <span class="hl-attribute">alias</span>=<span class="hl-value">"toName"</span><span class="hl-tag">/&gt;</span></pre>

<p>&#22312;&#36825;&#31181;&#24773;&#20917;&#19979;&#65292;&#22914;&#26524;&#23481;&#26131;&#20013;&#23384;&#22312;&#21517;&#20026;<code class="literal">fromName</code>&#30340;bean&#23450;&#20041;&#65292;&#22312;&#22686;&#21152;&#21035;&#21517;&#23450;&#20041;&#21518;&#65292;&#20063;&#21487;&#20197;&#29992;<code class="literal">toName</code>&#26469;&#24341;&#29992;&#12290;</p>
<p>&#20363;&#22914;&#65292;&#22312;&#23376;&#31995;&#32479;A&#20013;&#36890;&#36807;&#21517;&#23383;<code class="literal">subsystemA-dataSource</code>&#37197;&#32622;&#30340;&#25968;&#25454;&#28304;&#12290;&#22312;&#23376;&#31995;&#32479;B&#20013;&#21487;&#33021;&#36890;&#36807;&#21517;&#23383;<code class="literal">subsystemB-dataSource</code>&#26469;&#24341;&#29992;&#12290;&#24403;&#20004;&#20010;&#23376;&#31995;&#32479;&#26500;&#25104;&#20027;&#24212;&#29992;&#30340;&#26102;&#20505;&#65292;&#20027;&#24212;&#29992;&#21487;&#33021;&#36890;&#36807;&#21517;&#23383;<code class="literal">myApp-dataSource</code>&#24341;&#29992;&#25968;&#25454;&#28304;&#65292;&#23558;&#20840;&#37096;&#19977;&#20010;&#21517;&#23383;&#24341;&#29992;&#21516;&#19968;&#20010;&#23545;&#35937;&#65292;&#20320;&#21487;&#20197;&#23558;&#19979;&#38754;&#30340;&#21035;&#21517;&#23450;&#20041;&#28155;&#21152;&#21040;&#24212;&#29992;&#37197;&#32622;&#20013;&#65306;</p>
<pre class="programlisting"><span class="hl-tag">&lt;alias</span> <span class="hl-attribute">name</span>=<span class="hl-value">"subsystemA-dataSource"</span> <span class="hl-attribute">alias</span>=<span class="hl-value">"subsystemB-dataSource"</span><span class="hl-tag">/&gt;</span>
<span class="hl-tag">&lt;alias</span> <span class="hl-attribute">name</span>=<span class="hl-value">"subsystemA-dataSource"</span> <span class="hl-attribute">alias</span>=<span class="hl-value">"myApp-dataSource"</span><span class="hl-tag"> /&gt;</span></pre>

<p>&#29616;&#22312;&#27599;&#20010;&#23376;&#31995;&#32479;&#21644;&#20027;&#24212;&#29992;&#37117;&#21487;&#20197;&#36890;&#36807;&#21807;&#19968;&#30340;&#21517;&#31216;&#26469;&#24341;&#29992;&#30456;&#21516;&#30340;&#25968;&#25454;&#28304;&#65292;&#24182;&#19988;&#21487;&#20197;&#20445;&#35777;&#20182;&#20204;&#30340;&#23450;&#20041;&#19981;&#19982;&#20219;&#20309;&#20854;&#20182;&#30340;&#23450;&#20041;&#20914;&#31361;&#12290;</p>
<div class="sidebar"><div class="titlepage"><div><div><p class="title"><b>&#22522;&#20110;Java&#30340;&#37197;&#32622;</b></p></div></div></div>

<p>&#22914;&#26524;&#20320;&#24819;&#20351;&#29992;&#22522;&#20110;Java&#30340;&#37197;&#32622;&#65292;<code class="literal">@Bean</code>&#27880;&#35299;&#21487;&#20197;&#29992;&#26469;&#25552;&#20379;&#21035;&#21517;&#65292;&#35814;&#32454;&#20449;&#24687;&#35831;&#30475;
<a class="xref" href="beans.html#beans-java-bean-annotation" title="5.12.3&nbsp;&#20351;&#29992;@Bean&#27880;&#35299;">Section&nbsp;5.12.3, &#8220;&#20351;&#29992;@Bean&#27880;&#35299;&#8221;</a> &#12290;</p>
</div>

</div>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="beans-factory-class" href="#beans-factory-class"></a>5.3.2&nbsp;&#23454;&#20363;&#21270;bean</h3></div></div></div>

<p>bean&#23450;&#20041;&#22522;&#26412;&#19978;&#23601;&#26159;&#29992;&#26469;&#21019;&#24314;&#19968;&#20010;&#25110;&#22810;&#20010;&#23545;&#35937;&#30340;&#37197;&#26041;(recipe,&#26377;&#26356;&#21512;&#36866;&#30340;&#32763;&#35793;?)&#65292;&#24403;&#38656;&#35201;&#19968;&#20010;bean&#30340;&#26102;&#20505;&#65292;&#23481;&#22120;&#26597;&#30475;&#37197;&#26041;&#24182;&#19988;&#26681;&#25454;bean&#23450;&#20041;&#23553;&#35013;&#30340;&#37197;&#32622;&#20803;&#25968;&#25454;&#21019;&#24314;&#65288;&#25110;&#33719;&#21462;&#65289;&#19968;&#20010;&#23454;&#38469;&#30340;&#23545;&#35937;&#12290;</p>
<p>&#22914;&#26524;&#20320;&#20351;&#29992;&#22522;&#20110;XML&#30340;&#37197;&#32622;&#65292;&#20320;&#21487;&#20197;&#22312;<code class="literal">&lt;bean/&gt;</code>&#20803;&#32032;&#36890;&#36807;<code class="literal">class</code>&#23646;&#24615;&#26469;&#25351;&#23450;&#23545;&#35937;&#30340;&#31867;&#22411;&#12290;&#36825;&#20010;<code class="literal">class</code>&#23646;&#24615;&#65292;&#23454;&#38469;&#19978;&#26159;<code class="literal">BeanDefinition</code>&#23454;&#20363;&#20013;&#30340;&#19968;&#20010;<code class="literal">Class</code>&#23646;&#24615;&#12290;&#36825;&#20010;<code class="literal">class</code>&#23646;&#24615;&#36890;&#24120;&#26159;&#24517;&#39035;&#30340;&#65288;&#20363;&#22806;&#24773;&#20917;&#65292;&#26597;&#30475;<a class="xref" href="beans.html#beans-factory-class-instance-factory-method" title="&#20351;&#29992;&#23454;&#20363;&#24037;&#21378;&#26041;&#27861;&#23454;&#20363;&#21270;">the section called &#8220;&#20351;&#29992;&#23454;&#20363;&#24037;&#21378;&#26041;&#27861;&#23454;&#20363;&#21270;&#8221;</a> &#21644; <a class="xref" href="beans.html#beans-child-bean-definitions" title="5.7&nbsp;Bean&#23450;&#20041;&#30340;&#32487;&#25215;">Section&nbsp;5.7, &#8220;Bean&#23450;&#20041;&#30340;&#32487;&#25215;&#8221;</a>&#65289;&#65292;&#20351;&#29992;<code class="literal">Class</code>&#23646;&#24615;&#30340;&#20004;&#31181;&#26041;&#24335;&#65306;</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
&#36890;&#24120;&#24773;&#20917;&#19979;&#65292;&#30452;&#25509;&#36890;&#36807;&#21453;&#23556;&#35843;&#29992;&#26500;&#36896;&#26041;&#27861;&#26469;&#21019;&#24314;bean&#65292;&#21644;&#22312;Java&#20195;&#30721;&#20013;&#20351;&#29992;<code class="literal">new</code>&#26377;&#28857;&#20687;&#12290;
</li><li class="listitem">
&#36890;&#36807;&#38745;&#24577;&#24037;&#21378;&#26041;&#27861;&#21019;&#24314;&#65292;&#31867;&#20013;&#21253;&#21547;&#38745;&#24577;&#26041;&#27861;&#12290;&#36890;&#36807;&#35843;&#29992;&#38745;&#24577;&#26041;&#27861;&#36820;&#22238;&#23545;&#35937;&#30340;&#31867;&#22411;&#21487;&#33021;&#21644;<code class="literal">Class</code>&#19968;&#26679;&#65292;&#20063;&#21487;&#33021;&#23436;&#20840;&#19981;&#19968;&#26679;&#12290;
</li></ul></div>

<div class="sidebar"><div class="titlepage"></div>
<p>
<b>&#20869;&#37096;&#31867;&#21517;.&nbsp;</b>
&#22914;&#26524;&#20320;&#24819;&#37197;&#32622;&#20351;&#29992;&#38745;&#24577;&#30340;&#20869;&#37096;&#31867;&#65292;&#20320;&#24517;&#39035;&#29992;&#20869;&#37096;&#31867;&#30340;&#20108;&#36827;&#21046;&#21517;&#31216;&#12290;
</p>
<p>&#20363;&#22914;&#65292;&#22312;<code class="literal">com.example</code>&#21253;&#19979;&#26377;&#20010;<code class="literal">Foo</code>&#31867;&#65292;&#36825;&#37324;&#31867;&#37324;&#38754;&#26377;&#20010;&#38745;&#24577;&#30340;&#20869;&#37096;&#31867;<code class="literal">Bar</code>&#65292;&#36825;&#31181;&#24773;&#20917;&#19979;bean&#23450;&#20041;&#30340;<code class="literal">class</code>&#23646;&#24615;&#24212;&#35813;&#8230;</p>
<p><code class="literal">com.example.Foo$Bar</code></p>
<p>&#27880;&#24847;&#65292;&#20351;&#29992;<code class="literal">$</code>&#23383;&#31526;&#26469;&#20998;&#21106;&#22806;&#37096;&#31867;&#21644;&#20869;&#37096;&#31867;&#30340;&#21517;&#31216;&#12290;</p>
</div>

<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-factory-class-ctor" href="#beans-factory-class-ctor"></a>&#36890;&#36807;&#26500;&#36896;&#20989;&#25968;&#23454;&#20363;&#21270;</h4></div></div></div>

<p>&#24403;&#20320;&#20351;&#29992;&#26500;&#36896;&#26041;&#27861;&#26469;&#21019;&#24314;bean&#30340;&#26102;&#20505;&#65292;Spring&#23545;class&#27809;&#26377;&#29305;&#27530;&#30340;&#35201;&#27714;&#12290;&#20063;&#23601;&#26159;&#35828;&#65292;&#27491;&#22312;&#24320;&#21457;&#30340;&#31867;&#19981;&#38656;&#35201;&#23454;&#29616;&#20219;&#20309;&#29305;&#23450;&#30340;&#25509;&#21475;&#25110;&#32773;&#20197;&#29305;&#23450;&#30340;&#26041;&#24335;&#36827;&#34892;&#32534;&#30721;&#12290;&#20294;&#26159;&#65292;&#26681;&#25454;&#20320;&#20351;&#29992;&#37027;&#31181;&#31867;&#22411;&#30340;IoC&#26469;&#25351;&#23450;bean&#65292;&#20320;&#21487;&#33021;&#38656;&#35201;&#19968;&#20010;&#40664;&#35748;&#65288;&#26080;&#21442;&#65289;&#30340;&#26500;&#36896;&#26041;&#27861;&#12290;</p>
<p>Spring IoC
&#23481;&#22120;&#21487;&#20197;&#31649;&#29702;&#20960;&#20046;&#25152;&#26377;&#20320;&#24819;&#35753;&#23427;&#31649;&#29702;&#30340;&#31867;&#65292;&#23427;&#19981;&#38480;&#20110;&#31649;&#29702;POJO&#12290;&#22823;&#22810;&#25968;Spring&#29992;&#25143;&#26356;&#21916;&#27426;&#20351;&#29992;POJO&#65288;&#19968;&#20010;&#40664;&#35748;&#26080;&#21442;&#30340;&#26500;&#36896;&#26041;&#27861;&#21644;setter,getter&#26041;&#27861;&#65289;&#12290;&#20294;&#22312;&#23481;&#22120;&#20013;&#20351;&#29992;&#38750;bean&#24418;&#24335;(non-bean style)&#30340;&#31867;&#20063;&#26159;&#21487;&#20197;&#30340;&#12290;&#27604;&#22914;&#36951;&#30041;&#31995;&#32479;&#20013;&#30340;&#36830;&#25509;&#27744;&#65292;&#24456;&#26174;&#28982;&#23427;&#19982;JavaBean&#35268;&#33539;&#19981;&#31526;&#65292;&#20294;Spring&#20063;&#33021;&#31649;&#29702;&#23427;&#12290;</p>
<p>&#24403;&#20351;&#29992;&#22522;&#20110;XML&#30340;&#20803;&#25968;&#25454;&#37197;&#32622;&#25991;&#20214;&#65292;&#21487;&#20197;&#36825;&#26679;&#26469;&#25351;&#23450;bean&#31867;&#65306;</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"exampleBean"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"examples.ExampleBean"</span><span class="hl-tag">/&gt;</span>

<span class="hl-tag">&lt;bean</span> <span class="hl-attribute">name</span>=<span class="hl-value">"anotherExample"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"examples.ExampleBeanTwo"</span><span class="hl-tag">/&gt;</span></pre>

<p>&#32473;&#26500;&#36896;&#26041;&#27861;&#25351;&#23450;&#21442;&#25968;&#20197;&#21450;&#20026;bean&#23454;&#20363;&#21270;&#35774;&#32622;&#23646;&#24615;&#23558;&#22312;&#21518;&#38754;&#30340;<a class="link" href="beans.html#beans-factory-collaborators" title="5.4.1&nbsp;&#20381;&#36182;&#27880;&#20837;">&#20381;&#36182;&#27880;&#20837;</a>&#20013;&#35814;&#32454;&#35828;&#26126;&#12290;</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-factory-class-static-factory-method" href="#beans-factory-class-static-factory-method"></a>&#20351;&#29992;&#38745;&#24577;&#24037;&#21378;&#26041;&#27861;&#23454;&#20363;&#21270;</h4></div></div></div>

<p>&#24403;&#37319;&#29992;&#38745;&#24577;&#24037;&#21378;&#26041;&#27861;&#21019;&#24314;bean&#26102;&#65292;&#38500;&#20102;&#38656;&#35201;&#25351;&#23450;class&#23646;&#24615;&#22806;&#65292;&#36824;&#38656;&#35201;&#36890;&#36807;factory-method&#23646;&#24615;&#26469;&#25351;&#23450;&#21019;&#24314;bean&#23454;&#20363;&#30340;&#24037;&#21378;&#26041;&#27861;&#12290;Spring&#23558;&#35843;&#29992;&#27492;&#26041;&#27861;(&#20854;&#21487;&#36873;&#21442;&#25968;&#25509;&#19979;&#26469;&#20171;&#32461;)&#36820;&#22238;&#23454;&#20363;&#23545;&#35937;&#65292;&#23601;&#27492;&#32780;&#35328;&#65292;&#36319;&#36890;&#36807;&#26222;&#36890;&#26500;&#36896;&#22120;&#21019;&#24314;&#31867;&#23454;&#20363;&#27809;&#20160;&#20040;&#20004;&#26679;&#12290;</p>
<p>&#19979;&#38754;&#30340;bean&#23450;&#20041;&#23637;&#31034;&#20102;&#22914;&#20309;&#36890;&#36807;&#24037;&#21378;&#26041;&#27861;&#26469;&#21019;&#24314;bean&#23454;&#20363;&#12290;&#27880;&#24847;&#65292;&#27492;&#23450;&#20041;&#24182;&#26410;&#25351;&#23450;&#36820;&#22238;&#23545;&#35937;&#30340;&#31867;&#22411;&#65292;&#20165;&#25351;&#23450;&#35813;&#31867;&#21253;&#21547;&#30340;&#24037;&#21378;&#26041;&#27861;&#12290;&#22312;&#27492;&#20363;&#20013;&#65292;<code class="literal">createInstance()</code>&#24517;&#39035;&#26159;&#19968;&#20010;<span class="emphasis"><em>static</em></span>&#26041;&#27861;&#12290;</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"clientService"</span>
    <span class="hl-attribute">class</span>=<span class="hl-value">"examples.ClientService"</span>
    <span class="hl-attribute">factory-method</span>=<span class="hl-value">"createInstance"</span><span class="hl-tag">/&gt;</span></pre>

<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> ClientService {
    <span class="hl-keyword">private</span> <span class="hl-keyword">static</span> ClientService clientService = <span class="hl-keyword">new</span> ClientService();
    <span class="hl-keyword">private</span> ClientService() {}

    <span class="hl-keyword">public</span> <span class="hl-keyword">static</span> ClientService createInstance() {
        <span class="hl-keyword">return</span> clientService;
    }
}</pre>

<p>&#32473;&#24037;&#21378;&#26041;&#27861;&#25351;&#23450;&#21442;&#25968;&#20197;&#21450;&#20026;bean&#23454;&#20363;&#35774;&#32622;&#23646;&#24615;&#30340;&#35814;&#32454;&#20869;&#23481;&#35831;&#26597;&#38405;<a class="link" href="beans.html#beans-factory-properties-detailed" title="5.4.2&nbsp;&#20381;&#36182;&#37197;&#32622;&#35814;&#35299;">&#20381;&#36182;&#21644;&#37197;&#32622;&#35814;&#35299;</a>&#12290;</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-factory-class-instance-factory-method" href="#beans-factory-class-instance-factory-method"></a>&#20351;&#29992;&#23454;&#20363;&#24037;&#21378;&#26041;&#27861;&#23454;&#20363;&#21270;</h4></div></div></div>

<p>&#19982;&#36890;&#36807; <a class="link" href="beans.html#beans-factory-class-static-factory-method" title="&#20351;&#29992;&#38745;&#24577;&#24037;&#21378;&#26041;&#27861;&#23454;&#20363;&#21270;">&#38745;&#24577;&#24037;&#21378;&#26041;&#27861;</a> &#23454;&#20363;&#21270;&#31867;&#20284;&#65292;&#36890;&#36807;&#35843;&#29992;&#24037;&#21378;&#23454;&#20363;&#30340;&#38750;&#38745;&#24577;&#26041;&#27861;&#36827;&#34892;&#23454;&#20363;&#21270;&#12290;
&#20351;&#29992;&#36825;&#31181;&#26041;&#24335;&#26102;&#65292;class&#23646;&#24615;&#24517;&#39035;&#20026;&#31354;&#65292;&#32780;factory-bean&#23646;&#24615;&#24517;&#39035;&#25351;&#23450;&#20026;&#24403;&#21069;(&#25110;&#20854;&#31062;&#20808;)&#23481;&#22120;&#20013;&#21253;&#21547;&#24037;&#21378;&#26041;&#27861;&#30340;bean&#30340;&#21517;&#31216;&#65292;&#32780;&#35813;&#24037;&#21378;bean&#30340;&#24037;&#21378;&#26041;&#27861;&#26412;&#36523;&#24517;&#39035;&#36890;&#36807;factory-method&#23646;&#24615;&#26469;&#35774;&#23450;&#12290;</p>
<pre class="programlisting"><span class="hl-comment">&lt;!-- &#24037;&#21378;bean&#65292;&#21253;&#21547;createInstance()&#26041;&#27861; --&gt;</span>
<span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"serviceLocator"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"examples.DefaultServiceLocator"</span><span class="hl-tag">&gt;</span>
    <span class="hl-comment">&lt;!-- &#20854;&#20182;&#38656;&#35201;&#27880;&#20837;&#30340;&#20381;&#36182;&#39033; --&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span>

<span class="hl-comment">&lt;!-- &#36890;&#36807;&#24037;&#21378;bean&#21019;&#24314;&#30340;ben --&gt;</span>
<span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"clientService"</span>
    <span class="hl-attribute">factory-bean</span>=<span class="hl-value">"serviceLocator"</span>
    <span class="hl-attribute">factory-method</span>=<span class="hl-value">"createClientServiceInstance"</span><span class="hl-tag">/&gt;</span></pre>

<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> DefaultServiceLocator {

    <span class="hl-keyword">private</span> <span class="hl-keyword">static</span> ClientService clientService = <span class="hl-keyword">new</span> ClientServiceImpl();
    <span class="hl-keyword">private</span> DefaultServiceLocator() {}

    <span class="hl-keyword">public</span> ClientService createClientServiceInstance() {
        <span class="hl-keyword">return</span> clientService;
    }
}</pre>

<p>&#19968;&#20010;&#24037;&#21378;&#31867;&#20063;&#21487;&#20197;&#26377;&#22810;&#20010;&#24037;&#21378;&#26041;&#27861;&#65292;&#22914;&#19979;&#20195;&#30721;&#25152;&#31034;&#65306;</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"serviceLocator"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"examples.DefaultServiceLocator"</span><span class="hl-tag">&gt;</span>
    <span class="hl-comment">&lt;!-- &#20854;&#20182;&#38656;&#35201;&#27880;&#20837;&#30340;&#20381;&#36182;&#39033; --&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span>

<span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"clientService"</span>
    <span class="hl-attribute">factory-bean</span>=<span class="hl-value">"serviceLocator"</span>
    <span class="hl-attribute">factory-method</span>=<span class="hl-value">"createClientServiceInstance"</span><span class="hl-tag">/&gt;</span>

<span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"accountService"</span>
    <span class="hl-attribute">factory-bean</span>=<span class="hl-value">"serviceLocator"</span>
    <span class="hl-attribute">factory-method</span>=<span class="hl-value">"createAccountServiceInstance"</span><span class="hl-tag">/&gt;</span></pre>

<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> DefaultServiceLocator {

    <span class="hl-keyword">private</span> <span class="hl-keyword">static</span> ClientService clientService = <span class="hl-keyword">new</span> ClientServiceImpl();
    <span class="hl-keyword">private</span> <span class="hl-keyword">static</span> AccountService accountService = <span class="hl-keyword">new</span> AccountServiceImpl();

    <span class="hl-keyword">private</span> DefaultServiceLocator() {}

    <span class="hl-keyword">public</span> ClientService createClientServiceInstance() {
        <span class="hl-keyword">return</span> clientService;
    }

    <span class="hl-keyword">public</span> AccountService createAccountServiceInstance() {
        <span class="hl-keyword">return</span> accountService;
    }

}</pre>

<p>&#36825;&#31181;&#20570;&#27861;&#34920;&#26126;&#24037;&#21378;bean&#26412;&#36523;&#20063;&#21487;&#20197;&#36890;&#36807;&#20381;&#36182;&#27880;&#20837;&#65288;DI&#65289;&#36827;&#34892;&#31649;&#29702;&#37197;&#32622;&#12290;&#26597;&#30475;<a class="link" href="beans.html#beans-factory-properties-detailed" title="5.4.2&nbsp;&#20381;&#36182;&#37197;&#32622;&#35814;&#35299;">&#20381;&#36182;&#21644;&#37197;&#32622;&#35814;&#35299;</a>&#12290;</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p>&#22312;Spring&#25991;&#26723;&#20013;&#65292;<span class="emphasis"><em>factory bean</em></span>&#26159;&#25351;&#22312;Spring&#23481;&#22120;&#20013;&#37197;&#32622;&#30340;&#24037;&#21378;&#31867;&#36890;&#36807;
<a class="link" href="beans.html#beans-factory-class-instance-factory-method" title="&#20351;&#29992;&#23454;&#20363;&#24037;&#21378;&#26041;&#27861;&#23454;&#20363;&#21270;">&#23454;&#20363;</a> &#25110;
<a class="link" href="beans.html#beans-factory-class-static-factory-method" title="&#20351;&#29992;&#38745;&#24577;&#24037;&#21378;&#26041;&#27861;&#23454;&#20363;&#21270;">&#38745;&#24577;</a> &#24037;&#21378;&#26041;&#27861;&#26469;&#21019;&#24314;&#23545;&#35937;&#12290;&#30456;&#27604;&#32780;&#35328;,
<code class="literal">FactoryBean</code> (&#27880;&#24847;&#22823;&#23567;&#20889;) &#20195;&#34920;&#20102;Spring&#20013;&#29305;&#23450;&#30340;
<a class="link" href="beans.html#beans-factory-extension-factorybean" title="5.8.3&nbsp;Customizing instantiation logic with a FactoryBean"><code class="literal">FactoryBean</code></a>.</p>
</td></tr></table></div>

</div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="beans-dependencies" href="#beans-dependencies"></a>5.4&nbsp;&#20381;&#36182;</h2></div></div></div>

<p>&#20856;&#22411;&#30340;&#20225;&#19994;&#24212;&#29992;&#19981;&#20250;&#21333;&#19968;&#24471;&#30001;&#19968;&#20010;&#23545;&#35937;&#32452;&#25104;&#65288;&#25110;&#32773;&#35828;Spring&#26415;&#35821;&#20013;&#30340;bean&#65289;&#12290;&#21363;&#20415;&#26159;&#26368;&#31616;&#21333;&#30340;&#31995;&#32479;&#20063;&#38656;&#35201;&#22810;&#20010;&#23545;&#35937;&#20849;&#21516;&#21327;&#20316;&#26469;&#23637;&#31034;&#32473;&#32456;&#31471;&#29992;&#25143;&#19968;&#20010;&#26465;&#29702;&#20998;&#26126;&#30340;&#24212;&#29992;&#12290;&#25509;&#19979;&#26469;&#30340;&#36825;&#19968;&#33410;&#20869;&#23481;&#20250;&#38416;&#36848;&#22914;&#20309;&#23450;&#20041;&#22810;&#20010;&#29420;&#31435;&#20110;&#24212;&#29992;&#31243;&#24207;&#30340;bean&#19968;&#36215;&#21327;&#21516;&#24037;&#20316;&#23436;&#25104;&#30446;&#26631;&#12290;</p>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="beans-factory-collaborators" href="#beans-factory-collaborators"></a>5.4.1&nbsp;&#20381;&#36182;&#27880;&#20837;</h3></div></div></div>

<p><span class="emphasis"><em>&#20381;&#36182;&#27880;&#20837;</em></span> (DI) &#26159;&#25351;&#23545;&#35937;&#20043;&#38388;&#30340;&#20381;&#36182;&#20851;&#31995;&#65292;&#20063;&#23601;&#26159;&#35828;&#65292;&#19968;&#36215;&#21327;&#20316;&#30340;&#20854;&#20182;&#23545;&#35937;&#21482;&#36890;&#36807;&#26500;&#36896;&#22120;&#30340;&#21442;&#25968;&#12289;&#24037;&#21378;&#26041;&#27861;&#30340;&#21442;&#25968;&#25110;&#32773;&#30001;&#26500;&#36896;&#20989;&#25968;&#25110;&#32773;&#24037;&#21378;&#26041;&#27861;&#21019;&#24314;&#30340;&#23545;&#35937;&#35774;&#32622;&#23646;&#24615;&#12290;&#22240;&#27492;&#23481;&#22120;&#30340;&#24037;&#20316;&#23601;&#26159;&#21019;&#24314;bean&#24182;&#27880;&#20837;&#37027;&#20123;&#20381;&#36182;&#20851;&#31995;&#12290;&#36825;&#20010;&#36807;&#31243;&#23454;&#36136;&#36890;&#36807;&#30452;&#25509;&#20351;&#29992;&#31867;&#30340;&#26500;&#36896;&#20989;&#25968;&#25110;&#32773;&#26381;&#21153;&#23450;&#20301;&#27169;&#24335;&#26469;&#21453;&#36716;&#25511;&#21046;bean&#30340;&#23454;&#20363;&#25110;&#32773;&#20854;&#20381;&#36182;&#20851;&#31995;&#30340;&#20301;&#32622;&#65292;&#22240;&#27492;&#23427;&#26377;&#21478;&#22806;&#19968;&#20010;&#21517;&#23383;&#21483;<span class="emphasis"><em>&#25511;&#21046;&#21453;&#36716;</em></span> (IoC)&#12290;</p>
<p>&#36816;&#29992;&#20102;DI&#21407;&#29702;&#20195;&#30721;&#20250;&#26356;&#21152;&#28165;&#26224;&#24182;&#19988;&#30001;&#20381;&#36182;&#20851;&#31995;&#25552;&#20379;&#23545;&#35937;&#20063;&#23558;&#20351;&#21508;&#23618;&#27425;&#30340;&#26494;&#32806;&#21512;&#21464;&#24471;&#26356;&#21152;&#23481;&#26131;&#12290;&#23545;&#35937;&#19981;&#38656;&#35201;&#30693;&#36947;&#20854;&#20381;&#36182;&#20851;&#31995;&#65292;&#20063;&#19981;&#38656;&#35201;&#30693;&#36947;&#23427;&#30340;&#20301;&#32622;&#25110;&#32773;&#31867;&#20043;&#38388;&#30340;&#20381;&#36182;&#12290;&#22240;&#27492;&#65292;&#20320;&#30340;&#31867;&#20250;&#26356;&#23481;&#26131;&#27979;&#35797;&#65292;&#23588;&#20854;&#26159;&#24403;&#20381;&#36182;&#20851;&#31995;&#26159;&#22312;&#25509;&#21475;&#25110;&#32773;&#25277;&#35937;&#22522;&#26412;&#31867;&#65292;</p>
<p>DI&#20027;&#35201;&#26377;&#20004;&#31181;&#27880;&#20837;&#26041;&#24335;&#65292;&#21363;<a class="link" href="beans.html#beans-constructor-injection" title="&#26500;&#36896;&#22120;&#27880;&#20837;">&#26500;&#36896;&#22120;&#27880;&#20837;</a>&#21644;<a class="link" href="beans.html#beans-setter-injection" title="Setter&#27880;&#20837;">Setter&#27880;&#20837;</a>&#12290;</p>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-constructor-injection" href="#beans-constructor-injection"></a>&#26500;&#36896;&#22120;&#27880;&#20837;</h4></div></div></div>

<p><span class="emphasis"><em>&#22522;&#20110;&#26500;&#36896;&#22120;&#27880;&#20837;</em></span> DI&#36890;&#36807;&#35843;&#29992;&#24102;&#21442;&#25968;&#30340;&#26500;&#36896;&#22120;&#26469;&#23454;&#29616;&#65292;&#27599;&#20010;&#21442;&#25968;&#20195;&#34920;&#30528;&#19968;&#20010;&#20381;&#36182;&#20851;&#31995;&#12290;&#27492;&#22806;&#65292;&#36824;&#21487;&#36890;&#36807;&#32473; <code class="literal">&#38745;&#24577;</code> &#24037;&#21378;&#26041;&#27861;&#20256;&#21442;&#25968;&#26469;&#26500;&#36896;bean&#12290;&#25509;&#19979;&#26469;&#30340;&#20171;&#32461;&#23558;&#35748;&#20026;&#32473;&#26500;&#36896;&#22120;&#20256;&#21442;&#25968;&#21644;&#32473;&#38745;&#24577;&#24037;&#21378;&#26041;&#27861;&#20256;&#21442;&#25968;&#26159;&#31867;&#20284;&#30340;&#12290;&#19979;&#38754;&#23637;&#31034;&#20102;&#21482;&#33021;&#20351;&#29992;&#26500;&#36896;&#22120;&#26469;&#27880;&#20837;&#20381;&#36182;&#20851;&#31995;&#30340;&#20363;&#23376;&#12290;&#35831;&#27880;&#24847;&#36825;&#20010;&#31867;&#24182;&#27809;&#26377;&#20160;&#20040; <span class="emphasis"><em>&#29305;&#21035;</em></span> &#20043;&#22788;,&#23427;&#21482;&#26159;&#20010;&#26222;&#36890;&#30340;POJO&#65292;&#19981;&#20381;&#36182;&#20110;&#29305;&#27530;&#30340;&#25509;&#21475;&#65292;&#25277;&#35937;&#31867;&#25110;&#32773;&#27880;&#35299;&#12290;</p>
<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> SimpleMovieLister {

    <span class="hl-comment">// the SimpleMovieLister has a dependency on a MovieFinder</span>
    <span class="hl-keyword">private</span> MovieFinder movieFinder;

    <span class="hl-comment">// a constructor so that the Spring container can inject a MovieFinder</span>
    <span class="hl-keyword">public</span> SimpleMovieLister(MovieFinder movieFinder) {
        <span class="hl-keyword">this</span>.movieFinder = movieFinder;
    }

    <span class="hl-comment">// business logic that actually uses the injected MovieFinder is omitted...</span>

}</pre>

<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="beans-factory-ctor-arguments-resolution" href="#beans-factory-ctor-arguments-resolution"></a>&#26500;&#36896;&#22120;&#21442;&#25968;&#35299;&#26512;</h5></div></div></div>

<p>&#26500;&#36896;&#22120;&#21442;&#25968;&#36890;&#36807;&#21442;&#25968;&#31867;&#22411;&#36827;&#34892;&#21305;&#37197;&#12290;&#22914;&#26524;&#26500;&#36896;&#22120;&#21442;&#25968;&#30340;&#31867;&#22411;&#23450;&#20041;&#27809;&#26377;&#28508;&#22312;&#30340;&#27495;&#20041;&#65292;&#37027;&#20040;bean&#34987;&#23454;&#20363;&#21270;&#30340;&#26102;&#20505;&#65292;bean&#23450;&#20041;&#20013;&#26500;&#36896;&#22120;&#21442;&#25968;&#30340;&#23450;&#20041;&#39034;&#24207;&#23601;&#26159;&#36825;&#20123;&#21442;&#25968;&#30340;&#39034;&#24207;&#24182;&#20381;&#27425;&#36827;&#34892;&#21305;&#37197;&#12290;&#30475;&#19979;&#38754;&#30340;&#20195;&#30721;&#65306;</p>
<pre class="programlisting"><span class="hl-keyword">package</span> x.y;

<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> Foo {

    <span class="hl-keyword">public</span> Foo(Bar bar, Baz baz) {
        <span class="hl-comment">// ...</span>
    }

}</pre>

<p>&#19978;&#36848;&#20195;&#30721;&#20013;&#21442;&#25968;&#31867;&#22411;&#23450;&#20041;&#19981;&#23384;&#22312;&#28508;&#22312;&#30340;&#27495;&#20041;&#65292;&#25105;&#20204;&#20551;&#35774;<code class="literal">Bar</code>&#21644;<code class="literal">Baz</code>&#20043;&#38388;&#19981;&#23384;&#22312;&#32487;&#25215;&#20851;&#31995;&#12290;&#22240;&#27492;&#65292;&#19979;&#38754;&#20195;&#30721;&#20013;&#22312;&#20803;&#32032;<code class="literal">&lt;constructor-arg/&gt;</code>&#30340;&#37197;&#32622;&#21363;&#20351;&#27809;&#26377;&#26126;&#30830;&#25351;&#23450;&#26500;&#36896;&#21442;&#25968;&#39034;&#24207;&#25110;&#32773;&#31867;&#22411;&#20063;&#20250;&#36215;&#20316;&#29992;&#12290;</p>
<pre class="programlisting"><span class="hl-tag">&lt;beans&gt;</span>
    <span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"foo"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"x.y.Foo"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;constructor-arg</span> <span class="hl-attribute">ref</span>=<span class="hl-value">"bar"</span><span class="hl-tag">/&gt;</span>
        <span class="hl-tag">&lt;constructor-arg</span> <span class="hl-attribute">ref</span>=<span class="hl-value">"baz"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;/bean&gt;</span>

    <span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"bar"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"x.y.Bar"</span><span class="hl-tag">/&gt;</span>

    <span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"baz"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"x.y.Baz"</span><span class="hl-tag">/&gt;</span>
<span class="hl-tag">&lt;/beans&gt;</span></pre>

<p>&#24403;&#21478;&#19968;&#20010;bean&#34987;&#24341;&#29992;&#65292;&#23427;&#30340;&#31867;&#22411;&#26159;&#24050;&#30693;&#30340;&#65292;&#24182;&#19988;&#21305;&#37197;&#20063;&#27809;&#38382;&#39064;&#65288;&#36319;&#21069;&#38754;&#30340;&#20363;&#23376;&#19968;&#26679;&#65289;&#12290;&#24403;&#25105;&#20204;&#20351;&#29992;&#31616;&#21333;&#31867;&#22411;&#65292;&#27604;&#22914;<code class="literal">&lt;value&gt;true&lt;/value&gt;</code>&#12290;Spring&#24182;&#19981;&#33021;&#30693;&#36947;&#35813;&#20540;&#30340;&#31867;&#22411;&#65292;&#19981;&#20511;&#21161;&#20854;&#20182;&#24110;&#21161;Spring&#23558;&#19981;&#33021;&#36890;&#36807;&#31867;&#22411;&#36827;&#34892;&#21305;&#37197;&#12290;&#30475;&#19979;&#38754;&#30340;&#31867;&#65306;</p>
<pre class="programlisting"><span class="hl-keyword">package</span> examples;

<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> ExampleBean {

    <span class="hl-comment">// Number of years to calculate the Ultimate Answer</span>
    <span class="hl-keyword">private</span> <span class="hl-keyword">int</span> years;

    <span class="hl-comment">// The Answer to Life, the Universe, and Everything</span>
    <span class="hl-keyword">private</span> String ultimateAnswer;

    <span class="hl-keyword">public</span> ExampleBean(<span class="hl-keyword">int</span> years, String ultimateAnswer) {
        <span class="hl-keyword">this</span>.years = years;
        <span class="hl-keyword">this</span>.ultimateAnswer = ultimateAnswer;
    }

}</pre>

<p>&#38024;&#23545;&#19978;&#38754;&#30340;&#22330;&#26223;&#21487;&#20197;&#20351;&#29992;<code class="literal">type</code>&#23646;&#24615;&#26469;&#26174;&#24335;&#25351;&#23450;&#37027;&#20123;&#31616;&#21333;&#31867;&#22411;&#37027;&#20010;&#30340;&#26500;&#36896;&#21442;&#25968;&#31867;&#22411;&#65292;&#27604;&#22914;&#65306;</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"exampleBean"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"examples.ExampleBean"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;constructor-arg</span> <span class="hl-attribute">type</span>=<span class="hl-value">"int"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"7500000"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;constructor-arg</span> <span class="hl-attribute">type</span>=<span class="hl-value">"java.lang.String"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"42"</span><span class="hl-tag">/&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span></pre>

<p>&#20351;&#29992;<code class="literal">index</code>&#23646;&#24615;&#26469;&#26174;&#24335;&#25351;&#23450;&#26500;&#36896;&#21442;&#25968;&#30340;&#32034;&#24341;&#65292;&#27604;&#22914;&#65306;</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"exampleBean"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"examples.ExampleBean"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;constructor-arg</span> <span class="hl-attribute">index</span>=<span class="hl-value">"0"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"7500000"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;constructor-arg</span> <span class="hl-attribute">index</span>=<span class="hl-value">"1"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"42"</span><span class="hl-tag">/&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span></pre>

<p>&#20351;&#29992;&#32034;&#24341;&#21487;&#20197;&#35299;&#20915;&#22810;&#20010;&#31616;&#21333;&#20540;&#30340;&#28151;&#28102;&#65292;&#36824;&#33021;&#35299;&#20915;&#26500;&#36896;&#26041;&#27861;&#26377;&#20004;&#20010;&#30456;&#21516;&#31867;&#22411;&#30340;&#21442;&#25968;&#30340;&#28151;&#28102;&#38382;&#39064;&#65292;&#27880;&#24847;<span class="emphasis"><em>index&#26159;&#20174;0&#24320;&#22987;&#30340;</em></span>&#12290;</p>
<p>&#20320;&#20063;&#21487;&#20197;&#20351;&#29992;&#26500;&#36896;&#22120;&#21442;&#25968;&#21629;&#21517;&#26469;&#25351;&#23450;&#20540;&#30340;&#31867;&#22411;&#65306;</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"exampleBean"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"examples.ExampleBean"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;constructor-arg</span> <span class="hl-attribute">name</span>=<span class="hl-value">"years"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"7500000"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;constructor-arg</span> <span class="hl-attribute">name</span>=<span class="hl-value">"ultimateAnswer"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"42"</span><span class="hl-tag">/&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span></pre>

<p>&#35831;&#35760;&#20303;&#20026;&#20102;&#20351;&#36825;&#20010;&#36215;&#20316;&#29992;&#65292;&#20320;&#30340;&#20195;&#30721;&#32534;&#35793;&#26102;&#35201;&#25171;&#24320;&#32534;&#35793;&#27169;&#24335;&#65292;&#36825;&#26679;Spring&#21487;&#20197;&#26816;&#26597;&#26500;&#36896;&#26041;&#27861;&#30340;&#21442;&#25968;&#12290;&#22914;&#26524;&#20320;&#19981;&#25171;&#24320;&#35843;&#35797;&#27169;&#24335;&#65288;&#25110;&#32773;&#19981;&#24819;&#25171;&#24320;&#65289;&#65292;&#20063;&#21487;&#20197;&#20351;&#29992;
<a class="ulink" href="http://download.oracle.com/javase/6/docs/api/java/beans/ConstructorProperties.html" target="_top">@ConstructorProperties</a>  JDK&#27880;&#35299;&#26126;&#30830;&#25351;&#20986;&#26500;&#36896;&#20989;&#25968;&#30340;&#21442;&#25968;&#12290;&#19979;&#38754;&#26159;&#31616;&#21333;&#30340;&#20363;&#23376;&#65306;</p>
<pre class="programlisting"><span class="hl-keyword">package</span> examples;

<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> ExampleBean {

    <span class="hl-comment">// Fields omitted</span>

    <em><span class="hl-annotation" style="color: gray">@ConstructorProperties({"years", "ultimateAnswer"})</span></em>
    <span class="hl-keyword">public</span> ExampleBean(<span class="hl-keyword">int</span> years, String ultimateAnswer) {
        <span class="hl-keyword">this</span>.years = years;
        <span class="hl-keyword">this</span>.ultimateAnswer = ultimateAnswer;
    }

}</pre>

</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-setter-injection" href="#beans-setter-injection"></a>Setter&#27880;&#20837;</h4></div></div></div>

<p>&#22312;&#35843;&#29992;&#20102;&#26080;&#21442;&#30340;&#26500;&#36896;&#26041;&#27861;&#25110;&#32773;&#26080;&#21442;&#30340;<code class="literal">&#38745;&#24577;</code>&#24037;&#21378;&#26041;&#27861;&#23454;&#20363;&#21270;bean&#20043;&#21518;&#65292;&#23481;&#22120;&#36890;&#36807;&#22238;&#35843;bean&#30340;setter&#26041;&#27861;&#26469;&#23436;&#25104;setter&#27880;&#20837;&#12290;&#25509;&#19979;&#26469;&#30340;&#20363;&#23376;&#23558;&#23637;&#31034;&#21482;&#20351;&#29992;setter&#27880;&#20837;&#20381;&#36182;&#12290;&#36825;&#20010;&#31867;&#26159;&#20010;&#26222;&#36890;&#30340;Java&#31867;</p>
<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> SimpleMovieLister {

    <span class="hl-comment">// the SimpleMovieLister has a dependency on the MovieFinder</span>
    <span class="hl-keyword">private</span> MovieFinder movieFinder;

    <span class="hl-comment">// a setter method so that the Spring container can inject a MovieFinder</span>
    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> setMovieFinder(MovieFinder movieFinder) {
        <span class="hl-keyword">this</span>.movieFinder = movieFinder;
    }

    <span class="hl-comment">// business logic that actually uses the injected MovieFinder is omitted...</span>

}</pre>

<p><code class="literal">ApplicationContext</code>&#25152;&#31649;&#29702;&#30340;beans&#25903;&#25345;&#26500;&#36896;&#20989;&#25968;&#27880;&#20837;&#21644;setter&#27880;&#20837;&#65292;&#22312;&#19968;&#20123;&#20381;&#36182;&#24050;&#32463;&#20351;&#29992;&#26500;&#36896;&#22120;&#27880;&#20837;&#20043;&#21518;&#23427;&#36824;&#25903;&#25345;setter&#27880;&#20837;&#12290;&#20320;&#21487;&#20197;&#20197;<code class="literal">BeanDefinition</code>&#30340;&#24418;&#24335;&#37197;&#32622;&#20381;&#36182;&#65292;&#23427;&#33021;&#26681;&#25454;&#25351;&#23450;&#30340;<code class="literal">PropertyEditor</code>&#23454;&#29616;&#23558;&#23646;&#24615;&#20174;&#19968;&#31181;&#26684;&#24335;&#36716;&#21270;&#20026;&#21478;&#22806;&#19968;&#31181;&#26684;&#24335;&#12290;&#20294;&#26159;&#65292;&#22823;&#22810;&#25968;Spring&#30340;&#20351;&#29992;&#32773;&#19981;&#20250;&#30452;&#25509;&#20351;&#29992;&#36825;&#20123;&#31867;&#65288;&#20063;&#23601;&#26159;&#36890;&#36807;&#32534;&#31243;&#30340;&#24418;&#24335;&#65289;&#65292;&#32780;&#26159;&#37319;&#29992;XML&#37197;&#32622;&#36825;&#20123;<code class="literal">bean</code>&#65292;&#27880;&#35299;&#30340;&#32452;&#20214;&#65288;&#21363;&#29992;<code class="literal">@Component</code>&#65292;<code class="literal">@Controller</code>&#31561;&#27880;&#35299;&#31867;&#65289;&#65292;&#25110;&#32773;&#22522;&#20110;<code class="literal">@Configuration</code>&#31867;&#30340;<code class="literal">@Bean</code>&#26041;&#27861;&#12290;&#26412;&#36136;&#19978;&#36825;&#20123;&#36164;&#28304;&#20250;&#36716;&#25442;&#25104;<code class="literal">BeanDefinition</code>&#30340;&#23454;&#20363;&#24182;&#19988;&#29992;&#20110;&#21152;&#36733;&#25972;&#20010;Spring IoC&#23481;&#22120;&#23454;&#20363;&#12290;</p>
<div class="sidebar"><div class="titlepage"><div><div><p class="title"><b>&#26500;&#36896;&#22120;&#27880;&#20837;&#36824;&#26159;Setter&#27880;&#20837;</b></p></div></div></div>

<p>&#22240;&#20026;&#20320;&#21487;&#20197;&#28151;&#21512;&#20351;&#29992;&#26500;&#36896;&#22120;&#27880;&#20837;&#21644;setter&#27880;&#20837;&#65292; <span class="emphasis"><em>&#24378;&#21046;&#24615;&#20381;&#36182;&#20851;&#31995;</em></span> &#26102;&#20351;&#29992;&#26500;&#36896;&#22120;&#27880;&#20837;&#65292; <span class="emphasis"><em>&#21487;&#36873;&#30340;&#20381;&#36182;&#20851;&#31995;</em></span> &#26102;&#20351;&#29992;setter&#26041;&#27861;&#25110;&#32773;&#37197;&#32622;&#26041;&#27861;&#26159;&#27604;&#36739;&#22909;&#30340;&#32463;&#39564;&#27861;&#21017;&#12290;&#35831;&#27880;&#24847;<a class="link" href="beans.html#beans-required-annotation" title="5.9.1&nbsp;@Required">@Required</a>&#27880;&#35299;&#22312;setter&#26041;&#27861;&#19978;&#21487;&#20197;&#27880;&#20837;&#25152;&#38656;&#35201;&#30340;&#20381;&#36182;&#12290;</p>
<p>Spring&#24320;&#21457;&#22242;&#38431;&#19968;&#33324;&#20027;&#24352;&#24403;&#23454;&#29616;&#30340;&#24212;&#29992;&#32452;&#20214;&#26159;&#19981;&#21487;&#21464;&#23545;&#35937;&#26102;&#20351;&#29992;&#26500;&#36896;&#22120;&#27880;&#20837;&#24182;&#19988;&#35201;&#20445;&#35777;&#25152;&#38656;&#30340;&#20381;&#36182;&#19981;&#26159;<code class="literal">null</code>&#12290;&#27492;&#22806;&#26500;&#36896;&#22120;&#27880;&#20837;&#30340;&#32452;&#20214;&#24635;&#26159;&#36820;&#22238;&#32473;&#23458;&#25143;&#31471;&#65288;&#25110;&#35843;&#29992;&#65289;&#23436;&#25972;&#30340;&#21021;&#22987;&#21270;&#29366;&#24577;&#12290;&#21478;&#19968;&#26041;&#38754;&#65292;&#22823;&#37327;&#30340;&#26500;&#36896;&#22120;&#21442;&#25968;&#36896;&#25104;<span class="emphasis"><em>&#31967;&#31957;&#30340;&#20195;&#30721;&#24322;&#21619;</em></span>&#65292;&#36825;&#34920;&#26126;&#31867;&#21487;&#33021;&#25215;&#25285;&#20102;&#22826;&#22810;&#30340;&#32844;&#36131;&#24212;&#35813;&#38656;&#35201;&#37325;&#26500;&#20197;&#20415;&#26356;&#22909;&#30340;&#36866;&#24403;&#20998;&#31163;&#35201;&#35299;&#20915;&#30340;&#38382;&#39064;&#12290;</p>
<p>setter&#27880;&#20837;&#20027;&#35201;&#21482;&#29992;&#20316;&#21487;&#36873;&#30340;&#20381;&#36182;&#65292;&#36825;&#20123;&#20381;&#36182;&#20998;&#37197;&#21512;&#29702;&#30340;&#32570;&#30465;&#20540;&#12290;&#21542;&#21017;&#65292;&#24403;&#20195;&#30721;&#20351;&#29992;&#20381;&#36182;&#26102;&#24517;&#39035;&#36827;&#34892;&#38750;&#31354;&#26816;&#26597;&#12290;setter&#27880;&#20837;&#30340;&#19968;&#20010;&#22909;&#22788;&#26159;setter&#26041;&#27861;&#20351;&#24471;&#36825;&#20010;&#31867;&#30340;&#23545;&#35937;&#22312;&#20197;&#21518;&#30340;&#26576;&#20010;&#26102;&#20505;&#36824;&#21487;&#21512;&#29702;&#30340;&#37325;&#26032;&#37197;&#32622;&#25110;&#32773;&#37325;&#26032;&#27880;&#20837;&#12290;<a class="link" href="jmx.html" title="24.&nbsp;JMX">JMX MBeans</a>&#30340;&#31649;&#29702;&#23601;&#26159;&#19968;&#20010;&#24456;&#22909;&#30340;setter&#27880;&#20837;&#20363;&#23376;&#12290;</p>
<p>&#20351;&#29992;DI&#30340;&#39118;&#26684;&#21487;&#20197;&#20351;&#29305;&#23450;&#30340;&#31867;&#26356;&#26377;&#24847;&#20041;&#12290;&#26377;&#26102;&#65292;&#20351;&#29992;&#31532;&#19977;&#26041;&#31867;&#26102;&#20320;&#24182;&#27809;&#26377;&#36164;&#28304;&#65292;&#37027;&#20040;&#36825;&#20010;&#36873;&#25321;&#24456;&#36866;&#21512;&#20320;&#12290;&#20030;&#20010;&#20363;&#23376;&#65292;&#22914;&#26524;&#31532;&#19977;&#26041;&#31867;&#24182;&#19981;&#20844;&#24320;&#20219;&#20309;setter&#26041;&#27861;&#65292;&#37027;&#20040;&#26500;&#36896;&#22120;&#27880;&#20837;&#21487;&#33021;&#26159;&#21807;&#19968;&#21487;&#29992;&#30340;&#20381;&#36182;&#27880;&#20837;&#26041;&#24335;&#12290;</p>
</div>

</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-dependency-resolution" href="#beans-dependency-resolution"></a>&#20381;&#36182;&#35299;&#20915;&#27493;&#39588;</h4></div></div></div>

<p>&#23481;&#22120;&#35299;&#20915;&#20381;&#36182;&#38382;&#39064;&#36890;&#24120;&#26377;&#20197;&#19979;&#20960;&#20010;&#27493;&#39588;&#65306;</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
&#25551;&#36848;&#25152;&#26377;bean&#30340;<code class="literal">ApplicationContext</code>&#21019;&#24314;&#24182;&#26681;&#25454;&#37197;&#32622;&#30340;&#20803;&#25968;&#25454;&#21021;&#22987;&#21270;&#12290;&#37197;&#32622;&#30340;&#20803;&#25968;&#25454;&#21487;&#20197;&#36890;&#36807;&#32622;&#39030;&#30340;XML&#65292;Java&#20195;&#30721;&#25110;&#32773;&#27880;&#35299;&#12290;
</li><li class="listitem">
&#27599;&#20010;bean&#30340;&#20381;&#36182;&#23558;&#20197;&#23646;&#24615;&#65292;&#26500;&#36896;&#22120;&#21442;&#25968;&#25110;&#32773;&#38745;&#24577;&#24037;&#21378;&#26041;&#27861;&#30340;&#24418;&#24335;&#20986;&#29616;&#12290;&#24403;&#36825;&#20123;bean&#34987;&#21019;&#24314;&#26102;&#65292;&#36825;&#20123;&#20381;&#36182;&#23558;&#20250;&#25552;&#20379;&#32473;&#35813;bean&#12290;
</li><li class="listitem">
&#27599;&#20010;&#23646;&#24615;&#25110;&#32773;&#26500;&#36896;&#22120;&#21442;&#25968;&#26082;&#21487;&#20197;&#26159;&#19968;&#20010;&#23454;&#38469;&#30340;&#20540;&#20063;&#21487;&#20197;&#26159;&#23481;&#22120;&#20013;&#30340;&#21478;&#19968;&#20010;&#24341;&#29992;&#12290;
</li><li class="listitem">
&#27599;&#20010;&#25351;&#23450;&#30340;&#23646;&#24615;&#25110;&#32773;&#26500;&#36896;&#22120;&#21442;&#25968;&#20540;&#24517;&#39035;&#33021;&#22815;&#34987;&#36716;&#25442;&#25104;&#29305;&#23450;&#30340;&#26684;&#24335;&#25110;&#26500;&#36896;&#21442;&#25968;&#25152;&#38656;&#30340;&#31867;&#22411;&#12290;&#40664;&#35748;&#24773;&#20917;&#19979;Spring&#20250;&#20197;String&#31867;&#22411;&#36716;&#25442;&#20026;&#21508;&#31181;&#20869;&#32622;&#31867;&#22411;&#65292;&#27604;&#22914;<code class="literal">int</code>,<code class="literal">long</code>, <code class="literal">String</code>, <code class="literal">boolean</code> &#31561;&#12290;
</li></ul></div>

<p>&#24403;Spring&#23481;&#22120;&#21019;&#24314;&#26102;&#23481;&#22120;&#20250;&#26657;&#39564;&#27599;&#20010;bean&#30340;&#37197;&#32622;&#12290;&#20294;&#26159;&#22312;bean<span class="emphasis"><em>&#34987;&#23454;&#38469;&#21019;&#24314;</em></span> &#21069;&#65292;bean&#30340;&#20540;&#24182;&#19981;&#20250;&#34987;&#35774;&#32622;&#12290;&#37027;&#20123;&#21333;&#20363;&#31867;&#22411;&#30340;bean&#21644;&#34987;&#35774;&#32622;&#20026;&#39044;&#23433;&#35013;&#65288;&#40664;&#35748;&#65289;&#30340;bean&#20250;&#22312;&#23481;&#22120;&#21019;&#24314;&#26102;&#19982;&#23481;&#22120;&#21516;&#26102;&#21019;&#24314;&#12290;Scopes&#26159;&#22312;<a class="xref" href="beans.html#beans-factory-scopes" title="5.5&nbsp;Bean&#20316;&#29992;&#22495;">Section&nbsp;5.5, &#8220;Bean&#20316;&#29992;&#22495;&#8221;</a>&#20013;&#23450;&#20041;&#30340;&#12290;&#21516;&#26102;&#65292;&#21478;&#22806;&#30340;bean&#21482;&#20250;&#22312;&#34987;&#38656;&#35201;&#26102;&#21019;&#24314;&#12290;&#20276;&#38543;&#30528;bean&#34987;&#23454;&#38469;&#21019;&#24314;&#65292;&#20316;&#20026;&#35813;bean&#30340;&#20381;&#36182;&#21644;&#23427;&#30340;&#20381;&#36182;&#30340;&#20381;&#36182;&#65288;&#20197;&#27492;&#31867;&#25512;&#65289;&#20250;&#34987;&#21019;&#24314;&#21644;&#20998;&#37197;&#12290;&#27880;&#24847;
&#36825;&#20123;&#20381;&#36182;&#20043;&#38388;&#30340;&#35299;&#20915;&#20250;&#26174;&#31034;&#36831;&#19968;&#20123;</p>
<div class="sidebar"><div class="titlepage"><div><div><p class="title"><b>&#24490;&#29615;&#20381;&#36182;</b></p></div></div></div>

<p>&#22914;&#26524;&#20320;&#20027;&#35201;&#20351;&#29992;&#26500;&#36896;&#22120;&#27880;&#20837;&#65292;&#24456;&#26377;&#21487;&#33021;&#20250;&#20135;&#29983;&#26080;&#27861;&#35299;&#20915;&#30340;&#24490;&#29615;&#20381;&#36182;&#38382;&#39064;&#12290;
&#20030;&#20010;&#20363;&#23376;&#65306;A&#31867;&#38656;&#35201;&#36890;&#36807;&#26500;&#36896;&#22120;&#27880;&#20837;B&#31867;&#30340;&#23454;&#20363;&#65292;&#24182;&#19988;B&#31867;&#21448;&#38656;&#35201;&#36890;&#36807;&#26500;&#36896;&#22120;&#27880;&#20837;A&#31867;&#30340;&#23454;&#20363;&#12290;&#22914;&#26524;&#20026;&#31867;A&#21644;&#31867;B&#37197;&#32622;&#30340;bean&#34987;&#30456;&#20114;&#27880;&#20837;&#30340;&#35805;&#65292;Spring IoC&#23481;&#22120;&#22312;&#36816;&#34892;&#26102;&#20250;&#26816;&#27979;&#21040;&#36825;&#20010;&#24490;&#29615;&#20381;&#36182;&#24182;&#19988;&#25243;&#20986;&#19968;&#20010;<code class="literal">BeanCurrentlyInCreationException</code>&#24322;&#24120;&#12290;</p>
<p>&#19968;&#20010;&#21487;&#33021;&#30340;&#35299;&#20915;&#26041;&#27861;&#26159;&#20462;&#25913;&#31867;&#30340;&#28304;&#20195;&#30721;,&#23558;&#26500;&#36896;&#22120;&#27880;&#20837;&#25913;&#20026;setter&#27880;&#20837;&#12290;&#25110;&#32773;&#21482;&#20351;&#29992;setter&#27880;&#20837;&#36991;&#20813;&#20351;&#29992;&#26500;&#36896;&#22120;&#27880;&#20837;&#12290;&#25442;&#21477;&#35805;&#35828;&#65292;&#34429;&#28982;&#36825;&#24182;&#19981;&#34987;&#25512;&#33616;&#20351;&#29992;&#65292;&#20320;&#21487;&#20197;&#20351;&#29992;setter&#27880;&#20837;&#37197;&#32622;&#24490;&#29615;&#20381;&#36182;&#12290;
&#21644;<span class="emphasis"><em>&#36890;&#24120;&#30340;</em></span>&#24773;&#20917;&#19981;&#21516;&#65288;&#27809;&#26377;&#24490;&#29615;&#20381;&#36182;&#65289;&#65292;bean A &#21644;bean B&#20043;&#38388;&#30340;&#24490;&#29615;&#20381;&#36182;&#23558;&#20250;&#23548;&#33268;&#20854;&#20013;&#19968;&#20010;bean&#22312;&#34987;&#23436;&#20840;&#21021;&#22987;&#21270;&#30340;&#20043;&#21069;&#34987;&#27880;&#20837;&#21040;&#21478;&#19968;&#20010;bean&#37324;&#65288;&#20808;&#26377;&#40481;&#20808;&#26377;&#34507;&#30340;&#38382;&#39064;&#65289;</p>
</div>

<p>&#36890;&#24120;&#20320;&#21487;&#20197;&#20449;&#36182;Spring&#12290;&#22312;&#23481;&#22120;&#21152;&#36733;&#26102;Spring&#20250;&#26816;&#26597;&#37197;&#32622;&#65292;&#27604;&#22914;&#19981;&#23384;&#22312;&#30340;bean&#21644;&#24490;&#29615;&#20381;&#36182;&#12290;&#24403;bean&#21019;&#24314;&#26102;&#65292;Spring&#23613;&#21487;&#33021;&#36831;&#24471;&#35774;&#32622;&#23646;&#24615;&#21644;&#20381;&#36182;&#20851;&#31995;&#12290;&#36825;&#24847;&#21619;&#30528;&#21363;&#20351;Spring&#27491;&#24120;&#21152;&#36733;&#65292;&#22312;&#20320;&#38656;&#35201;&#19968;&#20010;&#23384;&#22312;&#38382;&#39064;&#25110;&#32773;&#23427;&#30340;&#20381;&#36182;&#23384;&#22312;&#38382;&#39064;&#30340;&#23545;&#35937;&#26102;&#65292;Spring&#20250;&#25253;&#20986;&#24322;&#24120;&#12290;&#20030;&#20010;&#20363;&#23376;&#65292;bean&#22240;&#35774;&#32622;&#32570;&#23569;&#25110;&#32773;&#26080;&#25928;&#30340;&#23646;&#24615;&#20250;&#25243;&#20986;&#19968;&#20010;&#24322;&#24120;&#12290;&#22240;&#20026;&#19968;&#20123;&#37197;&#32622;&#38382;&#39064;&#23384;&#22312;&#23558;&#20250;&#23548;&#33268;&#28508;&#22312;&#30340;&#21487;&#35265;&#24615;&#34987;&#24310;&#36831;&#65292;&#25152;&#20197;&#40664;&#35748;<code class="literal">ApplicationContext</code>&#30340;&#23454;&#29616;bean&#37319;&#29992;&#25552;&#21069;&#23454;&#20363;&#21270;&#30340;&#21333;&#20363;&#27169;&#24335;&#12290;&#22312;&#23454;&#38469;&#38656;&#35201;&#20043;&#21069;&#21019;&#24314;&#36825;&#20123;bean&#20250;&#24102;&#26469;&#26102;&#38388;&#21644;&#20869;&#23384;&#30340;&#24320;&#38144;&#65292;&#24403;<code class="literal">ApplicationContext</code>&#21019;&#24314;&#23436;&#25104;&#26102;&#20320;&#20250;&#21457;&#29616;&#37197;&#32622;&#38382;&#39064;&#65292;&#32780;&#19981;&#26159;&#20043;&#21518;&#12290;&#20320;&#20063;&#21487;&#20197;&#37325;&#20889;&#40664;&#35748;&#30340;&#34892;&#20026;&#20351;&#24471;&#21333;&#20363;bean&#24310;&#36831;&#23454;&#20363;&#21270;&#32780;&#19981;&#26159;&#25552;&#21069;&#23454;&#20363;&#21270;&#12290;</p>
<p>&#22914;&#26524;&#19981;&#23384;&#22312;&#24490;&#29615;&#20381;&#36182;&#65292;&#24403;&#19968;&#20010;&#25110;&#32773;&#22810;&#20010;&#21327;&#21161;bean&#20250;&#34987;&#27880;&#20837;&#20381;&#36182;bean&#26102;,&#27599;&#20010;&#21327;&#21161;bean&#24517;&#39035;&#22312;&#27880;&#20837;&#20381;&#36182;bean&#20043;&#21069; <span class="emphasis"><em>&#23436;&#20840;</em></span> &#37197;&#32622;&#22909;&#12290;&#36825;&#24847;&#21619;&#30528;&#22914;&#26524;bean A&#23545;bean B&#23384;&#22312;&#20381;&#36182;&#20851;&#31995;&#65292;
&#37027;&#20040;Spring Ioc&#23481;&#22120;&#22312;&#35843;&#29992;bean A&#30340;setter&#26041;&#27861;&#20043;&#21069;&#20250;&#23436;&#20840;&#37197;&#32622;bean B&#12290;&#25442;&#21477;&#35805;&#35828;&#65292;bean&#20250;&#34987;&#23454;&#20363;&#21270;&#65288;&#22914;&#26524;&#19981;&#26159;&#37319;&#29992;&#25552;&#21069;&#23454;&#20363;&#21270;&#30340;&#21333;&#20363;&#27169;&#24335;&#65289;&#65292;&#30456;&#20851;&#30340;&#20381;&#36182;&#20250;&#34987;&#35774;&#32622;&#22909;&#65292;&#30456;&#20851;&#30340;lifecycle&#26041;&#27861;&#65288;&#27604;&#22914;<a class="link" href="beans.html#beans-factory-lifecycle-initializingbean" title="&#21021;&#22987;&#21270;&#22238;&#35843;&#20989;&#25968;">configured init &#26041;&#27861;</a>&#25110;&#32773;<a class="link" href="beans.html#beans-factory-lifecycle-initializingbean" title="&#21021;&#22987;&#21270;&#22238;&#35843;&#20989;&#25968;">InitializingBean callback &#26041;&#27861;</a>&#65289;&#20250;&#34987;&#35843;&#29992;</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-some-examples" href="#beans-some-examples"></a>&#19968;&#20123;&#20381;&#36182;&#27880;&#20837;&#30340;&#20363;&#23376;</h4></div></div></div>

<p>&#25509;&#19979;&#26469;&#30340;Setter&#27880;&#20837;&#20363;&#23376;&#20351;&#29992;&#22522;&#20110;XML&#30340;&#37197;&#32622;&#20803;&#25968;&#25454;&#30340;&#26041;&#24335;&#12290;&#30456;&#24212;&#30340;Spring XML&#37197;&#32622;&#25991;&#20214;&#65306;</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"exampleBean"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"examples.ExampleBean"</span><span class="hl-tag">&gt;</span>
    <span class="hl-comment">&lt;!-- setter injection using the nested ref element --&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"beanOne"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;ref</span> <span class="hl-attribute">bean</span>=<span class="hl-value">"anotherExampleBean"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;/property&gt;</span>

    <span class="hl-comment">&lt;!-- setter injection using the neater ref attribute --&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"beanTwo"</span> <span class="hl-attribute">ref</span>=<span class="hl-value">"yetAnotherBean"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"integerProperty"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"1"</span><span class="hl-tag">/&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span>

<span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"anotherExampleBean"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"examples.AnotherBean"</span><span class="hl-tag">/&gt;</span>
<span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"yetAnotherBean"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"examples.YetAnotherBean"</span><span class="hl-tag">/&gt;</span></pre>

<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> ExampleBean {

    <span class="hl-keyword">private</span> AnotherBean beanOne;
    <span class="hl-keyword">private</span> YetAnotherBean beanTwo;
    <span class="hl-keyword">private</span> <span class="hl-keyword">int</span> i;

    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> setBeanOne(AnotherBean beanOne) {
        <span class="hl-keyword">this</span>.beanOne = beanOne;
    }

    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> setBeanTwo(YetAnotherBean beanTwo) {
        <span class="hl-keyword">this</span>.beanTwo = beanTwo;
    }

    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> setIntegerProperty(<span class="hl-keyword">int</span> i) {
        <span class="hl-keyword">this</span>.i = i;
    }

}</pre>

<p>&#22312;&#21069;&#38754;&#30340;&#20363;&#23376;&#65292;&#25105;&#20204;&#30475;&#21040;Setter&#20250;&#21305;&#37197;&#23450;&#20041;&#22312;XML&#37324;&#30340;&#23646;&#24615;&#65292;&#25509;&#19979;&#26469;&#30340;&#20363;&#23376;&#20250;&#20351;&#29992;&#26500;&#36896;&#22120;&#27880;&#20837;&#65306;</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"exampleBean"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"examples.ExampleBean"</span><span class="hl-tag">&gt;</span>
    <span class="hl-comment">&lt;!-- constructor injection using the nested ref element --&gt;</span>
    <span class="hl-tag">&lt;constructor-arg&gt;</span>
        <span class="hl-tag">&lt;ref</span> <span class="hl-attribute">bean</span>=<span class="hl-value">"anotherExampleBean"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;/constructor-arg&gt;</span>

    <span class="hl-comment">&lt;!-- constructor injection using the neater ref attribute --&gt;</span>
    <span class="hl-tag">&lt;constructor-arg</span> <span class="hl-attribute">ref</span>=<span class="hl-value">"yetAnotherBean"</span><span class="hl-tag">/&gt;</span>

    <span class="hl-tag">&lt;constructor-arg</span> <span class="hl-attribute">type</span>=<span class="hl-value">"int"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"1"</span><span class="hl-tag">/&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span>

<span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"anotherExampleBean"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"examples.AnotherBean"</span><span class="hl-tag">/&gt;</span>
<span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"yetAnotherBean"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"examples.YetAnotherBean"</span><span class="hl-tag">/&gt;</span></pre>

<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> ExampleBean {

    <span class="hl-keyword">private</span> AnotherBean beanOne;
    <span class="hl-keyword">private</span> YetAnotherBean beanTwo;
    <span class="hl-keyword">private</span> <span class="hl-keyword">int</span> i;

    <span class="hl-keyword">public</span> ExampleBean(
        AnotherBean anotherBean, YetAnotherBean yetAnotherBean, <span class="hl-keyword">int</span> i) {
        <span class="hl-keyword">this</span>.beanOne = anotherBean;
        <span class="hl-keyword">this</span>.beanTwo = yetAnotherBean;
        <span class="hl-keyword">this</span>.i = i;
    }

}</pre>

<p>&#22312;bean&#23450;&#20041;&#20013;&#25351;&#23450;&#30340;&#26500;&#36896;&#22120;&#21442;&#25968;&#20250;&#34987;&#29992;&#20316;<code class="literal">ExampleBean</code>&#30340;&#26500;&#36896;&#22120;&#21442;&#25968;&#12290;</p>
<p>&#29616;&#22312;&#26469;&#30475;&#20351;&#29992;&#26500;&#36896;&#22120;&#30340;&#20363;&#23376;&#65292;Spring&#35843;&#29992;<code class="literal">&#38745;&#24577;</code>&#24037;&#21378;&#26041;&#27861;&#26469;&#36820;&#22238;&#23545;&#35937;&#30340;&#23454;&#20363;&#65306;</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"exampleBean"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"examples.ExampleBean"</span> <span class="hl-attribute">factory-method</span>=<span class="hl-value">"createInstance"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;constructor-arg</span> <span class="hl-attribute">ref</span>=<span class="hl-value">"anotherExampleBean"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;constructor-arg</span> <span class="hl-attribute">ref</span>=<span class="hl-value">"yetAnotherBean"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;constructor-arg</span> <span class="hl-attribute">value</span>=<span class="hl-value">"1"</span><span class="hl-tag">/&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span>

<span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"anotherExampleBean"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"examples.AnotherBean"</span><span class="hl-tag">/&gt;</span>
<span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"yetAnotherBean"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"examples.YetAnotherBean"</span><span class="hl-tag">/&gt;</span></pre>

<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> ExampleBean {

    <span class="hl-comment">// a private constructor</span>
    <span class="hl-keyword">private</span> ExampleBean(...) {
        ...
    }

    <span class="hl-comment">// a static factory method; the arguments to this method can be</span>
    <span class="hl-comment">// considered the dependencies of the bean that is returned,</span>
    <span class="hl-comment">// regardless of how those arguments are actually used.</span>
    <span class="hl-keyword">public</span> <span class="hl-keyword">static</span> ExampleBean createInstance (
        AnotherBean anotherBean, YetAnotherBean yetAnotherBean, <span class="hl-keyword">int</span> i) {

        ExampleBean eb = <span class="hl-keyword">new</span> ExampleBean (...);
        <span class="hl-comment">// some other operations...</span>
        <span class="hl-keyword">return</span> eb;
    }

}</pre>

<p><code class="literal">&#38745;&#24577;</code>&#24037;&#21378;&#26041;&#27861;&#21442;&#25968;&#30001;<code class="literal">&lt;constructor-arg/&gt;</code>&#20803;&#32032;&#25552;&#20379;&#65292;&#23454;&#38469;&#19978;&#36825;&#21644;&#20351;&#29992;&#26500;&#36896;&#22120;&#26159;&#19968;&#26679;&#30340;&#12290;&#24037;&#21378;&#26041;&#27861;
&#36820;&#22238;&#30340;&#31867;&#30340;&#31867;&#22411;&#24182;&#19981;&#19968;&#23450;&#35201;&#19982;&#21253;&#21547;<code class="literal">&#38745;&#24577;</code>&#24037;&#21378;&#26041;&#27861;&#30340;&#31867;&#31867;&#22411;&#19968;&#33268;&#65292;&#34429;&#28982;&#22312;&#36825;&#20010;&#20363;&#23376;&#20013;&#26159;&#19968;&#26679;&#30340;&#12290;
&#23454;&#20363;&#24037;&#21378;&#26041;&#27861;&#65288;&#19981;&#26159;&#38745;&#24577;&#30340;&#65289;&#19982;&#27492;&#30456;&#21516;&#65288;&#38500;&#20102;&#20351;&#29992;<code class="literal">factory-bean</code>&#23646;&#24615;&#20195;&#26367;class&#23646;&#24615;&#22806;&#65289;&#65292;&#25152;&#20197;&#36825;&#37324;&#19981;&#20316;&#35814;&#32454;&#35752;&#35770;&#12290;</p>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="beans-factory-properties-detailed" href="#beans-factory-properties-detailed"></a>5.4.2&nbsp;&#20381;&#36182;&#37197;&#32622;&#35814;&#35299;</h3></div></div></div>

<p>&#27491;&#22914;&#22312;&#21069;&#38754;&#31456;&#33410;&#25152;&#25552;&#21040;&#30340;&#65292;&#20320;&#21487;&#20197;&#23450;&#20041;bean&#30340;&#23646;&#24615;&#21644;&#26500;&#36896;&#22120;&#21442;&#25968;&#20316;&#20026;&#20854;&#20182;&#25152;&#31649;&#29702;&#30340;bean&#30340;&#20381;&#36182;&#65288;&#21327;&#20316;&#65289;&#65292;
&#25110;&#32773;&#26159;&#20869;&#32852;&#30340;bean&#12290;&#22522;&#20110;XML&#30340;Spring&#37197;&#32622;&#20803;&#25968;&#25454;&#25903;&#25345;&#20351;&#29992;<code class="literal">&lt;property/&gt;</code> &#21644; <code class="literal">&lt;constructor-arg/&gt;</code>&#20803;&#32032;&#23450;&#20041;&#12290;</p>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-value-element" href="#beans-value-element"></a>&#30452;&#25509;&#21464;&#37327; (&#22522;&#26412;&#31867;&#22411;, String&#31867;&#22411;&#31561;)</h4></div></div></div>

<p><code class="literal">&lt;property/&gt;</code>&#20803;&#32032;&#30340;<code class="literal">value</code>&#20540;&#36890;&#36807;&#21487;&#35835;&#30340;&#23383;&#31526;&#20018;&#24418;&#24335;&#26469;&#25351;&#23450;&#23646;&#24615;&#21644;&#26500;&#36896;&#22120;&#21442;&#25968;&#12290;Spring&#30340;<a class="link" href="validation.html#core-convert-ConversionService-API" title="7.5.4&nbsp;ConversionService API">conversion service</a>
&#25226;<code class="literal">String</code>&#36716;&#25442;&#25104;&#23646;&#24615;&#25110;&#32773;&#26500;&#36896;&#22120;&#23454;&#38469;&#38656;&#35201;&#30340;&#31867;&#22411;&#12290;</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"myDataSource"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"org.apache.commons.dbcp.BasicDataSource"</span> <span class="hl-attribute">destroy-method</span>=<span class="hl-value">"close"</span><span class="hl-tag">&gt;</span>
    <span class="hl-comment">&lt;!-- results in a setDriverClassName(String) call --&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"driverClassName"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"com.mysql.jdbc.Driver"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"url"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"jdbc:mysql://localhost:3306/mydb"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"username"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"root"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"password"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"masterkaoli"</span><span class="hl-tag">/&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span></pre>

<p>&#25509;&#19979;&#26469;&#30340;&#20363;&#23376;&#20351;&#29992;<a class="link" href="beans.html#beans-p-namespace" title="XML&#20351;&#29992;p&#21629;&#21517;&#31354;&#38388;&#31616;&#21270;">p &#21629;&#21517;&#31354;&#38388;</a>&#31616;&#21270;XML&#37197;&#32622;</p>
<pre class="programlisting"><span class="hl-tag">&lt;beans</span> <span class="hl-attribute">xmlns</span>=<span class="hl-value">"http://www.springframework.org/schema/beans"</span>
    <span class="hl-attribute">xmlns:xsi</span>=<span class="hl-value">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hl-attribute">xmlns:p</span>=<span class="hl-value">"http://www.springframework.org/schema/p"</span>
    <span class="hl-attribute">xsi:schemaLocation</span>=<span class="hl-value">"http://www.springframework.org/schema/beans
    http://www.springframework.org/schema/beans/spring-beans.xsd"</span><span class="hl-tag">&gt;</span>

    <span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"myDataSource"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"org.apache.commons.dbcp.BasicDataSource"</span>
        <span class="hl-attribute">destroy-method</span>=<span class="hl-value">"close"</span>
        <span class="hl-attribute">p:driverClassName</span>=<span class="hl-value">"com.mysql.jdbc.Driver"</span>
        <span class="hl-attribute">p:url</span>=<span class="hl-value">"jdbc:mysql://localhost:3306/mydb"</span>
        <span class="hl-attribute">p:username</span>=<span class="hl-value">"root"</span>
        <span class="hl-attribute">p:password</span>=<span class="hl-value">"masterkaoli"</span><span class="hl-tag">/&gt;</span>

<span class="hl-tag">&lt;/beans&gt;</span></pre>

<p>&#20197;&#19978;&#30340;XML&#26356;&#21152;&#31616;&#27905;&#65307;&#20294;&#26159;&#65292;&#32534;&#30721;&#30340;&#38169;&#35823;&#21482;&#26377;&#22312;&#36816;&#34892;&#26102;&#25165;&#20250;&#34987;&#21457;&#29616;&#32780;&#19981;&#26159;&#32534;&#30721;&#35774;&#35745;&#30340;&#26102;&#20505;&#65292;&#38500;&#38750;&#20320;&#22312;&#23450;&#20041;bean&#30340;&#26102;&#20505;&#65292;
&#20351;&#29992; <a class="ulink" href="http://www.jetbrains.com/idea/" target="_top">IntelliJIDEA</a> &#25110;&#32773; <a class="ulink" href="https://spring.io/tools/sts" target="_top">Spring Tool Suite</a> (STS)
&#25903;&#25345;&#21160;&#24577;&#23646;&#24615;&#34917;&#20840;&#30340;IDE&#12290;IDE&#30340;&#24110;&#21161;&#26159;&#38750;&#24120;&#20540;&#24471;&#25512;&#33616;&#30340;&#12290;</p>
<p>&#20320;&#20063;&#21487;&#20197;&#37197;&#32622;<code class="literal">java.util.Properties</code>&#23454;&#20363;&#65292;&#23601;&#20687;&#36825;&#26679;&#65306;</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"mappings"</span>
    <span class="hl-attribute">class</span>=<span class="hl-value">"org.springframework.beans.factory.config.PropertyPlaceholderConfigurer"</span><span class="hl-tag">&gt;</span>

    <span class="hl-comment">&lt;!-- typed as a java.util.Properties --&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"properties"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;value&gt;</span>
            jdbc.driver.className=com.mysql.jdbc.Driver
            jdbc.url=jdbc:mysql://localhost:3306/mydb
        <span class="hl-tag">&lt;/value&gt;</span>
    <span class="hl-tag">&lt;/property&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span></pre>

<p>Spring&#23481;&#22120;&#20351;&#29992;JavaBeans <code class="literal">PropertyEditor</code>&#25226;&#20803;&#32032;<code class="literal">&lt;value/&gt;</code>&#20869;&#30340;&#25991;&#26412;&#36716;&#25442;&#20026;<code class="literal">java.util.Properties</code>
&#23454;&#20363;&#12290;&#30001;&#20110;&#36825;&#31181;&#20570;&#27861;&#38750;&#24120;&#31616;&#21333;&#65292;&#25152;&#20197;&#36825;&#26159;Spring&#22242;&#38431;&#22312;&#24456;&#22810;&#22320;&#26041;&#37319;&#29992;&#20869;&#23884;&#30340;<code class="literal">&lt;value/&gt;</code>&#20803;&#32032;&#20195;&#26367;value&#23646;&#24615;&#12290;</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="beans-idref-element" href="#beans-idref-element"></a>idref&#20803;&#32032;</h5></div></div></div>

<p><code class="literal">idref</code>&#20803;&#32032;&#29992;&#26469;&#23558;&#23481;&#22120;&#20869;&#20854;&#20182;bean&#30340;<span class="emphasis"><em>id</em></span>&#65288;&#20540;&#26159;&#23383;&#31526;&#20018;-&#19981;&#26159;&#24341;&#29992;&#65289;&#20256;&#32473;&#20803;&#32032;<code class="literal">&lt;constructor-arg/&gt;</code> &#25110;&#32773; <code class="literal">&lt;property/&gt;</code></p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"theTargetBean"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"..."</span><span class="hl-tag">/&gt;</span>

<span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"theClientBean"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"..."</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"targetName"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;idref</span> <span class="hl-attribute">bean</span>=<span class="hl-value">"theTargetBean"</span><span class="hl-tag"> /&gt;</span>
    <span class="hl-tag">&lt;/property&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span></pre>

<p>&#19978;&#38754;&#30340;bean&#23450;&#20041;&#29255;&#27573;<span class="emphasis"><em>&#23436;&#20840;</em></span>&#31561;&#21516;&#20110;&#65288;&#22312;&#36816;&#34892;&#26102;&#65289;&#19979;&#38754;&#29255;&#27573;&#65306;</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"theTargetBean"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"..."</span><span class="hl-tag"> /&gt;</span>

<span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"client"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"..."</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"targetName"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"theTargetBean"</span><span class="hl-tag"> /&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span></pre>

<p>&#31532;&#19968;&#31181;&#24418;&#24335;&#27604;&#31532;&#20108;&#31181;&#24418;&#24335;&#26356;&#22909;&#65292;&#22240;&#20026;&#20351;&#29992;<code class="literal">idref</code>&#26631;&#31614;&#20801;&#35768;&#23481;&#22120;<span class="emphasis"><em>&#22312;&#37096;&#32626;&#26102;</em></span>&#39564;&#35777;&#24341;&#29992;&#30340;bean&#26159;&#21542;&#23384;&#22312;&#12290;
&#22312;&#31532;&#20108;&#31181;&#24418;&#24335;&#20013;&#65292;&#20256;&#32473; <code class="literal">client</code> bean&#20013;&#23646;&#24615;<code class="literal">targetName</code>&#30340;&#20540;&#24182;&#27809;&#26377;&#34987;&#39564;&#35777;&#12290;
&#21482;&#26377;&#24403; <code class="literal">client</code> bean&#23436;&#20840;&#23454;&#20363;&#21270;&#30340;&#26102;&#20505;&#38169;&#35823;&#25165;&#20250;&#34987;&#21457;&#29616;&#65288;&#21487;&#33021;&#20276;&#38543;&#30528;&#33268;&#21629;&#30340;&#32467;&#26524;&#65289;&#12290;&#22914;&#26524; <code class="literal">client</code> bean&#26159;<a class="link" href="beans.html#beans-factory-scopes" title="5.5&nbsp;Bean&#20316;&#29992;&#22495;">&#21407;&#22411;</a> bean&#12290;&#37027;&#20040;&#36825;&#20010;&#38169;&#35823;&#21644;&#24322;&#24120;&#21487;&#33021;&#21482;&#26377;&#20877;&#23481;&#22120;&#37096;&#32626;&#24456;&#38271;&#19968;&#27573;&#26102;&#38388;&#21518;&#25165;&#33021;&#34987;&#21457;&#29616;&#12290;</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p><code class="literal">idref</code>&#20803;&#32032;&#19978;&#30340;<code class="literal">local</code>&#23646;&#24615;&#22312;4.0&#20043;&#21518;&#19981;&#20877;&#25903;&#25345;&#65292;&#22240;&#20026;&#23427;&#19981;&#20877;&#25552;&#20379;&#26222;&#36890;<code class="literal">bean</code>&#30340;&#20215;&#20540;&#12290;&#24403;&#20320;&#21319;&#32423;&#21040;4.0 schema&#26102;&#38656;&#35201;&#20462;&#25913;&#23384;&#22312;&#30340;<code class="literal">idref local</code>&#20026;<code class="literal">idref bean</code></p>
</td></tr></table></div>

<p>&#19982;<code class="literal">ProxyFactoryBean</code> bean&#23450;&#20041;&#20013;&#20351;&#29992;<code class="literal">&lt;idref/&gt;</code>&#20803;&#32032;&#25351;&#23450;<a class="link" href="aop-api.html#aop-pfb-1" title="10.5.1&nbsp;Basics">AOP &#25318;&#25130;&#22120;</a>&#37197;&#32622; &#65288;&#29256;&#26412;&#19981;&#20302;&#20110;Spring 2.0&#65289;&#30456;&#21516;&#20043;&#22788;&#22312;&#20110;&#65306;&#24403;&#20320;&#25351;&#23450;&#25318;&#25130;&#22120;&#21517;&#31216;&#30340;&#26102;&#20505;&#20351;&#29992;<code class="literal">&lt;idref/&gt;</code>&#20803;&#32032;&#21487;&#20197;&#38450;&#27490;&#20320;&#25340;&#38169;&#25318;&#25130;&#22120;&#30340;id&#12290;</p>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-ref-element" href="#beans-ref-element"></a>&#24341;&#29992;&#20854;&#20182;bean&#65288;&#21327;&#20316;&#32773;&#65289;</h4></div></div></div>

<p>&#22312; <code class="literal">&lt;constructor-arg/&gt;</code> &#25110;&#32773; <code class="literal">&lt;property/&gt;</code>&#21487;&#20197;&#20351;&#29992;<code class="literal">ref</code> &#20803;&#32032;&#12290;&#35813;&#20803;&#32032;&#29992;&#26469;&#23558;bean&#20013;&#25351;&#23450;&#23646;&#24615;&#30340;&#20540;&#35774;&#32622;&#20026;&#23545;&#23481;&#22120;&#30340;&#21478;&#22806;&#19968;&#20010;bean&#65288;&#21327;&#20316;&#32773;&#65289;&#30340;&#24341;&#29992;&#12290;
&#35813;&#24341;&#29992;bean&#23558;&#34987;&#20316;&#20026;&#20381;&#36182;&#27880;&#20837;&#65292;&#32780;&#19988;&#20877;&#27880;&#20837;&#20043;&#21069;&#20250;&#34987;&#21021;&#22987;&#21270;&#65288;&#22914;&#26524;&#21327;&#20316;&#32773;&#26159;&#21333;&#20363;&#65289;&#12290;&#25152;&#26377;&#30340;&#24341;&#29992;&#26368;&#32456;&#37117;&#26159;&#21478;&#19968;&#20010;&#23545;&#35937;&#30340;&#24341;&#29992;&#12290;
bean&#30340;&#33539;&#22260;&#21644;&#39564;&#35777;&#20381;&#36182;&#20110;&#20320;&#25351;&#23450;&#30340;<code class="literal">bean</code>&#65292;<code class="literal">local</code>&#65292;&#25110;&#32773; <code class="literal">parent</code>&#23646;&#24615;&#30340;id/name&#12290;</p>
<p>&#36890;&#36807;<code class="literal">&lt;ref/&gt;</code>&#26631;&#31614;&#30340;<code class="literal">bean</code>&#23646;&#24615;&#23450;&#20041;&#30446;&#26631;bean&#26159;&#26368;&#24120;&#35265;&#30340;&#24418;&#24335;&#65292;&#36890;&#36807;&#35813;&#26631;&#31614;&#21487;&#20197;&#24341;&#29992;&#21516;&#19968;&#23481;&#22120;&#25110;&#32773;&#29238;&#23481;&#22120;&#20219;&#20309;bean&#65292;&#26080;&#35770;&#26159;&#21542;&#22312;
&#30456;&#21516;&#30340;xml&#25991;&#20214;&#20013;&#12290;xml&#30340;<code class="literal">bean</code>&#20803;&#32032;&#30340;&#20540;&#26082;&#21487;&#20197;&#30446;&#26631;bean&#30340;<code class="literal">id</code>&#23646;&#24615;&#20063;&#21487;&#20197;&#26159;&#20854;&#20013;&#19968;&#20010;&#30446;&#26631;bean&#30340;<code class="literal">name</code> &#23646;&#24615;&#20540;&#12290;</p>
<pre class="programlisting"><span class="hl-tag">&lt;ref</span> <span class="hl-attribute">bean</span>=<span class="hl-value">"someBean"</span><span class="hl-tag">/&gt;</span></pre>

<p>&#36890;&#36807;<code class="literal">parent</code>&#23646;&#24615;&#25351;&#23450;&#30446;&#26631;bean&#26469;&#21019;&#24314;bean&#30340;&#24341;&#29992;&#65292;&#35813;bean&#26159;&#24403;&#21069;&#23481;&#22120;&#19979;&#30340;&#29238;&#32423;&#23481;&#22120;&#12290;<code class="literal">parent</code>&#23646;&#24615;&#20540;&#26082;&#21487;&#20197;&#26159;&#30446;&#26631;bean&#30340;id&#20063;&#21487;&#20197;&#26159;
name&#23646;&#24615;&#20540;&#12290;&#32780;&#19988;&#30446;&#26631;bean&#24517;&#39035;&#22312;&#24403;&#21069;&#23481;&#22120;&#30340;&#29238;&#32423;&#23481;&#22120;&#20013;&#12290;&#20351;&#29992;<code class="literal">parent</code>&#23646;&#24615;&#30340;&#20027;&#35201;&#29992;&#36884;&#26159;&#20026;&#20102;&#29992;&#26576;&#20010;&#19982;&#29238;&#32423;&#23481;&#22120;&#20013;&#30340;bean&#21516;&#21517;&#30340;&#20195;&#29702;&#26469;&#21253;&#35013;&#29238;&#32423;&#23481;&#22120;&#20013;&#30340;&#19968;&#20010;bean&#12290;</p>
<pre class="programlisting"><span class="hl-comment">&lt;!-- in the parent context --&gt;</span>
<span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"accountService"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"com.foo.SimpleAccountService"</span><span class="hl-tag">&gt;</span>
    <span class="hl-comment">&lt;!-- insert dependencies as required as here --&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span></pre>

<pre class="programlisting"><span class="hl-comment">&lt;!-- in the child (descendant) context --&gt;</span>
<span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"accountService"</span> <span class="hl-attribute">&lt;!--</span> <span class="hl-attribute">bean</span> <span class="hl-attribute">name</span> <span class="hl-attribute">is</span> <span class="hl-attribute">the</span> <span class="hl-attribute">same</span> <span class="hl-attribute">as</span> <span class="hl-attribute">the</span> <span class="hl-attribute">parent</span> <span class="hl-attribute">bean</span> <span class="hl-attribute">--&gt;</span>
    <span class="hl-attribute">class</span>=<span class="hl-value">"org.springframework.aop.framework.ProxyFactoryBean"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"target"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;ref</span> <span class="hl-attribute">parent</span>=<span class="hl-value">"accountService"</span><span class="hl-tag">/&gt;</span> <span class="hl-comment">&lt;!-- notice how we refer to the parent bean --&gt;</span>
    <span class="hl-tag">&lt;/property&gt;</span>
    <span class="hl-comment">&lt;!-- insert other configuration and dependencies as required here --&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span></pre>

<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p><code class="literal">ref</code>&#20803;&#32032;&#19978;&#30340;<code class="literal">local</code>&#23646;&#24615;4.0 beans xsd&#20043;&#21518;&#19981;&#22312;&#25903;&#25345;&#65292;&#22240;&#20026;&#23427;&#33021;&#25552;&#20379;&#30340;&#20540;&#19981;&#27604;&#26222;&#36890;<code class="literal">bean</code>&#22810;&#12290;&#24403;&#20320;&#21319;&#32423;&#21040;4.0schema&#26102;&#38656;&#35201;&#20462;&#25913;&#23384;&#22312;&#30340;<code class="literal">ref local</code> &#20026;ref bean`&#12290;</p>
</td></tr></table></div>

</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-inner-beans" href="#beans-inner-beans"></a>&#20869;&#37096;bean</h4></div></div></div>

<p>A <code class="literal">&lt;bean/&gt;</code> element inside the <code class="literal">&lt;property/&gt;</code> or <code class="literal">&lt;constructor-arg/&gt;</code> elements defines a
so-called <span class="emphasis"><em>inner bean</em></span>.
&#25152;&#35859;&#30340;&#20869;&#37096;bean&#23601;&#26159;&#25351;&#22312; <code class="literal">&lt;property/&gt;</code> &#25110;&#32773; <code class="literal">&lt;constructor-arg/&gt;</code> &#20803;&#32032;&#20869;&#37096;&#20351;&#29992;<code class="literal">&lt;bean/&gt;</code>&#23450;&#20041;bean&#12290;</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"outer"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"..."</span><span class="hl-tag">&gt;</span>
    <span class="hl-comment">&lt;!-- instead of using a reference to a target bean, simply define the target bean inline --&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"target"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;bean</span> <span class="hl-attribute">class</span>=<span class="hl-value">"com.example.Person"</span><span class="hl-tag">&gt;</span> <span class="hl-comment">&lt;!-- this is the inner bean --&gt;</span>
            <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"name"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"Fiona Apple"</span><span class="hl-tag">/&gt;</span>
            <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"age"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"25"</span><span class="hl-tag">/&gt;</span>
        <span class="hl-tag">&lt;/bean&gt;</span>
    <span class="hl-tag">&lt;/property&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span></pre>

<p>&#20869;&#37096;bean&#30340;&#23450;&#20041;&#19981;&#38656;&#35201;id&#25110;&#32773;name&#23646;&#24615;&#12290;&#23481;&#22120;&#20250;&#24573;&#30053;&#36825;&#20123;&#23646;&#24615;&#20540;&#12290;&#21516;&#26102;&#23481;&#22120;&#20063;&#20250;&#24573;&#30053;<code class="literal">scope</code>&#26631;&#24535;&#20301;&#12290;&#20869;&#37096;bean <span class="emphasis"><em>&#24635;&#26159;</em></span> &#21311;&#21517;&#30340;
&#24182;&#19988;&#20182;&#20204;<span class="emphasis"><em>&#24635;&#26159;</em></span>&#20276;&#38543;&#30528;&#22806;&#37096;bean&#21019;&#24314;&#12290;&#21516;&#26102;&#23558;&#20869;&#37096;bean&#27880;&#20837;&#21040;&#21253;&#21547;&#35813;&#20869;&#37096;bean&#20043;&#22806;&#30340;bean&#26159;&#19981;&#21487;&#33021;&#30340;&#12290;</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-collection-elements" href="#beans-collection-elements"></a>&#38598;&#21512;</h4></div></div></div>

<p>&#22312;<code class="literal">&lt;list/&gt;</code>, <code class="literal">&lt;set/&gt;</code>, <code class="literal">&lt;map/&gt;</code>, &#21644;<code class="literal">&lt;props/&gt;</code>&#20803;&#32032;&#20013;&#65292;&#20320;&#21487;&#20197;&#35774;&#32622;&#20540;&#21644;&#21442;&#25968;&#20998;&#21035;&#23545;&#24212;Java&#30340;&#38598;&#21512;&#31867;&#22411;<code class="literal">List</code>, <code class="literal">Set</code>, <code class="literal">Map</code>, &#21644; <code class="literal">Properties</code></p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"moreComplexObject"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"example.ComplexObject"</span><span class="hl-tag">&gt;</span>
    <span class="hl-comment">&lt;!-- results in a setAdminEmails(java.util.Properties) call --&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"adminEmails"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;props&gt;</span>
            <span class="hl-tag">&lt;prop</span> <span class="hl-attribute">key</span>=<span class="hl-value">"administrator"</span><span class="hl-tag">&gt;</span>administrator@example.org<span class="hl-tag">&lt;/prop&gt;</span>
            <span class="hl-tag">&lt;prop</span> <span class="hl-attribute">key</span>=<span class="hl-value">"support"</span><span class="hl-tag">&gt;</span>support@example.org<span class="hl-tag">&lt;/prop&gt;</span>
            <span class="hl-tag">&lt;prop</span> <span class="hl-attribute">key</span>=<span class="hl-value">"development"</span><span class="hl-tag">&gt;</span>development@example.org<span class="hl-tag">&lt;/prop&gt;</span>
        <span class="hl-tag">&lt;/props&gt;</span>
    <span class="hl-tag">&lt;/property&gt;</span>
    <span class="hl-comment">&lt;!-- results in a setSomeList(java.util.List) call --&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"someList"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;list&gt;</span>
            <span class="hl-tag">&lt;value&gt;</span>a list element followed by a reference<span class="hl-tag">&lt;/value&gt;</span>
            <span class="hl-tag">&lt;ref</span> <span class="hl-attribute">bean</span>=<span class="hl-value">"myDataSource"</span><span class="hl-tag"> /&gt;</span>
        <span class="hl-tag">&lt;/list&gt;</span>
    <span class="hl-tag">&lt;/property&gt;</span>
    <span class="hl-comment">&lt;!-- results in a setSomeMap(java.util.Map) call --&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"someMap"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;map&gt;</span>
            <span class="hl-tag">&lt;entry</span> <span class="hl-attribute">key</span>=<span class="hl-value">"an entry"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"just some string"</span><span class="hl-tag">/&gt;</span>
            <span class="hl-tag">&lt;entry</span> <span class="hl-attribute">key</span> =<span class="hl-value">"a ref"</span> <span class="hl-attribute">value-ref</span>=<span class="hl-value">"myDataSource"</span><span class="hl-tag">/&gt;</span>
        <span class="hl-tag">&lt;/map&gt;</span>
    <span class="hl-tag">&lt;/property&gt;</span>
    <span class="hl-comment">&lt;!-- results in a setSomeSet(java.util.Set) call --&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"someSet"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;set&gt;</span>
            <span class="hl-tag">&lt;value&gt;</span>just some string<span class="hl-tag">&lt;/value&gt;</span>
            <span class="hl-tag">&lt;ref</span> <span class="hl-attribute">bean</span>=<span class="hl-value">"myDataSource"</span><span class="hl-tag"> /&gt;</span>
        <span class="hl-tag">&lt;/set&gt;</span>
    <span class="hl-tag">&lt;/property&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span></pre>

<p><span class="emphasis"><em>map&#30340;key&#25110;&#32773;value&#20540;&#65292;&#25110;&#32773;set&#30340;value&#20540;&#36824;&#21487;&#20197;&#26159;&#20197;&#19979;&#20219;&#24847;&#20803;&#32032;:</em></span></p>
<pre class="programlisting">bean | ref | idref | list | set | map | props | value | null</pre>

<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="beans-collection-elements-merging" href="#beans-collection-elements-merging"></a>&#38598;&#21512;&#21512;&#24182;</h5></div></div></div>

<p>Spring&#23481;&#22120;&#20063;&#25903;&#25345;&#38598;&#21512;&#30340; <span class="emphasis"><em>&#21512;&#24182;</em></span>&#12290;&#24320;&#21457;&#32773;&#21487;&#20197;&#23450;&#20041;parent-style`&lt;list/&gt;<code class="literal">, `&lt;map/&gt;</code>, <code class="literal">&lt;set/&gt;</code> &#25110;&#32773;<code class="literal">&lt;props/&gt;</code> &#20803;&#32032;&#24182;&#65292;
child-style &#30340;<code class="literal">&lt;list/&gt;</code>, <code class="literal">&lt;map/&gt;</code>, <code class="literal">&lt;set/&gt;</code> &#25110;&#32773; <code class="literal">&lt;props/&gt;</code>&#20803;&#32032;&#32487;&#25215;&#21644;&#35206;&#30422;&#33258;&#29238;&#38598;&#21512;&#12290;&#20063;&#23601;&#26159;&#35828;&#12290;&#29238;&#38598;&#21512;&#20803;&#32032;&#21512;&#24182;&#21518;&#30340;&#20540;&#23601;&#26159;&#23376;&#38598;&#21512;&#30340;&#26368;&#32456;&#32467;&#26524;&#65292;&#32780;&#19988;&#23376;&#38598;&#20013;&#30340;&#20803;&#32032;&#20540;&#23558;&#35206;&#30422;&#29238;&#38598;&#20013;&#23545;&#24212;&#30340;&#20540;&#12290;</p>
<p><span class="emphasis"><em>&#20851;&#20110;&#21512;&#24182;&#30340;&#31456;&#33410;&#28041;&#21450;&#21040;&#20102;parent-child bean&#26426;&#21046;&#12290;&#19981;&#29087;&#24713;&#29238;&#23376;bean&#30340;&#35835;&#32773;&#21487;&#21442;&#35265;<a class="link" href="beans.html#beans-child-bean-definitions" title="5.7&nbsp;Bean&#23450;&#20041;&#30340;&#32487;&#25215;">relevant section</a>.</em></span></p>
<p>&#25509;&#19979;&#26469;&#30340;&#20363;&#23376;&#23637;&#31034;&#20102;&#38598;&#21512;&#30340;&#21512;&#24182;&#65306;</p>
<pre class="programlisting"><span class="hl-tag">&lt;beans&gt;</span>
    <span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"parent"</span> <span class="hl-attribute">abstract</span>=<span class="hl-value">"true"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"example.ComplexObject"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"adminEmails"</span><span class="hl-tag">&gt;</span>
            <span class="hl-tag">&lt;props&gt;</span>
                <span class="hl-tag">&lt;prop</span> <span class="hl-attribute">key</span>=<span class="hl-value">"administrator"</span><span class="hl-tag">&gt;</span>administrator@example.com<span class="hl-tag">&lt;/prop&gt;</span>
                <span class="hl-tag">&lt;prop</span> <span class="hl-attribute">key</span>=<span class="hl-value">"support"</span><span class="hl-tag">&gt;</span>support@example.com<span class="hl-tag">&lt;/prop&gt;</span>
            <span class="hl-tag">&lt;/props&gt;</span>
        <span class="hl-tag">&lt;/property&gt;</span>
    <span class="hl-tag">&lt;/bean&gt;</span>
    <span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"child"</span> <span class="hl-attribute">parent</span>=<span class="hl-value">"parent"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"adminEmails"</span><span class="hl-tag">&gt;</span>
            <span class="hl-comment">&lt;!-- the merge is specified on the child collection definition --&gt;</span>
            <span class="hl-tag">&lt;props</span> <span class="hl-attribute">merge</span>=<span class="hl-value">"true"</span><span class="hl-tag">&gt;</span>
                <span class="hl-tag">&lt;prop</span> <span class="hl-attribute">key</span>=<span class="hl-value">"sales"</span><span class="hl-tag">&gt;</span>sales@example.com<span class="hl-tag">&lt;/prop&gt;</span>
                <span class="hl-tag">&lt;prop</span> <span class="hl-attribute">key</span>=<span class="hl-value">"support"</span><span class="hl-tag">&gt;</span>support@example.co.uk<span class="hl-tag">&lt;/prop&gt;</span>
            <span class="hl-tag">&lt;/props&gt;</span>
        <span class="hl-tag">&lt;/property&gt;</span>
    <span class="hl-tag">&lt;/bean&gt;</span>
<span class="hl-tag">&lt;beans&gt;</span></pre>

<p>&#27880;&#24847;<code class="literal">child`bean&#30340;&#23450;&#20041;&#20013;</code>&lt;props/&gt;<code class="literal">&#20803;&#32032;&#19978;&#30340;`merge=true</code>&#23646;&#24615;&#30340;&#29992;&#27861;&#12290;&#24403;<code class="literal">child`bean&#34987;&#35299;&#26512;&#24182;&#19988;&#34987;&#23481;&#22120;&#21021;&#22987;&#21270;&#65292;&#20135;&#29983;&#30340;&#23454;&#20363;&#21253;&#21547;&#20102;`adminEmails</code>
&#65292;<code class="literal">Properties</code>&#38598;&#21512;&#65292;&#20854;adminEmails&#23558;&#19982;&#29238;&#38598;&#21512;&#30340;adminEmails&#23646;&#24615;&#36827;&#34892;&#21512;&#24182;&#12290;</p>

<pre class="literallayout">administrator=administrator@example.com
sales=sales@example.com
support=support@example.co.uk</pre>

<p>&#23376;bean&#30340;<code class="literal">Properties</code>&#38598;&#21512;&#23558;&#20174;&#29238;<code class="literal">&lt;props/&gt;</code>&#38598;&#25104;&#25152;&#26377;&#23646;&#24615;&#20803;&#32032;&#12290;&#21516;&#26102;&#23376;bean&#30340;support&#20540;&#23558;&#35206;&#30422;&#29238;&#38598;&#21512;&#30340;&#30456;&#24212;&#20540;&#12290;</p>
<p><code class="literal">&lt;list/&gt;</code>, <code class="literal">&lt;map/&gt;</code>, &#21644; <code class="literal">&lt;set/&gt;</code>&#38598;&#21512;&#31867;&#22411;&#30340;&#21512;&#24182;&#22788;&#29702;&#37117;&#22522;&#26412;&#31867;&#20284;&#12290;<code class="literal">&lt;list/&gt;</code>&#20803;&#32032;&#26576;&#20010;&#26041;&#38754;&#26377;&#28857;&#29305;&#27530;&#65292;&#36825;&#21644;<code class="literal">List</code>&#38598;&#21512;&#31867;&#22411;&#30340;&#35821;&#20041;&#23398;&#26377;&#20851;
&#25442;&#21477;&#35805;&#35828;&#65292;&#27604;&#22914;&#32500;&#25252;&#19968;&#20010;<code class="literal">&#26377;&#24207;</code>&#38598;&#21512;&#30340;&#20540;&#65292;&#29238;bean&#30340;&#21015;&#34920;&#20869;&#23481;&#23558;&#25490;&#22312;&#23376;bean&#26446;&#24426;&#20869;&#23481;&#30340;&#21069;&#38754;&#12290;&#23545;&#20110;<code class="literal">Map</code>, <code class="literal">Set</code>, &#21644; <code class="literal">Properties</code>&#38598;&#21512;&#31867;&#22411;&#27809;&#26377;&#39034;&#24207;&#30340;&#27010;&#24565;&#65292;
&#22240;&#27492;&#20316;&#20026;&#30456;&#20851;&#30340;<code class="literal">Map</code>, <code class="literal">Set</code>, &#21644; <code class="literal">Properties</code>&#23454;&#29616;&#22522;&#30784;&#30340;&#38598;&#21512;&#31867;&#22411;&#22312;&#23481;&#22120;&#20869;&#37096;&#25490;&#24207;&#30340;&#35821;&#20041;&#12290;</p>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="beans-collection-merge-limitations" href="#beans-collection-merge-limitations"></a>&#38598;&#21512;&#21512;&#24182;&#30340;&#38480;&#21046;</h5></div></div></div>

<p>&#20320;&#19981;&#33021;&#21512;&#24182;&#20004;&#31181;&#19981;&#33021;&#31867;&#22411;&#30340;&#38598;&#21512;&#65288;&#27604;&#22914;<code class="literal">Map</code> &#21644; <code class="literal">List</code>&#65289;&#65292;&#22914;&#26524;&#20320;&#36825;&#20040;&#20570;&#20102;&#23558;&#20250;&#25243;&#20986;&#30456;&#24212;&#30340;<code class="literal">&#24322;&#24120;</code>&#12290;<code class="literal">merge</code>&#23646;&#24615;&#24517;&#39035;&#22312;&#32487;&#25215;
&#30340;&#23376;bean&#20013;&#23450;&#20041;&#12290;&#23450;&#20041;&#22312;&#29238;bean&#30340;&#38598;&#21512;&#23646;&#24615;&#19978;&#25351;&#23450;&#30340;<code class="literal">merge</code>&#23646;&#24615;&#26159;&#22810;&#20313;&#30340;&#24182;&#19988;&#24471;&#19981;&#21040;&#26399;&#26395;&#30340;&#21512;&#24182;&#32467;&#26524;&#12290;</p>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="beans-collection-elements-strongly-typed" href="#beans-collection-elements-strongly-typed"></a>&#24378;&#31867;&#22411;&#38598;&#21512;</h5></div></div></div>

<p>Java 5 &#24341;&#20837;&#20102;&#27867;&#22411;&#65292;&#36825;&#26679;&#20320;&#21487;&#20197;&#20351;&#29992;&#24378;&#31867;&#22411;&#38598;&#21512;&#12290;&#25442;&#21477;&#35805;&#35828;&#32499;&#21629;&#19968;&#20010;&#21482;&#33021;&#21253;&#21547;String&#31867;&#22411;&#20803;&#32032;&#30340;<code class="literal">Collection</code>&#26159;&#21487;&#33021;&#30340;&#65288;&#27604;&#22914;&#65289;&#12290;
&#22914;&#26524;&#20351;&#29992;Spring&#26469;&#32473;bean&#27880;&#20837;&#24378;&#31867;&#22411;&#30340;<code class="literal">Collection</code>&#65292;&#20320;&#21487;&#20197;&#21033;&#29992;Spring&#30340;&#31867;&#22411;&#36716;&#25442;&#65292;&#22312;&#21521;&#24378;&#31867;&#22411;<code class="literal">Collection</code>&#28155;&#21152;&#20803;&#32032;&#21069;&#65292;&#36825;&#20123;&#20803;&#32032;&#23558;&#34987;&#36716;&#25442;&#12290;</p>
<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> Foo {

    <span class="hl-keyword">private</span> Map&lt;String, Float&gt; accounts;

    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> setAccounts(Map&lt;String, Float&gt; accounts) {
        <span class="hl-keyword">this</span>.accounts = accounts;
    }
}</pre>

<pre class="programlisting"><span class="hl-tag">&lt;beans&gt;</span>
    <span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"foo"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"x.y.Foo"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"accounts"</span><span class="hl-tag">&gt;</span>
            <span class="hl-tag">&lt;map&gt;</span>
                <span class="hl-tag">&lt;entry</span> <span class="hl-attribute">key</span>=<span class="hl-value">"one"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"9.99"</span><span class="hl-tag">/&gt;</span>
                <span class="hl-tag">&lt;entry</span> <span class="hl-attribute">key</span>=<span class="hl-value">"two"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"2.75"</span><span class="hl-tag">/&gt;</span>
                <span class="hl-tag">&lt;entry</span> <span class="hl-attribute">key</span>=<span class="hl-value">"six"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"3.99"</span><span class="hl-tag">/&gt;</span>
            <span class="hl-tag">&lt;/map&gt;</span>
        <span class="hl-tag">&lt;/property&gt;</span>
    <span class="hl-tag">&lt;/bean&gt;</span>
<span class="hl-tag">&lt;/beans&gt;</span></pre>

<p>&#24403;<code class="literal">foo</code> bean&#30340;<code class="literal">accounts</code> &#23646;&#24615;&#20934;&#22791;&#27880;&#20837;&#26102;&#65292;&#36890;&#36807;&#21453;&#23556;&#33719;&#24471;&#24378;&#31867;&#22411;<code class="literal">Map&lt;String, Float&gt;</code>&#20803;&#32032;&#31867;&#22411;&#30340;&#27867;&#22411;&#20449;&#24687;&#12290;Spring&#30340;&#24213;&#23618;&#31867;&#22411;&#36716;&#25442;
&#26426;&#21046;&#20250;&#25226;&#21508;&#31181;value&#20803;&#32032;&#20540;&#36716;&#25442;&#20026;<code class="literal">Float</code>&#65292;&#22240;&#27492;&#23383;&#31526;&#20018;<code class="literal">9.99, 2.75</code> &#21644;<code class="literal">3.99</code>&#23558;&#20250;&#36716;&#25442;&#20026;&#23454;&#38469;&#30340;<code class="literal">Float</code> &#31867;&#22411;&#12290;</p>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-null-element" href="#beans-null-element"></a>Null&#21644;&#31354;&#23383;&#31526;&#20018;</h4></div></div></div>

<p>Spring&#20250;&#25226;&#31354;&#23646;&#24615;&#24403;&#20570;&#31354;&#23383;&#31526;&#20018;&#22788;&#29702;&#12290;&#20197;&#19979;&#30340;&#22522;&#20110;XML&#37197;&#32622;&#30340;&#29255;&#27573;&#23558;email&#23646;&#24615;&#35774;&#32622;&#20026;&#31354;&#23383;&#31526;&#20018;&#12290;</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">class</span>=<span class="hl-value">"ExampleBean"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"email"</span> <span class="hl-attribute">value</span>=<span class="hl-value">""</span><span class="hl-tag">/&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span></pre>

<p>&#20808;&#21069;&#30340;&#20363;&#23376;&#31561;&#21516;&#20110;&#20197;&#19979;Java&#20195;&#30721;&#65306;</p>
<pre class="programlisting">exampleBean.setEmail(<span class="hl-string">""</span>)</pre>

<p><code class="literal">&lt;null/&gt;</code>&#20803;&#32032;&#22788;&#29702;<code class="literal">null</code>&#20540;&#65292;&#20363;&#22914;&#65306;</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">class</span>=<span class="hl-value">"ExampleBean"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"email"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;null/&gt;</span>
    <span class="hl-tag">&lt;/property&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span></pre>

<p>&#19978;&#38754;&#30340;&#37197;&#32622;&#31561;&#21516;&#20110;&#19979;&#38754;&#30340;Java&#20195;&#30721;&#65306;</p>
<pre class="programlisting">exampleBean.setEmail(null)</pre>

</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-p-namespace" href="#beans-p-namespace"></a>XML&#20351;&#29992;p&#21629;&#21517;&#31354;&#38388;&#31616;&#21270;</h4></div></div></div>

<p>&#20351;&#29992;p&#21629;&#21517;&#31354;&#38388;&#21487;&#20197;&#29992;<code class="literal">bean</code> &#20803;&#32032;&#30340;&#23646;&#24615;&#20195;&#26367;&lt;property/&gt;` &#20803;&#32032;&#26469;&#25551;&#36848;&#23646;&#24615;&#20540;&#25110;&#32773;&#21327;&#20316;bean&#12290;</p>
<p>Spring&#25903;&#25345;&#21517;&#31216;&#31354;&#38388;&#30340;&#21487;&#25193;&#23637;&#37197;&#32622;<a class="link" href="xsd-config.html" title="33.&nbsp;XML Schema-based configuration">with namespaces</a>&#65292;&#36825;&#20123;&#21517;&#31216;&#31354;&#38388;&#22522;&#20110;&#19968;&#31181;XML Schema&#23450;&#20041;&#12290;&#36825;&#31456;&#33410;&#28041;&#21450;&#21040;&#30340;<code class="literal">beans</code>
&#37197;&#32622;&#37117;&#26159;&#23450;&#20041;&#22312;&#19968;&#20010;XML Schema&#25991;&#26723;&#29702;&#12290;&#20294;&#26159;p&#21629;&#21517;&#31354;&#38388;&#19981;&#26159;&#23450;&#20041;&#22312;XSD&#25991;&#20214;&#32780;&#26159;&#23384;&#22312;&#20110;Spring&#20869;&#26680;&#20013;&#12290;</p>
<p>&#19979;&#38754;&#30340;&#20363;&#23376;&#23637;&#31034;&#20102;&#20004;&#31181;XML&#29255;&#27573;&#65292;&#20854;&#32467;&#26524;&#26159;&#19968;&#26679;&#30340;&#65306;&#31532;&#19968;&#20010;&#20351;&#29992;&#20102;&#26631;&#20934;XML&#26684;&#24335;&#65292;&#31532;&#20108;&#31181;&#20351;&#29992;&#20102;p&#21629;&#21517;&#31354;&#38388;&#12290;</p>
<pre class="programlisting"><span class="hl-tag">&lt;beans</span> <span class="hl-attribute">xmlns</span>=<span class="hl-value">"http://www.springframework.org/schema/beans"</span>
    <span class="hl-attribute">xmlns:xsi</span>=<span class="hl-value">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hl-attribute">xmlns:p</span>=<span class="hl-value">"http://www.springframework.org/schema/p"</span>
    <span class="hl-attribute">xsi:schemaLocation</span>=<span class="hl-value">"http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd"</span><span class="hl-tag">&gt;</span>

    <span class="hl-tag">&lt;bean</span> <span class="hl-attribute">name</span>=<span class="hl-value">"classic"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"com.example.ExampleBean"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"email"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"foo@bar.com"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;/bean&gt;</span>

    <span class="hl-tag">&lt;bean</span> <span class="hl-attribute">name</span>=<span class="hl-value">"p-namespace"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"com.example.ExampleBean"</span>
        <span class="hl-attribute">p:email</span>=<span class="hl-value">"foo@bar.com"</span><span class="hl-tag">/&gt;</span>
<span class="hl-tag">&lt;/beans&gt;</span></pre>

<p>&#22312;&#20363;&#23376;&#20013;&#65292;&#20351;&#29992;p&#21629;&#21517;&#31354;&#38388;&#30340;bean&#23450;&#20041;&#26377;&#20102;&#19968;&#20010;&#21483;email&#30340;&#23646;&#24615;&#12290;&#36825;&#21578;&#35785;Spring&#35201;&#21253;&#21547;&#36825;&#20010;&#23646;&#24615;&#30340;&#22768;&#26126;&#12290;&#27491;&#22914;&#21069;&#38754;&#25152;&#35828;&#30340;&#65292;
p&#21629;&#21517;&#31354;&#38388;&#19981;&#38656;&#35201;schema&#23450;&#20041;&#65292;&#22240;&#27492;&#20320;&#21487;&#20197;&#35774;&#32622;&#23646;&#24615;&#30340;&#21517;&#23383;&#20316;&#20026;bean&#30340;property&#30340;&#21517;&#23383;&#12290;</p>
<p>&#25509;&#19979;&#26469;&#30340;&#20363;&#23376;&#21253;&#25324;&#20102;&#20004;&#31181;&#20197;&#19978;bean&#30340;&#23450;&#20041;&#65292;&#37117;&#24341;&#29992;&#20102;&#21478;&#22806;&#19968;&#20010;bean&#12290;</p>
<pre class="programlisting"><span class="hl-tag">&lt;beans</span> <span class="hl-attribute">xmlns</span>=<span class="hl-value">"http://www.springframework.org/schema/beans"</span>
    <span class="hl-attribute">xmlns:xsi</span>=<span class="hl-value">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hl-attribute">xmlns:p</span>=<span class="hl-value">"http://www.springframework.org/schema/p"</span>
    <span class="hl-attribute">xsi:schemaLocation</span>=<span class="hl-value">"http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd"</span><span class="hl-tag">&gt;</span>

    <span class="hl-tag">&lt;bean</span> <span class="hl-attribute">name</span>=<span class="hl-value">"john-classic"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"com.example.Person"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"name"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"John Doe"</span><span class="hl-tag">/&gt;</span>
        <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"spouse"</span> <span class="hl-attribute">ref</span>=<span class="hl-value">"jane"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;/bean&gt;</span>

    <span class="hl-tag">&lt;bean</span> <span class="hl-attribute">name</span>=<span class="hl-value">"john-modern"</span>
        <span class="hl-attribute">class</span>=<span class="hl-value">"com.example.Person"</span>
        <span class="hl-attribute">p:name</span>=<span class="hl-value">"John Doe"</span>
        <span class="hl-attribute">p:spouse-ref</span>=<span class="hl-value">"jane"</span><span class="hl-tag">/&gt;</span>

    <span class="hl-tag">&lt;bean</span> <span class="hl-attribute">name</span>=<span class="hl-value">"jane"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"com.example.Person"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"name"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"Jane Doe"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;/bean&gt;</span>
<span class="hl-tag">&lt;/beans&gt;</span></pre>

<p>&#27491;&#22914;&#20320;&#30475;&#21040;&#30340;&#65292;&#20363;&#23376;&#19981;&#20165;&#20351;&#29992;p&#21629;&#21517;&#31354;&#38388;&#21253;&#21547;&#20102;&#19968;&#20010;&#23646;&#24615;&#20540;&#65292;&#32780;&#19988;&#20351;&#29992;&#20102;&#19968;&#20010;&#29305;&#27530;&#30340;&#26684;&#24335;&#22768;&#26126;&#20102;&#19968;&#20010;&#23646;&#24615;&#30340;&#24341;&#29992;&#12290;&#22312;&#31532;&#19968;&#20010;bean
&#23450;&#20041;&#20013;&#20351;&#29992;&#20102;<code class="literal">&lt;property name="spouse" ref="jane"/&gt;</code>&#21019;&#24314;&#19968;&#20010;<code class="literal">john</code> bean &#23545;<code class="literal">jane</code> bean&#30340;&#24341;&#29992;&#65292;&#31532;&#20108;&#20010;bean&#30340;&#23450;&#20041;&#20351;&#29992;&#20102;<code class="literal">p:spouse-ref="jane"</code>&#65292;&#23427;&#20204;&#20570;&#20102;&#21516;&#26679;&#19968;&#20214;&#20107;&#24773;&#12290;&#22312;&#36825;&#20010;&#20363;&#23376;&#20013;<code class="literal">spouse</code>&#26159;&#23646;&#24615;&#21517;&#65292;&#32780;<code class="literal">-ref</code>&#37096;&#20998;&#22768;&#26126;&#20102;&#36825;&#19981;&#26159;&#19968;&#20010;&#30452;&#25509;&#30340;&#20540;&#32780;&#26159;&#21478;&#19968;&#20010;bean&#30340;&#24341;&#29992;&#12290;</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p>p&#21629;&#21517;&#31354;&#38388;&#27809;&#26377;&#26631;&#20934;XML&#26684;&#24335;&#37027;&#20040;&#28789;&#27963;&#12290;&#20030;&#20010;&#20363;&#23376;&#65292;&#22768;&#26126;&#23646;&#24615;&#30340;&#24341;&#29992;&#26159;&#20197;<code class="literal">Ref</code>&#32467;&#23614;&#30340;&#65292;&#37319;&#29992;p&#21629;&#21517;&#31354;&#38388;&#23558;&#20250;&#20135;&#29983;&#20914;&#31361;&#65292;&#20294;&#26159;&#37319;&#29992;&#26631;&#20934;XML
&#26684;&#24335;&#21017;&#19981;&#20250;&#12290;&#25105;&#20204;&#24314;&#35758;&#20320;&#23567;&#24515;&#30340;&#36873;&#25321;&#24182;&#21644;&#22242;&#38431;&#25104;&#21592;&#20132;&#27969;&#20320;&#30340;&#24819;&#27861;&#65292;&#36991;&#20813;&#22312;XML&#25991;&#26723;&#20013;&#21516;&#26102;&#20351;&#29992;&#25152;&#26377;&#30340;&#19977;&#31181;&#26041;&#27861;&#12290;</p>
</td></tr></table></div>

</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-c-namespace" href="#beans-c-namespace"></a>XML shortcut with the c-namespace</h4></div></div></div>

<p>&#21644;p&#21629;&#21517;&#31354;&#38388;<a class="xref" href="beans.html#beans-p-namespace" title="XML&#20351;&#29992;p&#21629;&#21517;&#31354;&#38388;&#31616;&#21270;">the section called &#8220;XML&#20351;&#29992;p&#21629;&#21517;&#31354;&#38388;&#31616;&#21270;&#8221;</a>&#31867;&#20284;&#65292;Spring3.1 &#24341;&#20837;&#20102;<span class="emphasis"><em>c&#21629;&#21517;&#31354;&#38388;</em></span>&#65292;&#20351;&#29992;&#20869;&#32852;&#30340;&#26500;&#36896;&#21442;&#25968;&#20195;&#26367;&#23884;&#22871;&#30340;<code class="literal">constructor-arg</code>&#20803;&#32032;</p>
<p>&#35753;&#25105;&#20204;&#22238;&#39038;&#19968;&#19979;<a class="xref" href="beans.html#beans-constructor-injection" title="&#26500;&#36896;&#22120;&#27880;&#20837;">the section called &#8220;&#26500;&#36896;&#22120;&#27880;&#20837;&#8221;</a>&#20351;&#29992;c&#21629;&#21517;&#31354;&#38388;&#30340;&#20363;&#23376;:</p>
<pre class="programlisting">&lt;beans xmlns=<span class="hl-string">"http://www.springframework.org/schema/beans"</span>
    xmlns:xsi=<span class="hl-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
    xmlns:c=<span class="hl-string">"http://www.springframework.org/schema/c"</span>
    xsi:schemaLocation=<span class="hl-string">"http://www.springframework.org/schema/beans
</span>        http:<span class="hl-comment">//www.springframework.org/schema/beans/spring-beans.xsd"&gt;</span>

    &lt;bean id=<span class="hl-string">"bar"</span> <span class="hl-keyword">class</span>=<span class="hl-string">"x.y.Bar"</span>/&gt;
    &lt;bean id=<span class="hl-string">"baz"</span> <span class="hl-keyword">class</span>=<span class="hl-string">"x.y.Baz"</span>/&gt;

    &lt;!-- traditional declaration --&gt;
    &lt;bean id=<span class="hl-string">"foo"</span> <span class="hl-keyword">class</span>=<span class="hl-string">"x.y.Foo"</span>&gt;
        &lt;constructor-arg ref=<span class="hl-string">"bar"</span>/&gt;
        &lt;constructor-arg ref=<span class="hl-string">"baz"</span>/&gt;
        &lt;constructor-arg value=<span class="hl-string">"foo@bar.com"</span>/&gt;
    &lt;/bean&gt;

    &lt;!-- c-namespace declaration --&gt;
    &lt;bean id=<span class="hl-string">"foo"</span> <span class="hl-keyword">class</span>=<span class="hl-string">"x.y.Foo"</span> c:bar-ref=<span class="hl-string">"bar"</span> c:baz-ref=<span class="hl-string">"baz"</span> c:email=<span class="hl-string">"foo@bar.com"</span>/&gt;

&lt;/beans&gt;</pre>

<p>&#21644;p&#21629;&#21517;&#31354;&#38388;&#32422;&#23450;&#30340;&#19968;&#26679;(bean&#30340;&#24341;&#29992;&#20197;<code class="literal">-ref</code>&#32467;&#23614;)&#65292;c&#21629;&#21517;&#31354;&#38388;&#20351;&#29992;&#23427;&#20204;&#30340;&#21517;&#31216;&#20316;&#20026;&#26500;&#36896;&#22120;&#21442;&#25968;&#12290;&#21516;&#26102;&#23427;&#38656;&#35201;&#22768;&#26126;&#21363;&#20351;&#23427;&#27809;&#26377;
XSD schema&#20013;&#23450;&#20041;&#65288;&#20294;&#26159;&#23427;&#23384;&#22312;&#20110;Spring&#20869;&#26680;&#20013;&#65289;</p>
<p>&#26497;&#23569;&#25968;&#30340;&#24773;&#20917;&#19979;&#26500;&#36896;&#22120;&#21442;&#25968;&#30340;&#21517;&#31216;&#19981;&#21487;&#29992;&#65288;&#36890;&#24120;&#23383;&#33410;&#30721;&#27809;&#26377;&#32463;&#36807;&#35843;&#35797;&#20449;&#24687;&#32534;&#35793;&#65289;&#65292;&#21487;&#20197;&#20351;&#29992;&#22791;&#20221;&#36827;&#34892;&#21442;&#25968;&#32034;&#24341;&#12290;</p>
<pre class="programlisting">&lt;!-- c-namespace index declaration --&gt;
&lt;bean id=<span class="hl-string">"foo"</span> <span class="hl-keyword">class</span>=<span class="hl-string">"x.y.Foo"</span> c:_<span class="hl-number">0</span>-ref=<span class="hl-string">"bar"</span> c:_<span class="hl-number">1</span>-ref=<span class="hl-string">"baz"</span>/&gt;</pre>

<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p>&#22240;&#20026;XML&#30340;&#35821;&#27861;&#65292;&#32034;&#24341;&#26631;&#35760;&#38656;&#35201;<code class="literal">_</code>&#20027;&#23548;&#20316;&#20026;XML&#23646;&#24615;&#21517;&#31216;&#65292;&#36825;&#19981;&#33021;&#24050;&#25968;&#23383;&#24320;&#22836;&#65288;&#21363;&#20351;&#26576;&#20123;IDE&#36825;&#20040;&#20801;&#35768;&#65289;</p>
</td></tr></table></div>

<p>&#22312;&#23454;&#36341;&#20013;&#65292;&#26500;&#36896;&#22120;&#35299;&#26512;&#26426;&#26234;<a class="link" href="beans.html#beans-factory-ctor-arguments-resolution" title="&#26500;&#36896;&#22120;&#21442;&#25968;&#35299;&#26512;">&#26426;&#21046;</a>&#22312;&#21305;&#37197;&#21442;&#25968;&#19978;&#30456;&#24403;&#39640;&#25928;&#12290;&#38500;&#38750;&#20320;&#38656;&#35201;&#36825;&#20040;&#20570;&#65292;&#25105;&#20204;&#24314;&#35758;&#24744;&#22312;&#37197;&#32622;&#20013;&#20351;&#29992;&#31526;&#21495;&#21517;&#31216;&#12290;</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-compound-property-names" href="#beans-compound-property-names"></a>&#32452;&#21512;&#23646;&#24615;&#21517;&#31216;</h4></div></div></div>

<p>&#24403;&#20320;&#35774;&#32622;bean&#23646;&#24615;&#26102;&#21487;&#20197;&#20351;&#29992;&#32452;&#21512;&#25110;&#32773;&#23884;&#22871;&#23646;&#24615;&#21517;&#31216;&#65292;&#21482;&#35201;&#36335;&#24452;&#19978;&#25152;&#26377;&#32452;&#20214;&#38500;&#20102;&#26368;&#32456;&#23646;&#24615;&#19981;&#20026;&#31354;&#12290;&#30475;&#20197;&#19979;bean&#30340;&#23450;&#20041;&#65306;</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"foo"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"foo.Bar"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"fred.bob.sammy"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"123"</span><span class="hl-tag"> /&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span></pre>

<p><code class="literal">foo</code> bean&#26377;&#19968;&#20010;<code class="literal">fred</code>&#23646;&#24615;&#65292;<code class="literal">fred</code>&#23646;&#24615;&#21448;&#26377;&#20010;<code class="literal">bob</code>&#23646;&#24615;&#65292;<code class="literal">bob</code>&#23646;&#24615;&#21448;&#26377;&#20010;&#23646;&#24615;&#65292;&#26368;&#21518;&#25226; <code class="literal">sammy</code>&#23646;&#24615;&#35774;&#32622;&#20540;&#20026;<code class="literal">123</code>&#12290;&#20026;&#20102;&#26159;&#36825;&#20010;&#36215;&#20316;&#29992;&#65292;<code class="literal">foo</code>&#30340;<code class="literal">fred</code>&#23646;&#24615;&#21644; <code class="literal">fred</code>&#30340;<code class="literal">bob</code>&#23646;&#24615;&#22312;bean&#34987;&#26500;&#36896;&#21518;&#37117;&#19981;&#33021;&#20026;&#31354;&#65292;&#21542;&#21017;&#20250;&#25243;&#20986;<code class="literal">NullPointerException</code>&#24322;&#24120;&#12290;</p>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="beans-factory-dependson" href="#beans-factory-dependson"></a>5.4.3&nbsp;&#20351;&#29992; depends-on</h3></div></div></div>

<p>&#22914;&#26524;&#19968;&#20010;bean&#26159;&#21478;&#22806;&#19968;&#20010;bean&#30340;&#20381;&#36182;&#65292;&#36825;&#36890;&#24120;&#24847;&#21619;&#30528;&#36825;&#20010;bean&#21487;&#20197;&#35774;&#32622;&#25104;&#20026;&#21478;&#22806;&#19968;&#20010;bean&#30340;&#23646;&#24615;&#12290;&#22312;XML&#37197;&#32622;&#25991;&#20214;&#20013;&#20320;&#21487;&#20197;&#20351;&#29992;&lt;&lt;beans-ref-element, <code class="literal">&lt;ref/&gt;`element&gt;&gt;
&#23454;&#29616;&#20381;&#36182;&#12290;&#20294;&#26159;&#26576;&#20123;&#26102;&#20505;bean&#20043;&#38388;&#30340;&#20381;&#36182;&#24182;&#19981;&#26159;&#37027;&#20040;&#30452;&#25509;&#12290;&#20030;&#20010;&#20363;&#23376;&#65306;&#31867;&#30340;&#38745;&#24577;&#22359;&#21021;&#22987;&#21270;&#65292;&#27604;&#22914;&#25968;&#25454;&#24211;&#39537;&#21160;&#30340;&#27880;&#20876;&#12290;`depends-on</code>&#23646;&#24615;
&#21487;&#20197;&#21516;&#20110;&#24403;&#21069;bean&#21021;&#22987;&#21270;&#20043;&#21069;&#26174;&#24335;&#22320;&#24378;&#21046;&#19968;&#20010;&#25110;&#22810;&#20010;bean&#34987;&#21021;&#22987;&#21270;&#12290;&#19979;&#38754;&#30340;&#20363;&#23376;&#20013;&#20351;&#29992;&#20102;<code class="literal">depends-on</code>&#23646;&#24615;&#26469;&#25351;&#23450;&#19968;&#20010;bean&#30340;&#20381;&#36182;&#12290;</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"beanOne"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"ExampleBean"</span> <span class="hl-attribute">depends-on</span>=<span class="hl-value">"manager"</span><span class="hl-tag">/&gt;</span>
<span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"manager"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"ManagerBean"</span><span class="hl-tag"> /&gt;</span></pre>

<p>&#20026;&#20102;&#23454;&#29616;&#22810;&#20010;bean&#30340;&#20381;&#36182;&#65292;&#20320;&#21487;&#20197;&#22312;<code class="literal">depends-on</code>&#20013;&#23558;&#25351;&#23450;&#30340;&#22810;&#20010;bean&#21517;&#23383;&#29992;&#20998;&#38548;&#31526;&#36827;&#34892;&#20998;&#38548;&#65292;&#20998;&#38548;&#31526;&#21487;&#20197;&#26159;&#36887;&#21495;&#65292;&#31354;&#26684;&#20197;&#21450;&#20998;&#21495;&#31561;&#12290;</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"beanOne"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"ExampleBean"</span> <span class="hl-attribute">depends-on</span>=<span class="hl-value">"manager,accountDao"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"manager"</span> <span class="hl-attribute">ref</span>=<span class="hl-value">"manager"</span><span class="hl-tag"> /&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span>

<span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"manager"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"ManagerBean"</span><span class="hl-tag"> /&gt;</span>
<span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"accountDao"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"x.y.jdbc.JdbcAccountDao"</span><span class="hl-tag"> /&gt;</span></pre>

<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p><code class="literal">depends-on</code>&#23646;&#24615;&#22312;bean&#30340;&#23450;&#20041;&#20013;&#21487;&#20197;&#25351;&#23450;&#21021;&#22987;&#21270;&#26102;&#30340;&#20381;&#36182;&#21644;&#25351;&#23450;&#30456;&#24212;&#30340;&#38144;&#27585;&#26102;&#30340;&#20381;&#36182;&#65292;&#35813;&#20381;&#36182;&#21482;&#38024;&#23545;&#20110;<a class="link" href="beans.html#beans-factory-scopes-singleton" title="5.5.1&nbsp;&#21333;&#20363;&#20316;&#29992;&#22495;">singleton</a> bean
&#36825;&#26679;<code class="literal">depends-on</code>&#21487;&#20197;&#25511;&#21046;&#38144;&#27585;&#39034;&#24207;&#12290;</p>
</td></tr></table></div>

</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="beans-factory-lazy-init" href="#beans-factory-lazy-init"></a>5.4.4&nbsp;&#24310;&#36831;&#21021;&#22987;&#21270;bean</h3></div></div></div>

<p><code class="literal">ApplicationContext</code>&#23454;&#29616;&#30340;&#40664;&#35748;&#34892;&#20026;&#23601;&#26159;&#20877;&#21551;&#21160;&#26102;&#23558;&#25152;&#26377;<a class="link" href="beans.html#beans-factory-scopes-singleton" title="5.5.1&nbsp;&#21333;&#20363;&#20316;&#29992;&#22495;">singleton</a> bean&#25552;&#21069;&#36827;&#34892;&#23454;&#20363;&#21270;&#12290;
&#36890;&#24120;&#36825;&#26679;&#30340;&#25552;&#21069;&#23454;&#20363;&#21270;&#26041;&#24335;&#26159;&#22909;&#20107;&#65292;&#22240;&#20026;&#37197;&#32622;&#20013;&#25110;&#32773;&#36816;&#34892;&#29615;&#22659;&#30340;&#38169;&#35823;&#23601;&#20250;&#34987;&#31435;&#21051;&#21457;&#29616;&#65292;&#21542;&#21017;&#21487;&#33021;&#35201;&#33457;&#20960;&#20010;&#23567;&#26102;&#29978;&#33267;&#20960;&#22825;&#12290;&#22914;&#26524;&#20320;&#19981;&#24819;
&#36825;&#26679;&#65292;&#20320;&#21487;&#20197;&#23558;&#21333;&#20363;bean&#23450;&#20041;&#20026;&#24310;&#36831;&#21152;&#36733;&#38450;&#27490;&#23427;&#25552;&#21069;&#23454;&#20363;&#21270;&#12290;&#24310;&#36831;&#21021;&#22987;&#21270;bean&#20250;&#21578;&#35785;Ioc&#23481;&#22120;&#22312;&#31532;&#19968;&#27425;&#38656;&#35201;&#30340;&#26102;&#20505;&#25165;&#23454;&#20363;&#21270;&#32780;&#19981;&#26159;&#22312;&#23481;&#22120;&#21551;&#21160;&#26102;&#23601;&#23454;&#20363;&#21270;&#12290;</p>
<p>&#22312;XML&#37197;&#32622;&#25991;&#20214;&#20013;&#65292;&#24310;&#36831;&#21021;&#22987;&#21270;&#36890;&#36807;<code class="literal">&lt;bean/&gt;</code>&#20803;&#32032;&#30340;<code class="literal">lazy-init</code>&#23646;&#24615;&#36827;&#34892;&#25511;&#21046;&#65292;&#27604;&#22914;&#65306;</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"lazy"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"com.foo.ExpensiveToCreateBean"</span> <span class="hl-attribute">lazy-init</span>=<span class="hl-value">"true"</span><span class="hl-tag">/&gt;</span>
<span class="hl-tag">&lt;bean</span> <span class="hl-attribute">name</span>=<span class="hl-value">"not.lazy"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"com.foo.AnotherBean"</span><span class="hl-tag">/&gt;</span></pre>

<p>&#24403;<code class="literal">ApplicationContext</code>&#23454;&#29616;&#19978;&#38754;&#30340;&#37197;&#32622;&#26102;&#65292;&#35774;&#32622;&#20026;<code class="literal">lazy</code>&#30340;bean&#23558;&#19981;&#20250;&#22312;<code class="literal">ApplicationContext</code>&#21551;&#21160;&#26102;&#25552;&#21069;&#23454;&#20363;&#21270;&#65292;&#32780;`not.lazy`bean
&#21364;&#20250;&#34987;&#25552;&#21069;&#23454;&#20363;&#21270;&#12290;</p>
<p>&#20294;&#26159;&#24403;&#19968;&#20010;&#24310;&#36831;&#21152;&#36733;&#30340;bean&#26159;&#21333;&#20363;bean&#30340;&#20381;&#36182;&#65292;&#20294;&#36825;&#20010;&#21333;&#20363;bean&#21448;<span class="emphasis"><em>&#19981;&#26159;</em></span> &#24310;&#36831;&#21152;&#36733;&#65292;<code class="literal">ApplicationContext</code>&#22312;&#21551;&#21160;&#26102;&#21019;&#24314;&#20102;&#24310;&#36831;&#21152;&#36733;
&#30340;bean&#65292;&#22240;&#20026;&#23427;&#24517;&#39035;&#28385;&#36275;&#21333;&#20363;bean&#30340;&#20381;&#36182;&#12290;&#22240;&#27492;&#24310;&#36831;&#21152;&#36733;&#30340;bean&#20250;&#34987;&#27880;&#20837;&#21333;&#20363;bean&#65292;&#28982;&#32780;&#22312;&#20854;&#20182;&#22320;&#26041;&#23427;&#19981;&#20250;&#24310;&#36831;&#21152;&#36733;&#12290;</p>
<p>&#20320;&#20063;&#21487;&#20197;&#20351;&#29992;<code class="literal">&lt;beans/&gt;</code>&#20803;&#32032;&#19978;&#30340;<code class="literal">default-lazy-init</code>&#23646;&#24615;&#22312;&#23481;&#22120;&#23618;&#27425;&#19978;&#25511;&#21046;&#24310;&#36831;&#21152;&#36733;&#12290;&#27604;&#22914;&#65306;</p>
<pre class="programlisting"><span class="hl-tag">&lt;beans</span> <span class="hl-attribute">default-lazy-init</span>=<span class="hl-value">"true"</span><span class="hl-tag">&gt;</span>
    <span class="hl-comment">&lt;!-- no beans will be pre-instantiated... --&gt;</span>
<span class="hl-tag">&lt;/beans&gt;</span></pre>

</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="beans-factory-autowire" href="#beans-factory-autowire"></a>5.4.5&nbsp;&#33258;&#21160;&#35013;&#37197;&#21327;&#20316;&#32773;</h3></div></div></div>

<p>Spring&#23481;&#22120;&#21487;&#20197;&#33258;&#21160;&#35013;&#37197;&#30456;&#20114;&#21327;&#20316;bean&#30340;&#20851;&#32852;&#20851;&#31995;&#12290;&#22240;&#27492;&#65292;&#22914;&#26524;&#21487;&#33021;&#30340;&#35805;&#65292;&#21487;&#20197;&#33258;&#21160;&#35753;Spring&#26816;&#27979;<code class="literal">ApplicationContext</code>&#30340;&#20869;&#23481;&#33258;&#21160;
&#22788;&#29702;&#21327;&#20316;&#32773;&#65288;&#20854;&#20182;bean&#65289;&#12290;&#33258;&#21160;&#35013;&#37197;&#26377;&#20197;&#19979;&#22909;&#22788;&#65306;</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
&#33258;&#21160;&#35013;&#37197;&#21487;&#20197;&#26174;&#33879;&#24471;&#20943;&#23569;&#25351;&#23450;&#23646;&#24615;&#25110;&#32773;&#26500;&#36896;&#22120;&#21442;&#25968;&#30340;&#38656;&#27714;&#12290;&#65288;&#20854;&#20182;&#30340;&#26426;&#21046;&#27604;&#22914;bean&#27169;&#26495;<a class="link" href="beans.html#beans-child-bean-definitions" title="5.7&nbsp;Bean&#23450;&#20041;&#30340;&#32487;&#25215;">discussed elsewhere in this chapter</a>&#22312;&#36825;&#26041;&#38754;&#20063;&#26159;&#30001;&#20215;&#20540;&#30340;&#65289;
</li><li class="listitem">
&#24403;&#23545;&#35937;&#21457;&#29983;&#21464;&#21270;&#26102;&#33258;&#21160;&#35013;&#37197;&#21487;&#20197;&#26356;&#26032;&#37197;&#32622;&#12290;&#27604;&#22914;&#22914;&#26524;&#20320;&#38656;&#35201;&#32473;&#19968;&#20010;&#31867;&#28155;&#21152;&#20381;&#36182;&#65292;&#37027;&#20040;&#36825;&#20010;&#20381;&#36182;&#21487;&#20197;&#34987;&#33258;&#21160;&#28385;&#36275;&#32780;&#19981;&#38656;&#35201;&#20320;&#21435;&#20462;&#25913;&#37197;&#32622;&#12290;
&#22240;&#27492;&#33258;&#21160;&#20381;&#36182;&#22312;&#24320;&#21457;&#26102;&#23588;&#20854;&#26377;&#29992;&#65292;&#24403;&#31995;&#32479;&#36235;&#20110;&#31283;&#23450;&#26102;&#25913;&#20026;&#26174;&#24335;&#35013;&#37197;&#12290;
</li></ul></div>

<p>&#24403;&#20351;&#29992;XML&#37197;&#32622;&#33050;&#27880;&#65306;[See
<a class="xref" href="beans.html#beans-factory-collaborators" title="5.4.1&nbsp;&#20381;&#36182;&#27880;&#20837;">Section&nbsp;5.4.1, &#8220;&#20381;&#36182;&#27880;&#20837;&#8221;</a>]&#65292;&#21487;&#20197;&#20351;&#29992;<code class="literal">&lt;bean/&gt;</code>&#20803;&#32032;&#30340;<code class="literal">autowire</code>&#23646;&#24615;
&#20026;&#23450;&#20041;&#30340;bean&#25351;&#23450;&#33258;&#21160;&#35013;&#37197;&#27169;&#24335;&#12290;&#20320;&#21487;&#20197;&#25351;&#23450;&#33258;&#21160;&#35013;&#37197;<span class="emphasis"><em>per</em></span> bean&#65292;&#36873;&#25321;&#37027;&#31181;&#26041;&#24335;&#26469;&#33258;&#21160;&#35013;&#37197;&#12290;</p>
<div class="table"><a name="beans-factory-autowiring-modes-tbl" href="#beans-factory-autowiring-modes-tbl"></a><p class="title"><b>Table&nbsp;5.2.&nbsp;&#33258;&#21160;&#35013;&#37197;&#27169;&#24335;</b></p><div class="table-contents">

  <table summary="&#33258;&#21160;&#35013;&#37197;&#27169;&#24335;" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="col_1"><col class="col_2"></colgroup><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Mode</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Explanation
  &#27169;&#24335;&#35299;&#37322;</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>no</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>&#65288;&#40664;&#35748;&#65289;&#19981;&#33258;&#21160;&#35013;&#37197;&#12290;Bean&#30340;&#24341;&#29992;&#24517;&#39035;&#29992;<code class="literal">ref</code>&#20803;&#32032;&#23450;&#20041;&#12290;&#23545;&#20110;&#36739;&#22823;&#30340;&#37096;&#32626;&#19981;&#24314;&#35758;&#25913;&#21464;&#40664;&#35748;&#35774;&#32622;&#65292;&#22240;&#20026;&#26126;&#30830;&#25351;&#23450;&#21327;&#20316;&#32773;&#33021;&#26356;&#22909;&#25511;&#21046;&#21644;&#32500;&#25252;&#31995;&#32479;&#12290;
  &#22312;&#26576;&#31181;&#31243;&#24230;&#19978;&#65292;&#23427;&#35760;&#24405;&#20102;&#31995;&#32479;&#30340;&#32467;&#26500;&#12290;</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>byName</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>&#36890;&#36807;&#23646;&#24615;&#21517;&#31216;&#33258;&#21160;&#35013;&#37197;&#12290;Spring&#20250;&#23547;&#25214;&#30456;&#21516;&#21517;&#31216;&#30340;bean&#24182;&#23558;&#20854;&#19982;&#23646;&#24615;&#33258;&#21160;&#35013;&#37197;&#12290;&#35692;&#22914;&#65292;&#22914;&#26524;bean&#30340;&#23450;&#20041;&#35774;&#32622;&#20102;&#26681;&#25454;&#21517;&#31216;&#33258;&#21160;&#35013;&#37197;&#65292;
  &#24182;&#19988;&#21253;&#21547;&#20102;&#19968;&#20010;<span class="emphasis"><em>master</em></span> &#23646;&#24615;&#65288;&#25442;&#21477;&#35805;&#35828;&#65292;&#23427;&#26377;<span class="emphasis"><em>setMaster(..)</em></span>&#26041;&#27861;&#65289;&#65292;Spring&#20250;&#23547;&#25214;&#21517;&#20026;<code class="literal">master</code>&#30340;bean&#30340;&#23450;&#20041;&#65292;&#24182;&#29992;&#23427;&#26469;&#35013;&#37197;&#23646;&#24615;</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>byType</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>&#22914;&#26524;&#23481;&#22120;&#20013;&#23384;&#22312;&#19968;&#20010;&#19982;&#25351;&#23450;&#23646;&#24615;&#31867;&#22411;&#30456;&#21516;&#30340;bean&#65292;&#37027;&#20040;&#23558;&#19982;&#35813;&#23646;&#24615;&#33258;&#21160;&#35013;&#37197;&#12290;&#22914;&#26524;&#23384;&#22312;&#22810;&#20010;&#35813;&#31867;&#22411;&#30340;bean&#65292;&#23558;&#20250;&#25243;&#20986;&#24322;&#24120;&#65292;&#24182;&#25351;&#20986;
  &#19981;&#33021;&#20351;&#29992;<span class="emphasis"><em>byType</em></span>&#33258;&#21160;&#35013;&#37197;&#36825;&#20010;bean&#12290;&#22914;&#26524;&#27809;&#26377;&#25214;&#21040;&#30456;&#21516;&#31867;&#22411;&#30340;&#65292;&#20160;&#20040;&#20063;&#19981;&#20250;&#21457;&#29983;&#12290;&#23646;&#24615;&#19981;&#20250;&#34987;&#35774;&#32622;&#12290;</p></td></tr><tr><td style="border-right: 0.5pt solid ; " align="left" valign="top"><p>constructor</p></td><td style="" align="left" valign="top"><p>&#21644;<span class="emphasis"><em>byType</em></span>&#31867;&#20284;&#65292;&#19981;&#21516;&#20043;&#22788;&#22312;&#20110;&#23427;&#24212;&#29992;&#20110;&#26500;&#36896;&#22120;&#21442;&#25968;&#12290;&#22914;&#26524;&#22312;&#23481;&#22120;&#20013;&#27809;&#26377;&#25214;&#21040;&#19982;&#26500;&#36896;&#22120;&#21442;&#25968;&#31867;&#22411;&#19968;&#33268;&#30340;bean&#65292;&#23601;&#20250;&#25243;&#20986;&#24322;&#24120;&#12290;</p></td></tr></tbody></table>
</div></div><br class="table-break">

<p><span class="emphasis"><em>byType</em></span> &#25110;&#32773; <span class="emphasis"><em>constructor</em></span> &#33258;&#21160;&#35013;&#37197;&#27169;&#24335;&#20063;&#21487;&#20197;&#24212;&#29992;&#20110;&#25968;&#32452;&#21644;&#25351;&#23450;&#31867;&#22411;&#30340;&#38598;&#21512;&#12290;&#22312;&#36825;&#31181;&#24773;&#20917;&#19979;&#23481;&#22120;&#20013;&#30340;&#25152;&#26377;&#21305;&#37197;&#30340;&#33258;&#21160;&#35013;&#37197;&#23545;&#35937;&#23558;
&#34987;&#24212;&#29992;&#20110;&#28385;&#36275;&#21508;&#31181;&#20381;&#36182;&#12290;&#23545;&#20110;key&#20540;&#31867;&#22411;&#20026;String&#30340;&#24378;&#31867;&#22411;Map&#20063;&#21487;&#20197;&#33258;&#21160;&#35013;&#37197;&#12290;&#19968;&#20010;&#33258;&#21160;&#35013;&#37197;&#30340;Map value&#20540;&#23558;&#30001;&#25152;&#21305;&#37197;&#31867;&#22411;&#30340;bean&#25152;&#22635;&#20805;&#12290;</p>
<p>&#20320;&#21487;&#20197;&#32467;&#21512;&#33258;&#21160;&#35013;&#37197;&#21644;&#20381;&#36182;&#26816;&#26597;&#65292;&#21518;&#32773;&#23558;&#20250;&#22312;&#33258;&#21160;&#35013;&#37197;&#23436;&#25104;&#20043;&#21518;&#36827;&#34892;&#12290;</p>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-autowired-exceptions" href="#beans-autowired-exceptions"></a>&#33258;&#21160;&#35013;&#37197;&#30340;&#23616;&#38480;&#24615;&#21644;&#32570;&#28857;</h4></div></div></div>

<p>&#22312;&#24037;&#31243;&#37324;&#19968;&#33268;&#20351;&#29992;&#33258;&#21160;&#35013;&#37197;&#65292;&#36825;&#23558;&#20250;&#24037;&#20316;&#24471;&#24456;&#22909;&#12290;&#22914;&#26524;&#33258;&#21160;&#35013;&#37197;&#24182;&#19981;&#24120;&#20351;&#29992;&#65292;&#21482;&#20351;&#29992;&#22312;&#19968;&#20010;&#25110;&#20004;&#20010;bean&#30340;&#23450;&#20041;&#19978;&#65292;
&#23427;&#21487;&#33021;&#20250;&#23545;&#24320;&#21457;&#32773;&#20135;&#29983;&#22256;&#25200;&#12290;</p>
<p>&#32771;&#34385;&#19968;&#19979;&#33258;&#21160;&#35013;&#37197;&#30340;&#23616;&#38480;&#24615;&#21644;&#32570;&#28857;&#65306;</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<code class="literal">property</code> &#21644; <code class="literal">constructor-arg</code> &#26174;&#24335;&#30340;&#20381;&#36182;&#35774;&#32622;&#24635;&#26159;&#20250;&#35206;&#30422;&#33258;&#21160;&#35013;&#37197;&#12290;&#20320;&#19981;&#33021;&#35013;&#37197;&#25152;&#35859;&#30340;<span class="emphasis"><em>&#31616;&#21333;</em></span>&#23646;&#24615;&#27604;&#22914;&#21407;&#22987;&#30340;<code class="literal">Strings</code>, &#21644; <code class="literal">Classes</code>
&#65288;&#36825;&#26679;&#30340;&#31616;&#21333;&#23646;&#24615;&#25968;&#32452;&#20063;&#26159;&#65289;&#12290;&#36825;&#31181;&#32570;&#38519;&#26159;&#25925;&#24847;&#35774;&#35745;&#30340;&#12290;
</li><li class="listitem">
&#33258;&#21160;&#35013;&#37197;&#27809;&#26377;&#26174;&#31034;&#32534;&#20889;&#31934;&#30830;&#12290;&#34429;&#28982;&#22312;&#19978;&#38754;&#30340;&#34920;&#26684;&#25552;&#21040;&#30340;&#65292;Spring&#24456;&#23567;&#24515;&#24471;&#36991;&#20813;&#29468;&#27979;&#27169;&#31946;&#30340;&#24773;&#20917;&#65292;&#36825;&#21487;&#33021;&#20250;&#23548;&#33268;&#24847;&#24819;&#19981;&#21040;&#30340;&#32467;&#26524;&#12290;
Spring&#31649;&#29702;&#30340;&#23545;&#35937;&#20043;&#38388;&#30340;&#20851;&#31995;&#19981;&#20877;&#35760;&#24405;&#26126;&#30830;&#12290;
</li><li class="listitem">
&#33258;&#21160;&#35013;&#37197;&#30340;&#20381;&#36182;&#20449;&#24687;&#21487;&#33021;&#19981;&#33021;&#29992;&#20110;&#26681;&#25454;Spring&#23481;&#22120;&#29983;&#25104;&#25991;&#26723;&#30340;&#30340;&#24037;&#20855;&#12290;
</li><li class="listitem">
&#22312;&#23481;&#22120;&#20869;&#37096;&#21487;&#33021;&#23384;&#22312;&#22810;&#20010;bean&#30340;&#23450;&#20041;&#19982;&#33258;&#21160;&#35013;&#37197;&#30340;setter&#26041;&#27861;&#25110;&#32773;&#26500;&#36896;&#22120;&#21442;&#25968;&#21305;&#37197;&#12290;&#23545;&#20110;&#25968;&#32452;&#65292;&#38598;&#21512;&#25110;&#32773;Map&#26469;&#35828;&#65292;&#36825;&#19981;&#26159;&#38382;&#39064;&#12290;
&#20294;&#26159;&#23545;&#20110;&#21333;&#20540;&#20381;&#36182;&#26469;&#35828;&#65292;&#23601;&#20250;&#23384;&#22312;&#27169;&#26865;&#20004;&#21487;&#30340;&#38382;&#39064;&#12290;&#22914;&#26524;bean&#23450;&#20041;&#19981;&#21807;&#19968;&#65292;&#35013;&#37197;&#26102;&#23601;&#20250;&#25243;&#20986;&#24322;&#24120;&#12290;
</li></ul></div>

<p>&#38024;&#23545;&#20110;&#19978;&#36848;&#22330;&#26223;&#65292;&#20320;&#20250;&#26377;&#22810;&#20010;&#36873;&#39033;&#65306;</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
&#25918;&#24323;&#33258;&#21160;&#35013;&#37197;&#20197;&#20415;&#20110;&#26126;&#30830;&#20381;&#36182;&#20851;&#31995;&#12290;
</li><li class="listitem">
&#22312;bean&#23450;&#20041;&#20013;&#36890;&#36807;&#35774;&#32622;<code class="literal">autowire-candidate</code>&#23646;&#24615;&#20026;<code class="literal">false</code>&#36991;&#20813;&#35813;bean&#33258;&#21160;&#35013;&#37197;&#65292;&#36825;&#23558;&#20250;&#22312;&#19979;&#19968;&#33410;&#20013;&#35814;&#32454;&#25551;&#36848;&#12290;
</li><li class="listitem">
&#22312;bean&#23450;&#20041;&#20013;&#35774;&#32622;&lt;bean/&gt;<code class="literal">&#20803;&#32032;&#19978;&#30340;`primary</code>&#23646;&#24615;&#20026;<code class="literal">true</code>&#65292;&#23558;&#35813;bean&#35774;&#32622;&#20026;&#39318;&#36873;&#33258;&#21160;&#35013;&#37197;bean&#12290;
</li><li class="listitem">
&#20351;&#29992;&#27880;&#35299;&#37197;&#32622;&#23454;&#29616;&#26356;&#21152;&#32454;&#31890;&#24230;&#30340;&#25511;&#21046;&#65292;&#35814;&#24773;&#35265;<a class="xref" href="beans.html#beans-annotation-config" title="5.9&nbsp;Annotation-based container configuration">Section&nbsp;5.9, &#8220;Annotation-based container configuration&#8221;</a>&#12290;
</li></ul></div>

</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-factory-autowire-candidate" href="#beans-factory-autowire-candidate"></a>&#23558;bean&#25490;&#38500;&#22312;&#33258;&#21160;&#35013;&#37197;&#20043;&#22806;</h4></div></div></div>

<p>&#22312;&#25552;&#21069;&#23454;&#20363;&#21270;bean&#30340;&#22522;&#30784;&#19978;&#65292;&#20320;&#21487;&#20197;&#23558;bean&#25490;&#38500;&#22312;&#33258;&#21160;&#35013;&#37197;&#20043;&#22806;&#12290;&#22312;Spring XML&#26684;&#24335;&#20013;&#65292;&#23558;<code class="literal">&lt;bean/&gt;</code> &#20803;&#32032;&#20013;&#30340;<code class="literal">autowire-candidate</code>&#23646;&#24615;
&#35774;&#32622;&#20026;<code class="literal">false</code>&#12290;&#23481;&#22120;&#20250;&#20351;&#29305;&#23450;&#30340;bean&#23450;&#20041;&#19981;&#21487;&#20110;&#33258;&#21160;&#35013;&#37197;&#65288;&#21253;&#25324;&#27880;&#35299;&#37197;&#32622;&#27604;&#22914;<a class="link" href="beans.html#beans-autowired-annotation" title="5.9.2&nbsp;@Autowired"><code class="literal">@Autowired</code></a>&#65289;</p>
<p>&#20320;&#20063;&#21487;&#20197;&#23545;&#20351;&#29992;bean&#21517;&#23383;&#36827;&#34892;&#27169;&#24335;&#21305;&#37197;&#26469;&#23545;&#33258;&#21160;&#35013;&#37197;&#36827;&#34892;&#38480;&#21046;&#12290;&#39030;&#23618;&#30340;<code class="literal">&lt;beans/&gt;</code> &#20803;&#32032;&#22312;&#23427;&#30340;<code class="literal">default-autowire-candidates</code>&#23646;&#24615;
&#25509;&#21463;&#19968;&#20010;&#25110;&#22810;&#20010;&#27169;&#24335;&#12290;&#35692;&#22914;&#65292;&#20026;&#20102;&#38480;&#21046;</p>
<p>&#23545;&#20110;&#37027;&#20123;&#20174;&#26469;&#23601;&#19981;&#20250;&#34987;&#20854;&#20182;bean&#37319;&#29992;&#33258;&#21160;&#35013;&#37197;&#30340;&#26041;&#24335;&#27880;&#20837;&#30340;bean&#32780;&#35328;&#65292;&#36825;&#26159;&#26377;&#29992;&#30340;&#12290;&#19981;&#36807;&#36825;&#24182;&#19981;&#24847;&#21619;&#36825;&#34987;&#25490;&#38500;&#30340;bean&#33258;&#24049;&#23601;
&#19981;&#33021;&#20351;&#29992;&#33258;&#21160;&#35013;&#37197;&#26469;&#27880;&#20837;&#20854;&#20182;bean&#12290;&#26356;&#30830;&#20999;&#24471;&#35828;&#65292;&#35813;bean&#26412;&#36523;&#19981;&#20250;&#34987;&#32771;&#34385;&#20316;&#20026;&#20854;&#20182;bean&#33258;&#21160;&#35013;&#37197;&#30340;&#20505;&#36873;&#32773;&#12290;</p>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="beans-factory-method-injection" href="#beans-factory-method-injection"></a>5.4.6&nbsp;&#26041;&#27861;&#27880;&#20837;</h3></div></div></div>

<p>&#22312;&#22823;&#37096;&#20998;&#30340;&#24212;&#29992;&#22330;&#26223;&#20013;&#65292;&#23481;&#22120;&#20013;&#30340;&#22823;&#37096;&#20998;bean&#26159;<a class="link" href="beans.html#beans-factory-scopes-singleton" title="5.5.1&nbsp;&#21333;&#20363;&#20316;&#29992;&#22495;">singletons</a>&#31867;&#22411;&#30340;&#12290;&#24403;&#19968;&#20010;&#21333;&#20363;bean&#38656;&#35201;&#21644;&#21478;&#22806;&#19968;&#20010;&#21333;&#20363;bean&#65292;
&#21327;&#20316;&#26102;&#65292;&#25110;&#32773;&#19968;&#20010;&#36153;&#21333;&#20363;bean&#35201;&#24341;&#29992;&#21478;&#22806;&#19968;&#20010;&#38750;&#21333;&#20363;bean&#26102;&#65292;&#36890;&#24120;&#24773;&#20917;&#19979;&#23558;&#19968;&#20010;bean&#23450;&#20041;&#20026;&#21478;&#22806;&#19968;&#20010;bean&#30340;&#23646;&#24615;&#20540;&#23601;&#34892;&#20102;&#12290;&#19981;&#36807;&#23545;&#20110;&#20855;&#26377;&#19981;&#21516;&#29983;&#21629;&#21608;&#26399;&#30340;bean
&#26469;&#35828;&#36825;&#26679;&#20570;&#23601;&#20250;&#26377;&#38382;&#39064;&#20102;&#65292;&#27604;&#22914;&#22312;&#35843;&#29992;&#19968;&#20010;&#21333;&#20363;&#31867;&#22411;bean A&#30340;&#26576;&#20010;&#26041;&#27861;&#65292;&#38656;&#35201;&#24341;&#29992;&#21478;&#19968;&#20010;&#38750;&#21333;&#20363;&#65288;prototype&#65289;&#31867;&#22411;bean B&#65292;&#23545;&#20110;bean A&#26469;&#35828;&#65292;&#23481;&#22120;&#21482;&#20250;&#21019;&#24314;&#19968;&#27425;&#65292;&#36825;&#26679;&#23601;&#27809;&#27861;
&#22312;&#38656;&#35201;&#30340;&#26102;&#20505;&#27599;&#27425;&#35753;&#23481;&#22120;&#20026;bean A&#25552;&#20379;&#19968;&#20010;&#26032;&#30340;bean B&#23454;&#20363;&#12290;</p>
<p>&#19978;&#38754;&#38382;&#39064;&#30340;&#19968;&#20010;&#35299;&#20915;&#26041;&#27861;&#26159;&#25918;&#24323;&#25511;&#21046;&#21453;&#36716;&#65292;&#20320;&#21487;&#20197;&#23454;&#29616;<code class="literal">ApplicationContextAware</code>&#25509;&#21475;&#26469;<a class="link" href="beans.html#beans-factory-aware" title="5.6.2&nbsp;ApplicationContextAware and BeanNameAware">&#35753;bean A&#24863;&#30693;&#21040;&#23481;&#22120;</a>&#65292;
&#24182;&#19988;&#22312;&#38656;&#35201;&#30340;&#26102;&#20505;&#36890;&#36807;&#20351;&#29992;<a class="link" href="beans.html#beans-factory-client" title="5.2.3&nbsp;&#20351;&#29992;&#23481;&#22120;">&#20351;&#29992;getBean("B")&#21521;&#23481;&#22120;&#35831;&#27714;</a>&#19968;&#20010;&#65288;&#26032;&#30340;&#65289;bean B&#23454;&#20363;&#12290;&#19979;&#38754;&#30340;&#20363;&#23376;&#20351;&#29992;&#20102;&#36825;&#20010;&#26041;&#27861;&#65306;</p>
<pre class="programlisting"><span class="hl-comment">// a class that uses a stateful Command-style class to perform some processing</span>
<span class="hl-keyword">package</span> fiona.apple;

<span class="hl-comment">// Spring-API imports</span>
<span class="hl-keyword">import</span> org.springframework.beans.BeansException;
<span class="hl-keyword">import</span> org.springframework.context.ApplicationContext;
<span class="hl-keyword">import</span> org.springframework.context.ApplicationContextAware;

<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> CommandManager <span class="hl-keyword">implements</span> ApplicationContextAware {

    <span class="hl-keyword">private</span> ApplicationContext applicationContext;

    <span class="hl-keyword">public</span> Object process(Map commandState) {
        <span class="hl-comment">// grab a new instance of the appropriate Command</span>
        Command command = createCommand();
        <span class="hl-comment">// set the state on the (hopefully brand new) Command instance</span>
        command.setState(commandState);
        <span class="hl-keyword">return</span> command.execute();
    }

    <span class="hl-keyword">protected</span> Command createCommand() {
        <span class="hl-comment">// notice the Spring API dependency!</span>
        <span class="hl-keyword">return</span> <span class="hl-keyword">this</span>.applicationContext.getBean(<span class="hl-string">"command"</span>, Command.<span class="hl-keyword">class</span>);
    }

    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> setApplicationContext(
            ApplicationContext applicationContext) <span class="hl-keyword">throws</span> BeansException {
        <span class="hl-keyword">this</span>.applicationContext = applicationContext;
    }
}</pre>

<p>&#19978;&#38754;&#30340;&#20363;&#23376;&#24182;&#27809;&#26377;&#36798;&#21040;&#26399;&#26395;&#30340;&#25928;&#26524;&#65292;&#22240;&#20026;&#19994;&#21153;&#20195;&#30721;&#21644;Spring&#26694;&#26550;&#20135;&#29983;&#30340;&#32806;&#21512;&#12290;&#26041;&#27861;&#27880;&#20837;&#65292;&#20316;&#20026;Spring Ioc&#23481;&#22120;&#30340;&#39640;&#32423;&#29305;&#24615;&#65292;&#21487;&#20197;&#20197;&#19968;&#31181;
&#24178;&#20928;&#30340;&#26041;&#27861;&#26469;&#22788;&#29702;&#36825;&#31181;&#24773;&#20917;&#12290;</p>
<div class="sidebar"><div class="titlepage"></div>
<p>&#20320;&#21487;&#20197;&#22312; <a class="ulink" href="https://spring.io/blog/2004/08/06/method-injection/" target="_top">this blog entry</a> &#38405;&#35835;&#26356;&#22810;&#20851;&#20110;&#26041;&#27861;&#27880;&#20837;&#30340;&#21160;&#26426;&#12290;</p>
</div>

<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-factory-lookup-method-injection" href="#beans-factory-lookup-method-injection"></a>Lookup &#26041;&#27861;&#27880;&#20837;</h4></div></div></div>

<p>Lookup&#26041;&#27861;&#20855;&#26377;&#20351;&#23481;&#22120;&#35206;&#30422;<span class="emphasis"><em>&#21463;&#23481;&#22120;&#31649;&#29702;&#30340;</em></span>bean&#26041;&#27861;&#30340;&#33021;&#21147;&#65292;&#20174;&#32780;&#36820;&#22238;&#25351;&#23450;&#21517;&#23383;&#30340;bean&#23454;&#20363;&#12290;&#22312;&#19978;&#36848;&#22330;&#26223;&#20013;&#65292;Lookup&#26041;&#27861;&#27880;&#20837;&#36866;&#29992;&#20110;&#21407;&#22411;bean&#12290;
Lookup&#26041;&#27861;&#27880;&#20837;&#30340;&#20869;&#37096;&#26426;&#21046;&#26159;Spring&#21033;&#29992;&#20102;CGLIB&#24211;&#22312;&#36816;&#34892;&#26102;&#29983;&#25104;&#20108;&#36827;&#21046;&#20195;&#30721;&#30340;&#21151;&#33021;&#65292;&#36890;&#36807;&#21160;&#24577;&#21019;&#24314;Lookup&#26041;&#27861;bean&#30340;&#23376;&#31867;&#20174;&#32780;&#36798;&#21040;&#22797;&#20889;Lookup&#26041;&#27861;&#30340;&#30446;&#30340;&#12290;</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p>&#20026;&#20102;&#20351;&#21160;&#24577;&#23376;&#31867;&#36215;&#20316;&#29992;&#65292;Spring&#23481;&#22120;&#35201;&#23376;&#31867;&#21270;&#30340;&#31867;&#19981;&#33021;&#26159;<code class="literal">final</code>&#65292;&#24182;&#19988;&#38656;&#35201;&#22797;&#20889;&#30340;&#26041;&#27861;&#20063;&#19981;&#33021;&#26159;<code class="literal">final</code>&#12290;&#21516;&#26679;&#30340;&#65292;&#35201;&#27979;&#35797;&#19968;&#20010;&#21253;&#21547;
<code class="literal">&#25277;&#35937;</code>&#26041;&#27861;&#30340;&#31867;&#20063;&#31245;&#24494;&#26377;&#20123;&#19981;&#21516;&#65292;&#20320;&#38656;&#35201;&#23376;&#38598;&#32534;&#20889;&#23427;&#30340;&#23376;&#31867;&#25552;&#20379;&#35813;<code class="literal">&#25277;&#35937;</code>&#26041;&#27861;&#30340;&#23454;&#29616;&#12290;&#26368;&#21518;&#65292;&#20316;&#20026;&#26041;&#27861;&#27880;&#20837;&#30446;&#26631;&#30340;bean&#19981;&#33021;&#26159;&#24207;&#21015;&#21270;&#30340;&#12290;
&#22312;Spring 3.2&#20043;&#21518;&#20877;&#20063;&#27809;&#24517;&#35201;&#28155;&#21152;CGLIB&#21040;classpath&#65292;&#22240;&#20026;CGLIB&#30340;&#31867;&#25171;&#21253;&#22312;&#20102;org.springframework&#19979;&#24182;&#19988;&#22312;Spring&#26680;&#24515;JAR&#20013;&#26377;&#25152;&#25551;&#36848;&#12290;
&#36825;&#26679;&#20570;&#26082;&#26041;&#20415;&#65292;&#21448;&#36991;&#20813;&#20102;&#19982;&#20854;&#20182;&#20351;&#29992;&#20102;&#19981;&#21516;&#29256;&#26412;CGLIB&#30340;&#39033;&#30446;&#30340;&#20914;&#31361;&#12290;</p>
</td></tr></table></div>

<p>&#20877;&#30475;&#19968;&#19979;&#22312;&#20043;&#21069;&#20195;&#30721;&#29255;&#27573;&#20013;&#30340;<code class="literal">CommandManager</code>&#31867;&#65292;&#20320;&#21487;&#20197;&#21457;&#29616;Spring&#23481;&#22120;&#20250;&#33258;&#21160;&#22797;&#20889;<code class="literal">createCommand()</code>&#26041;&#27861;&#30340;&#23454;&#29616;&#12290;<code class="literal">CommandManager</code>&#31867;
&#23558;&#19981;&#20250;&#26377;&#20219;&#20309;&#30340;Spring&#20381;&#36182;&#65292;&#19979;&#38754;&#36820;&#24037;&#30340;&#20363;&#23376;&#21487;&#20197;&#30475;&#20986;&#65306;</p>
<pre class="programlisting"><span class="hl-keyword">package</span> fiona.apple;

<span class="hl-comment">// no more Spring imports!</span>

<span class="hl-keyword">public</span> <span class="hl-keyword">abstract</span> <span class="hl-keyword">class</span> CommandManager {

    <span class="hl-keyword">public</span> Object process(Object commandState) {
        <span class="hl-comment">// grab a new instance of the appropriate Command interface</span>
        Command command = createCommand();
        <span class="hl-comment">// set the state on the (hopefully brand new) Command instance</span>
        command.setState(commandState);
        <span class="hl-keyword">return</span> command.execute();
    }

    <span class="hl-comment">// okay... but where is the implementation of this method?</span>
    <span class="hl-keyword">protected</span> <span class="hl-keyword">abstract</span> Command createCommand();
}</pre>

<p>&#22312;&#21253;&#21547;&#34987;&#27880;&#20837;&#26041;&#27861;&#30340;&#23458;&#25143;&#31867;&#20013;&#65288;&#36825;&#20010;&#20363;&#23376;&#20013;&#26159;<code class="literal">CommandManager</code>&#65289;&#65292;&#27492;&#26041;&#27861;&#30340;&#23450;&#20041;&#38656;&#35201;&#25353;&#20197;&#19979;&#24418;&#24335;&#36827;&#34892;&#65306;</p>
<pre class="programlisting"><span class="hl-tag">&lt;public|protected&gt;</span> [abstract] <span class="hl-tag">&lt;return-type&gt;</span> theMethodName(no-arguments);</pre>

<p>&#22914;&#26524;&#26041;&#27861;&#26159;<code class="literal">&#25277;&#35937;</code>&#65292;&#21160;&#24577;&#29983;&#25104;&#30340;&#23376;&#31867;&#20250;&#23454;&#29616;&#35813;&#26041;&#27861;&#12290;&#27807;&#21017;&#65292;&#21160;&#24577;&#29983;&#25104;&#30340;&#23376;&#31867;&#20250;&#35206;&#30422;&#31867;&#37324;&#30340;&#20855;&#20307;&#26041;&#27861;&#12290;&#35692;&#22914;&#65306;</p>
<pre class="programlisting"><span class="hl-comment">&lt;!-- a stateful bean deployed as a prototype (non-singleton) --&gt;</span>
<span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"command"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"fiona.apple.AsyncCommand"</span> <span class="hl-attribute">scope</span>=<span class="hl-value">"prototype"</span><span class="hl-tag">&gt;</span>
    <span class="hl-comment">&lt;!-- inject dependencies here as required --&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span>

<span class="hl-comment">&lt;!-- commandProcessor uses statefulCommandHelper --&gt;</span>
<span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"commandManager"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"fiona.apple.CommandManager"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;lookup-method</span> <span class="hl-attribute">name</span>=<span class="hl-value">"createCommand"</span> <span class="hl-attribute">bean</span>=<span class="hl-value">"command"</span><span class="hl-tag">/&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span></pre>

<p>&#26631;&#35782;&#20026;<span class="emphasis"><em>commandManager</em></span>&#30340;bean&#22312;&#38656;&#35201;&#19968;&#20010;&#26032;&#30340;<span class="emphasis"><em>command</em></span> bean&#23454;&#20363;&#26102;&#20250;&#35843;&#29992;<code class="literal">createCommand()</code>&#26041;&#27861;&#12290;&#20320;&#24517;&#39035;&#23558;`command`bean&#37096;&#32626;&#20026;
&#21407;&#22411;&#65288;prototype&#65289;&#31867;&#22411;&#65292;&#22914;&#26524;&#36825;&#26159;&#23454;&#38469;&#38656;&#35201;&#30340;&#35805;&#12290;&#22914;&#26524;&#37096;&#32626;&#20026;<a class="link" href="beans.html#beans-factory-scopes-singleton" title="5.5.1&nbsp;&#21333;&#20363;&#20316;&#29992;&#22495;">singleton</a>&#12290;&#37027;&#20040;&#27599;&#27425;&#23558;&#36820;&#22238;&#30456;&#21516;&#30340;
`command`bean&#12290;</p>
<div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="images/tip.png"></td><th align="left">Tip</th></tr><tr><td align="left" valign="top">
<p>&#24863;&#20852;&#36259;&#30340;&#35835;&#32773;&#20063;&#35768;&#21457;&#29616;&#20102;<code class="literal">ServiceLocatorFactoryBean</code>&#65288;&#22312;&#21253;<code class="literal">org.springframework.beans.factory.config</code>&#19979;&#65289;&#21487;&#20197;&#20351;&#29992;&#12290;ServiceLocatorFactoryBean&#30340;&#29992;&#27861;
&#19982;&#21478;&#19968;&#20010;&#23454;&#29992;&#31867;<code class="literal">ObjectFactoryCreatingFactoryBean</code>&#31867;&#20284;&#65292;&#20294;&#26159;&#23427;&#20801;&#35768;&#20320;&#25351;&#23450;&#23376;&#38598;&#30340;lookup&#25509;&#21475;&#65292;&#19981;&#19968;&#23450;&#38750;&#35201;&#29992;Spring&#30340;lookup&#25509;&#21475;&#12290;&#35201;&#35814;&#32454;&#20102;&#35299;&#36825;&#31181;&#26041;&#27861;&#21442;&#32771;
&#36825;&#20123;&#31867;&#30340;javadoc&#12290;</p>
</td></tr></table></div>

</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-factory-arbitrary-method-replacement" href="#beans-factory-arbitrary-method-replacement"></a>&#33258;&#23450;&#20041;&#26041;&#27861;&#30340;&#26367;&#20195;&#26041;&#26696;</h4></div></div></div>

<p>&#27604;&#36215;Lookup&#26041;&#27861;&#27880;&#20837;&#26469;&#65292;&#36824;&#26377;&#19968;&#31181;&#36739;&#23569;&#29992;&#21040;&#30340;&#26041;&#27861;&#27880;&#20837;&#24418;&#24335;&#65292;&#35813;&#27880;&#20837;&#33021;&#20351;&#29992;bean&#30340;&#21478;&#19968;&#20010;&#26041;&#27861;&#23454;&#29616;&#21435;&#26367;&#25442;&#33258;&#23450;&#20041;&#26041;&#27861;&#30340;&#26041;&#27861;&#12290;
&#38500;&#38750;&#20320;&#30495;&#30340;&#38656;&#35201;&#35813;&#21151;&#33021;&#65292;&#21542;&#21017;&#21487;&#20197;&#30053;&#36807;&#26412;&#33410;&#12290;</p>
<p>&#20351;&#29992;&#22522;&#20110;XML&#37197;&#32622;&#25991;&#20214;&#26102;&#65292;&#20320;&#21487;&#20197;&#20351;&#29992;<code class="literal">replaced-method</code>&#20803;&#32032;&#26469;&#36798;&#21040;&#29992;&#21478;&#19968;&#20010;&#26041;&#27861;&#26469;&#21462;&#20195;&#24050;&#26377;&#26041;&#27861;&#30340;&#30446;&#30340;&#12290;&#32771;&#34385;&#19979;&#38754;&#30340;&#31867;&#65292;&#25105;&#20204;&#23558;&#35206;&#30422;
computeValue&#26041;&#27861;&#12290;</p>
<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> MyValueCalculator {

    <span class="hl-keyword">public</span> String computeValue(String input) {
        <span class="hl-comment">// some real code...</span>
    }

    <span class="hl-comment">// some other methods...</span>

}</pre>

<p>&#23454;&#29616;<code class="literal">org.springframework.beans.factory.support.MethodReplacer</code>&#25509;&#21475;&#30340;&#31867;&#25552;&#20379;&#20102;&#26032;&#30340;&#26041;&#27861;&#23450;&#20041;&#12290;</p>
<pre class="programlisting"><strong class="hl-tag" style="color: blue">/**
 * meant to be used to override the existing computeValue(String)
 * implementation in MyValueCalculator
 */</strong>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> ReplacementComputeValue <span class="hl-keyword">implements</span> MethodReplacer {

    <span class="hl-keyword">public</span> Object reimplement(Object o, Method m, Object[] args) <span class="hl-keyword">throws</span> Throwable {
        <span class="hl-comment">// get the input value, work with it, and return a computed result</span>
        String input = (String) args[<span class="hl-number">0</span>];
        ...
        <span class="hl-keyword">return</span> ...;
    }
}</pre>

<p>&#19979;&#38754;&#30340;bean&#23450;&#20041;&#20013;&#25351;&#23450;&#20102;&#35201;&#37197;&#32622;&#30340;&#21407;&#22987;&#31867;&#21644;&#23558;&#35201;&#22797;&#20889;&#30340;&#26041;&#27861;&#65306;</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"myValueCalculator"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"x.y.z.MyValueCalculator"</span><span class="hl-tag">&gt;</span>
    <span class="hl-comment">&lt;!-- arbitrary method replacement --&gt;</span>
    <span class="hl-tag">&lt;replaced-method</span> <span class="hl-attribute">name</span>=<span class="hl-value">"computeValue"</span> <span class="hl-attribute">replacer</span>=<span class="hl-value">"replacementComputeValue"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;arg-type&gt;</span>String<span class="hl-tag">&lt;/arg-type&gt;</span>
    <span class="hl-tag">&lt;/replaced-method&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span>

<span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"replacementComputeValue"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"a.b.c.ReplacementComputeValue"</span><span class="hl-tag">/&gt;</span></pre>

<p>&#20320;&#21487;&#20197;&#22312;<code class="literal">&lt;replaced-method/&gt;</code>&#20803;&#32032;&#20013;&#21487;&#20197;&#21253;&#21547;&#22810;&#20010;<code class="literal">&lt;arg-type/&gt;</code>&#20803;&#32032;&#65292;&#36825;&#20123;&#20803;&#32032;&#29992;&#26469;&#26631;&#26126;&#34987;&#22797;&#20889;&#30340;&#26041;&#27861;&#31614;&#21517;&#12290;&#21482;&#26377;&#34987;&#22797;&#20889;&#30340;&#26041;&#27861;
&#23384;&#22312;&#37325;&#36733;&#30340;&#24773;&#20917;&#21644;&#21516;&#21517;&#30340;&#22810;&#20010;&#26041;&#27861;&#21464;&#20307;&#12290;&#20026;&#20102;&#26041;&#20415;&#65292;&#21442;&#25968;&#30340;&#31867;&#22411;&#23383;&#31526;&#21487;&#20197;&#37319;&#29992;&#20840;&#38480;&#23450;&#31867;&#21517;&#30340;&#31616;&#20889;&#12290;&#20363;&#22914;&#65292;&#19979;&#38754;&#30340;&#23383;&#31526;&#20018;&#37117;&#26631;&#35782;&#21442;&#25968;&#31867;&#22411;
&#20026;<code class="literal">java.lang.String</code>&#65306;</p>
<pre class="programlisting">java.lang.String
String
Str</pre>

<p>&#22240;&#20026;&#21442;&#25968;&#30340;&#25968;&#30446;&#36890;&#24120;&#36275;&#22815;&#29992;&#26469;&#21306;&#21035;&#27599;&#20010;&#21487;&#33021;&#30340;&#36873;&#25321;&#65292;&#36825;&#20010;&#32467;&#26230;&#33021;&#20943;&#23569;&#24456;&#22810;&#38190;&#30424;&#36755;&#20837;&#30340;&#24037;&#20316;&#65292;&#23427;&#20801;&#35768;&#20320;&#21482;&#36755;&#20837;&#26368;&#30701;&#30340;&#21305;&#37197;&#21442;&#25968;&#31867;&#22411;&#30340;&#23383;&#31526;&#20018;&#12290;</p>
</div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="beans-factory-scopes" href="#beans-factory-scopes"></a>5.5&nbsp;Bean&#20316;&#29992;&#22495;</h2></div></div></div>

<p>&#24403;&#20320;&#21019;&#24314;&#19968;&#20010; bean &#30340;&#23450;&#20041;&#65292;&#23454;&#38469;&#19978;&#26159;&#21019;&#24314;&#20102;&#19968;&#20010;&#20135;&#29983;&#30495;&#23454;&#23454;&#20363;&#30340;<span class="emphasis"><em>&#37197;&#26041;(recipe)</em></span>&#12290;bean &#23450;&#20041;&#26159;&#19968;&#20010;&#37197;&#26041;(recipe)&#36825;&#31181;&#27010;&#24565;&#26159;&#24456;&#37325;&#35201;&#30340;&#65292;&#23427;&#30340;&#24847;&#24605;&#26159;&#25351;&#65292;&#21644;class&#19968;&#26679;&#65292;&#20320;&#21487;&#20197;&#20174;&#19968;&#20010;&#37197;&#26041;(recipe)&#21019;&#24314;&#22810;&#20010;&#23545;&#35937;&#23454;&#20363;&#12290;</p>
<p>You can control not only the various dependencies and configuration values that are to
be plugged into an object that is created from a particular bean definition, but also
the <span class="emphasis"><em>scope</em></span> of the objects created from a particular bean definition. This approach is
powerful and flexible in that you can <span class="emphasis"><em>choose</em></span> the scope of the objects you create
through configuration instead of having to bake in the scope of an object at the Java
class level. Beans can be defined to be deployed in one of a number of scopes: out of
the box, the Spring Framework supports five scopes, three of which are available only if
you use a web-aware <code class="literal">ApplicationContext</code>.</p>
<p>&#20320;&#19981;&#20165;&#21487;&#20197;&#25511;&#21046;&#34987;&#25554;&#20837;&#21040;&#19968;&#20010;&#20174;&#29305;&#23450; bean &#23450;&#20041;&#21019;&#24314;&#30340;&#23545;&#35937;&#30340;&#21508;&#31181;&#20381;&#36182;&#21644;&#37197;&#32622;&#20540;&#65292;&#36824;&#21487;&#20197;&#25511;&#21046;&#20174;&#36825;&#20010;&#29305;&#23450; bean &#23450;&#20041;&#21019;&#24314;&#30340;&#23545;&#35937;&#30340;<span class="emphasis"><em>&#20316;&#29992;&#22495;(scope)</em></span>&#12290;&#36825;&#31181;&#26041;&#27861;&#26159;&#24378;&#22823;&#32780;&#28789;&#27963;&#30340;&#65292;&#20320;&#21487;&#20197;<span class="emphasis"><em>&#36873;&#25321;(choose)</em></span>&#36890;&#36807;&#37197;&#32622;&#21019;&#24314;&#30340;&#23545;&#35937;&#20316;&#29992;&#22495;&#32780;&#19981;&#24517;&#22312; Java class level &#30340;&#20316;&#29992;&#22495;(scope)&#39044;&#28909;&#12290;Bean &#21487;&#20197;&#34987;&#22810;&#31181;&#20316;&#29992;&#22495;&#20043;&#19968;&#23450;&#20041;&#65306;Spring &#26694;&#26550;&#25903;&#25345;&#20116;&#31181;&#24320;&#31665;&#21363;&#29992;&#30340;&#20316;&#29992;&#22495;&#65292;&#20854;&#20013;&#19977;&#31181;&#20165;&#22312;&#22522;&#20110; web &#30340; <code class="literal">ApplicationContext</code> &#20013;&#20351;&#29992;&#12290;</p>
<p>&#19979;&#38754;&#30340;&#20316;&#29992;&#22495;&#26159;&#24320;&#31665;&#21363;&#29992;&#30340;&#12290;&#21516;&#26102;&#20320;&#20063;&#21487;&#20197;&#21019;&#24314;
<a class="link" href="beans.html#beans-factory-scopes-custom" title="5.5.5&nbsp;Custom scopes">&#33258;&#23450;&#20041;&#20316;&#29992;&#22495;.</a></p>
<div class="table"><a name="beans-factory-scopes-tbl" href="#beans-factory-scopes-tbl"></a><p class="title"><b>Table&nbsp;5.3.&nbsp;Bean&#20316;&#29992;&#22495;</b></p><div class="table-contents">

  <table summary="Bean&#20316;&#29992;&#22495;" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="col_1"><col class="col_2"></colgroup><thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&#20316;&#29992;&#22495;</th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top">&#25551;&#36848;</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><a class="link" href="beans.html#beans-factory-scopes-singleton" title="5.5.1&nbsp;&#21333;&#20363;&#20316;&#29992;&#22495;">singleton</a></p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>(&#40664;&#35748;&#30340;) &#27599;&#20010; String IoC &#23481;&#22120;&#20316;&#29992;&#22495;&#20013;&#19968;&#20010; bean &#23450;&#20041;&#21482;&#23545;&#24212;&#19968;&#20010;&#23545;&#35937;&#23454;&#20363;&#12290;</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><a class="link" href="beans.html#beans-factory-scopes-prototype" title="5.5.2&nbsp;&#21407;&#22411;&#20316;&#29992;&#22495;">prototype</a></p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>&#19968;&#20010; bean &#23450;&#20041;&#23545;&#24212;&#22810;&#20010;&#23545;&#35937;&#23454;&#20363;&#12290;</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><a class="link" href="beans.html#beans-factory-scopes-request" title="&#35831;&#27714;&#20316;&#29992;&#22495;">request</a></p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>&#19968;&#20010; bean &#23450;&#20041;&#20316;&#29992;&#20110; HTTP <code class="literal">request</code> &#29983;&#21629;&#21608;&#26399;&#65307;&#26159;&#25351;&#27599;&#20010; HTTP request &#25317;&#26377;&#33258;&#24049;&#30340;&#36890;&#36807;&#19968;&#20010; bean &#23450;&#20041;&#21019;&#24314;&#30340;&#23454;&#20363;&#12290;&#20165;&#22312;&#22522;&#20110; web &#30340; Spring <code class="literal">ApplicationContext</code> &#20013;&#26377;&#25928;&#12290;</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><a class="link" href="beans.html#beans-factory-scopes-session" title="&#20250;&#35805;&#20316;&#29992;&#22495;">session</a></p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>&#19968;&#20010; bean &#23450;&#20041;&#20316;&#29992;&#20110; HTTP <code class="literal">session</code> &#29983;&#21629;&#21608;&#26399;&#12290;&#20165;&#22312;&#22522;&#20110; web &#30340; Spring <code class="literal">ApplicationContext</code> &#20013;&#26377;&#25928;&#12290;</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><a class="link" href="beans.html#beans-factory-scopes-global-session" title="&#20840;&#23616;&#20250;&#35805;&#20316;&#29992;&#22495;">global session</a></p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>&#19968;&#20010; bean &#23450;&#20041;&#20316;&#29992;&#20110;&#20840;&#23616;&#30340; HTTP <code class="literal">session</code> &#29983;&#21629;&#21608;&#26399;&#12290;&#20165;&#22312; portlet context &#20013;&#20351;&#29992;&#25165;&#26377;&#25928;&#12290;&#20165;&#22312;&#22522;&#20110; web &#30340; Spring <code class="literal">ApplicationContext</code> &#20013;&#26377;&#25928;&#12290;</p></td></tr><tr><td style="border-right: 0.5pt solid ; " align="left" valign="top"><p><a class="link" href="beans.html#beans-factory-scopes-application" title="&#24212;&#29992;&#31243;&#24207;&#20316;&#29992;&#22495;">application</a></p></td><td style="" align="left" valign="top"><p>&#19968;&#20010; bean &#23450;&#20041;&#20316;&#29992;&#20110;&#25972;&#20010; <code class="literal">ServletContext</code> &#29983;&#21629;&#21608;&#26399;&#12290;&#20165;&#22312;&#22522;&#20110; web &#30340; Spring <code class="literal">ApplicationContext</code> &#20013;&#26377;&#25928;&#12290;</p></td></tr></tbody></table>
</div></div><br class="table-break">

<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p>&#20174; Spring 3.0 &#24320;&#22987;&#65292;&#26032;&#22686;&#20102;&#19968;&#20010;<span class="emphasis"><em>thread scope</em></span>&#65292;&#20294;&#26159;&#40664;&#35748;&#26159;&#19981;&#34987;&#27880;&#20876;&#30340;&#12290;&#35201;&#33719;&#21462;&#26356;&#22810;&#30456;&#20851;&#20449;&#24687;&#65292;&#35831;&#30475;&#25991;&#26723;
<a class="ulink" href="http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/context/support/SimpleThreadScope.html" target="_top"><code class="literal">SimpleThreadScope</code></a>&#12290;
&#35201;&#20102;&#35299;&#20851;&#20110;&#22914;&#20309;&#27880;&#20876;&#36825;&#20010;&#20316;&#29992;&#22495;&#25110;&#32773;&#20854;&#23427;&#33258;&#23450;&#20041;&#30340;&#20316;&#29992;&#22495;&#65292;&#35831;&#30475;
<a class="link" href="beans.html#beans-factory-scopes-custom-using" title="Using a custom scope">&#33258;&#23450;&#20041; bean &#20316;&#29992;&#22495;</a>.</p>
</td></tr></table></div>

<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="beans-factory-scopes-singleton" href="#beans-factory-scopes-singleton"></a>5.5.1&nbsp;&#21333;&#20363;&#20316;&#29992;&#22495;</h3></div></div></div>

<p>&#20165;&#31649;&#29702;&#19968;&#20010;&#21333;&#20363; bean &#30340;&#20849;&#20139;&#23454;&#20363;&#65292;&#24182;&#19988;&#25152;&#26377;&#36890;&#36807; id &#25110;&#32773; ids &#33719;&#24471; bean &#23450;&#20041;&#30340;&#35831;&#27714;&#65292;&#37117;&#20250;&#20174; Spring &#23481;&#22120;&#20013;&#24471;&#21040;&#21516;&#19968;&#20010;&#29305;&#23450;&#30340; bean &#23454;&#20363;&#12290;</p>
<p>&#25442;&#21477;&#35805;&#35828;&#65292;&#24403;&#20320;&#23450;&#20041;&#19968;&#20010; bean &#23450;&#20041;&#65292;&#24182;&#19988;&#23427;&#30340;&#20316;&#29992;&#22495;&#20026;&#21333;&#20363;&#30340;&#65292;Spring IoC &#23481;&#22120;&#23601;&#20250;<span class="emphasis"><em>&#31934;&#30830;&#22320;(exactly)</em></span>&#21019;&#24314;<span class="emphasis"><em>&#19968;&#20010;(one)</em></span>&#23545;&#35937;&#23454;&#20363;&#12290;&#36825;&#20010;&#23454;&#20363;&#34987;&#23384;&#20648;&#22312;&#19968;&#20010;&#21253;&#21547;&#24456;&#22810;&#21333;&#20363; bean &#30340;&#32531;&#23384;&#20013;&#12290;&#24182;&#19988;<span class="emphasis"><em>&#25152;&#26377;&#30340;&#21518;&#26469;&#30340;&#35831;&#27714;&#21644;&#24341;&#29992;(all subsequent requests and references)</em></span>&#37117;&#20250;&#36820;&#22238;&#32531;&#23384;&#30340;&#23545;&#35937;&#12290;</p>
<div class="figure"><a name="d5e1965" href="#d5e1965"></a><p class="title"><b>Figure&nbsp;5.2.&nbsp;</b></p><div class="figure-contents">
  <div class="mediaobject"><img src="images/singleton.png" alt="singleton"></div>
</div></div><br class="figure-break">

<p>Spring &#20013;&#21333;&#20363; bean &#30340;&#27010;&#24565;&#19982;&#22235;&#20154;&#24110;(GoF)&#35774;&#35745;&#27169;&#24335;&#19968;&#20070;&#20013;&#30340;&#23450;&#20041;&#26159;&#19981;&#21516;&#30340;&#12290;GoF &#20013;&#30340;&#21333;&#20363;&#26159;&#30828;&#32534;&#30721;&#26041;&#24335;&#30340;&#23545;&#35937;&#30340;&#20316;&#29992;&#22495;&#20197;&#33267;&#20110;&#27599;&#20010;&#29305;&#23450;&#30340;&#31867;&#22312;<span class="emphasis"><em>&#27599;&#20010;&#31867;&#21152;&#36733;&#22120;(per ClassLoader)</em></span>&#20013;&#26377;<span class="emphasis"><em>&#19988;&#20165;&#26377;&#19968;&#20010;(and only one)</em></span>&#23454;&#20363;&#12290;Spring &#21333;&#20363;&#20316;&#29992;&#22495;&#26356;&#22909;&#30340;&#25551;&#36848;&#20102;<span class="emphasis"><em>&#27599;&#20010;&#23481;&#22120;&#21644;&#27599;&#20010; bean(per container and per bean)</em></span>&#12290;&#23427;&#30340;&#24847;&#24605;&#26159;&#35828;&#65292;&#22914;&#26524;&#20320;&#22312;&#19968;&#20010; Spring &#23481;&#22120;&#20013;&#23450;&#20041;&#20102;&#19968;&#20010;&#29305;&#23450;&#31867;&#30340; bean&#65292;&#28982;&#21518;&#36825;&#20010; Spring &#23481;&#22120;&#23601;&#20250;&#21019;&#24314;&#19968;&#20010;<span class="emphasis"><em>&#19988;&#20165;&#20165;&#19968;&#20010;(and only one)<span class="emphasis"><em>&#36890;&#36807;&#25351;&#23450; bean &#23450;&#20041;&#30340;&#23454;&#20363;&#12290;</em></span>&#21333;&#20363;&#20316;&#29992;&#22495;&#22312; Spring &#20013;&#26159;&#40664;&#35748;&#30340;&#20316;&#29992;&#22495;(The singleton scope is the default scope in Spring)_</em></span>&#12290;&#22312; XML &#20013;&#23450;&#20041;&#19968;&#20010;&#21333;&#20363;&#30340; bean&#65292;&#20320;&#38656;&#35201;&#20889;&#22914;&#19979;&#30340;&#37197;&#32622;&#65292;&#20363;&#22914;&#65306;</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"accountService"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"com.foo.DefaultAccountService"</span><span class="hl-tag">/&gt;</span>

<span class="hl-comment">&lt;!-- &#36890;&#36807;&#26174;&#31034;&#30340;&#20887;&#20313;&#37197;&#32622;&#26159;&#31561;&#20215;&#30340; (&#21333;&#20363;&#20316;&#29992;&#22495;&#26159;&#40664;&#35748;&#30340;) --&gt;</span>
<span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"accountService"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"com.foo.DefaultAccountService"</span> <span class="hl-attribute">scope</span>=<span class="hl-value">"singleton"</span><span class="hl-tag">/&gt;</span></pre>

</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="beans-factory-scopes-prototype" href="#beans-factory-scopes-prototype"></a>5.5.2&nbsp;&#21407;&#22411;&#20316;&#29992;&#22495;</h3></div></div></div>

<p>bean&#20351;&#29992;&#21407;&#22411;&#20316;&#29992;&#22495;&#32780;&#19981;&#26159;&#21333;&#20363;&#20316;&#29992;&#22495;&#30340;&#35805;&#65292;&#20250;&#22312;&#27599;&#27425;&#35831;&#27714;&#35813;bean&#65292;&#20063;&#23601;&#26159;bean&#34987;&#27880;&#20837;&#33267;&#21478;&#19968;&#20010;bean&#12289;
&#25110;&#36890;&#36807;&#35843;&#29992;Spring&#23481;&#22120;&#30340; <code class="literal">getBean()</code> &#26041;&#27861;&#26102;&#65292;<span class="emphasis"><em>&#21019;&#24314;&#19968;&#20010;&#26032;&#30340;bean&#23454;&#20363;</em></span> &#12290;
&#36890;&#24120;&#65292;&#23545;&#20110;&#26377;&#29366;&#24577;&#30340;bean&#20351;&#29992;&#21407;&#22411;&#20316;&#29992;&#22495;&#65292;&#26080;&#29366;&#24577;&#30340;bean&#21017;&#20351;&#29992;&#21333;&#20363;&#20316;&#29992;&#22495;&#12290;</p>
<p>&#19979;&#22270;&#23637;&#31034;&#20102;Spring&#30340;&#21407;&#22411;&#20316;&#29992;&#22495;&#12290;<span class="emphasis"><em>&#19968;&#33324;&#26469;&#35828;&#65292;&#25968;&#25454;&#35775;&#38382;&#23545;&#35937;&#65288;data access object, DAO &#65289;&#19981;&#20250;&#20445;&#23384;&#20219;&#20309;&#20250;&#35805;&#29366;&#24577;&#65292;
&#22240;&#27492;&#26159;&#26080;&#29366;&#24577;&#30340;&#65292;&#19981;&#35813;&#34987;&#37197;&#32622;&#20026;&#21407;&#22411;&#20316;&#29992;&#22495;&#12290;&#20316;&#32773;&#20043;&#25152;&#20197;&#22312;&#19979;&#22270;&#20351;&#29992;DAO&#65292;&#21482;&#26159;&#20026;&#20102;&#33021;&#37325;&#29992;&#19978;&#38754;&#21333;&#20363;&#30340;&#37027;&#24352;&#22270;&#65292;&#33410;&#32422;&#24037;&#20316;&#37327;&#12290;</em></span></p>
<div class="figure"><a name="d5e1985" href="#d5e1985"></a><p class="title"><b>Figure&nbsp;5.3.&nbsp;</b></p><div class="figure-contents">
  <div class="mediaobject"><img src="images/prototype.png" alt="prototype"></div>
</div></div><br class="figure-break">

<p>&#36825;&#27573;&#26679;&#20363;&#20195;&#30721;&#23637;&#31034;&#20102;&#22914;&#20309;&#22312;xml&#37197;&#32622;&#25991;&#20214;&#20013;&#23450;&#20041;&#19968;&#20010;&#21407;&#22411;&#20316;&#29992;&#22495;&#30340;bean&#65306;</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"accountService"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"com.foo.DefaultAccountService"</span> <span class="hl-attribute">scope</span>=<span class="hl-value">"prototype"</span><span class="hl-tag">/&gt;</span></pre>

<p>&#19982;&#20854;&#20182;&#20316;&#29992;&#22495;&#19981;&#21516;&#30340;&#26159;&#65292;Spring&#23481;&#22120;&#19981;&#20250;&#31649;&#29702;&#21407;&#22411;&#22495;bean&#30340;&#23436;&#25972;&#29983;&#21629;&#21608;&#26399;&#65306;Spring&#23481;&#22120;&#20250;&#21021;&#22987;&#21270;&#12289;
&#37197;&#32622;&#65292;&#20134;&#25110;&#32773;&#32452;&#35013;&#21407;&#22411;&#22495;&#30340;bean&#23545;&#35937;&#65292;&#28982;&#21518;&#20132;&#32473;&#23458;&#25143;&#31471;&#65292;&#20043;&#21518;&#23601;&#20877;&#20063;&#19981;&#20250;&#31649;&#36825;&#20010;bean&#23545;&#35937;&#20102;&#12290;
&#22240;&#27492;&#65292;&#23545;&#20110;bean&#30340;&#29983;&#21629;&#21608;&#26399;&#26041;&#27861;&#26469;&#35828;&#65292;&#23613;&#31649;&#25152;&#26377;&#20316;&#29992;&#22495;&#30340; <span class="emphasis"><em>&#21021;&#22987;&#21270;&#26041;&#27861;</em></span> &#37117;&#20250;&#34987;&#35843;&#29992;&#65292;
&#20294;&#26159;&#21407;&#22411;&#22495;bean&#30340; <span class="emphasis"><em>&#38144;&#27585;&#26041;&#27861;</em></span> <span class="emphasis"><em>&#19981;&#20250;</em></span> &#34987;Spring&#23481;&#22120;&#35843;&#29992;&#12290;&#23458;&#25143;&#31471;&#20195;&#30721;&#35201;&#33258;&#24049;&#36127;&#36131;&#38144;&#27585;&#21407;&#22411;&#22495;bean
&#20197;&#21450;&#21644;bean&#30456;&#20851;&#30340;&#36164;&#28304;&#65288;&#29305;&#21035;&#26159;&#24320;&#38144;&#22823;&#30340;&#36164;&#28304;&#65289;&#12290;&#22914;&#26524;&#24819;&#35753;Spring&#36127;&#36131;&#36825;&#20123;&#20107;&#65288;&#38144;&#27585;bean&#12289;&#37322;&#25918;&#36164;&#28304;&#65289;&#65292;
&#23601;&#24471;&#33258;&#23450;&#20041;bean&#30340;&#21518;&#22788;&#29702;&#22120; <a class="link" href="beans.html#beans-factory-extension-bpp" title="5.8.1&nbsp;&#20351;&#29992;BeanPostProcessor&#33258;&#23450;&#20041;beans">bean post-processor</a>  &#65292;&#23427;&#20250;&#25345;&#29992;&#21407;&#22411;&#22495;bean&#30340;&#24341;&#29992;&#12290;</p>
<p>&#20174;&#26576;&#31181;&#24847;&#20041;&#19978;&#35828;&#65292;&#23545;&#20110;&#21407;&#22411;&#22495;bean&#65292;Spring&#23481;&#22120;&#20195;&#26367;&#20102;Java &#30340; <code class="literal">new</code> &#25805;&#20316;&#31526;&#12290;&#25152;&#26377;&#22312; <code class="literal">new</code> &#20043;&#21518;&#30340;&#29983;&#21629;&#21608;&#26399;&#31649;&#29702;&#20219;&#21153;&#65292;
&#37117;&#35201;&#30001;&#23458;&#25143;&#31471;&#33258;&#34892;&#22788;&#29702;&#12290;&#65288;&#24819;&#20102;&#35299;Spring&#23481;&#22120;&#20855;&#20307;&#22914;&#20309;&#31649;&#29702;bean&#30340;&#29983;&#21629;&#21608;&#26399;&#65292;&#35831;&#21442;&#32771; <a class="xref" href="beans.html#beans-factory-lifecycle" title="5.6.1&nbsp;&#29983;&#21629;&#21608;&#26399;&#22238;&#35843;">Section&nbsp;5.6.1, &#8220;&#29983;&#21629;&#21608;&#26399;&#22238;&#35843;&#8221;</a>. &#65289;</p>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="beans-factory-scopes-sing-prot-interaction" href="#beans-factory-scopes-sing-prot-interaction"></a>5.5.3&nbsp;&#20381;&#36182;&#21407;&#22411;bean&#30340;&#21333;&#20363;bean</h3></div></div></div>

<p>&#22914;&#26524;&#20320;&#30340;&#21333;&#20363;bean&#20381;&#36182;&#20102;&#21407;&#22411;bean&#65292;&#35880;&#35760;&#36825;&#20123;&#20381;&#36182;&#65288;&#30340;&#21407;&#22411;bean&#65289; <span class="emphasis"><em>&#21482;&#22312;&#21021;&#22987;&#21270;&#26102;&#35299;&#26512;</em></span> &#12290;
&#22240;&#27492;&#65292;&#20551;&#22914;&#20320;&#23558;&#21407;&#22411;bean&#20381;&#36182;&#27880;&#20837;&#33267;&#21333;&#20363;bean&#65292;&#22312;&#27880;&#20837;&#26102;&#20250;&#21021;&#22987;&#21270;&#19968;&#20010;&#26032;&#30340;&#21407;&#22411;bean&#23454;&#20363;&#65292;
&#36825;&#20010;&#34987;&#27880;&#20837;&#30340;&#21407;&#22411;bean&#23454;&#20363;&#26159;&#19968;&#20010;&#29420;&#31435;&#30340;&#23454;&#20363;&#12290;</p>
<p>&#19981;&#36807;&#65292;&#20551;&#22914;&#20320;&#24076;&#26395;&#21333;&#20363;bean&#22312;&#36816;&#34892;&#26102;&#33021;&#22815;&#21453;&#22797;&#33719;&#24471;&#19968;&#20010;&#26032;&#30340;&#21407;&#22411;bean&#23454;&#20363;&#65292;&#20320;&#23601;&#19981;&#33021;&#29992;&#20381;&#36182;&#27880;&#20837;&#30340;&#26041;&#24335;&#65292;
&#22240;&#20026;&#36825;&#20010;&#27880;&#20837;&#21482;&#21457;&#29983;<span class="emphasis"><em>&#19968;&#27425;</em></span> &#65292;&#21363;&#24403;Spring&#23481;&#22120;&#21021;&#22987;&#21270;&#21333;&#20363;bean&#24182;&#35299;&#26512;&#20381;&#36182;&#26102;&#12290;
&#22914;&#26524;&#20320;&#38656;&#35201;&#22312;&#36816;&#34892;&#26102;&#22810;&#27425;&#33719;&#24471;&#26032;&#30340;&#21407;&#22411;bean&#23454;&#20363;&#65292;&#35831;&#21442;&#38405; <a class="xref" href="beans.html#beans-factory-method-injection" title="5.4.6&nbsp;&#26041;&#27861;&#27880;&#20837;">Section&nbsp;5.4.6, &#8220;&#26041;&#27861;&#27880;&#20837;&#8221;</a></p>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="beans-factory-scopes-other" href="#beans-factory-scopes-other"></a>5.5.4&nbsp;&#35831;&#27714;&#20316;&#29992;&#22495;&#12289;&#20250;&#35805;&#20316;&#29992;&#22495;&#21644;&#20840;&#23616;&#20250;&#35805;&#20316;&#29992;&#22495;</h3></div></div></div>

<p><span class="emphasis"><em>&#20165;&#24403;</em></span> &#20320;&#20351;&#29992;web&#30456;&#20851;&#30340;Spring <code class="literal">ApplicationContext</code>&#65288;&#20363;&#22914; <code class="literal">XmlWebApplicationContext</code>&#65289;&#26102;&#65292;
&#35831;&#27714; <code class="literal">request</code> &#12289;&#20250;&#35805; <code class="literal">session</code> &#21644;&#20840;&#23616;&#20250;&#35805; <code class="literal">global session</code> &#20316;&#29992;&#22495;&#25165;&#20250;&#36215;&#20316;&#29992;&#12290;&#22914;&#26524;&#20320;&#22312;&#26222;&#36890;&#30340;Spring IoC &#23481;&#22120;&#65288;&#20363;&#22914; <code class="literal">ClassPathXmlApplicationContext</code>&#65289;&#20013;&#20351;&#29992;&#36825;&#20960;&#20010;&#20316;&#29992;&#22495;&#65292;&#20250;&#25243;&#20986;&#24322;&#24120; <code class="literal">IllegalStateException</code> &#65292;&#21578;&#30693;&#20320;&#36825;&#26159;&#19968;&#20010;&#26410;&#30693;&#30340;bean&#20316;&#29992;&#22495;</p>
<p>The <code class="literal">request</code>, <code class="literal">session</code>, and <code class="literal">global session</code> scopes are <span class="emphasis"><em>only</em></span> available if you use
a web-aware Spring <code class="literal">ApplicationContext</code> implementation (such as
<code class="literal">XmlWebApplicationContext</code>). If you use these scopes with regular Spring IoC containers
such as the <code class="literal">ClassPathXmlApplicationContext</code>, you get an <code class="literal">IllegalStateException</code>
complaining about an unknown bean scope.</p>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-factory-scopes-other-web-configuration" href="#beans-factory-scopes-other-web-configuration"></a>&#22522;&#26412;&#30340;web&#37197;&#32622;</h4></div></div></div>

<p>&#20026;&#20102;&#20351;&#29992;&#35831;&#27714; <code class="literal">request</code> &#12289;&#20250;&#35805; <code class="literal">session</code> &#21644;&#20840;&#23616;&#20250;&#35805; <code class="literal">global session</code> &#31561;&#20316;&#29992;&#22495;&#65288;web&#20316;&#29992;&#22495;&#65289;&#65292;
&#22312;&#23450;&#20041;bean&#20043;&#21069;&#35201;&#20570;&#19968;&#20123;&#26368;&#22522;&#26412;&#30340;&#21021;&#22987;&#21270;&#37197;&#32622;&#12290;&#65288;&#22914;&#26524;&#20351;&#29992;&#21333;&#20363;&#21644;&#21407;&#22411;&#36825;&#31867;&#26631;&#20934;&#20316;&#29992;&#22495;&#65292;&#26159; <span class="emphasis"><em>&#19981;&#38656;&#35201;</em></span> &#36825;&#20123;&#21021;&#22987;&#21270;&#37197;&#32622;&#30340;&#65289;&#12290;</p>
<p>&#20855;&#20307;&#22914;&#20309;&#32452;&#35013;&#36825;&#20123;&#21021;&#22987;&#21270;&#37197;&#32622;&#19982;&#20320;&#20351;&#29992;&#30340;&#29305;&#23450;&#30340;Servlet&#29615;&#22659;&#26377;&#20851;..</p>
<p>&#20107;&#23454;&#19978;&#65292;&#22914;&#26524;&#20320;&#20351;&#29992;Spring Web MVC &#65292;&#22312; <code class="literal">DispatcherServlet</code> &#25110; <code class="literal">DispatcherPortlet</code> &#22788;&#29702;&#30340;&#35831;&#27714;&#20869;&#21435;&#35775;&#38382;&#36825;&#20123;&#20316;&#29992;&#22495;&#30340;bean&#65292;
&#37027;&#23601;&#19981;&#29992;&#20570;&#20219;&#20309;&#19987;&#38376;&#30340;&#37197;&#32622;&#65306;<code class="literal">DispatcherServlet</code> &#21644; <code class="literal">DispatcherPortlet</code> &#24050;&#32463;&#24110;&#20320;&#20570;&#20102;&#36825;&#20123;&#20107;&#24773;&#12290;</p>
<p>&#22914;&#26524;&#20320;&#20351;&#29992;&#30340;&#26159; Servlet2.5 &#26631;&#20934;&#30340;web&#23481;&#22120;&#65292;&#32780;&#19988;&#35831;&#27714;&#19981;&#26159;&#30001; Spring&#30340; DispatcherServlet &#22788;&#29702;
&#65288;&#20363;&#22914;&#20351;&#29992;&#20102;Struts&#25110;JSF&#65289;&#65292;&#20320;&#23601;&#24471;&#27880;&#20876; <code class="literal">org.springframework.web.context.request.RequestContextListener</code> &#36825;&#19968; <code class="literal">ServletRequestListener</code> &#12290;
&#23545;&#20110;Servlet 3.0 &#20197;&#19978;&#30340;&#29615;&#22659;&#65292;&#21487;&#20197;&#36890;&#36807; <code class="literal">WebApplicationInitializer</code> &#25509;&#21475;&#20197;&#20195;&#30721;&#30340;&#26041;&#24335;&#21435;&#23454;&#29616;&#12290;
&#25110;&#32773;&#65292;&#23545;&#20110;&#27604;&#36739;&#32769;&#26087;&#30340;web &#23481;&#22120;&#65292;&#22312; <code class="literal">web.xml</code> &#37197;&#32622;&#25991;&#20214;&#20013;&#21152;&#20837;&#20197;&#19979;&#30340;&#22768;&#26126;&#65306;</p>
<pre class="programlisting"><span class="hl-tag">&lt;web-app&gt;</span>
    ...
    <span class="hl-tag">&lt;listener&gt;</span>
        <span class="hl-tag">&lt;listener-class&gt;</span>
            org.springframework.web.context.request.RequestContextListener
        <span class="hl-tag">&lt;/listener-class&gt;</span>
    <span class="hl-tag">&lt;/listener&gt;</span>
    ...
<span class="hl-tag">&lt;/web-app&gt;</span></pre>

<p>&#21448;&#25110;&#32773;&#65292;&#22914;&#26524;&#20320;&#22312;&#37197;&#32622;&#30417;&#21548;&#22120;&#26102;&#26377;&#38382;&#39064;&#65292;&#20063;&#21487;&#20197;&#20351;&#29992; <code class="literal">RequestContextFilter</code> &#12290;&#36807;&#28388;&#22120;&#30340;&#26144;&#23556;&#19982;&#20855;&#20307;&#30340;web&#24212;&#29992;&#26377;&#20851;&#65292;&#25152;&#20197;&#20320;&#24471;&#33258;&#34892;&#20462;&#25913;&#26144;&#23556;&#30340;&#20869;&#23481;&#12290;</p>
<pre class="programlisting"><span class="hl-tag">&lt;web-app&gt;</span>
    ...
    <span class="hl-tag">&lt;filter&gt;</span>
        <span class="hl-tag">&lt;filter-name&gt;</span>requestContextFilter<span class="hl-tag">&lt;/filter-name&gt;</span>
        <span class="hl-tag">&lt;filter-class&gt;</span>org.springframework.web.filter.RequestContextFilter<span class="hl-tag">&lt;/filter-class&gt;</span>
    <span class="hl-tag">&lt;/filter&gt;</span>
    <span class="hl-tag">&lt;filter-mapping&gt;</span>
        <span class="hl-tag">&lt;filter-name&gt;</span>requestContextFilter<span class="hl-tag">&lt;/filter-name&gt;</span>
        <span class="hl-tag">&lt;url-pattern&gt;</span>/*<span class="hl-tag">&lt;/url-pattern&gt;</span>
    <span class="hl-tag">&lt;/filter-mapping&gt;</span>
    ...
<span class="hl-tag">&lt;/web-app&gt;</span></pre>

<p><code class="literal">DispatcherServlet</code>, <code class="literal">RequestContextListener</code> &#21644; <code class="literal">RequestContextFilter</code> &#20570;&#30340;&#20107;&#24773;&#26159;&#19968;&#26679;&#30340;&#65292;&#37117;&#26159;&#25226;&#27599;&#20010;http&#35831;&#27714;&#23545;&#35937;&#32465;&#23450;&#21040;&#22788;&#29702;&#32447;&#31243; <code class="literal">Thread</code> &#19978;&#65292;
&#37027;&#20040;&#65292;&#35831;&#27714;&#12289;&#20250;&#35805;&#21644;&#20840;&#23616;&#20250;&#35805;&#20316;&#29992;&#22495;bean&#23601;&#21487;&#20197;&#27839;&#30528;&#35843;&#29992;&#38142;&#32487;&#32493;&#24448;&#19979;&#36208;&#20102;&#12290;</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-factory-scopes-request" href="#beans-factory-scopes-request"></a>&#35831;&#27714;&#20316;&#29992;&#22495;</h4></div></div></div>

<p>&#32771;&#34385;&#22914;&#19979;&#30340;bean&#23450;&#20041;&#65306;</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"loginAction"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"com.foo.LoginAction"</span> <span class="hl-attribute">scope</span>=<span class="hl-value">"request"</span><span class="hl-tag">/&gt;</span></pre>

<p>&#23545;&#20110;&#27599;&#20010;http&#35831;&#27714;&#65292;Spring&#23481;&#22120;&#20250;&#21019;&#24314;&#19968;&#20010; <code class="literal">LoginAction</code> bean &#30340;&#26032;&#23454;&#20363;&#12290;&#20063;&#23601;&#26159;&#35828;&#65292;<code class="literal">loginAction</code> bean &#30340;&#20316;&#29992;&#22495;&#38480;&#20110; HTTP &#35831;&#27714;&#33539;&#22260;&#12290;
&#20320;&#21487;&#20197;&#22312;&#35831;&#27714;&#20869;&#38543;&#24847;&#20462;&#25913;&#36825;&#20010;bean&#23454;&#20363;&#30340;&#29366;&#24577;&#65292;&#22240;&#20026;&#20854;&#20182; <code class="literal">loginAction</code> bean&#23454;&#20363;&#30475;&#19981;&#21040;&#36825;&#20123;&#21464;&#21270;&#65292;bean&#23454;&#20363;&#26159;&#19982;&#29305;&#23450;&#30340;&#35831;&#27714;&#30456;&#20851;&#30340;&#12290;
&#24403;&#35831;&#27714;&#22788;&#29702;&#23436;&#27605;&#65292;&#23545;&#24212;&#30340;bean&#23454;&#20363;&#20063;&#23601;&#38144;&#27585;&#65288;&#34987;&#22238;&#25910;&#65289;&#20102;&#12290;</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-factory-scopes-session" href="#beans-factory-scopes-session"></a>&#20250;&#35805;&#20316;&#29992;&#22495;</h4></div></div></div>

<p>&#32771;&#34385;&#22914;&#19979;&#30340;bean&#23450;&#20041;:</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"userPreferences"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"com.foo.UserPreferences"</span> <span class="hl-attribute">scope</span>=<span class="hl-value">"session"</span><span class="hl-tag">/&gt;</span></pre>

<p>&#22312;&#27599;&#20010;HTTP <code class="literal">Session</code>&#30340;&#29983;&#21629;&#21608;&#26399;&#20869;&#65292;Spring&#23481;&#22120;&#20250;&#26681;&#25454;id&#20026; <code class="literal">userPreferences</code> &#30340;bean&#23450;&#20041;&#21019;&#24314;&#19968;&#20010; <code class="literal">UserPreferences</code> bean &#30340;&#26032;&#23454;&#20363;&#12290;
&#20063;&#23601;&#26159;&#35828;&#65292;<code class="literal">userPreferences</code> bean &#30340;&#20316;&#29992;&#22495;&#38480;&#20110; HTTP <code class="literal">Session</code>&#33539;&#22260;&#12290;&#21644;&#35831;&#27714;&#20316;&#29992;&#22495; <code class="literal">request-scoped</code> bean &#31867;&#20284;&#65292;
&#22240;&#20026;&#27599;&#20010;&#20250;&#35805;&#22495; <code class="literal">session-scoped</code> bean&#30340;&#33539;&#22260;&#38480;&#20110;&#29305;&#23450;&#30340; HTTP <code class="literal">Session</code> &#20869;&#37096;&#65292;&#25152;&#20197;&#19968;&#20010; <code class="literal">Session</code> &#20869;&#30340; <code class="literal">userPreferences</code> bean&#20063;&#26159;&#21487;&#20197;&#34987;&#38543;&#24847;&#20462;&#25913;&#65292;
&#32780;&#19981;&#20250;&#24433;&#21709;&#21040;&#20854;&#20182; <code class="literal">Session</code> &#20013;&#30340; <code class="literal">userPreferences</code> bean&#12290;&#24403;&#19968;&#20010;HTTP <code class="literal">Session</code> &#26368;&#32456;&#29992;&#23436;&#34987;JVM&#22238;&#25910;&#26102;&#65292;&#30456;&#20851;&#30340;&#20250;&#35805;&#22495; <code class="literal">session-scoped</code> bean&#20063;&#34987;&#19968;&#36215;&#22238;&#25910;&#12290;</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-factory-scopes-global-session" href="#beans-factory-scopes-global-session"></a>&#20840;&#23616;&#20250;&#35805;&#20316;&#29992;&#22495;</h4></div></div></div>

<p>&#32771;&#34385;&#22914;&#19979;&#30340;bean&#23450;&#20041;:</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"userPreferences"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"com.foo.UserPreferences"</span> <span class="hl-attribute">scope</span>=<span class="hl-value">"globalSession"</span><span class="hl-tag">/&gt;</span></pre>

<p>&#20840;&#23616;&#20250;&#35805;&#20316;&#29992;&#22495; <code class="literal">global session</code> &#19982; <a class="link" href="beans.html#beans-factory-scopes-session" title="&#20250;&#35805;&#20316;&#29992;&#22495;">&#19978;&#25991;</a> &#25552;&#21040;&#30340;&#26631;&#20934;HTTP <code class="literal">Session</code> &#20316;&#29992;&#22495;&#31867;&#20284;&#65292;&#20294;&#26159;&#20165;&#36866;&#29992;&#20110;&#22522;&#20110;&#38376;&#25143;&#65288;portlet&#65289;&#30340;web&#24212;&#29992;&#31243;&#24207;&#19978;&#19979;&#25991;&#12290;
Portlet&#35268;&#33539;&#23450;&#20041;&#20102;&#22914;&#20309;&#22312;&#32452;&#25104;&#19968;&#20010;&#38376;&#25143;&#30340;&#22810;&#20010;portlet&#32452;&#20214;&#20043;&#38388;&#20849;&#20139;&#20840;&#23616; <code class="literal">Session</code> &#12290;
&#22240;&#27492;&#65292;&#20840;&#23616;&#20250;&#35805;&#20316;&#29992;&#22495; <code class="literal">global session</code> bean&#30340;&#29983;&#21629;&#21608;&#26399;&#20063;&#23601;&#19982;&#20840;&#23616;&#38376;&#25143; <code class="literal">Session</code> &#32039;&#23494;&#20851;&#32852;&#12290;</p>
<p>&#20551;&#22914;&#20320;&#24320;&#21457;&#20102;&#19968;&#20010;&#26631;&#20934;&#30340;&#12289;&#22522;&#20110;Servlet&#30340;web&#24212;&#29992;&#65292;&#24182;&#19988;&#23450;&#20041;&#20102;&#19968;&#20010;&#25110;&#22810;&#20010;&#20840;&#23616;&#20250;&#35805;&#20316;&#29992;&#22495; <code class="literal">global session</code> bean&#65292;
Spring&#23481;&#22120;&#20250;&#20351;&#29992; HTTP  <code class="literal">Session</code> &#20316;&#29992;&#22495;&#65288;&#26469;&#20195;&#26367;&#65289;&#65292;&#19981;&#20250;&#21457;&#29983;&#38169;&#35823;&#12290;</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-factory-scopes-application" href="#beans-factory-scopes-application"></a>&#24212;&#29992;&#31243;&#24207;&#20316;&#29992;&#22495;</h4></div></div></div>

<p>&#32771;&#34385;&#22914;&#19979;&#30340;bean&#23450;&#20041;:</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"appPreferences"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"com.foo.AppPreferences"</span> <span class="hl-attribute">scope</span>=<span class="hl-value">"application"</span><span class="hl-tag">/&gt;</span></pre>

<p>Spring&#23481;&#22120;&#20381;&#25454; <code class="literal">appPreferences</code> &#30340;bean &#23450;&#20041;&#65292;&#22312;&#25972;&#20010;web&#24212;&#29992;&#21551;&#21160;&#26102;&#21019;&#24314;&#20102;&#19968;&#20010; <code class="literal">AppPreferences</code> bean &#30340;&#23454;&#20363;&#12290;
&#20063;&#23601;&#26159;&#35828;&#65292; <code class="literal">appPreferences</code> bean &#30340;&#20316;&#29992;&#22495;&#38480;&#20110; <code class="literal">ServletContext</code> &#33539;&#22260;&#65292;&#20316;&#20026;&#19968;&#20010;&#26222;&#36890;&#30340; <code class="literal">ServletContext</code> &#23646;&#24615;&#36827;&#34892;&#23384;&#20648;&#12290;
&#36825;&#36319;Spring&#30340;&#21333;&#20363;&#20316;&#29992;&#22495;&#26377;&#20123;&#30456;&#20284;&#65292;&#20294;&#26377;&#20004;&#20010;&#37325;&#22823;&#24046;&#24322;&#65306;1. &#36825;&#26159;&#26576;&#20010; <code class="literal">ServletContext</code> &#30340;&#21333;&#20363;&#65292;
&#19981;&#26159;&#26576;&#20010;Spring <span class="emphasis"><em>ApplicationContext</em></span> &#30340;&#21333;&#20363;&#65288;&#20219;&#20309;&#32473;&#23450;&#30340;web&#24212;&#29992;&#37117;&#21487;&#33021;&#26377;&#22810;&#20010; <span class="emphasis"><em>ApplicationContext</em></span> &#65289;&#12290;
2. &#36825;&#26159;&#20316;&#20026;&#19968;&#20010; <code class="literal">ServletContext</code> &#23646;&#24615;&#34987;&#26292;&#38706;&#21644;&#35775;&#38382;&#30340;&#12290;</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-factory-scopes-other-injection" href="#beans-factory-scopes-other-injection"></a>&#23558;&#19978;&#36848;&#20316;&#29992;&#22495;&#30340;bean&#20316;&#20026;&#20381;&#36182;</h4></div></div></div>

<p>Spring IoC &#23481;&#22120;&#19981;&#20165;&#36127;&#36131;&#31649;&#29702;&#23545;&#35937;&#65288;beans&#65289;&#30340;&#21019;&#24314;&#65292;&#20063;&#36127;&#36131;&#26377;&#21512;&#20316;&#65288;&#20381;&#36182;&#65289;&#20851;&#31995;&#23545;&#35937;&#20043;&#38388;&#30340;&#32452;&#35013;&#12290;
&#22914;&#26524;&#20320;&#24819;&#23558;&#19968;&#20010;HTTP &#35831;&#27714;&#20316;&#29992;&#22495;&#30340;bean&#27880;&#20837;&#21040;&#21478;&#19968;&#20010; bean&#65292;&#24517;&#39035;&#27880;&#20837;&#19968;&#20010; AOP &#20195;&#29702;&#26469;&#21462;&#20195;&#35831;&#27714;&#20316;&#29992;&#22495;&#30340;bean&#26412;&#36523;&#12290;
&#20063;&#23601;&#26159;&#35828;&#65292;&#20320;&#24471;&#26377;&#19968;&#20010;&#21644;&#20316;&#29992;&#22495;bean&#23454;&#29616;&#20102;&#30456;&#21516;&#25509;&#21475;&#12289;&#33021;&#22312;&#30456;&#24212;&#20316;&#29992;&#22495;&#65288;&#20363;&#22914;&#65292;HTTP &#35831;&#27714;&#65289;
&#35775;&#38382;&#30495;&#27491;&#30340;&#35831;&#27714;&#22495;bean&#30446;&#26631;&#23545;&#35937;&#30340;&#20195;&#29702;&#23545;&#35937;&#65292;&#32780;&#19988;&#36825;&#20010;&#20195;&#29702;&#23545;&#35937;&#35201;&#33021;&#25226;&#26041;&#27861;&#35843;&#29992;&#22996;&#27966;&#32473;&#30495;&#27491;&#30340;&#35831;&#27714;&#22495;bean&#65292;
&#28982;&#21518;&#25226;&#20195;&#29702;&#23545;&#35937;&#27880;&#20837;&#21040;&#35831;&#27714;&#22495;bean&#35813;&#27880;&#20837;&#30340;&#22320;&#26041;&#12290;</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p>&#23545;&#20110;&#20316;&#29992;&#22495;&#20026; <code class="literal">singletons</code> &#65288;&#21333;&#20363;&#65289;&#25110; <code class="literal">prototypes</code>&#65288;&#21407;&#22411;&#65289;&#30340;bean &#65292; <span class="emphasis"><em>&#19981;&#38656;&#35201;</em></span> &#20351;&#29992; <code class="literal">&lt;aop:scoped&#8208;proxy/&gt;</code> &#20803;&#32032;</p>
</td></tr></table></div>

<p>&#19979;&#36848;&#20195;&#30721;&#34429;&#28982;&#21482;&#26377;&#19968;&#34892;&#65292;&#20294;&#35835;&#32773;&#19981;&#20165;&#35201;&#8220;&#30693;&#20854;&#28982;&#8221;&#65292;&#26356;&#35201;&#8220;&#30693;&#20854;&#25152;&#20197;&#28982;&#8221;&#12290;</p>
<pre class="programlisting"><span class="hl-directive" style="color: maroon">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="hl-tag">&lt;beans</span> <span class="hl-attribute">xmlns</span>=<span class="hl-value">"http://www.springframework.org/schema/beans"</span>
    <span class="hl-attribute">xmlns:xsi</span>=<span class="hl-value">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hl-attribute">xmlns:aop</span>=<span class="hl-value">"http://www.springframework.org/schema/aop"</span>
    <span class="hl-attribute">xsi:schemaLocation</span>=<span class="hl-value">"http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/aop
        http://www.springframework.org/schema/aop/spring-aop.xsd"</span><span class="hl-tag">&gt;</span>


    <span class="hl-comment">&lt;!-- &#23558;&#19968;&#20010;HTTP Session bean &#26292;&#38706;&#20026;&#19968;&#20010;&#20195;&#29702;bean --&gt;</span>
    <span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"userPreferences"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"com.foo.UserPreferences"</span> <span class="hl-attribute">scope</span>=<span class="hl-value">"session"</span><span class="hl-tag">&gt;</span>

        <span class="hl-comment">&lt;!-- &#36890;&#30693;Spring&#23481;&#22120;&#21435;&#20195;&#29702;&#36825;&#20010;bean --&gt;</span>
        <span class="hl-tag">&lt;aop:scoped-proxy/&gt;</span>
    <span class="hl-tag">&lt;/bean&gt;</span>


    <span class="hl-comment">&lt;!-- &#23558;&#19978;&#36848;bean &#30340;&#20195;&#29702;&#27880;&#20837;&#21040;&#19968;&#20010;&#21333;&#20363;bean --&gt;</span>
    <span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"userService"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"com.foo.SimpleUserService"</span><span class="hl-tag">&gt;</span>

        <span class="hl-comment">&lt;!-- &#24341;&#29992;&#34987;&#20195;&#29702;&#30340; userPreferences bean --&gt;</span>
        <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"userPreferences"</span> <span class="hl-attribute">ref</span>=<span class="hl-value">"userPreferences"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;/bean&gt;</span>
<span class="hl-tag">&lt;/beans&gt;</span></pre>

<p>&#20026;&#20102;&#21019;&#24314;&#19978;&#25991;&#25552;&#21040;&#30340;&#20195;&#29702;&#23545;&#35937;&#65292;&#35201;&#22312; <code class="literal">request</code> &#35831;&#27714;&#12289; <code class="literal">session</code> &#20250;&#35805;&#12289; <code class="literal">globalSession</code> &#20840;&#23616;&#20250;&#35805;
&#21644;&#33258;&#23450;&#20041;&#20316;&#29992;&#22495;&#30340;bean&#22768;&#26126;&#20013;&#21152;&#20837; <code class="literal">&lt;aop:scoped&#8208;proxy/&gt;</code>  &#23376;&#20803;&#32032;&#12290;
&#65288;&#21442;&#32771; <a class="xref" href="beans.html#beans-factory-scopes-other-injection-proxies" title="&#36873;&#25321;&#35201;&#21019;&#24314;&#30340;&#20195;&#29702;&#31867;&#22411;">the section called &#8220;&#36873;&#25321;&#35201;&#21019;&#24314;&#30340;&#20195;&#29702;&#31867;&#22411;&#8221;</a> &#21644;
<a class="xref" href="xsd-config.html" title="33.&nbsp;XML Schema-based configuration">Chapter&nbsp;33, <i>XML Schema-based configuration</i></a>&#65289;
&#12290;&#20026;&#20160;&#20040;&#35201;&#36825;&#20040;&#20570;&#21602;&#65311;&#35753;&#25105;&#20204;&#23558;&#36825;&#20960;&#20010;&#20316;&#29992;&#22495;&#30340;bean&#23450;&#20041;&#19982;&#21333;&#20363;&#20316;&#29992;&#22495;&#30340;bean&#23450;&#20041;&#20570;&#20010;&#23545;&#27604;&#12290;
&#65288;&#19979;&#21015;&#20195;&#30721;&#30340; <code class="literal">userPreferences</code> bean&#23450;&#20041;&#23454;&#38469;&#26159; <span class="emphasis"><em>&#19981;&#23436;&#25972;&#30340;</em></span> &#65289;&#12290;</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"userPreferences"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"com.foo.UserPreferences"</span> <span class="hl-attribute">scope</span>=<span class="hl-value">"session"</span><span class="hl-tag">/&gt;</span>

<span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"userManager"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"com.foo.UserManager"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"userPreferences"</span> <span class="hl-attribute">ref</span>=<span class="hl-value">"userPreferences"</span><span class="hl-tag">/&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span></pre>

<p>&#22312;&#19978;&#36848;&#20363;&#23376;&#20013;&#65292;&#23558;HTTP <code class="literal">Session</code> &#20250;&#35805;&#22495;&#30340; <code class="literal">userPreferences</code> bean &#27880;&#20837;&#36827;&#20102;&#21333;&#20363;&#22495; <code class="literal">userManager</code>&#12290;
&#20195;&#30721;&#30340;&#20851;&#38190;&#22312;&#20110;userManager &nbsp;&#26159;&#20010;&#21333;&#20363;bean&#65292;&#23427;&#22312;&#27599;&#20010;Spring &#23481;&#22120;&#20013;&#21482;&#20250;&#34987;&#21021;&#22987;&#21270; <span class="emphasis"><em>&#19968;&#27425;</em></span>&#65292;
&#23427;&#30340;&#20381;&#36182;&#23545;&#35937;&#65288;&#22312;&#36825;&#20010;&#20363;&#23376;&#20013;&#26159; <code class="literal">userPreferences</code> bean&#65289;&#20063;&#21482;&#20250;&#34987;&#27880;&#20837;&#19968;&#27425;&#12290;&#36825;&#23601;&#24847;&#21619;&#30528; <code class="literal">userManager</code> &nbsp;
&#27599;&#27425;&#25805;&#20316;&#30340;&#37117;&#26159;&#22312;&#26368;&#24320;&#22987;&#27880;&#20837;&#36827;&#26469;&#30340;&#21516;&#19968;&#20010; <code class="literal">userPreferences</code> &#23545;&#35937;&#12290;</p>
<p>&#24403;&#20320;&#25226;&#19968;&#20010;&#29983;&#21629;&#21608;&#26399;&#36739;&#30701;&#30340;bean&#27880;&#20837;&#33267;&#19968;&#20010;&#29983;&#21629;&#21608;&#26399;&#36739;&#38271;&#30340;bean&#26102;&#65292;&#20363;&#22914;&#25226;HTTP <code class="literal">Session</code> bean&#27880;&#20837;&#21040;&#21333;&#20363;bean&#65292;
&#36825;&#31181;&#24773;&#20917;&#32943;&#23450; <span class="emphasis"><em>&#19981;&#26159;</em></span> &#20320;&#25152;&#26399;&#26395;&#30340;&#12290;&#30456;&#21453;&#65292;&#20320;&#24076;&#26395;&#26377;&#20010;&#21807;&#19968;&#30340; <code class="literal">userManager</code> &#21333;&#20363;&#23545;&#35937;&#65292;&#22312;&#27599;&#20010;HTTP <code class="literal">Session</code>&#30340;&#29983;&#21629;&#21608;&#26399;&#20869;&#65292;
&#37117;&#33021;&#26377;&#19968;&#20010;&#19987;&#38376;&#30340; <code class="literal">userPreferences</code>  &#23545;&#35937;&#20379; <code class="literal">userManager</code> &#20351;&#29992;&#12290;&#22240;&#27492;&#65292;Spring&#23481;&#22120;&#20250;&#21019;&#24314;&#19968;&#20010;&#20195;&#29702;&#31867;&#65292;
&#20351;&#20043;&#19982;  <code class="literal">UserPreferences</code> &#31867;&#23454;&#29616;&#30456;&#21516;&#30340;&#25509;&#21475;&#65288;&#29702;&#35770;&#19978;&#20063;&#26159;&#19968;&#20010; <code class="literal">UserPreferences</code> &#23545;&#35937;&#65289;&#65292;&#24182;&#33021;&#26681;&#25454;&#20316;&#29992;&#22495;&#65288;HTTP &#35831;&#27714;&#12289; <code class="literal">Session</code>&#65292;&#31561;&#31561;&#65289;&#21435;&#33719;&#24471;&#30495;&#27491;&#30340; <code class="literal">UserPreferences</code> &#23545;&#35937;&#12290;
Spring&#23481;&#22120;&#23558;&#36825;&#20010;&#20195;&#29702;&#31867;&#30340;&#23545;&#35937;&#27880;&#20837;&#21040;  <code class="literal">userManager</code> &#65292; &#20294;&#26159; <code class="literal">userManager</code> &#24182;&#19981;&#28165;&#26970;&#23427;&#33719;&#24471;&#30340; <code class="literal">UserPreferences</code> &#20854;&#23454;&#26159;&#20010;&#20195;&#29702;&#12290;
&#22312;&#36825;&#20010;&#20363;&#23376;&#20013;&#65292;&#24403;UserManager &#23454;&#20363;&#35843;&#29992;&#27880;&#20837;&#30340; <code class="literal">UserPreferences</code> &#23545;&#35937;&#30340;&#26576;&#20010;&#26041;&#27861;&#26102;&#65292;&#23454;&#38469;&#19978;&#35843;&#29992;&#30340;&#26159;&#20195;&#29702;&#23545;&#35937;&#30340;&#26041;&#27861;&#12290;
&#28982;&#21518;&#65292;&#20195;&#29702;&#23545;&#35937;&#20174;HTTP <code class="literal">Session</code> &#20013;&#33719;&#21462;&#12289;&#24182;&#23558;&#26041;&#27861;&#35843;&#29992;&#22996;&#27966;&#32473;&#30495;&#27491;&#30340; <code class="literal">UserPreferences</code> &#23545;&#35937;&#12290;</p>
<p>&#25152;&#20197;&#65292;&#24403;&#20320;&#38656;&#35201;&#23558; <code class="literal">request-</code>, <code class="literal">session-</code>, and <code class="literal">globalSession-scoped</code> &#20316;&#29992;&#22495;&#30340; bean &#27880;&#20837;&#33267;&#20854;&#20182;&#21512;&#20316;&#32773;bean&#30340;&#26102;&#20505;&#65292;&#35201;&#25353;&#29031;&#19979;&#38754;&#30340;&#26041;&#27861;&#21435;&#27491;&#30830;&#22320;&#37197;&#32622;&#12290;</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"userPreferences"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"com.foo.UserPreferences"</span> <span class="hl-attribute">scope</span>=<span class="hl-value">"session"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;aop:scoped-proxy/&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span>
<span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"userManager"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"com.foo.UserManager"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"userPreferences"</span> <span class="hl-attribute">ref</span>=<span class="hl-value">"userPreferences"</span><span class="hl-tag">/&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span></pre>

<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="beans-factory-scopes-other-injection-proxies" href="#beans-factory-scopes-other-injection-proxies"></a>&#36873;&#25321;&#35201;&#21019;&#24314;&#30340;&#20195;&#29702;&#31867;&#22411;</h5></div></div></div>

<p>&#40664;&#35748;&#24773;&#20917;&#19979;&#65292;&#23545;&#20110;&#20351;&#29992;&#20102; <code class="literal">&lt;aop:scoped-proxy/&gt;</code> &#20803;&#32032;&#30340;bean&#65292;Spring&#23481;&#22120;&#20250;&#21019;&#24314;&#19968;&#20010; <span class="emphasis"><em>&#22522;&#20110;CGLIB&#31867;&#20195;&#29702;&#26426;&#21046;&#30340;&#20195;&#29702;&#31867;</em></span>&#12290;</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p>CGLIB &#20195;&#29702;&#21482;&#33021;&#25318;&#25130; public&#26041;&#27861;&#65281;&#19981;&#35201;&#22312;&#20195;&#29702;&#31867;&#19978;&#35843;&#29992; &#38750; public&#26041;&#27861;&#65292;&#37027;&#26679;&#19981;&#20250;&#22996;&#27966;&#32473;&#30495;&#27491;&#30340;&#30446;&#26631;&#23545;&#35937;&#12290;</p>
</td></tr></table></div>

<p>&#25110;&#32773;&#65292;&#20320;&#20063;&#21487;&#20197;&#25351;&#23450; <code class="literal">&lt;aop:scoped-proxy/&gt;</code> &#20803;&#32032;&#30340; <code class="literal">proxy-target-class</code> &#23646;&#24615;&#20026; <code class="literal">false</code> &#65292;
&#20174;&#32780;&#35753;Spring&#23481;&#22120;&#21019;&#24314;&#26631;&#20934;&#30340;&#12289;&#22522;&#20110;&#25509;&#21475;&#26426;&#21046;&#30340;JDK &#20195;&#29702;&#31867;&#12290;&#20351;&#29992; JDK &#20195;&#29702;&#31867;&#24847;&#21619;&#30528;&#20320;&#19981;&#38656;&#35201;&#22312;&#24212;&#29992;&#31243;&#24207;&#30340;classpath &#25351;&#23450;&#39069;&#22806;&#30340;&#31867;&#24211;&#12290;
&#20294;&#26159;&#65292;&#36825;&#20063;&#24847;&#21619;&#30528;&#20320;&#30340; scoped-bean &#33267;&#23569;&#24471;&#23454;&#29616;&#19968;&#20010;&#25509;&#21475;&#65292;&#32780;&#19988; <span class="emphasis"><em>&#25152;&#26377;</em></span> &#21512;&#20316;&#32773;&#24517;&#39035;&#36890;&#36807;&#20854;&#20013;&#19968;&#20010;&#25509;&#21475;&#26469;&#24341;&#29992;&#34987;&#27880;&#20837;&#30340;scoped-bean&#12290;</p>
<pre class="programlisting"><span class="hl-comment">&lt;!-- DefaultUserPreferences &#23454;&#29616;&#20102; UserPreferences &#25509;&#21475; --&gt;</span>
<span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"userPreferences"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"com.foo.DefaultUserPreferences"</span> <span class="hl-attribute">scope</span>=<span class="hl-value">"session"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;aop:scoped-proxy</span> <span class="hl-attribute">proxy-target-class</span>=<span class="hl-value">"false"</span><span class="hl-tag">/&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span>
<span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"userManager"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"com.foo.UserManager"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"userPreferences"</span> <span class="hl-attribute">ref</span>=<span class="hl-value">"userPreferences"</span><span class="hl-tag">/&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span></pre>

<p>&#21040;&#24213;&#35813;&#36873;&#25321;&#22522;&#20110;&#31867;&#30340;&#36824;&#26159;&#22522;&#20110;&#25509;&#21475;&#30340;&#20195;&#29702;&#26426;&#21046;&#21602;&#65311;&#21487;&#21442;&#32771; <a class="link" href="aop.html#aop-proxying" title="9.6&nbsp;Proxying mechanisms">aop&#20195;&#29702;</a> &#20102;&#35299;&#26356;&#22810;&#32454;&#33410;&#20449;&#24687;&#12290;</p>
</div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="beans-factory-scopes-custom" href="#beans-factory-scopes-custom"></a>5.5.5&nbsp;Custom scopes</h3></div></div></div>

<p>The bean scoping mechanism is extensible; You can define your own
scopes, or even redefine existing scopes, although the latter is considered bad practice
and you <span class="emphasis"><em>cannot</em></span> override the built-in <code class="literal">singleton</code> and <code class="literal">prototype</code> scopes.</p>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-factory-scopes-custom-creating" href="#beans-factory-scopes-custom-creating"></a>Creating a custom scope</h4></div></div></div>

<p>To integrate your custom scope(s) into the Spring container, you need to implement the
<code class="literal">org.springframework.beans.factory.config.Scope</code> interface, which is described in this
section. For an idea of how to implement your own scopes, see the <code class="literal">Scope</code>
implementations that are supplied with the Spring Framework itself and the
<a class="ulink" href="http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/beans/factory/config/Scope.html" target="_top"><code class="literal">Scope</code> javadocs</a>,
which explains the methods you need to implement in more detail.</p>
<p>The <code class="literal">Scope</code> interface has four methods to get objects from the scope, remove them from
the scope, and allow them to be destroyed.</p>
<p>The following method returns the object from the underlying scope. The session scope
implementation, for example, returns the session-scoped bean (and if it does not exist,
the method returns a new instance of the bean, after having bound it to the session for
future reference).</p>
<pre class="programlisting">Object get(String name, ObjectFactory objectFactory)</pre>

<p>The following method removes the object from the underlying scope. The session scope
implementation for example, removes the session-scoped bean from the underlying session.
The object should be returned, but you can return null if the object with the specified
name is not found.</p>
<pre class="programlisting">Object remove(String name)</pre>

<p>The following method registers the callbacks the scope should execute when it is
destroyed or when the specified object in the scope is destroyed. Refer to the javadocs
or a Spring scope implementation for more information on destruction callbacks.</p>
<pre class="programlisting"><span class="hl-keyword">void</span> registerDestructionCallback(String name, Runnable destructionCallback)</pre>

<p>The following method obtains the conversation identifier for the underlying scope. This
identifier is different for each scope. For a session scoped implementation, this
identifier can be the session identifier.</p>
<pre class="programlisting">String getConversationId()</pre>

</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-factory-scopes-custom-using" href="#beans-factory-scopes-custom-using"></a>Using a custom scope</h4></div></div></div>

<p>After you write and test one or more custom <code class="literal">Scope</code> implementations, you need to make
the Spring container aware of your new scope(s). The following method is the central
method to register a new <code class="literal">Scope</code> with the Spring container:</p>
<pre class="programlisting"><span class="hl-keyword">void</span> registerScope(String scopeName, Scope scope);</pre>

<p>This method is declared on the <code class="literal">ConfigurableBeanFactory</code> interface, which is available
on most of the concrete <code class="literal">ApplicationContext</code> implementations that ship with Spring via
the BeanFactory property.</p>
<p>The first argument to the <code class="literal">registerScope(..)</code> method is the unique name associated with
a scope; examples of such names in the Spring container itself are <code class="literal">singleton</code> and
<code class="literal">prototype</code>. The second argument to the <code class="literal">registerScope(..)</code> method is an actual instance
of the custom <code class="literal">Scope</code> implementation that you wish to register and use.</p>
<p>Suppose that you write your custom <code class="literal">Scope</code> implementation, and then register it as below.</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p>The example below uses <code class="literal">SimpleThreadScope</code> which is included with Spring, but not
registered by default. The instructions would be the same for your own custom <code class="literal">Scope</code>
implementations.</p>
</td></tr></table></div>

<pre class="programlisting">Scope threadScope = <span class="hl-keyword">new</span> SimpleThreadScope();
beanFactory.registerScope(<span class="hl-string">"thread"</span>, threadScope);</pre>

<p>You then create bean definitions that adhere to the scoping rules of your custom <code class="literal">Scope</code>:</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"..."</span> <span class="hl-attribute">class</span>=<span class="hl-value">"..."</span> <span class="hl-attribute">scope</span>=<span class="hl-value">"thread"</span><span class="hl-tag">&gt;</span></pre>

<p>With a custom <code class="literal">Scope</code> implementation, you are not limited to programmatic registration
of the scope. You can also do the <code class="literal">Scope</code> registration declaratively, using the
<code class="literal">CustomScopeConfigurer</code> class:</p>
<pre class="programlisting"><span class="hl-directive" style="color: maroon">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="hl-tag">&lt;beans</span> <span class="hl-attribute">xmlns</span>=<span class="hl-value">"http://www.springframework.org/schema/beans"</span>
    <span class="hl-attribute">xmlns:xsi</span>=<span class="hl-value">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hl-attribute">xmlns:aop</span>=<span class="hl-value">"http://www.springframework.org/schema/aop"</span>
    <span class="hl-attribute">xsi:schemaLocation</span>=<span class="hl-value">"http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/aop
        http://www.springframework.org/schema/aop/spring-aop.xsd"</span><span class="hl-tag">&gt;</span>

    <span class="hl-tag">&lt;bean</span> <span class="hl-attribute">class</span>=<span class="hl-value">"org.springframework.beans.factory.config.CustomScopeConfigurer"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"scopes"</span><span class="hl-tag">&gt;</span>
            <span class="hl-tag">&lt;map&gt;</span>
                <span class="hl-tag">&lt;entry</span> <span class="hl-attribute">key</span>=<span class="hl-value">"thread"</span><span class="hl-tag">&gt;</span>
                    <span class="hl-tag">&lt;bean</span> <span class="hl-attribute">class</span>=<span class="hl-value">"org.springframework.context.support.SimpleThreadScope"</span><span class="hl-tag">/&gt;</span>
                <span class="hl-tag">&lt;/entry&gt;</span>
            <span class="hl-tag">&lt;/map&gt;</span>
        <span class="hl-tag">&lt;/property&gt;</span>
    <span class="hl-tag">&lt;/bean&gt;</span>

    <span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"bar"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"x.y.Bar"</span> <span class="hl-attribute">scope</span>=<span class="hl-value">"thread"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"name"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"Rick"</span><span class="hl-tag">/&gt;</span>
        <span class="hl-tag">&lt;aop:scoped-proxy/&gt;</span>
    <span class="hl-tag">&lt;/bean&gt;</span>

    <span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"foo"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"x.y.Foo"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"bar"</span> <span class="hl-attribute">ref</span>=<span class="hl-value">"bar"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;/bean&gt;</span>

<span class="hl-tag">&lt;/beans&gt;</span></pre>

<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p>When you place <code class="literal">&lt;aop:scoped-proxy/&gt;</code> in a <code class="literal">FactoryBean</code> implementation, it is the factory
bean itself that is scoped, not the object returned from <code class="literal">getObject()</code>.</p>
</td></tr></table></div>

</div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="beans-factory-nature" href="#beans-factory-nature"></a>5.6&nbsp;&#23450;&#21046;bean&#29305;&#24615;</h2></div></div></div>

<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="beans-factory-lifecycle" href="#beans-factory-lifecycle"></a>5.6.1&nbsp;&#29983;&#21629;&#21608;&#26399;&#22238;&#35843;</h3></div></div></div>

<p>Spring&#25552;&#20379;&#20102;&#20960;&#20010;&#26631;&#24535;&#25509;&#21475;&#65288;marker interface&#65289;&#65292;&#36825;&#20123;&#25509;&#21475;&#29992;&#26469;&#25913;&#21464;&#23481;&#22120;&#20013;bean&#30340;&#34892;&#20026;&#65307;&#23427;&#20204;&#21253;&#25324;InitializingBean&#21644;DisposableBean&#12290;
&#23454;&#29616;&#36825;&#20004;&#20010;&#25509;&#21475;&#30340;bean&#22312;&#21021;&#22987;&#21270;&#21644;&#26512;&#26500;&#26102;&#23481;&#22120;&#20250;&#35843;&#29992;&#21069;&#32773;&#30340;afterPropertiesSet()&#26041;&#27861;&#65292;&#20197;&#21450;&#21518;&#32773;&#30340;destroy()&#26041;&#27861;&#12290;</p>
<div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="images/tip.png"></td><th align="left">Tip</th></tr><tr><td align="left" valign="top">
<p>&#22312;&#29616;&#20195;&#30340;Spring&#24212;&#29992;&#20013;&#65292;The JSR-250 <code class="literal">@PostConstruct</code> and <code class="literal">@PreDestroy</code> &#25509;&#21475;&#19968;&#33324;&#35748;&#20026;&#26159;&#25509;&#25910;&#29983;&#21629;&#21608;&#26399;&#22238;&#35843;&#30340;&#26368;&#20339;&#20570;&#27861;&#12290;
&#20351;&#29992;&#36825;&#20123;&#27880;&#35299;&#24847;&#21619;&#30528;bean&#27809;&#26377;&#32806;&#21512;&#21040;Spring&#20855;&#20307;&#30340;&#25509;&#21475;&#12290;&#35814;&#24773;&#35265;<a class="xref" href="beans.html#beans-postconstruct-and-predestroy-annotations" title="5.9.7&nbsp;@PostConstruct and @PreDestroy">Section&nbsp;5.9.7, &#8220;@PostConstruct and @PreDestroy&#8221;</a>&#12290;</p>
<p>&#22914;&#26524;&#20320;&#19981;&#24819;&#20351;&#29992;JSR-250 &#27880;&#35299;&#65292;&#20294;&#20320;&#36824;&#26159;&#23547;&#25214;&#28040;&#38500;&#32806;&#21512;&#65292;&#32771;&#34385;&#20351;&#29992;&#23545;&#35937;&#30340;init&#26041;&#27861;&#21644;destroy&#26041;&#27861;&#23450;&#20041;&#20803;&#25968;&#25454;&#12290;</p>
</td></tr></table></div>

<p>Spring&#22312;&#20869;&#37096;&#20351;&#29992; <code class="literal">BeanPostProcessor</code> &#23454;&#29616;&#26469;&#22788;&#29702;&#23427;&#33021;&#25214;&#21040;&#30340;&#20219;&#20309;&#22238;&#35843;&#25509;&#21475;&#24182;&#35843;&#29992;&#30456;&#24212;&#30340;&#26041;&#27861;&#12290;&#22914;&#26524;&#20320;&#38656;&#35201;&#33258;&#23450;&#20041;&#29305;&#24615;&#25110;&#32773;&#29983;&#21629;&#21608;&#26399;&#34892;&#20026;&#65292;&#20320;&#21487;&#20197;&#23454;&#29616;&#33258;&#24049;&#30340;
 <code class="literal">BeanPostProcessor</code> &#12290;&#26356;&#22810;&#20449;&#24687;&#65292;&#35814;&#24773;&#35265;<a class="xref" href="beans.html#beans-factory-extension" title="5.8&nbsp;&#23481;&#22120;&#25299;&#23637;&#28857;">Section&nbsp;5.8, &#8220;&#23481;&#22120;&#25299;&#23637;&#28857;&#8221;</a>&#12290;</p>
<p>&#38500;&#20102;&#21021;&#22987;&#21270;&#21644;&#38144;&#27585;&#22238;&#35843;&#20043;&#22806;&#65292;Spring&#31649;&#29702;&#23545;&#35937;&#21487;&#33021;&#36824;&#23454;&#29616;&#20102;<code class="literal">Lifecycle</code>&#25509;&#21475;&#65292;&#36825;&#20123;&#23545;&#35937;&#21487;&#20197;&#21442;&#19982;&#30001;&#23481;&#22120;&#33258;&#36523;&#39537;&#21160;&#30340;&#21551;&#21160;&#21644;&#20851;&#38381;&#36807;&#31243;&#12290;</p>
<p>&#26412;&#33410;&#20013;&#25551;&#36848;&#20102;&#29983;&#21629;&#21608;&#26399;&#22238;&#35843;&#25509;&#21475;&#12290;</p>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-factory-lifecycle-initializingbean" href="#beans-factory-lifecycle-initializingbean"></a>&#21021;&#22987;&#21270;&#22238;&#35843;&#20989;&#25968;</h4></div></div></div>

<p>&#23454;&#29616; <code class="literal">org.springframework.beans.factory.InitializingBean</code> &#25509;&#21475;&#65292;&#20801;&#35768;&#23481;&#22120;&#22312;&#35774;&#32622;&#22909;bean&#30340;&#25152;&#26377;&#24517;&#35201;&#23646;&#24615;&#21518;&#65292;&#25191;&#34892;&#21021;&#22987;&#21270;&#20107;&#23452;&#12290;
 <code class="literal">InitializingBean</code> &#25509;&#21475;&#20165;&#25351;&#23450;&#20102;&#19968;&#20010;&#26041;&#27861;&#65306;</p>
<pre class="programlisting"><span class="hl-keyword">void</span> afterPropertiesSet() <span class="hl-keyword">throws</span> Exception;</pre>

<p>&#36890;&#24120;&#65292;&#35201;&#36991;&#20813;&#20351;&#29992; <code class="literal">InitializingBean</code> &#25509;&#21475;&#24182;&#19988;&#19981;&#40723;&#21169;&#20351;&#29992;&#35813;&#25509;&#21475;&#65292;&#22240;&#20026;&#36825;&#26679;&#20250;&#23558;&#20195;&#30721;&#21644;Spring&#32806;&#21512;&#36215;&#26469;&#12290;
&#20351;&#29992;<a class="link" href="beans.html#beans-postconstruct-and-predestroy-annotations" title="5.9.7&nbsp;@PostConstruct and @PreDestroy"><code class="literal">@PostConstruct</code></a>&#27880;&#35299;&#25110;&#32773;&#25351;&#23450;&#19968;&#20010;POJO&#30340;&#21021;&#22987;&#21270;&#26041;&#27861;&#12290;
&#22312;XML&#37197;&#32622;&#20803;&#25968;&#25454;&#30340;&#24773;&#20917;&#19979;&#65292;&#20351;&#29992; <code class="literal">init-method</code> &#23646;&#24615;&#21435;&#25351;&#23450;&#26041;&#27861;&#21517;&#65292;&#24182;&#19988;&#35813;&#26041;&#27861;&#26080;&#21442;&#25968;&#31614;&#21517;&#12290;
&#20363;&#22914;&#65292;&#19979;&#38754;&#30340;&#23450;&#20041;&#65306;</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"exampleInitBean"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"examples.ExampleBean"</span> <span class="hl-attribute">init-method</span>=<span class="hl-value">"init"</span><span class="hl-tag">/&gt;</span></pre>

<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> ExampleBean {

    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> init() {
        <span class="hl-comment">// do some initialization work</span>
    }

}</pre>

<p>&#8230;&#26159;&#23436;&#20840;&#19968;&#26679;&#30340;&#8230;</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"exampleInitBean"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"examples.AnotherExampleBean"</span><span class="hl-tag">/&gt;</span></pre>

<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> AnotherExampleBean <span class="hl-keyword">implements</span> InitializingBean {

    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> afterPropertiesSet() {
        <span class="hl-comment">// do some initialization work</span>
    }

}</pre>

<p>&#20294;&#26159;&#27809;&#26377;&#23558;&#20195;&#30721;&#19982;Spring&#32806;&#21512;&#22312;&#19968;&#36215;&#12290;</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-factory-lifecycle-disposablebean" href="#beans-factory-lifecycle-disposablebean"></a>&#26512;&#26500;&#22238;&#35843;&#20989;&#25968;</h4></div></div></div>

<p>&#23454;&#29616; <code class="literal">org.springframework.beans.factory.DisposableBean</code> &#25509;&#21475;&#65292;&#20801;&#35768;&#19968;&#20010;bean&#24403;&#23481;&#22120;&#38656;&#35201;&#20854;&#38144;&#27585;&#26102;&#33719;&#24471;&#19968;&#27425;&#22238;&#35843;&#12290;
 <code class="literal">DisposableBean</code> &#25509;&#21475;&#20063;&#21482;&#35268;&#23450;&#20102;&#19968;&#20010;&#26041;&#27861;&#65306;</p>
<pre class="programlisting"><span class="hl-keyword">void</span> destroy() <span class="hl-keyword">throws</span> Exception;</pre>

<p>&#24314;&#35758;&#19981;&#20351;&#29992; <code class="literal">DisposableBean</code> &#22238;&#35843;&#25509;&#21475;&#65292;&#22240;&#20026;&#20250;&#19982;Spring&#32806;&#21512;&#12290;&#20351;&#29992;<a class="link" href="beans.html#beans-postconstruct-and-predestroy-annotations" title="5.9.7&nbsp;@PostConstruct and @PreDestroy"><code class="literal">@PreDestroy</code></a>
&#27880;&#35299;&#25110;&#32773;&#25351;&#23450;&#19968;&#20010;&#26222;&#36890;&#30340;&#26041;&#27861;&#65292;&#20294;&#33021;&#30001;bean&#23450;&#20041;&#25903;&#25345;&#12290;&#22522;&#20110;XML&#37197;&#32622;&#30340;&#20803;&#25968;&#25454;&#65292;&#20351;&#29992; <code class="literal">&lt;bean/&gt;</code> &#30340; <code class="literal">destroy-method</code> &#23646;&#24615;&#12290;&#20363;&#22914;&#65292;&#19979;&#38754;&#30340;&#23450;&#20041;&#65306;</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"exampleInitBean"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"examples.ExampleBean"</span> <span class="hl-attribute">destroy-method</span>=<span class="hl-value">"cleanup"</span><span class="hl-tag">/&gt;</span></pre>

<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> ExampleBean {

    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> cleanup() {
        <span class="hl-comment">// do some destruction work (like releasing pooled connections)</span>
    }

}</pre>

<p>&#19982;&#19979;&#38754;&#25928;&#26524;&#30456;&#21516;&#65306;</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"exampleInitBean"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"examples.AnotherExampleBean"</span><span class="hl-tag">/&gt;</span></pre>

<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> AnotherExampleBean <span class="hl-keyword">implements</span> DisposableBean {

    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> destroy() {
        <span class="hl-comment">// do some destruction work (like releasing pooled connections)</span>
    }

}</pre>

<p>&#20294;&#26159;&#19981;&#19982;Spring&#32806;&#21512;&#12290;</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-factory-lifecycle-default-init-destroy-methods" href="#beans-factory-lifecycle-default-init-destroy-methods"></a>&#32570;&#30465;&#30340;&#21021;&#22987;&#21270;&#21644;&#26512;&#26500;&#26041;&#27861;</h4></div></div></div>

<p>&#22914;&#26524;&#26377;&#20154;&#27809;&#26377;&#37319;&#29992;Spring&#25152;&#25351;&#23450;&#30340; <code class="literal">InitializingBean</code> &#21644; <code class="literal">DisposableBean</code> &#22238;&#35843;&#25509;&#21475;&#26469;&#32534;&#20889;&#21021;&#22987;&#21270;&#21644;&#26512;&#26500;&#26041;&#27861;&#22238;&#35843;&#65292;&#20250;&#21457;&#29616;&#33258;&#24049;&#27491;&#22312;&#32534;&#20889;&#30340;&#26041;&#27861;&#65292;
&#20854;&#21517;&#31216;&#33707;&#36807;&#20110; <code class="literal">init()</code>, <code class="literal">initialize()</code>, <code class="literal">dispose()</code> &#31561;&#31561;&#12290;&#36825;&#31181;&#29983;&#21629;&#21608;&#26399;&#22238;&#35843;&#26041;&#27861;&#30340;&#21517;&#31216;&#26368;&#22909;&#22312;&#19968;&#20010;&#39033;&#30446;&#33539;&#22260;&#20869;&#26631;&#20934;&#21270;&#65292;
&#36825;&#26679;&#22242;&#38431;&#20013;&#30340;&#24320;&#21457;&#20154;&#21592;&#23601;&#21487;&#20197;&#20351;&#29992;&#21516;&#26679;&#30340;&#26041;&#27861;&#21517;&#31216;&#65292;&#24182;&#19988;&#30830;&#20445;&#20102;&#26576;&#31181;&#31243;&#24230;&#30340;&#19968;&#33268;&#24615;&#12290;</p>
<p>Spring&#23481;&#22120;&#36890;&#36807;&#37197;&#32622;&#21487;&#20197;&#23454;&#29616;&#23545;&#27599;&#20010; bean&#21021;&#22987;&#21270;&#26102;&#30340;&#26597;&#25214;&#21644;&#38144;&#27585;&#26102;&#30340;&#22238;&#35843;&#35843;&#29992;&#12290;&#36825;&#20063;&#23601;&#26159;&#35828;&#65292;&#19968;&#20010;&#24212;&#29992;&#30340;&#24320;&#21457;&#32773;&#21487;&#20197;&#20511;&#21161;&#20110;&#21021;&#22987;&#21270;&#30340;&#22238;&#35843;&#26041;&#27861; <code class="literal">init()</code>
&#36731;&#26494;&#30340;&#20889;&#19968;&#20010;&#31867;&#65288;&#19981;&#24517;&#24819;XML&#37197;&#32622;&#25991;&#20214;&#37027;&#26679;&#20026;&#27599;&#20010;bean&#37117;&#37197;&#32622;&#19968;&#20010;<span class="emphasis"><em>init-method="init"</em></span>&#23646;&#24615;&#65289;&#12290;Spring IoC&#23481;&#22120;&#22312;&#21019;&#24314;bean&#30340;&#26102;&#20505;&#23558;&#35843;&#29992;&#36825;&#20010;&#26041;&#27861;&#65288;
&#36825;&#21644;&#20043;&#21069;&#25551;&#36848;&#30340;&#26631;&#20934;&#29983;&#21629;&#21608;&#26399;&#22238;&#35843;&#19968;&#33268;&#65289;&#12290;</p>
<p>&#20026;&#20102;&#23436;&#20840;&#24324;&#28165;&#22914;&#20309;&#20351;&#29992;&#35813;&#29305;&#24615;&#65292;&#35753;&#25105;&#20204;&#30475;&#19968;&#20010;&#20363;&#23376;&#12290;&#20986;&#20110;&#31034;&#33539;&#30340;&#30446;&#30340;&#65292;&#20551;&#35774;&#19968;&#20010;&#39033;&#30446;&#30340;&#32534;&#30721;&#35268;&#33539;&#20013;&#32422;&#23450;&#25152;&#26377;&#30340;&#21021;&#22987;&#21270;&#22238;&#35843;&#26041;&#27861;&#37117;&#34987;&#21629;&#21517;&#20026; <code class="literal">init()</code>
&#32780;&#26512;&#26500;&#22238;&#35843;&#26041;&#27861;&#34987;&#21629;&#21517;&#20026; <code class="literal">destroy()</code> &#12290;&#36981;&#24490;&#27492;&#35268;&#21017;&#20889;&#25104;&#30340;&#31867;&#22914;&#19979;&#25152;&#31034;&#65306;</p>
<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> DefaultBlogService <span class="hl-keyword">implements</span> BlogService {

    <span class="hl-keyword">private</span> BlogDao blogDao;

    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> setBlogDao(BlogDao blogDao) {
        <span class="hl-keyword">this</span>.blogDao = blogDao;
    }

    <span class="hl-comment">// this is (unsurprisingly) the initialization callback method</span>
    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> init() {
        <span class="hl-keyword">if</span> (<span class="hl-keyword">this</span>.blogDao == null) {
            <span class="hl-keyword">throw</span> <span class="hl-keyword">new</span> IllegalStateException(<span class="hl-string">"The [blogDao] property must be set."</span>);
        }
    }

}</pre>

<pre class="programlisting"><span class="hl-tag">&lt;beans</span> <span class="hl-attribute">default-init-method</span>=<span class="hl-value">"init"</span><span class="hl-tag">&gt;</span>

    <span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"blogService"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"com.foo.DefaultBlogService"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"blogDao"</span> <span class="hl-attribute">ref</span>=<span class="hl-value">"blogDao"</span><span class="hl-tag"> /&gt;</span>
    <span class="hl-tag">&lt;/bean&gt;</span>

<span class="hl-tag">&lt;/beans&gt;</span></pre>

<p>&#27880;&#24847;&#22312;&#39030;&#32423;&#30340; <code class="literal">&lt;beans/&gt;</code> &#20803;&#32032;&#20013;&#30340; <code class="literal">default-init-method</code> &#23646;&#24615;&#12290;&#36825;&#20010;&#23646;&#24615;&#30340;&#21547;&#20041;&#26159; Spring IOC&#23481;&#22120;&#22312;bean&#21019;&#24314;&#21644;&#35013;&#37197;&#30340;&#26102;&#20505;&#20250;&#23558; <code class="literal">init</code> &#26041;&#27861;
&#20316;&#20026;&#23454;&#20363;&#21270;&#22238;&#35843;&#26041;&#27861;&#12290;&#22914;&#26524;&#31867;&#26377;&#36825;&#20010;&#26041;&#27861;&#65292;&#21017;&#20250;&#22312;&#36866;&#24403;&#30340;&#26102;&#20505;&#25191;&#34892;&#12290;</p>
<p>&#38144;&#27585;&#22238;&#35843;&#26041;&#27861;&#37197;&#32622;&#26159;&#30456;&#21516;&#30340; (XML&#37197;&#32622;)&#65292;&#22312;&#39030;&#32423;&#30340;&lt;beans/&gt;&#20803;&#32032;&#20013;&#20351;&#29992; <code class="literal">default-destroy-method</code> &#23646;&#24615;&#12290;</p>
<p>&#24403;&#24050;&#32463;&#23384;&#22312;&#30340;&#31867;&#30340;&#21021;&#22987;&#21270;&#26041;&#27861;&#30340;&#21629;&#21517;&#35268;&#21017;&#19982;&#24815;&#20363;&#26377;&#24046;&#24322;&#30340;&#26102;&#20505;&#65292;&#20320;&#24212;&#35813;&#22987;&#32456;&#20351;&#29992;&lt;bean/&gt;&#20803;&#32032;&#20013;&#30340;<span class="emphasis"><em>init-method</em></span>&#21644;<span class="emphasis"><em>destroy-method</em></span>&#23646;&#24615;(&#22312;XML&#37197;&#32622;&#20013;)&#26469;&#35206;&#30422;&#40664;&#35748;&#30340;&#26041;&#24335;&#12290;</p>
<p>&#26368;&#21518;&#65292;&#35831;&#27880;&#24847;Spring&#23481;&#22120;&#20445;&#35777;&#22312;bean&#30340;&#25152;&#26377;&#20381;&#36182;&#37117;&#28385;&#36275;&#21518;&#31435;&#21363;&#25191;&#34892;&#37197;&#32622;&#30340;&#21021;&#22987;&#21270;&#22238;&#35843;&#12290;&#36825;&#24847;&#21619;&#30528;&#21021;&#22987;&#21270;&#22238;&#35843;&#22312;&#21407;&#29983;bean&#19978;&#35843;&#29992;&#65292;&#36825;&#20063;&#24847;&#21619;&#30528;&#36825;&#20010;&#26102;&#20505;&#20219;&#20309;&#35832;&#22914;AOP&#25318;&#25130;&#22120;&#20043;&#31867;&#30340;&#23558;&#19981;&#33021;&#34987;&#24212;&#29992;&#12290;
&#19968;&#20010;&#30446;&#26631;bean&#26159;&#39318;&#20808;&#23436;&#20840;&#21019;&#24314;&#65292;&#28982;&#21518;&#25165;&#24212;&#29992;&#35832;&#22914;AOP&#20195;&#29702;&#31561;&#25318;&#25130;&#22120;&#38142;&#12290;&#27880;&#24847;&#65292;&#22914;&#26524;&#30446;&#26631;bean&#21644;&#20195;&#29702;&#26159;&#20998;&#24320;&#23450;&#20041;&#20102;&#65292;&#20320;&#30340;&#20195;&#30721;&#29978;&#33267;&#21487;&#20197;&#32469;&#24320;&#20195;&#29702;&#30452;&#25509;&#21644;&#21407;&#29983;bean&#36890;&#20449;&#12290;
&#22240;&#27492;&#65292;&#22312;&#21021;&#22987;&#21270;&#26041;&#27861;&#19978;&#20351;&#29992;&#25318;&#25130;&#22120;&#23558;&#20135;&#29983;&#26410;&#30693;&#30340;&#32467;&#26524;&#65292;&#22240;&#20026;&#36825;&#23558;&#30446;&#26631;bean&#21644;&#23427;&#30340;&#20195;&#29702;/&#25318;&#25130;&#22120;&#30340;&#29983;&#21629;&#21608;&#26399;&#32465;&#23450;&#24182;&#19988;&#30041;&#19979;&#20102;&#21644;&#21021;&#22987;bean&#30452;&#25509;&#36890;&#20449;&#36825;&#26679;&#22855;&#24618;&#30340;&#26041;&#24335;&#12290;</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-factory-lifecycle-combined-effects" href="#beans-factory-lifecycle-combined-effects"></a>&#32452;&#21512;&#29983;&#21629;&#21608;&#26399;&#26426;&#21046;</h4></div></div></div>

<p>&#25130;&#33267; Spring 2.5&#65292;&#26377;&#19977;&#31181;&#36873;&#25321;&#25511;&#21046;bean&#29983;&#21629;&#21608;&#26399;&#34892;&#20026;&#65306;<a class="link" href="beans.html#beans-factory-lifecycle-initializingbean" title="&#21021;&#22987;&#21270;&#22238;&#35843;&#20989;&#25968;"><code class="literal">InitializingBean</code></a> &#21644;
<a class="link" href="beans.html#beans-factory-lifecycle-disposablebean" title="&#26512;&#26500;&#22238;&#35843;&#20989;&#25968;"><code class="literal">DisposableBean</code></a> &#22238;&#35843;&#25509;&#21475;&#65307;&#33258;&#23450;&#20041;<code class="literal">init()</code> &#21644; <code class="literal">destroy()</code> &#26041;&#27861;&#65307;
<a class="link" href="beans.html#beans-postconstruct-and-predestroy-annotations" title="5.9.7&nbsp;@PostConstruct and @PreDestroy"><code class="literal">@PostConstruct</code> and `@PreDestroy`annotations</a>&#12290;
&#20320;&#21487;&#20197;&#32452;&#21512;&#36825;&#20123;&#26426;&#21046;&#21435;&#25511;&#21046;&#32473;&#23450;&#30340;bean&#12290;</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p>&#22914;&#26524;bean&#23384;&#22312;&#22810;&#31181;&#30340;&#29983;&#21629;&#21608;&#26399;&#26426;&#21046;&#37197;&#32622;&#24182;&#19988;&#27599;&#31181;&#26426;&#21046;&#37117;&#37197;&#32622;&#20026;&#19981;&#21516;&#30340;&#26041;&#27861;&#21517;&#65292; &#37027;&#25152;&#26377;&#37197;&#32622;&#30340;&#26041;&#27861;&#23558;&#20250;&#25353;&#29031;&#19978;&#38754;&#30340;&#39034;&#21033;&#25191;&#34892;&#12290;&#28982;&#32780;&#22914;&#26524;&#37197;&#32622;&#20102;&#30456;&#21516;&#30340;&#26041;&#27861;&#21517; -
&#20363;&#22914;&#65292; init()&#21021;&#22987;&#21270;&#26041;&#27861; - &#37319;&#29992;&#22810;&#31181;&#26426;&#21046;&#37197;&#32622;&#21518;&#65292;&#21482;&#20250;&#25191;&#34892;&#19968;&#27425;&#12290;</p>
</td></tr></table></div>

<p>&#20026;&#21516;&#19968;&#20010;bean&#37197;&#32622;&#22810;&#20010;&#29983;&#21629;&#21608;&#26399;&#26426;&#21046;&#65292;&#19981;&#21516;&#30340;&#21021;&#22987;&#21270;&#26041;&#27861;&#65292;&#35843;&#29992;&#22914;&#19979;&#65306;</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<code class="literal">@PostConstruct</code> &#20803;&#27880;&#37322;
</li><li class="listitem">
<code class="literal">InitializingBean</code> &#30340; <code class="literal">afterPropertiesSet()</code> &#23450;&#20041;
</li><li class="listitem">
&#33258;&#23450;&#20041; <code class="literal">init()</code> &#26041;&#27861;
</li></ul></div>

<p>&#26512;&#26500;&#26041;&#27861;&#35843;&#29992;&#39034;&#24207;&#26159;&#30456;&#21516;&#30340;&#65306;</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<code class="literal">@PreDestroy</code> &#20803;&#27880;&#37322;
</li><li class="listitem">
<code class="literal">DisposableBean</code> &#30340; <code class="literal">destroy()</code> &#23450;&#20041;
</li><li class="listitem">
&#33258;&#23450;&#20041; <code class="literal">destroy()</code> &#26041;&#27861;
</li></ul></div>

</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-factory-lifecycle-processor" href="#beans-factory-lifecycle-processor"></a>&#21551;&#21160;&#21644;&#20851;&#38381;&#22238;&#35843;</h4></div></div></div>

<p><code class="literal">Lifecycle</code> &#25509;&#21475; &#20026;&#20219;&#20309;&#26377;&#23427;&#33258;&#24049;&#29983;&#21629;&#21608;&#26399;&#35201;&#27714;&#30340;&#23545;&#35937;&#23450;&#20041;&#22522;&#26412;&#26041;&#27861;&#65288;&#20363;&#22914; &#24320;&#22987;&#21644;&#20572;&#27490;&#19968;&#20123;&#21518;&#21488;&#22788;&#29702;&#65289;&#65306;</p>
<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">interface</span> Lifecycle {

    <span class="hl-keyword">void</span> start();

    <span class="hl-keyword">void</span> stop();

    <span class="hl-keyword">boolean</span> isRunning();

}</pre>

<p>&#20219;&#20309;Spring&#31649;&#29702;&#30340;&#23545;&#35937;&#21487;&#33021;&#23454;&#29616;&#37027;&#20010;&#25509;&#21475;&#12290;&#28982;&#21518;&#65292;&#24403; <code class="literal">ApplicationContext</code> &#24320;&#22987;&#21644;&#20572;&#27490;&#30340;&#26102;&#20505;&#65292;&#23427;&#20250;&#23558;&#37027;&#20123;&#35843;&#29992;&#30340;&#25152;&#26377;&#29983;&#21629;&#21608;&#26399;&#30340;&#23454;&#29616;
&#23450;&#20041;&#22312;&#36825;&#26679;&#30340;&#19978;&#19979;&#25991;&#20013;&#12290;&#36890;&#36807; <code class="literal">LifecycleProcessor</code> &#65306;</p>
<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">interface</span> LifecycleProcessor <span class="hl-keyword">extends</span> Lifecycle {

    <span class="hl-keyword">void</span> onRefresh();

    <span class="hl-keyword">void</span> onClose();

}</pre>

<p>&#27880;&#24847;&#65292; <code class="literal">LifecycleProcessor</code> &#26412;&#36523;&#25193;&#23637;&#20110; <code class="literal">Lifecycle</code> &#25509;&#21475;&#12290;&#23427;&#36824;&#22686;&#21152;&#20102;&#20004;&#20010;&#20854;&#20182;&#30340;&#26041;&#27861;&#65292;&#29992;&#20110;&#23545;&#19978;&#19979;&#25991;&#36827;&#34892;&#21047;&#26032;&#21644;&#20851;&#38381;&#12290;</p>
<p>Notice that the <code class="literal">LifecycleProcessor</code> is itself an extension of the <code class="literal">Lifecycle</code>
interface. It also adds two other methods for reacting to the context being refreshed
and closed.</p>
<p>&#21551;&#21160;&#21644;&#20851;&#38381;&#30340;&#39034;&#24207;&#35843;&#29992;&#20063;&#24456;&#37325;&#35201;&#12290;&#22914;&#26524;&#20219;&#20309;&#20004;&#20010;&#23545;&#35937;&#20043;&#38388;&#23384;&#22312;&#20381;&#36182;&#20851;&#31995;&#65292;&#20381;&#36182;&#26041;&#23558;&#20250;&#22312;&#20381;&#36182;&#21518;&#24320;&#22987;&#65292;&#22312;&#20381;&#36182;&#21069;&#20572;&#27490;&#12290;&#28982;&#32780;&#65292;&#26377;&#26102;&#20505;&#30452;&#25509;&#20381;&#36182;&#20851;&#31995;&#26159;&#26410;&#30693;&#30340;&#12290;
&#20320;&#21487;&#33021;&#21482;&#30693;&#36947;&#26576;&#20010;&#31867;&#22411;&#30340;&#23545;&#35937;&#24212;&#35813;&#22312;&#21478;&#19968;&#31181;&#31867;&#22411;&#30340;&#23545;&#35937;&#20043;&#21069;&#24320;&#22987;&#12290;&#22312;&#36825;&#31181;&#24773;&#20917;&#19979;&#65292; <code class="literal">SmartLifecycle</code> &#25509;&#21475;&#23450;&#20041;&#21478;&#19968;&#31181;&#36873;&#25321;&#65292;&#25442;&#21477;&#35805;&#35828;&#65292;
&#20316;&#20026;&#20854;&#36229;&#32423;&#25509;&#21475;&#65292;<code class="literal">Phased</code> &#23450;&#20041; <code class="literal">getPhase()</code> &#26041;&#27861;&#12290;</p>
<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">interface</span> Phased {

    <span class="hl-keyword">int</span> getPhase();

}</pre>

<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">interface</span> SmartLifecycle <span class="hl-keyword">extends</span> Lifecycle, Phased {

    <span class="hl-keyword">boolean</span> isAutoStartup();

    <span class="hl-keyword">void</span> stop(Runnable callback);

}</pre>

<p>&#24403;&#24320;&#22987;&#30340;&#26102;&#20505;&#65292;&#26368;&#20302;&#38454;&#27573;&#30340;&#23545;&#35937;&#39318;&#20808;&#24320;&#22987;&#65292;&#24182;&#19988;&#24403;&#20572;&#27490;&#30340;&#26102;&#20505;&#65292;&#26159;&#21453;&#21521;&#30340;&#39034;&#24207;&#12290;&#22240;&#27492;&#65292;&#23454;&#29616; <code class="literal">SmartLifecycle</code> &#25509;&#21475;&#21644;&#36820;&#22238;&#20540;&#26159; <code class="literal">Integer.MIN_VALUE</code>
&#30340; <code class="literal">getPhase()</code> &#26041;&#27861; &#30340;&#23545;&#35937;&#23558;&#22312;&#31532;&#19968;&#20010;&#24320;&#22987;&#21644;&#26368;&#21518;&#19968;&#20010;&#20572;&#27490;&#12290;&#22312;&#21478;&#19968;&#26041;&#38754;&#65292;&#30456;&#20301;&#20540;<code class="literal">Integer.MAX_VALUE</code> &#23558;&#34920;&#26126;&#23545;&#35937;&#24212;&#35813;&#31532;&#19968;&#20010;&#20572;&#27490;&#21644;&#26368;&#21518;&#24320;&#22987;&#65288;
&#21487;&#33021;&#26159;&#22240;&#20026;&#23427;&#20381;&#36182;&#20110;&#20854;&#20182;&#36827;&#31243;&#30340;&#36816;&#34892;&#65289;&#12290;&#24403;&#32771;&#34385;&#30456;&#20301;&#20540;&#30340;&#26102;&#20505;&#65292;&#21516;&#26679;&#37325;&#35201;&#30340;&#26159;&#35201;&#30693;&#36947;&#20219;&#20309;&#27809;&#26377;&#23454;&#29616; <code class="literal">SmartLifecycle</code> &#30340; <code class="literal">Lifecycle</code> &#23545;&#35937;&#40664;&#35748;&#30340;&#30456;&#20301;&#26159;0&#12290;
&#22240;&#27492;&#65292;&#20219;&#20309;&#36127;&#30456;&#20540;&#37117;&#20250;&#26174;&#31034;&#19968;&#20010;&#23545;&#35937;&#24212;&#35813;&#22312;&#37027;&#20123;&#26631;&#20934;&#32452;&#20214;&#21069;&#24320;&#22987;&#65288;&#24182;&#19988;&#22312;&#20182;&#20204;&#20043;&#21518;&#20572;&#27490;&#65289;&#65292;&#21453;&#20043;&#20026;&#20219;&#20309;&#27491;&#30456;&#20301;&#20540;&#12290;</p>
<p>&#27491;&#22914;&#20320;&#25152;&#30475;&#21040;&#30340;&#65292; <code class="literal">SmartLifecycle</code> &#25509;&#21463;&#22238;&#35843;&#65292;&#23450;&#20041;&#20102;&#20572;&#27490;&#26041;&#27861;&#12290;&#20219;&#20309;&#23454;&#29616;&#24517;&#39035;&#35843;&#29992;&#22238;&#35843;&#30340; <code class="literal">run()</code> &#26041;&#27861;&#65292;&#22312;&#23454;&#29616;&#30340;&#20851;&#38381;&#36827;&#31243;&#23436;&#25104;&#20043;&#21518;&#12290;
&#37027;&#20351;&#24471;&#24322;&#27493;&#20851;&#38381;&#65292;&#22312;&#40664;&#35748;&#23454;&#29616;&#30340; <code class="literal">lifecycleprocessor</code> &#25509;&#21475;&#24320;&#22987;&#65292;<code class="literal">DefaultLifecycleProcessor</code> &#65292;&#23558;&#31561;&#24453;&#20854;&#22312;&#27599;&#20010;&#38454;&#27573;&#20013;&#30340;&#23545;&#35937;&#32452;&#30340;&#36229;&#26102;&#20540;&#26469;&#35843;&#29992;&#36825;&#20010;&#22238;&#35843;&#12290;
&#40664;&#35748;&#30340; per-phase &#36229;&#26102;&#26102;&#38388;&#26159;30&#31186;&#12290;&#20320;&#21487;&#20197;&#22312;&#19978;&#19979;&#25991;&#20013;&#23450;&#20041;&#19968;&#20010;&#21517;&#20026;"lifecycleProcessor"&#30340;bean&#26469;&#37325;&#20889;&#40664;&#35748;&#29983;&#21629;&#21608;&#26399;&#22788;&#29702;&#22120;&#23454;&#20363;&#12290;&#22914;&#26524;&#20320;&#25171;&#31639;&#20462;&#25913;&#36229;&#26102;&#26102;&#38388;&#65292;
&#28982;&#21518;&#23450;&#20041;&#20197;&#19979;&#30340;&#23601;&#36275;&#22815;&#20102;&#65306;</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"lifecycleProcessor"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"org.springframework.context.support.DefaultLifecycleProcessor"</span><span class="hl-tag">&gt;</span>
    <span class="hl-comment">&lt;!-- timeout value in milliseconds --&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"timeoutPerShutdownPhase"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"10000"</span><span class="hl-tag">/&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span></pre>

<p>&#22914;&#19978;&#25152;&#36848;&#65292; <code class="literal">LifecycleProcessor</code> &#25509;&#21475;&#23545;&#20110;&#19978;&#19979;&#25991;&#30340;&#21047;&#26032;&#21644;&#20851;&#38381;&#23450;&#20041;&#20102;&#22238;&#35843;&#26041;&#27861;&#12290;&#22914;&#26524;` stop() <code class="literal">&#34987;&#26174;&#24335;&#35843;&#29992;&#65292;&#21518;&#32773;&#23558;&#31616;&#21333;&#30340;&#39537;&#21160;&#20851;&#38381;&#36827;&#31243;&#65292;
&#20294;&#24403;&#19978;&#19979;&#25991;&#20851;&#38381;&#26102;&#20250;&#21457;&#29983;&#12290; 'refresh' &#22238;&#35843;&#22312;&#21478;&#19968;&#26041;&#38754;&#26469;&#35828;&#26159; `SmartLifecycle</code> bean&#30340;&#21478;&#19968;&#20010;&#29305;&#28857;&#12290;&#24403;&#19978;&#19979;&#25991;&#34987;&#21047;&#26032;&#30340;&#26102;&#20505;&#65288;&#22312;&#25152;&#26377;&#23545;&#35937;&#34987;&#23454;&#20363;&#21270;&#21644;
&#21021;&#22987;&#21270;&#20043;&#21518;&#65289;&#65292;&#22238;&#35843;&#23558;&#34987;&#35843;&#29992;&#65292;&#32780;&#22312;&#36825;&#19968;&#28857;&#19978;&#65292;&#40664;&#35748;&#29983;&#21629;&#21608;&#26399;&#22788;&#29702;&#22120;&#23558;&#26816;&#26597;&#36890;&#36807;&#27599;&#19968;&#20010; <code class="literal">SmartLifecycle</code> &#23545;&#35937;&#30340; <code class="literal">isAutoStartup()</code> &#26041;&#27861;&#36820;&#22238;&#30340;&#24067;&#23572;&#20540;&#12290;
&#22914;&#26524;&#36820;&#22238; "true"&#65292;&#36825;&#20010;&#23545;&#35937;&#23558;&#22312;&#36825;&#19968;&#28857;&#19978;&#24320;&#22987;&#65292;&#32780;&#19981;&#26159;&#31561;&#24453;&#19978;&#19979;&#25991;&#30340;&#25110;&#32773;&#26412;&#36523;&#30340; <code class="literal">start()</code> &#26041;&#27861;&#30340;&#26174;&#31034;&#35843;&#29992;&#65288;&#19982;&#19978;&#19979;&#25991;&#21047;&#26032;&#19981;&#21516;&#65292;&#19978;&#19979;&#25991;&#24320;&#22987;&#19981;&#20250;
&#20026;&#19968;&#20010;&#26631;&#20934;&#30340;&#19978;&#19979;&#25991;&#23454;&#29616;&#33258;&#21160;&#21457;&#29983;&#65289;&#12290; "phase" &#20540;&#20197;&#21450; "depends-on" &#20851;&#31995;&#23558;&#20197;&#30456;&#21516;&#30340;&#26041;&#24335;&#30830;&#23450;&#21551;&#21160;&#39034;&#24207;&#65292;&#22914;&#19978;&#25152;&#36848;&#12290;</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-factory-shutdown" href="#beans-factory-shutdown"></a>&#22312;&#38750;web&#24212;&#29992;&#20013;&#20248;&#38597;&#22320;&#20851;&#38381;Spring IoC&#23481;&#22120;</h4></div></div></div>

<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p>&#26412;&#33410;&#20165;&#36866;&#29992;&#20110;&#38750;web&#24212;&#29992;&#31243;&#24207;&#12290;&#22312;&#22522;&#20110;web&#30340;ApplicationContext&#23454;&#29616;&#20013;&#24050;&#26377;&#30456;&#24212;&#30340;&#20195;&#30721;&#26469;&#22788;&#29702;&#20851;&#38381;web&#24212;&#29992;&#26102;&#22914;&#20309;&#24688;&#24403;&#22320;&#20851;&#38381;Spring IoC&#23481;&#22120;&#12290;</p>
<p>This section applies only to non-web applications. Spring&#8217;s web-based
<code class="literal">ApplicationContext</code> implementations already have code in place to shut down the Spring
IoC container gracefully when the relevant web application is shut down.</p>
</td></tr></table></div>

<p>&#22914;&#26524;&#20320;&#27491;&#22312;&#19968;&#20010;&#38750;web&#24212;&#29992;&#30340;&#29615;&#22659;&#19979;&#20351;&#29992;Spring&#30340;IoC&#23481;&#22120;;&#20363;&#22914;&#22312;&#26700;&#38754;&#23500;&#23458;&#25143;&#31471;&#29615;&#22659;&#19979;&#65292;&#20320;&#24819;&#35753;&#23481;&#22120;&#20248;&#38597;&#30340;&#20851;&#38381;&#65292;&#24182;&#35843;&#29992;singleton bean&#19978;&#30340;&#30456;&#24212;&#26512;&#26500;&#22238;&#35843;&#26041;&#27861;&#65292;
&#20320;&#38656;&#35201;&#22312;JVM&#37324;&#27880;&#20876;&#19968;&#20010;&#8220;&#20851;&#38381;&#38057;&#23376;&#8221;&#65288;shutdown hook&#65289;&#12290;&#36825;&#19968;&#28857;&#38750;&#24120;&#23481;&#26131;&#20570;&#21040;&#65292;&#24182;&#19988;&#23558;&#20250;&#30830;&#20445;&#20320;&#30340;Spring IoC&#23481;&#22120;&#34987;&#24688;&#24403;&#20851;&#38381;&#65292;&#20197;&#21450;&#25152;&#26377;&#30001;&#21333;&#20363;&#25345;&#26377;&#30340;&#36164;&#28304;&#37117;&#20250;
&#34987;&#37322;&#25918;&#65288;&#24403;&#28982;&#65292;&#20026;&#20320;&#30340;&#21333;&#20363;&#37197;&#32622;&#38144;&#27585;&#22238;&#35843;&#65292;&#24182;&#27491;&#30830;&#23454;&#29616;&#38144;&#27585;&#22238;&#35843;&#26041;&#27861;&#65292;&#20381;&#28982;&#26159;&#20320;&#30340;&#24037;&#20316;&#65289;&#12290;</p>
<p>&#20026;&#20102;&#27880;&#20876;&#8220;&#20851;&#38381;&#38057;&#23376;&#8221;&#65292;&#20320;&#21482;&#38656;&#35201;&#31616;&#21333;&#22320;&#35843;&#29992;&#22312; <code class="literal">AbstractApplicationContext</code> &#23454;&#29616;&#20013;&#30340; <code class="literal">registerShutdownHook()</code> &#26041;&#27861;&#21363;&#21487;&#12290;&#20063;&#23601;&#26159;&#65306;</p>
<pre class="programlisting"><span class="hl-keyword">import</span> org.springframework.context.support.AbstractApplicationContext;
<span class="hl-keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;

<span class="hl-keyword">public</span> <span class="hl-keyword">final</span> <span class="hl-keyword">class</span> Boot {

    <span class="hl-keyword">public</span> <span class="hl-keyword">static</span> <span class="hl-keyword">void</span> main(<span class="hl-keyword">final</span> String[] args) <span class="hl-keyword">throws</span> Exception {

        AbstractApplicationContext ctx = <span class="hl-keyword">new</span> ClassPathXmlApplicationContext(
                <span class="hl-keyword">new</span> String []{<span class="hl-string">"beans.xml"</span>});

        <span class="hl-comment">// add a shutdown hook for the above context...</span>
        ctx.registerShutdownHook();

        <span class="hl-comment">// app runs here...</span>

        <span class="hl-comment">// main method exits, hook is called prior to the app shutting down...</span>

    }
}</pre>

</div>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="beans-factory-aware" href="#beans-factory-aware"></a>5.6.2&nbsp;ApplicationContextAware and BeanNameAware</h3></div></div></div>

<p>&#24403; <code class="literal">ApplicationContext</code> &#21019;&#24314;&#19968;&#20010;&#23454;&#29616; <code class="literal">org.springframework.context.ApplicationContextAware</code> &#25509;&#21475;&#30340;&#23545;&#35937;&#30340;&#23454;&#20363;&#65292;
&#35813;&#23454;&#20363;&#25552;&#20379;&#19968;&#20010;&#21442;&#32771;&#65292;<code class="literal">ApplicationContext</code>&#12290;</p>
<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">interface</span> ApplicationContextAware {

    <span class="hl-keyword">void</span> setApplicationContext(ApplicationContext applicationContext) <span class="hl-keyword">throws</span> BeansException;

}</pre>

<p>When an <code class="literal">ApplicationContext</code> creates an object instance that implements the
<code class="literal">org.springframework.context.ApplicationContextAware</code> interface, the instance is provided
with a reference to that <code class="literal">ApplicationContext</code>.</p>
<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">interface</span> ApplicationContextAware {

    <span class="hl-keyword">void</span> setApplicationContext(ApplicationContext applicationContext) <span class="hl-keyword">throws</span> BeansException;

}</pre>

<p>&#22240;&#27492;&#65292;bean&#21487;&#20197;&#36890;&#36807;&#32534;&#31243;&#26041;&#24335;&#25805;&#32437; <code class="literal">ApplicationContext</code> &#26469;&#21019;&#24314;&#65292;&#36890;&#36807; <code class="literal">ApplicationContext</code> &#25509;&#21475;&#65292;&#25110;&#32773;&#36890;&#36807;&#21521;&#36825;&#20010;&#25509;&#21475;&#30340;&#19968;&#20010;&#24050;&#30693;&#30340;&#23376;&#31867;&#30340;&#24341;&#29992;&#65292;
&#22914; <code class="literal">ConfigurableApplicationContext</code> &#65292;&#20844;&#24320;&#38468;&#21152;&#21151;&#33021;&#12290;&#19968;&#20010;&#24212;&#29992;&#31243;&#24207;&#23558;&#26159;&#20854;&#20182;bean&#30340;&#26041;&#26696;&#26816;&#32034;&#12290;&#26377;&#26102;&#20505;&#36825;&#31181;&#24615;&#33021;&#26159;&#26377;&#29992;&#30340;&#65292;&#28982;&#32780;&#65292;&#19968;&#33324;&#26469;&#35828;&#65292;
&#20320;&#24212;&#35813;&#36991;&#20813;&#23427;&#65292;&#22240;&#20026;&#20182;&#20250;&#19982;Spirng&#32806;&#21512;&#65292;&#24182;&#19988;&#19981;&#36981;&#24490;&#21453;&#36716;&#25511;&#21046;&#26041;&#24335;&#65292;&#22312;&#21512;&#20316;&#32773;&#34987;&#25552;&#20379;&#32473;bean&#20316;&#20026;&#23646;&#24615;&#30340;&#22320;&#26041;&#12290; <code class="literal">ApplicationContext</code> &#30340;&#20854;&#20182;&#26041;&#27861;&#25552;&#20379;
&#33719;&#21462;&#25991;&#20214;&#36164;&#28304;&#65292;&#21457;&#24067;&#24212;&#29992;&#31243;&#24207;&#20107;&#20214;&#65292;&#21644;&#33719;&#21462;&#19968;&#20010;<code class="literal">MessageSource</code>&#12290;&#36825;&#20123;&#38468;&#21152;&#21151;&#33021;&#22312;<a class="xref" href="beans.html#context-introduction" title="5.15&nbsp;ApplicationContext &#30340;&#38468;&#21152;&#21151;&#33021;">Section&nbsp;5.15, &#8220;ApplicationContext &#30340;&#38468;&#21152;&#21151;&#33021;&#8221;</a>&#20013;&#25551;&#36848;&#12290;</p>
<p>&#25130;&#27490;Spring 2.5&#65292;&#33258;&#21160;&#35013;&#37197;&#26159;&#33719;&#21462; <code class="literal">ApplicationContext</code> &#32034;&#24341;&#30340;&#21478;&#19968;&#31181;&#36873;&#25321;&#12290;&#20256;&#32479;&#30340; <code class="literal">constructor</code> &#21644; <code class="literal">byType</code>&#33258;&#21160;&#27169;&#24335;&#65288;&#22312;
<a class="xref" href="beans.html#beans-factory-autowire" title="5.4.5&nbsp;&#33258;&#21160;&#35013;&#37197;&#21327;&#20316;&#32773;">Section&nbsp;5.4.5, &#8220;&#33258;&#21160;&#35013;&#37197;&#21327;&#20316;&#32773;&#8221;</a>&#20013;&#25551;&#36848;&#65289;&#21487;&#20197;&#20998;&#21035;&#20026; <code class="literal">ApplicationContext</code> &#31867;&#22411;&#30340;&#26500;&#36896;&#20989;&#25968;&#21442;&#25968;&#25110;setter&#26041;&#27861;&#21442;&#25968;&#25552;&#20379;&#20381;&#36182;&#12290;&#20026;&#20102;&#26356;&#28789;&#27963;&#65292;
&#21253;&#25324;&#33258;&#21160;&#35013;&#37197;&#25104;&#21592;&#21644;&#22810;&#21442;&#25968;&#26041;&#27861;&#30340;&#33021;&#21147;&#65292;&#20351;&#29992;&#26032;&#30340;&#22522;&#20110;&#27880;&#37322;&#30340;&#33258;&#21160;&#21151;&#33021;&#65292;&#22914;&#26524;&#20320;&#36825;&#26679;&#20570;&#65292; <code class="literal">ApplicationContext</code> &#34987;&#33258;&#21160;&#35013;&#37197;&#21040;&#25104;&#21592;&#65292;&#26500;&#36896;&#20989;&#25968;&#21442;&#25968;&#65292;&#25110;&#32773;
&#26041;&#27861;&#21442;&#25968;&#65292;&#24076;&#26395;` ApplicationContext <code class="literal">&#31867;&#22411;&#65292;&#22914;&#26524;&#25104;&#21592;&#65292;&#26500;&#36896;&#20989;&#25968;&#65292;&#26041;&#27861;&#22312;&#38382;&#39064;&#36827;&#34892; `@Autowired</code> &#27880;&#37322;&#12290;
&#26356;&#22810;&#20449;&#24687;&#35831;&#30475;<a class="xref" href="beans.html#beans-autowired-annotation" title="5.9.2&nbsp;@Autowired">Section&nbsp;5.9.2, &#8220;@Autowired&#8221;</a>&#12290;</p>
<p>&#24403; <code class="literal">ApplicationContext</code> &#21019;&#24314;&#19968;&#20010;&#23454;&#29616; <code class="literal">org.springframework.beans.factory.BeanNameAware</code> &#25509;&#21475;&#30340;&#31867;&#65292;&#35813;&#31867;&#20026;
&#23450;&#20041;&#22312;&#20854;&#30456;&#20851;&#23545;&#35937;&#23450;&#20041;&#20013;&#30340;&#21517;&#31216;&#25552;&#20379;&#19968;&#20010;&#32034;&#24341;&#12290;</p>
<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">interface</span> BeanNameAware {

    <span class="hl-keyword">void</span> setBeanName(string name) <span class="hl-keyword">throws</span> BeansException;

}</pre>

<p>&#22238;&#35843;&#26159;&#22312;&#25152;&#26377;&#27491;&#24120;bean&#23646;&#24615;&#20043;&#21518;&#65292;&#20294;&#26159;&#22312;&#22914; <code class="literal">InitializingBean</code> <span class="emphasis"><em>afterPropertiesSet</em></span> &#25110;&#32773;&#19968;&#20010;&#33258;&#23450;&#20041;&#30340;&#21021;&#22987;&#21270;&#26041;&#27861; &#30340;&#21021;&#22987;&#21270;&#22238;&#35843;&#20043;&#21069;&#65292;&#34987;&#35843;&#29992;&#12290;</p>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="aware-list" href="#aware-list"></a>5.6.3&nbsp;&#20854;&#20182; Aware &#25509;&#21475;</h3></div></div></div>

<p>&#38500;&#20102;&#19978;&#36848;&#30340; <code class="literal">ApplicationContextAware</code> &#21644; <code class="literal">BeanNameAware</code> &#65292;Spring&#25552;&#20379;&#19968;&#31995;&#21015;&#30340; <code class="literal">Aware</code> &#25509;&#21475;&#65292;&#20801;&#35768;bean&#34920;&#31034;&#20182;&#20204;&#38656;&#35201;&#19968;&#23450;&#22522;&#30784;&#35774;&#26045;&#20381;&#36182;&#30340;&#23481;&#22120;&#12290;
&#26368;&#37325;&#35201;&#30340; <code class="literal">Aware</code> &#25509;&#21475;&#27010;&#25324;&#22914;&#19979;&#65292;&#20316;&#20026;&#19968;&#33324;&#35268;&#21017;&#65292;&#36825;&#20010;&#21517;&#31216;&#26159;&#20381;&#36182;&#31867;&#22411;&#30340;&#19968;&#20010;&#24456;&#22909;&#30340;&#25351;&#31034;:</p>
<div class="table"><a name="beans-factory-nature-aware-list" href="#beans-factory-nature-aware-list"></a><p class="title"><b>Table&nbsp;5.4.&nbsp;Aware &#25509;&#21475;</b></p><div class="table-contents">

  <table summary="Aware &#25509;&#21475;" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="col_1"><col class="col_2"><col class="col_3"></colgroup><thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&#21517;&#31216;</th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&#27880;&#20837;&#20381;&#36182;</th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top">&#35299;&#37322;&#8230;</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">ApplicationContextAware</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>&#22768;&#26126; <code class="literal">ApplicationContext</code></p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p><a class="xref" href="beans.html#beans-factory-aware" title="5.6.2&nbsp;ApplicationContextAware and BeanNameAware">Section&nbsp;5.6.2, &#8220;ApplicationContextAware and BeanNameAware&#8221;</a></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">ApplicationEventPublisherAware</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>&#23553;&#38381;&#30340;&#20107;&#20214;&#21457;&#24067;&#32773; <code class="literal">ApplicationContext</code></p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p><a class="xref" href="beans.html#context-introduction" title="5.15&nbsp;ApplicationContext &#30340;&#38468;&#21152;&#21151;&#33021;">Section&nbsp;5.15, &#8220;ApplicationContext &#30340;&#38468;&#21152;&#21151;&#33021;&#8221;</a></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">BeanClassLoaderAware</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>&#29992;&#20110;&#35013;&#36733;bean class &#30340;&#35013;&#36733;&#22120;.</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p><a class="xref" href="beans.html#beans-factory-class" title="5.3.2&nbsp;&#23454;&#20363;&#21270;bean">Section&nbsp;5.3.2, &#8220;&#23454;&#20363;&#21270;bean&#8221;</a></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">BeanFactoryAware</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>&#22768;&#26126; <code class="literal">BeanFactory</code></p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p><a class="xref" href="beans.html#beans-factory-aware" title="5.6.2&nbsp;ApplicationContextAware and BeanNameAware">Section&nbsp;5.6.2, &#8220;ApplicationContextAware and BeanNameAware&#8221;</a></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">BeanNameAware</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>&#22768;&#26126;bean&#30340;&#21517;&#31216;</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p><a class="xref" href="beans.html#beans-factory-aware" title="5.6.2&nbsp;ApplicationContextAware and BeanNameAware">Section&nbsp;5.6.2, &#8220;ApplicationContextAware and BeanNameAware&#8221;</a></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">BootstrapContextAware</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Resource adapter <code class="literal">BootstrapContext</code> the container runs in. Typically available only in
  JCA aware <code class="literal">ApplicationContext</code>s</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p><a class="xref" href="cci.html" title="25.&nbsp;JCA CCI">Chapter&nbsp;25, <i>JCA CCI</i></a></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">LoadTimeWeaverAware</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>&#22312;&#21152;&#36733;&#26102;&#23450;&#20041;<span class="emphasis"><em>weaver</em></span>&#22788;&#29702;&#31867;&#30340;&#23450;&#20041;</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p><a class="xref" href="aop.html#aop-aj-ltw" title="9.8.4&nbsp;Load-time weaving with AspectJ in the Spring Framework">Section&nbsp;9.8.4, &#8220;Load-time weaving with AspectJ in the Spring Framework&#8221;</a></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">MessageSourceAware</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>&#35299;&#20915;&#28040;&#24687;&#30340;&#37197;&#32622;&#31574;&#30053; (&#29992;&#21442;&#25968;&#21270;&#21644;&#22269;&#38469;&#21270;&#25903;&#25345;)</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p><a class="xref" href="beans.html#context-introduction" title="5.15&nbsp;ApplicationContext &#30340;&#38468;&#21152;&#21151;&#33021;">Section&nbsp;5.15, &#8220;ApplicationContext &#30340;&#38468;&#21152;&#21151;&#33021;&#8221;</a></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">NotificationPublisherAware</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Spring JMX &#36890;&#30693;&#21457;&#24067;&#32773;</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p><a class="xref" href="jmx.html#jmx-notifications" title="24.7&nbsp;Notifications">Section&nbsp;24.7, &#8220;Notifications&#8221;</a></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">PortletConfigAware</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>&#30446;&#21069; <code class="literal">PortletConfig</code> &#23481;&#22120;&#36816;&#34892;. &#20165;&#22312;&#19968;&#20010;web-aware Spring&#20013;&#26377;&#25928;
  <code class="literal">ApplicationContext</code></p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p><a class="xref" href="portlet.html" title="19.&nbsp;Portlet MVC Framework">Chapter&nbsp;19, <i>Portlet MVC Framework</i></a></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">PortletContextAware</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>&#30446;&#21069; <code class="literal">PortletContext</code> &#23481;&#22120;&#36816;&#34892;. &#20165;&#22312;&#19968;&#20010;web-aware Spring&#20013;&#26377;&#25928;
  <code class="literal">ApplicationContext</code></p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p><a class="xref" href="portlet.html" title="19.&nbsp;Portlet MVC Framework">Chapter&nbsp;19, <i>Portlet MVC Framework</i></a></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">ResourceLoaderAware</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>&#20026;&#20302;&#32423;&#21035;&#35775;&#38382;&#36164;&#28304;&#37197;&#32622;&#30340;&#21152;&#36733;&#31243;&#24207;</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p><a class="xref" href="resources.html" title="6.&nbsp;Resources">Chapter&nbsp;6, <i>Resources</i></a></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">ServletConfigAware</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>&#30446;&#21069; <code class="literal">ServletConfig</code> &#23481;&#22120;&#36816;&#34892;. &#20165;&#22312;&#19968;&#20010;web-aware Spring&#20013;&#26377;&#25928;
  <code class="literal">ApplicationContext</code></p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p><a class="xref" href="mvc.html" title="16.&nbsp;Web MVC &#26694;&#26550;">Chapter&nbsp;16, <i>Web MVC &#26694;&#26550;</i></a></p></td></tr><tr><td style="border-right: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">ServletContextAware</code></p></td><td style="border-right: 0.5pt solid ; " align="left" valign="top"><p>&#30446;&#21069; <code class="literal">ServletContext</code> &#23481;&#22120;&#36816;&#34892;. &#20165;&#22312;&#19968;&#20010;web-aware Spring&#20013;&#26377;&#25928;
  <code class="literal">ApplicationContext</code></p></td><td style="" align="left" valign="top"><p><a class="xref" href="mvc.html" title="16.&nbsp;Web MVC &#26694;&#26550;">Chapter&nbsp;16, <i>Web MVC &#26694;&#26550;</i></a></p></td></tr></tbody></table>
</div></div><br class="table-break">

<p>&#20877;&#27425;&#35828;&#26126;&#65292;&#36825;&#20123;&#25509;&#21475;&#30340;&#20351;&#29992;&#23558;&#24744;&#30340;&#20195;&#30721;&#32852;&#31995;&#21040;Spring API&#65292;&#24182;&#19988;&#19981;&#36981;&#24490;&#21453;&#36716;&#25511;&#21046;&#26041;&#24335;&#12290;&#22240;&#27492;&#65292;&#23427;&#20204;&#34987;&#25512;&#33616;&#29992;&#20110;&#35201;&#27714;&#23545;&#23481;&#22120;&#36827;&#34892;&#32534;&#31243;&#35775;&#38382;&#30340;&#22522;&#30784;bean&#12290;</p>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="beans-child-bean-definitions" href="#beans-child-bean-definitions"></a>5.7&nbsp;Bean&#23450;&#20041;&#30340;&#32487;&#25215;</h2></div></div></div>

<p>&#22312;&#19968;&#20010;bean&#23450;&#20041;&#20013;&#65292;&#21487;&#20197;&#21253;&#21547;&#37197;&#32622;&#20449;&#24687;&#65292;&#21253;&#25324;&#26500;&#36896;&#22120;&#21442;&#25968;&#65292;&#23646;&#24615;&#20540;&#65292;&#20197;&#21450;&#23481;&#22120;&#30340;&#29305;&#23450;&#20449;&#24687;&#65292;&#27604;&#22914;&#21021;&#22987;&#21270;&#26041;&#27861;&#65292;
&#38745;&#24577;&#24037;&#21378;&#26041;&#27861;&#21517;&#31561;&#31561;&#12290;&#23376;bean&#23450;&#20041;&#65292;&#20174;&#23427;&#30340;&#29238;bean&#23450;&#20041;&#32487;&#25215;&#37197;&#32622;&#25968;&#25454;&#65307;&#23376;bean&#23450;&#20041;&#21487;&#20197;&#35206;&#30422;&#19968;&#20123;&#20540;&#65292;
&#25110;&#32773;&#26681;&#25454;&#38656;&#35201;&#28155;&#21152;&#19968;&#20123;&#20854;&#20182;&#20540;&#12290;&#20351;&#29992;&#29238;&#23376;bean&#23450;&#20041;&#65292;&#21487;&#20197;&#36991;&#20813;&#24456;&#22810;&#37197;&#32622;&#22635;&#20889;&#12290;&#20107;&#23454;&#19978;&#65292;&#36825;&#26159;&#19968;&#31181;&#27169;&#26495;&#35774;&#35745;&#27169;&#24335;&#12290;</p>
<p>&#22914;&#26524;&#22312;&#24037;&#20316;&#20013;&#65292;&#20320;&#32534;&#31243;&#24335;&#22320;&#20351;&#29992;<code class="literal">ApplicationContext</code>&#25509;&#21475;&#65292;&#23376;bean&#23450;&#20041;&#30001;<code class="literal">ChildBeanDefinition</code> &#31867;&#26469;&#34920;&#31034;&#65307;
&#22823;&#22810;&#25968;&#30340;&#20351;&#29992;&#32773;&#65292;&#22312;&#24037;&#20316;&#20013;&#19981;&#22312;&#36825;&#20010;&#23618;&#38754;&#19978;&#20351;&#29992;&#23427;&#65292;&#32780;&#26159;&#22768;&#26126;&#24335;&#37197;&#32622;bean&#23450;&#20041;&#65292;&#27604;&#22914;&#20351;&#29992;<code class="literal">ClassPathXmlApplicationContext</code>
&#24403;&#20351;&#29992;&#22522;&#20110;XML&#30340;&#37197;&#32622;&#20803;&#25968;&#25454;&#65292;&#20320;&#21487;&#20197;&#25351;&#26126;&#19968;&#20010;&#23376;bean&#23450;&#20041;&#20351;&#29992;<code class="literal">parent</code>&#23646;&#24615;&#65292;&#25351;&#23450;&#29238;&#31867;bean&#20316;&#20026;&#36825;&#20010;&#23646;&#24615;&#30340;&#20540;</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"inheritedTestBean"</span> <span class="hl-attribute">abstract</span>=<span class="hl-value">"true"</span>
        <span class="hl-attribute">class</span>=<span class="hl-value">"org.springframework.beans.TestBean"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"name"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"parent"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"age"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"1"</span><span class="hl-tag">/&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span>

<span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"inheritsWithDifferentClass"</span>
        <span class="hl-attribute">class</span>=<span class="hl-value">"org.springframework.beans.DerivedTestBean"</span>
        <span class="strong"><strong>parent="inheritedTestBean"</strong></span> init-method="initialize"&gt;
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"name"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"override"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-comment">&lt;!--age&#23646;&#24615;&#30340;&#20540;1&#65292;&#23558;&#20250;&#20174;&#29238;&#31867;&#32487;&#25215;--&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span></pre>

<p>&#19968;&#20010;&#23376;bean&#23450;&#20041;&#22914;&#26524;&#27809;&#26377;&#25351;&#23450;class&#65292;&#20182;&#21487;&#20197;&#20351;&#29992;&#29238;bean&#23450;&#20041;&#30340;class&#65292;&#20063;&#21487;&#20197;&#35206;&#30422;&#23427;&#65307;&#22312;&#21518;&#19968;&#31181;&#24773;&#24418;&#20013;&#23376;bean&#23450;&#20041;&#65292;
&#24517;&#39035;&#20860;&#23481;&#29238;&#31867;&#65292;&#20063;&#23601;&#26159;&#35828;&#65292;&#20182;&#35201;&#25509;&#21463;&#29238;&#31867;&#30340;&#23646;&#24615;&#20540;</p>
<p>&#23376;bean&#23450;&#20041;&#20174;&#29238;&#31867;&#32487;&#25215;&#26500;&#36896;&#22120;&#21442;&#25968;&#65292;&#23646;&#24615;&#20540;&#65292;&#21644;&#21487;&#20197;&#37325;&#20889;&#30340;&#26041;&#27861;&#65292;&#21478;&#22806;&#20063;&#21487;&#20197;&#22686;&#21152;&#26032;&#30340;&#20540;&#12290;&#20320;&#25351;&#23450;&#30340;&#20219;&#20309;&#21021;&#22987;&#21270;&#26041;&#27861;&#65292;
&#38144;&#27585;&#26041;&#27861;&#65292;&#21644;/&#25110;&#32773;&#38745;&#24577;&#24037;&#21378;&#26041;&#27861;&#35774;&#32622;&#65292;&#37117;&#20250;&#35206;&#30422;&#30456;&#24212;&#30340;&#29238;&#31867;&#35774;&#32622;&#12290;</p>
<p>&#20854;&#20313;&#30340;&#35774;&#32622; <span class="emphasis"><em>&#24635;&#26159;</em></span> &#21462;&#33258;&#23376;bean&#23450;&#20041;&#65306;<span class="emphasis"><em>depends on</em></span>,
<span class="emphasis"><em>autowire mode</em></span>, <span class="emphasis"><em>dependency check</em></span>, <span class="emphasis"><em>singleton</em></span>, <span class="emphasis"><em>scope</em></span>, <span class="emphasis"><em>lazy init</em></span>.</p>
<p>&#19979;&#38754;&#30340;&#20363;&#23376;&#65292;&#36890;&#36807;&#20351;&#29992;<code class="literal">abstract</code>&#23646;&#24615;&#65292;&#26126;&#30830;&#22320;&#26631;&#26126;&#36825;&#20010;&#29238;&#31867;bean&#23450;&#20041;&#26159;&#25277;&#35937;&#30340;&#12290;&#22914;&#26524;&#65292;&#29238;&#31867;bean&#23450;&#20041;
&#27809;&#26377;&#26126;&#30830;&#22320;&#25351;&#20986;&#25152;&#23646;&#30340;&#31867;&#65292;&#37027;&#20040;&#26631;&#35760;&#29238;bean&#23450;&#20041;&#20026;&#20026;<code class="literal">abstract</code>&#26159;&#24517;&#39035;&#30340;&#65292;&#22914;&#19979;&#65306;</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"inheritedTestBeanWithoutClass"</span> <span class="hl-attribute">abstract</span>=<span class="hl-value">"true"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"name"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"parent"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"age"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"1"</span><span class="hl-tag">/&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span>

<span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"inheritsWithClass"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"org.springframework.beans.DerivedTestBean"</span>
        <span class="hl-attribute">parent</span>=<span class="hl-value">"inheritedTestBeanWithoutClass"</span> <span class="hl-attribute">init-method</span>=<span class="hl-value">"initialize"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"name"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"override"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-comment">&lt;!--age&#23646;&#24615;&#30340;&#20540;1&#65292;&#23558;&#20250;&#20174;&#29238;&#31867;&#32487;&#25215;--&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span></pre>

<p>&#36825;&#20010;&#29238;bean&#19981;&#33021;&#33258;&#20027;&#23454;&#20363;&#21270;&#65292;&#22240;&#20026;&#23427;&#26159;&#19981;&#23436;&#25972;&#30340;&#65292;&#21516;&#26102;&#23427;&#20063;&#26126;&#30830;&#22320;&#34987;&#26631;&#27880;&#20026;<code class="literal">abstract</code>&#65307;&#20687;&#36825;&#26679;&#65292;
&#19968;&#20010;bean&#23450;&#20041;&#20026;<code class="literal">abstract</code> &#30340;&#65292;&#23427;&#21482;&#33021;&#20316;&#20026;&#19968;&#20010;&#32431;&#31929;&#30340;bean&#27169;&#26495;&#65292;&#20026;&#23376;bean&#23450;&#20041;&#65292;&#20805;&#24403;&#29238;bean&#23450;&#20041;&#12290;
&#23581;&#35797;&#29420;&#31435;&#22320;&#20351;&#29992;&#36825;&#26679;&#19968;&#20010;<code class="literal">abstract</code>&#30340;&#29238;bean&#65292;&#25226;&#20182;&#20316;&#20026;&#21478;&#19968;&#20010;bean &#30340;&#24341;&#29992;&#65292;&#25110;&#32773;&#26681;&#25454;&#36825;&#20010;&#29238;bean&#30340;id&#26174;&#24335;&#35843;&#29992;<code class="literal">getBean()</code>&#26041;&#27861;&#65292;
&#23558;&#20250;&#36820;&#22238;&#19968;&#20010;&#38169;&#35823;&#12290;&#31867;&#20284;&#22320;&#65292;&#23481;&#22120;&#20869;&#37096;&#30340;<code class="literal">preInstantiateSingletons()</code> &#26041;&#27861;&#65292;&#20063;&#24573;&#30053;&#23450;&#20041;&#20026;&#25277;&#35937;&#30340;bean&#23450;&#20041;&#12290;</p>
<p>[&#27880;&#24847;]</p>
<div class="informalexample">
<p><code class="literal">ApplicationContext</code>&#40664;&#35748;&#22320;&#39044;&#23454;&#20363;&#21270;&#25152;&#26377;&#21333;&#20363;bean&#12290;&#22240;&#27492;&#65292;&#22914;&#26524;&#20320;&#25171;&#31639;&#25226;&#19968;&#20010;(&#29238;)bean&#23450;&#20041;&#20165;&#20165;&#20316;&#20026;&#27169;&#26495;&#26469;&#20351;&#29992;&#65292;
&#21516;&#26102;&#32473;&#23427;&#25351;&#23450;&#20102;&#31867;&#23646;&#24615;&#65292;&#20320;&#24517;&#39035;&#30830;&#20445;&#35774;&#32622; <span class="emphasis"><em>abstract</em></span> &#23646;&#24615;&#20026; <span class="emphasis"><em>true</em></span>,&#21542;&#21017;&#65292;&#24212;&#29992;&#31243;&#24207;&#19978;&#19979;&#25991;&#65292;&#20250;(&#23581;&#35797;)
&#39044;&#23454;&#20363;&#21270;&#36825;&#20010;<code class="literal">abstract</code> bean&#12290;</p>
</div>

</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="beans-factory-extension" href="#beans-factory-extension"></a>5.8&nbsp;&#23481;&#22120;&#25299;&#23637;&#28857;</h2></div></div></div>

<p>&#36890;&#24120;&#65292;&#24212;&#29992;&#31243;&#24207;&#24320;&#21457;&#32773;&#65292;&#19981;&#38656;&#35201;&#32487;&#25215;<code class="literal">ApplicationContext</code>&#30340;&#23454;&#29616;&#31867;&#12290;&#30456;&#21453;&#65292;Spring IoC&#23481;&#22120;&#21487;&#20197;&#36890;&#36807;&#25554;&#20837;&#29305;&#27530;&#30340;&#38598;&#25104;&#25509;&#21475;&#30340;&#23454;&#29616;&#65292;&#36827;&#34892;&#25299;&#23637;&#12290;&#26032;&#30340;&#19968;&#33410;&#20013;&#65292;&#25551;&#36848;&#20102;&#36825;&#20123;&#38598;&#25104;&#25509;&#21475;&#12290;</p>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="beans-factory-extension-bpp" href="#beans-factory-extension-bpp"></a>5.8.1&nbsp;&#20351;&#29992;BeanPostProcessor&#33258;&#23450;&#20041;beans</h3></div></div></div>

<p><code class="literal">BeanPostProcessor</code> &#23450;&#20041;&#20102;&#22238;&#35843;&#26041;&#27861;&#65292;&#36890;&#36807;&#23454;&#29616;&#36825;&#20010;&#22238;&#35843;&#26041;&#27861;&#65292;&#20320;&#21487;&#20197;&#25552;&#20379;&#20320;&#33258;&#24049;&#30340;(&#25110;&#32773;&#37325;&#20889;&#23481;&#22120;&#40664;&#35748;&#30340;)
&#23454;&#20363;&#21270;&#36923;&#36753;&#65292;&#20381;&#36182;&#20998;&#26512;&#36923;&#36753;&#31561;&#31561;&#12290;&#22914;&#26524;&#20320;&#24819;&#22312;Spring&#23481;&#22120;&#23436;&#25104;&#23454;&#20363;&#21270;&#37197;&#32622;&#65292;&#23454;&#20363;&#21270;&#19968;&#20010;bean&#20043;&#21518;&#65292;&#23454;&#29616;&#19968;&#20123;&#33258;&#23450;&#20041;&#36923;&#36753;
&#20320;&#21487;&#20197;&#25554;&#20837;&#19968;&#20010;&#25110;&#22810;&#20010; <code class="literal">BeanPostProcessor</code> &#30340;&#23454;&#29616;&#12290;</p>
<p>&#20320;&#21487;&#20197;&#37197;&#32622;&#22810;&#20010;<code class="literal">BeanPostProcessor</code>&#23454;&#20363;&#65292;&#21516;&#26102;&#20320;&#20063;&#33021;&#36890;&#36807;&#35774;&#32622; <code class="literal">order</code> &#23646;&#24615;&#26469;&#25511;&#21046;&#36825;&#20123;<code class="literal">BeanPostProcessor</code>s &#30340;&#25191;&#34892;&#39034;&#24207;&#12290;&#21482;&#26377;<code class="literal">BeanPostProcessor</code>&#23454;&#29616;&#20102;<code class="literal">Ordered</code> &#25509;&#21475;&#65292;&#20320;&#25165;&#21487;&#20197;&#35774;&#32622; <code class="literal">order</code> &#23646;&#24615;&#12290;&#22914;&#26524;&#65292;&#20320;&#32534;&#20889;&#20102;&#33258;&#24049;&#30340;<code class="literal">BeanPostProcessor</code>
&#20063;&#24212;&#24403;&#32771;&#34385;&#23454;&#29616; <code class="literal">Ordered</code> &#25509;&#21475;&#12290;&#27442;&#30693;&#35814;&#24773;&#65292;&#35831;&#21442;&#32771;<code class="literal">BeanPostProcessor</code> &#21644; <code class="literal">Ordered</code>&#25509;&#21475;&#30340;javadoc&#12290;&#20063;&#21487;&#20197;&#30475;&#30475;&#19979;&#38754;&#30340;&#35201;&#28857;<a class="link" href="">programmatic registration of <code class="literal">BeanPostProcessors</code></a></p>
<p>[&#27880;&#24847;]</p>
<div class="informalexample">
<p><code class="literal">BeanPostProcessor</code>s &#20316;&#29992;&#22312;&#19968;&#20010;bean(&#25110;&#32773;&#23545;&#35937;)&#30340;<span class="emphasis"><em>&#23454;&#20363;</em></span>&#19978;;&#20063;&#23601;&#26159;&#35828;&#65292;Spring IoC&#23454;&#20363;&#21270;&#19968;&#20010;bean&#23454;&#20363;&#20043;&#21518;&#65292;
<code class="literal">BeanPostProcessor</code>s&#65292;&#25165;&#24320;&#22987;&#36827;&#34892;&#22788;&#29702;&#12290;</p>
<p><code class="literal">BeanPostProcessor</code>s&#20316;&#29992;&#33539;&#22260;&#26159;<span class="emphasis"><em>&#27599;&#19968;&#20010;&#23481;&#22120;</em></span>&#12290;&#36825;&#20165;&#20165;&#21644;&#20320;&#27491;&#22312;&#20351;&#29992;&#23481;&#22120;&#26377;&#20851;&#12290;&#22914;&#26524;&#20320;&#22312;&#19968;&#20010;&#23481;&#22120;&#20013;&#23450;&#20041;&#20102;&#19968;&#20010;<code class="literal">BeanPostProcessor</code>
&#65292;&#23427;&#23558; <span class="emphasis"><em>&#20165;&#20165;</em></span> &#21518;&#32622;&#22788;&#29702;&#37027;&#20010;&#23481;&#22120;&#20013;&#30340;beans&#12290;&#25442;&#35328;&#20043;&#65292;&#19968;&#20010;&#23481;&#22120;&#20013;&#30340;beans&#19981;&#20250;&#34987;&#21478;&#19968;&#20010;&#65292;&#23481;&#22120;&#20013;&#30340;<code class="literal">BeanPostProcessor</code>&#22788;&#29702;&#65292;&#21363;&#20351;&#36825;&#20004;&#20010;&#23481;&#22120;&#65292;&#20855;&#26377;&#30456;&#21516;&#30340;&#29238;&#31867;&#12290;</p>
<p>&#20026;&#20102;&#25913;&#21464;&#23454;&#38469;&#30340;bean&#23450;&#20041;(&#20363;&#22914;&#65292; <span class="emphasis"><em>blueprint</em></span> &#23450;&#20041;&#30340;bean)&#65292;&#20320;&#21453;&#32780;&#38656;&#35201;&#20351;&#29992;<code class="literal">BeanFactoryPostProcessor</code>&#65292;&#23601;&#20687;&#22312;<a class="xref" href="beans.html#beans-factory-extension-factory-postprocessors" title="5.8.2&nbsp;Customizing configuration metadata with a BeanFactoryPostProcessor">Section&nbsp;5.8.2, &#8220;Customizing configuration metadata with a BeanFactoryPostProcessor&#8221;</a>&#20013;&#25551;&#36848;&#30340;&#37027;&#26679;&#12290;</p>
</div>

<p><code class="literal">org.springframework.beans.factory.config.BeanPostProcessor</code> &#25509;&#21475;&#65292;&#24688;&#22909;&#26377;&#20004;&#20010;&#22238;&#35843;&#26041;&#27861;&#32452;&#25104;&#12290;
&#24403;&#36825;&#26679;&#30340;&#19968;&#20010;&#31867;&#27880;&#20876;&#20026;&#23481;&#22120;&#30340;&#19968;&#20010;&#21518;&#32622;&#22788;&#29702;&#22120;&#65292;&#30001;&#20110;&#27599;&#19968;&#20010;bean&#23454;&#20363;&#37117;&#26159;&#30001;&#23481;&#22120;&#21019;&#24314;&#30340;&#65292;&#36825;&#20010;&#21518;&#32622;&#22788;&#29702;&#22120;&#20250;&#20174;&#23481;&#22120;&#24471;&#21040;&#19968;&#20010;&#22238;&#35843;&#26041;&#27861;
&#22312;&#23481;&#22120;&#30340;&#21021;&#22987;&#21270;&#26041;&#27861;(&#27604;&#22914;InitializingBean&#30340;<span class="emphasis"><em>afterPropertiesSet()</em></span>&#21644;&#20219;&#20309;&#29983;&#21629;&#30340;&#21021;&#22987;&#21270;&#26041;&#27861;)&#34987;&#35843;&#29992;<span class="emphasis"><em>&#20043;&#21069;</em></span>&#21644;&#20219;&#20309;bean&#23454;&#20363;&#21270;&#22238;&#35843;<span class="emphasis"><em>&#20043;&#21518;</em></span>&#12290;
&#21518;&#32622;&#22788;&#29702;&#22120;&#65292;&#21487;&#20197;&#23545;bean&#37319;&#21462;&#20219;&#20309;&#25514;&#26045;&#65292;&#21253;&#25324;&#24573;&#30053;&#22238;&#21040;&#26041;&#27861;&#26159;&#21542;&#23436;&#25104;&#12290;&#19968;&#20010;bean&#21518;&#32622;&#22788;&#29702;&#22120;&#65292;&#36890;&#24120;&#20250;&#26816;&#26597;&#22238;&#35843;&#25509;&#21475;&#25110;&#32773;&#20351;&#29992;&#20195;&#29702;&#21253;&#35013;&#19968;&#20010;bean&#12290;&#19968;&#20123;
Spring AOP&#22522;&#30784;&#35774;&#26045;&#31867;&#65292;&#20026;&#20102;&#25552;&#20379;&#21253;&#35013;&#24335;&#30340;&#20195;&#29702;&#36923;&#36753;&#65292;&#34987;&#23454;&#29616;&#20026;bean&#21518;&#32622;&#22788;&#29702;&#22120;&#65292;</p>
<p>&#19968;&#20010;<code class="literal">ApplicationContext</code>&#65292;<span class="emphasis"><em>&#33258;&#21160;&#22320;&#26816;&#27979;</em></span>&#25152;&#26377;&#23450;&#20041;&#22312;&#37197;&#32622;&#20803;&#25991;&#20214;&#20013;&#65292;&#24182;&#23454;&#29616;&#20102;<code class="literal">BeanPostProcessor</code>&#25509;&#21475;&#30340;bean&#12290;
&#35813;<code class="literal">ApplicationContext</code>&#27880;&#20876;&#36825;&#20123;beans&#20316;&#20026;&#21518;&#32622;&#22788;&#29702;&#22120;&#65292;&#20351;&#20182;&#20204;&#21487;&#20197;&#22312;bean&#21019;&#24314;&#23436;&#25104;&#20043;&#21518;&#65292;&#34987;&#35843;&#29992;&#12290;
bean&#21518;&#32622;&#22788;&#29702;&#22120;&#21487;&#20197;&#20687;&#20854;&#20182;bean&#19968;&#26679;&#37096;&#32626;&#21040;&#23481;&#22120;&#20013;&#12290;</p>
<p>&#27880;&#24847;&#65292;&#24403;&#22312;&#19968;&#20010;&#37197;&#32622;&#31867;&#19978;&#65292;&#20351;&#29992;<code class="literal">@Bean</code>&#24037;&#21378;&#26041;&#27861;&#22768;&#26126;&#19968;&#20010; <code class="literal">BeanPostProcessor</code> &#65292;&#36820;&#22238;&#31867;&#22411;&#24212;&#35813;&#26159;&#23454;&#29616;&#31867;&#33258;&#36523;&#65292;
&#33267;&#23569;&#20063;&#35201;&#26159; <code class="literal">org.springframework.beans.factory.config.BeanPostProcessor</code>&#25509;&#21475;&#65292;&#35201;&#28165;&#26970;&#22320;&#34920;&#26126;&#36825;&#20010;bean&#30340;&#21518;&#32622;&#22788;&#29702;&#22120;&#26412;&#36136;&#29305;&#28857;&#12290;
&#27492;&#22806;&#65292;&#22312;&#23427;&#23436;&#20840;&#21019;&#24314;&#20043;&#21069;&#65292;<code class="literal">ApplicationContext</code>&#23558;&#19981;&#33021;&#36890;&#36807;&#31867;&#22411;&#33258;&#21160;&#25506;&#27979;&#23427;&#12290;&#30001;&#20110;&#19968;&#20010;<code class="literal">BeanPostProcessor</code>&#65292;&#26089;&#26399;&#23601;&#38656;&#35201;&#34987;&#23454;&#20363;&#21270;&#65292;
&#20197;&#36866;&#24212;&#19978;&#19979;&#25991;&#20013;&#20854;&#20182;bean&#30340;&#23454;&#20363;&#21270;&#65292;&#22240;&#27492;&#36825;&#20010;&#26089;&#26399;&#30340;&#31867;&#22411;&#26816;&#26597;&#26159;&#33267;&#20851;&#37325;&#35201;&#30340;&#12290;</p>
<p>[&#27880;&#24847;]</p>
<div class="informalexample">
<p><span class="strong"><strong>&#32534;&#31243;&#24335;&#27880;&#20876; BeanPostProcessors</strong></span>
&#34429;&#28982;&#25512;&#33616;&#20351;&#29992;<code class="literal">ApplicationContext</code>&#30340;&#33258;&#21160;&#26816;&#27979;&#26469;&#27880;&#20876;<code class="literal">BeanPostProcessor</code>&#65292;&#20294;&#26159;&#23545;&#20110;&#20351;&#29992;&#20102;<code class="literal">addBeanPostProcessor</code>&#26041;&#27861;&#30340;<code class="literal">ConfigurableBeanFactory</code>&#20063;&#21487;&#20197;&#32534;&#31243;&#24335;&#22320;&#27880;&#20876;&#20182;&#20204;&#12290;
&#22312;&#27880;&#20876;&#20043;&#21069;&#65292;&#25110;&#32773;&#26159;&#22312;&#32487;&#25215;&#23618;&#27425;&#30340;&#19978;&#19979;&#25991;&#20043;&#38388;&#22797;&#21046;bean&#21518;&#32622;&#22788;&#29702;&#22120;&#65292;&#38656;&#35201;&#23545;&#36923;&#36753;&#36827;&#34892;&#26465;&#20214;&#24335;&#30340;&#35780;&#20272;&#26102;&#65292;&#36825;&#26159;&#26377;&#29992;&#30340;&#12290;&#20294;&#26159;&#35831;&#27880;&#24847;&#65292;&#32534;&#31243;&#22320;&#28155;&#21152;&#30340;<code class="literal">BeanPostProcessors</code> <span class="emphasis"><em>&#19981;&#38656;&#35201;&#32771;&#34385;<code class="literal">Ordered</code>&#25509;&#21475; </em></span>&#12290;
&#20063;&#23601;&#26159;<span class="emphasis"><em>&#27880;&#20876;&#30340;&#39034;&#24207;</em></span>&#20915;&#23450;&#20102;<span class="emphasis"><em>&#25191;&#34892;&#30340;&#39034;&#24207;</em></span>&#12290;&#20063;&#35201;&#27880;&#24847;&#65292;&#32534;&#31243;&#24335;&#27880;&#20876;&#30340;<code class="literal">BeanPostProcessors</code>&#65292;&#24635;&#26159;&#39044;&#20808;&#34987;&#22788;&#29702;----&#26089;&#20110;&#36890;&#36807;&#33258;&#21160;&#26816;&#27979;&#26041;&#24335;&#27880;&#20876;&#30340;&#65292;&#21516;&#26102;&#24573;&#30053;
&#20219;&#20309;&#26126;&#30830;&#30340;&#25490;&#24207;</p>
</div>

<p>[&#27880;&#24847;]</p>
<div class="informalexample">
<p><span class="strong"><strong>BeanPostProcessors &#21644; AOP &#33258;&#21160;&#20195;&#29702;</strong></span>
&#23454;&#29616;&#20102;<code class="literal">BeanPostProcessor</code>&#25509;&#21475;&#30340;&#31867;&#26159;<span class="emphasis"><em>&#29305;&#27530;</em></span>&#30340;,&#20250;&#34987;&#23481;&#22120;&#29305;&#27530;&#22788;&#29702;&#12290;&#25152;&#26377;<code class="literal">BeanPostProcessors`__&#21644;&#20182;&#20204;&#30452;&#25509;&#24341;&#29992;&#30340;
beans__&#37117;&#20250;&#22312;&#23481;&#22120;&#21551;&#21160;&#30340;&#26102;&#20505;&#34987;&#23454;&#20363;&#21270;,&#20316;&#20026;`ApplicationContext</code>&#29305;&#27530;&#21551;&#21160;&#38454;&#27573;&#30340;&#19968;&#37096;&#20998;&#12290;&#25509;&#30528;&#65292;&#25152;&#26377;&#30340;<code class="literal">BeanPostProcessors</code>
&#20197;&#19968;&#20010;&#26377;&#24207;&#30340;&#26041;&#24335;&#65292;&#36827;&#34892;&#27880;&#20876;&#65292;&#24182;&#24212;&#29992;&#20110;&#23481;&#22120;&#20013;&#30340;&#19968;&#20999;bean&#12290;&#22240;&#20026;AOP&#33258;&#21160;&#20195;&#29702;&#26412;&#36523;&#34987;&#23454;&#29616;&#20026;<code class="literal">BeanPostProcessor</code>&#65292; &#36825;&#20010;<code class="literal">BeanPostProcessors</code>
&#21644;&#23427;&#30452;&#25509;&#24212;&#29992;&#30340;beans&#37117;&#27809;&#26377;&#36164;&#26684;&#36827;&#34892;&#33258;&#21160;&#20195;&#29702;&#65292;&#36825;&#26679;&#23601;&#27809;&#26377;&#20999;&#38754;&#32534;&#32455;&#21040;&#20182;&#20204;&#37324;&#38754;&#12290;</p>
<p>&#23545;&#20110;&#25152;&#26377;&#36825;&#26679;&#30340;bean&#65292;&#20320;&#20250;&#30475;&#21040;&#19968;&#20010;info&#26085;&#24535;&#65306;"<span class="emphasis"><em>Bean foo &#27809;&#26377;&#36164;&#26684;&#33719;&#21462;&#20219;&#20309;BeanPostProcessor&#25509;&#21475;&#30340;&#22788;&#29702;(&#20363;&#22914;&#65292;&#27809;&#26377;&#36164;&#26684;&#33719;&#21462;&#33258;&#21160;&#20195;&#29702;&#30340;)</em></span>".</p>
<p>&#27880;&#24847;&#65292;&#22914;&#26524;&#20320;&#26377;beans&#20351;&#29992;&#33258;&#21160;&#35013;&#37197;&#25110;&#32773;<code class="literal">@Resource</code> &#35013;&#37197;&#21040;&#20102;&#20320;&#30340;<code class="literal">BeanPostProcessor</code>&#20013;&#65292;&#24403;&#26681;&#25454;&#20505;&#36873;&#20381;&#36182;&#65292;&#25628;&#32034;&#21305;&#37197;&#31867;&#22411;&#26102;&#65292;Spring&#20063;&#35768;&#20250;&#35775;&#38382;&#24847;&#22806;&#31867;&#22411;&#30340;bean&#65307;
&#22240;&#27492;&#65292;&#20351;&#23427;&#20204;&#27809;&#26377;&#36164;&#26684;&#36827;&#34892;&#33258;&#21160;&#20195;&#29702;&#65292;&#25110;&#32773;&#20854;&#20182;&#31867;&#22411;&#30340;bean&#21518;&#32622;&#22788;&#29702;&#12290;&#20363;&#22914;&#65292;&#20320;&#20351;&#29992;<code class="literal">@Resource</code>&#27880;&#35299;&#19968;&#20010;&#20381;&#36182;&#65292;&#20854;&#20013;&#23383;&#27573;&#25110;&#32773;set&#26041;&#27861;&#21517;&#65292;&#19981;&#26159;&#21644;bean&#22768;&#26126;&#30340;&#21517;&#23383;&#30452;&#25509;&#23545;&#24212;
&#21516;&#26102;&#27809;&#26377;name&#23646;&#24615;&#34987;&#20351;&#29992;&#65292;&#28982;&#21518;&#65292;Spring&#23558;&#20250;&#26681;&#25454;&#31867;&#22411;&#65292;&#35775;&#38382;&#20854;&#20182;beans&#36827;&#34892;&#21305;&#37197;&#12290;</p>
</div>

<p>&#19979;&#38754;&#30340;&#31034;&#20363;&#26174;&#31034;&#20102;&#22914;&#20309;&#32534;&#20889;&#65292;&#27880;&#20876;&#21644;&#22312;&#19968;&#20010;<code class="literal">ApplicationContext</code>&#20013;&#20351;&#29992;<code class="literal">BeanPostProcessor</code>&#12290;</p>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-factory-extension-bpp-examples-hw" href="#beans-factory-extension-bpp-examples-hw"></a>Example: Hello World, BeanPostProcessor-style</h4></div></div></div>

<p>This first example illustrates basic usage. The example shows a custom
<code class="literal">BeanPostProcessor</code> implementation that invokes the <code class="literal">toString()</code> method of each bean as
it is created by the container and prints the resulting string to the system console.</p>
<p>Find below the custom <code class="literal">BeanPostProcessor</code> implementation class definition:</p>
<pre class="programlisting"><span class="hl-keyword">package</span> scripting;

<span class="hl-keyword">import</span> org.springframework.beans.factory.config.BeanPostProcessor;
<span class="hl-keyword">import</span> org.springframework.beans.BeansException;

<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> InstantiationTracingBeanPostProcessor <span class="hl-keyword">implements</span> BeanPostProcessor {

    <span class="hl-comment">// simply return the instantiated bean as-is</span>
    <span class="hl-keyword">public</span> Object postProcessBeforeInitialization(Object bean,
            String beanName) <span class="hl-keyword">throws</span> BeansException {
        <span class="hl-keyword">return</span> bean; <span class="hl-comment">// we could potentially return any object reference here...</span>
    }

    <span class="hl-keyword">public</span> Object postProcessAfterInitialization(Object bean,
            String beanName) <span class="hl-keyword">throws</span> BeansException {
        System.out.println(<span class="hl-string">"Bean </span><span class="emphasis"><em>'" + beanName + "</em></span><span class="hl-string">' created : " + bean.toString());
</span>        <span class="hl-keyword">return</span> bean;
    }

}</pre>

<pre class="programlisting"><span class="hl-directive" style="color: maroon">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="hl-tag">&lt;beans</span> <span class="hl-attribute">xmlns</span>=<span class="hl-value">"http://www.springframework.org/schema/beans"</span>
    <span class="hl-attribute">xmlns:xsi</span>=<span class="hl-value">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hl-attribute">xmlns:lang</span>=<span class="hl-value">"http://www.springframework.org/schema/lang"</span>
    <span class="hl-attribute">xsi:schemaLocation</span>=<span class="hl-value">"http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/lang
        http://www.springframework.org/schema/lang/spring-lang.xsd"</span><span class="hl-tag">&gt;</span>

    <span class="hl-tag">&lt;lang:groovy</span> <span class="hl-attribute">id</span>=<span class="hl-value">"messenger"</span>
            <span class="hl-attribute">script-source</span>=<span class="hl-value">"classpath:org/springframework/scripting/groovy/Messenger.groovy"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;lang:property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"message"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"Fiona Apple Is Just So Dreamy."</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;/lang:groovy&gt;</span>

    <span class="hl-comment">&lt;!--
    when the above bean (messenger) is instantiated, this custom
    BeanPostProcessor implementation will output the fact to the system console
    --&gt;</span>
    <span class="hl-tag">&lt;bean</span> <span class="hl-attribute">class</span>=<span class="hl-value">"scripting.InstantiationTracingBeanPostProcessor"</span><span class="hl-tag">/&gt;</span>

<span class="hl-tag">&lt;/beans&gt;</span></pre>

<p>Notice how the <code class="literal">InstantiationTracingBeanPostProcessor</code> is simply defined. It does not
even have a name, and because it is a bean it can be dependency-injected just like any
other bean. (The preceding configuration also defines a bean that is backed by a Groovy
script. The Spring dynamic language support is detailed in the chapter entitled
<a class="xref" href="dynamic-language.html" title="28.&nbsp;Dynamic language support">Chapter&nbsp;28, <i>Dynamic language support</i></a>.)</p>
<p>The following simple Java application executes the preceding code and configuration:</p>
<pre class="programlisting"><span class="hl-keyword">import</span> org.springframework.context.ApplicationContext;
<span class="hl-keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;
<span class="hl-keyword">import</span> org.springframework.scripting.Messenger;

<span class="hl-keyword">public</span> <span class="hl-keyword">final</span> <span class="hl-keyword">class</span> Boot {

    <span class="hl-keyword">public</span> <span class="hl-keyword">static</span> <span class="hl-keyword">void</span> main(<span class="hl-keyword">final</span> String[] args) <span class="hl-keyword">throws</span> Exception {
        ApplicationContext ctx = <span class="hl-keyword">new</span> ClassPathXmlApplicationContext(<span class="hl-string">"scripting/beans.xml"</span>);
        Messenger messenger = (Messenger) ctx.getBean(<span class="hl-string">"messenger"</span>);
        System.out.println(messenger);
    }

}</pre>

<p>The output of the preceding application resembles the following:</p>

<pre class="literallayout">Bean <span class="emphasis"><em>messenger</em></span> created : org.springframework.scripting.groovy.GroovyMessenger@272961
org.springframework.scripting.groovy.GroovyMessenger@272961</pre>

</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-factory-extension-bpp-examples-rabpp" href="#beans-factory-extension-bpp-examples-rabpp"></a>Example: The RequiredAnnotationBeanPostProcessor</h4></div></div></div>

<p>Using callback interfaces or annotations in conjunction with a custom
<code class="literal">BeanPostProcessor</code> implementation is a common means of extending the Spring IoC
container. An example is Spring&#8217;s <code class="literal">RequiredAnnotationBeanPostProcessor</code> - a
<code class="literal">BeanPostProcessor</code> implementation that ships with the Spring distribution which ensures
that JavaBean properties on beans that are marked with an (arbitrary) annotation are
actually (configured to be) dependency-injected with a value.</p>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="beans-factory-extension-factory-postprocessors" href="#beans-factory-extension-factory-postprocessors"></a>5.8.2&nbsp;Customizing configuration metadata with a BeanFactoryPostProcessor</h3></div></div></div>

<p>The next extension point that we will look at is the
<code class="literal">org.springframework.beans.factory.config.BeanFactoryPostProcessor</code>. The semantics of
this interface are similar to those of the <code class="literal">BeanPostProcessor</code>, with one major
difference: <code class="literal">BeanFactoryPostProcessor</code> operates on the <span class="emphasis"><em>bean configuration metadata</em></span>;
that is, the Spring IoC container allows a <code class="literal">BeanFactoryPostProcessor</code> to read the
configuration metadata and potentially change it <span class="emphasis"><em>before</em></span> the container instantiates
any beans other than <code class="literal">BeanFactoryPostProcessors</code>.</p>
<p>You can configure multiple <code class="literal">BeanFactoryPostProcessors</code>, and you can control the order in
which these <code class="literal">BeanFactoryPostProcessors</code> execute by setting the <code class="literal">order</code> property.
However, you can only set this property if the <code class="literal">BeanFactoryPostProcessor</code> implements the
<code class="literal">Ordered</code> interface. If you write your own <code class="literal">BeanFactoryPostProcessor</code>, you should
consider implementing the <code class="literal">Ordered</code> interface too. Consult the javadocs of the
<code class="literal">BeanFactoryPostProcessor</code> and <code class="literal">Ordered</code> interfaces for more details.</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p>If you want to change the actual bean <span class="emphasis"><em>instances</em></span> (i.e., the objects that are created
from the configuration metadata), then you instead need to use a <code class="literal">BeanPostProcessor</code>
(described above in <a class="xref" href="beans.html#beans-factory-extension-bpp" title="5.8.1&nbsp;&#20351;&#29992;BeanPostProcessor&#33258;&#23450;&#20041;beans">Section&nbsp;5.8.1, &#8220;&#20351;&#29992;BeanPostProcessor&#33258;&#23450;&#20041;beans&#8221;</a>). While it is technically possible
to work with bean instances within a <code class="literal">BeanFactoryPostProcessor</code> (e.g., using
<code class="literal">BeanFactory.getBean()</code>), doing so causes premature bean instantiation, violating the
standard container lifecycle. This may cause negative side effects such as bypassing
bean post processing.</p>
<p>Also, <code class="literal">BeanFactoryPostProcessors</code> are scoped <span class="emphasis"><em>per-container</em></span>. This is only relevant if
you are using container hierarchies. If you define a <code class="literal">BeanFactoryPostProcessor</code> in one
container, it will <span class="emphasis"><em>only</em></span> be applied to the bean definitions in that container. Bean
definitions in one container will not be post-processed by <code class="literal">BeanFactoryPostProcessors</code>
in another container, even if both containers are part of the same hierarchy.</p>
</td></tr></table></div>

<p>A bean factory post-processor is executed automatically when it is declared inside an
<code class="literal">ApplicationContext</code>, in order to apply changes to the configuration metadata that
define the container. Spring includes a number of predefined bean factory
post-processors, such as <code class="literal">PropertyOverrideConfigurer</code> and
<code class="literal">PropertyPlaceholderConfigurer</code>. A custom <code class="literal">BeanFactoryPostProcessor</code> can also be used,
for example, to register custom property editors.</p>
<p><a name="null" href="#null"></a>An <code class="literal">ApplicationContext</code> automatically detects any beans that are deployed into it that
implement the <code class="literal">BeanFactoryPostProcessor</code> interface. It uses these beans as bean factory
post-processors, at the appropriate time. You can deploy these post-processor beans as
you would any other bean.</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p>As with <code class="literal">BeanPostProcessor</code>s , you typically do not want to configure
<code class="literal">BeanFactoryPostProcessor</code>s for lazy initialization. If no other bean references a
<code class="literal">Bean(Factory)PostProcessor</code>, that post-processor will not get instantiated at all.
Thus, marking it for lazy initialization will be ignored, and the
<code class="literal">Bean(Factory)PostProcessor</code> will be instantiated eagerly even if you set the
<code class="literal">default-lazy-init</code> attribute to <code class="literal">true</code> on the declaration of your <code class="literal">&lt;beans /&gt;</code> element.</p>
</td></tr></table></div>

<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-factory-placeholderconfigurer" href="#beans-factory-placeholderconfigurer"></a>Example: the Class name substitution PropertyPlaceholderConfigurer</h4></div></div></div>

<p>You use the <code class="literal">PropertyPlaceholderConfigurer</code> to externalize property values from a bean
definition in a separate file using the standard Java <code class="literal">Properties</code> format. Doing so
enables the person deploying an application to customize environment-specific properties
such as database URLs and passwords, without the complexity or risk of modifying the
main XML definition file or files for the container.</p>
<p>Consider the following XML-based configuration metadata fragment, where a <code class="literal">DataSource</code>
with placeholder values is defined. The example shows properties configured from an
external <code class="literal">Properties</code> file. At runtime, a <code class="literal">PropertyPlaceholderConfigurer</code> is applied to
the metadata that will replace some properties of the DataSource. The values to replace
are specified as <span class="emphasis"><em>placeholders</em></span> of the form <code class="literal">${property-name}</code> which follows the Ant /
log4j / JSP EL style.</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">class</span>=<span class="hl-value">"org.springframework.beans.factory.config.PropertyPlaceholderConfigurer"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"locations"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"classpath:com/foo/jdbc.properties"</span><span class="hl-tag">/&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span>

<span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"dataSource"</span> <span class="hl-attribute">destroy-method</span>=<span class="hl-value">"close"</span>
        <span class="hl-attribute">class</span>=<span class="hl-value">"org.apache.commons.dbcp.BasicDataSource"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"driverClassName"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"${jdbc.driverClassName}"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"url"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"${jdbc.url}"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"username"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"${jdbc.username}"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"password"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"${jdbc.password}"</span><span class="hl-tag">/&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span></pre>

<p>The actual values come from another file in the standard Java <code class="literal">Properties</code> format:</p>

<pre class="literallayout">jdbc.driverClassName=org.hsqldb.jdbcDriver
jdbc.url=jdbc:hsqldb:hsql://production:9002
jdbc.username=sa
jdbc.password=root</pre>

<p>Therefore, the string <code class="literal">${jdbc.username}</code> is replaced at runtime with the value <span class="emphasis"><em>sa</em></span>, and
the same applies for other placeholder values that match keys in the properties file.
The <code class="literal">PropertyPlaceholderConfigurer</code> checks for placeholders in most properties and
attributes of a bean definition. Furthermore, the placeholder prefix and suffix can be
customized.</p>
<p>With the <code class="literal">context</code> namespace introduced in Spring 2.5, it is possible to configure
property placeholders with a dedicated configuration element. One or more locations can
be provided as a comma-separated list in the <code class="literal">location</code> attribute.</p>
<pre class="programlisting"><span class="hl-tag">&lt;context:property-placeholder</span> <span class="hl-attribute">location</span>=<span class="hl-value">"classpath:com/foo/jdbc.properties"</span><span class="hl-tag">/&gt;</span></pre>

<p>The <code class="literal">PropertyPlaceholderConfigurer</code> not only looks for properties in the <code class="literal">Properties</code>
file you specify. By default it also checks against the Java <code class="literal">System</code> properties if it
cannot find a property in the specified properties files. You can customize this
behavior by setting the <code class="literal">systemPropertiesMode</code> property of the configurer with one of
the following three supported integer values:</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="emphasis"><em>never</em></span> (0): Never check system properties
</li><li class="listitem">
<span class="emphasis"><em>fallback</em></span> (1): Check system properties if not resolvable in the specified
properties files. This is the default.
</li><li class="listitem">
<span class="emphasis"><em>override</em></span> (2): Check system properties first, before trying the specified
properties files. This allows system properties to override any other property source.
</li></ul></div>

<p>Consult the <code class="literal">PropertyPlaceholderConfigurer</code> javadocs for more information.</p>
<div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="images/tip.png"></td><th align="left">Tip</th></tr><tr><td align="left" valign="top">
<p>You can use the <code class="literal">PropertyPlaceholderConfigurer</code> to substitute class names, which is
sometimes useful when you have to pick a particular implementation class at runtime. For
example:</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">class</span>=<span class="hl-value">"org.springframework.beans.factory.config.PropertyPlaceholderConfigurer"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"locations"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;value&gt;</span>classpath:com/foo/strategy.properties<span class="hl-tag">&lt;/value&gt;</span>
    <span class="hl-tag">&lt;/property&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"properties"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;value&gt;</span>custom.strategy.class=com.foo.DefaultStrategy<span class="hl-tag">&lt;/value&gt;</span>
    <span class="hl-tag">&lt;/property&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span>

<span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"serviceStrategy"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"${custom.strategy.class}"</span><span class="hl-tag">/&gt;</span></pre>

<p>If the class cannot be resolved at runtime to a valid class, resolution of the bean
fails when it is about to be created, which is during the <code class="literal">preInstantiateSingletons()</code>
phase of an <code class="literal">ApplicationContext</code> for a non-lazy-init bean.</p>
</td></tr></table></div>

</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-factory-overrideconfigurer" href="#beans-factory-overrideconfigurer"></a>Example: the PropertyOverrideConfigurer</h4></div></div></div>

<p>The <code class="literal">PropertyOverrideConfigurer</code>, another bean factory post-processor, resembles the
<code class="literal">PropertyPlaceholderConfigurer</code>, but unlike the latter, the original definitions can
have default values or no values at all for bean properties. If an overriding
<code class="literal">Properties</code> file does not have an entry for a certain bean property, the default
context definition is used.</p>
<p>Note that the bean definition is <span class="emphasis"><em>not</em></span> aware of being overridden, so it is not
immediately obvious from the XML definition file that the override configurer is being
used. In case of multiple <code class="literal">PropertyOverrideConfigurer</code> instances that define different
values for the same bean property, the last one wins, due to the overriding mechanism.</p>
<p>Properties file configuration lines take this format:</p>

<pre class="literallayout">beanName.property=value</pre>

<p>For example:</p>

<pre class="literallayout">dataSource.driverClassName=com.mysql.jdbc.Driver
dataSource.url=jdbc:mysql:mydb</pre>

<p>This example file can be used with a container definition that contains a bean called
<span class="emphasis"><em>dataSource</em></span>, which has <span class="emphasis"><em>driver</em></span> and <span class="emphasis"><em>url</em></span> properties.</p>
<p>Compound property names are also supported, as long as every component of the path
except the final property being overridden is already non-null (presumably initialized
by the constructors). In this example&#8230;</p>

<pre class="literallayout">foo.fred.bob.sammy=123</pre>

<div class="orderedlist"><ol class="orderedlist" type="i"><li class="listitem">
the <code class="literal">sammy</code> property of the <code class="literal">bob</code> property of the <code class="literal">fred</code> property of the <code class="literal">foo</code> bean
is set to the scalar value <code class="literal">123</code>.
</li></ol></div>

<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p>Specified override values are always <span class="emphasis"><em>literal</em></span> values; they are not translated into
bean references. This convention also applies when the original value in the XML bean
definition specifies a bean reference.</p>
</td></tr></table></div>

<p>With the <code class="literal">context</code> namespace introduced in Spring 2.5, it is possible to configure
property overriding with a dedicated configuration element:</p>
<pre class="programlisting"><span class="hl-tag">&lt;context:property-override</span> <span class="hl-attribute">location</span>=<span class="hl-value">"classpath:override.properties"</span><span class="hl-tag">/&gt;</span></pre>

</div>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="beans-factory-extension-factorybean" href="#beans-factory-extension-factorybean"></a>5.8.3&nbsp;Customizing instantiation logic with a FactoryBean</h3></div></div></div>

<p>Implement the <code class="literal">org.springframework.beans.factory.FactoryBean</code> interface for objects that
<span class="emphasis"><em>are themselves factories</em></span>.</p>
<p>The <code class="literal">FactoryBean</code> interface is a point of pluggability into the Spring IoC container&#8217;s
instantiation logic. If you have complex initialization code that is better expressed in
Java as opposed to a (potentially) verbose amount of XML, you can create your own
<code class="literal">FactoryBean</code>, write the complex initialization inside that class, and then plug your
custom <code class="literal">FactoryBean</code> into the container.</p>
<p>The <code class="literal">FactoryBean</code> interface provides three methods:</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<code class="literal">Object getObject()</code>: returns an instance of the object this factory creates. The
instance can possibly be shared, depending on whether this factory returns singletons
or prototypes.
</li><li class="listitem">
<code class="literal">boolean isSingleton()</code>: returns <code class="literal">true</code> if this <code class="literal">FactoryBean</code> returns singletons,
<code class="literal">false</code> otherwise.
</li><li class="listitem">
<code class="literal">Class getObjectType()</code>: returns the object type returned by the <code class="literal">getObject()</code> method
or <code class="literal">null</code> if the type is not known in advance.
</li></ul></div>

<p>The <code class="literal">FactoryBean</code> concept and interface is used in a number of places within the Spring
Framework; more than 50 implementations of the <code class="literal">FactoryBean</code> interface ship with Spring
itself.</p>
<p>When you need to ask a container for an actual <code class="literal">FactoryBean</code> instance itself instead of
the bean it produces, preface the bean&#8217;s id with the ampersand symbol ( <code class="literal">&amp;</code>) when
calling the <code class="literal">getBean()</code> method of the <code class="literal">ApplicationContext</code>. So for a given <code class="literal">FactoryBean</code>
with an id of <code class="literal">myBean</code>, invoking <code class="literal">getBean("myBean")</code> on the container returns the
product of the <code class="literal">FactoryBean</code>; whereas, invoking <code class="literal">getBean("&amp;myBean")</code> returns the
<code class="literal">FactoryBean</code> instance itself.</p>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="beans-annotation-config" href="#beans-annotation-config"></a>5.9&nbsp;Annotation-based container configuration</h2></div></div></div>

<div class="sidebar"><div class="titlepage"><div><div><p class="title"><b>Are annotations better than XML for configuring Spring?</b></p></div></div></div>

<p>The introduction of annotation-based configurations raised the question of whether this
approach is <span class="emphasis"><em>better</em></span> than XML. The short answer is <span class="emphasis"><em>it depends</em></span>. The long answer is
that each approach has its pros and cons, and usually it is up to the developer to
decide which strategy suits them better. Due to the way they are defined, annotations
provide a lot of context in their declaration, leading to shorter and more concise
configuration. However, XML excels at wiring up components without touching their source
code or recompiling them. Some developers prefer having the wiring close to the source
while others argue that annotated classes are no longer POJOs and, furthermore, that the
configuration becomes decentralized and harder to control.</p>
<p>No matter the choice, Spring can accommodate both styles and even mix them together.
It&#8217;s worth pointing out that through its <a class="link" href="beans.html#beans-java" title="5.12&nbsp;&#22522;&#20110;Java&#65288;Java-based&#65289;&#30340;&#23481;&#22120;&#37197;&#32622;">JavaConfig</a> option, Spring allows
annotations to be used in a non-invasive way, without touching the target components
source code and that in terms of tooling, all configuration styles are supported by the
<a class="ulink" href="https://spring.io/tools/sts" target="_top">Spring Tool Suite</a>.</p>
</div>

<p>An alternative to XML setups is provided by annotation-based configuration which rely on
the bytecode metadata for wiring up components instead of angle-bracket declarations.
Instead of using XML to describe a bean wiring, the developer moves the configuration
into the component class itself by using annotations on the relevant class, method, or
field declaration. As mentioned in <a class="xref" href="beans.html#beans-factory-extension-bpp-examples-rabpp" title="Example: The RequiredAnnotationBeanPostProcessor">the section called &#8220;Example: The RequiredAnnotationBeanPostProcessor&#8221;</a>, using
a <code class="literal">BeanPostProcessor</code> in conjunction with annotations is a common means of extending the
Spring IoC container. For example, Spring 2.0 introduced the possibility of enforcing
required properties with the <a class="link" href="beans.html#beans-required-annotation" title="5.9.1&nbsp;@Required">@Required</a> annotation. Spring
2.5 made it possible to follow that same general approach to drive Spring&#8217;s dependency
injection. Essentially, the <code class="literal">@Autowired</code> annotation provides the same capabilities as
described in <a class="xref" href="beans.html#beans-factory-autowire" title="5.4.5&nbsp;&#33258;&#21160;&#35013;&#37197;&#21327;&#20316;&#32773;">Section&nbsp;5.4.5, &#8220;&#33258;&#21160;&#35013;&#37197;&#21327;&#20316;&#32773;&#8221;</a> but with more fine-grained control and wider
applicability. Spring 2.5 also added support for JSR-250 annotations such as
<code class="literal">@PostConstruct</code>, and <code class="literal">@PreDestroy</code>. Spring 3.0 added support for JSR-330 (Dependency
Injection for Java) annotations contained in the javax.inject package such as <code class="literal">@Inject</code>
and <code class="literal">@Named</code>. Details about those annotations can be found in the
<a class="link" href="beans.html#beans-standard-annotations" title="5.11&nbsp;Using JSR 330 Standard Annotations">relevant section</a>.</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p>Annotation injection is performed <span class="emphasis"><em>before</em></span> XML injection, thus the latter
configuration will override the former for properties wired through both approaches.</p>
</td></tr></table></div>

<p>As always, you can register them as individual bean definitions, but they can also be
implicitly registered by including the following tag in an XML-based Spring
configuration (notice the inclusion of the <code class="literal">context</code> namespace):</p>
<pre class="programlisting"><span class="hl-directive" style="color: maroon">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="hl-tag">&lt;beans</span> <span class="hl-attribute">xmlns</span>=<span class="hl-value">"http://www.springframework.org/schema/beans"</span>
    <span class="hl-attribute">xmlns:xsi</span>=<span class="hl-value">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hl-attribute">xmlns:context</span>=<span class="hl-value">"http://www.springframework.org/schema/context"</span>
    <span class="hl-attribute">xsi:schemaLocation</span>=<span class="hl-value">"http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/context
        http://www.springframework.org/schema/context/spring-context.xsd"</span><span class="hl-tag">&gt;</span>

    <span class="hl-tag">&lt;context:annotation-config/&gt;</span>

<span class="hl-tag">&lt;/beans&gt;</span></pre>

<p>(The implicitly registered post-processors include
<a class="ulink" href="http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/beans/factory/annotation/AutowiredAnnotationBeanPostProcessor.html" target="_top"><code class="literal">AutowiredAnnotationBeanPostProcessor</code></a>,
 <a class="ulink" href="http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/context/annotation/CommonAnnotationBeanPostProcessor.html" target="_top"><code class="literal">CommonAnnotationBeanPostProcessor</code></a>,
 <a class="ulink" href="http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/orm/jpa/support/PersistenceAnnotationBeanPostProcessor.html" target="_top"><code class="literal">PersistenceAnnotationBeanPostProcessor</code></a>,
as well as the aforementioned
<a class="ulink" href="http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/beans/factory/annotation/RequiredAnnotationBeanPostProcessor.html" target="_top"><code class="literal">RequiredAnnotationBeanPostProcessor</code></a>.)</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p><code class="literal">&lt;context:annotation-config/&gt;</code> only looks for annotations on beans in the same
application context in which it is defined. This means that, if you put
<code class="literal">&lt;context:annotation-config/&gt;</code> in a <code class="literal">WebApplicationContext</code> for a <code class="literal">DispatcherServlet</code>,
it only checks for <code class="literal">@Autowired</code> beans in your controllers, and not your services. See
<a class="xref" href="mvc.html#mvc-servlet" title="16.2&nbsp;The DispatcherServlet">Section&nbsp;16.2, &#8220;The DispatcherServlet&#8221;</a> for more information.</p>
</td></tr></table></div>

<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="beans-required-annotation" href="#beans-required-annotation"></a>5.9.1&nbsp;@Required</h3></div></div></div>

<p>The <code class="literal">@Required</code> annotation applies to bean property setter methods, as in the following
example:</p>
<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> SimpleMovieLister {

    <span class="hl-keyword">private</span> MovieFinder movieFinder;

    <em><span class="hl-annotation" style="color: gray">@Required</span></em>
    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> setMovieFinder(MovieFinder movieFinder) {
        <span class="hl-keyword">this</span>.movieFinder = movieFinder;
    }

    <span class="hl-comment">// ...</span>

}</pre>

<p>This annotation simply indicates that the affected bean property must be populated at
configuration time, through an explicit property value in a bean definition or through
autowiring. The container throws an exception if the affected bean property has not been
populated; this allows for eager and explicit failure, avoiding <code class="literal">NullPointerException</code>s
or the like later on. It is still recommended that you put assertions into the bean
class itself, for example, into an init method. Doing so enforces those required
references and values even when you use the class outside of a container.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="beans-autowired-annotation" href="#beans-autowired-annotation"></a>5.9.2&nbsp;@Autowired</h3></div></div></div>

<p>As expected, you can apply the <code class="literal">@Autowired</code> annotation to "traditional" setter methods:</p>
<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> SimpleMovieLister {

    <span class="hl-keyword">private</span> MovieFinder movieFinder;

    <em><span class="hl-annotation" style="color: gray">@Autowired</span></em>
    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> setMovieFinder(MovieFinder movieFinder) {
        <span class="hl-keyword">this</span>.movieFinder = movieFinder;
    }

    <span class="hl-comment">// ...</span>

}</pre>

<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p>JSR 330&#8217;s @Inject annotation can be used in place of Spring&#8217;s <code class="literal">@Autowired</code> annotation in
the examples below. See <a class="link" href="beans.html#beans-standard-annotations" title="5.11&nbsp;Using JSR 330 Standard Annotations">here</a> for more details</p>
</td></tr></table></div>

<p>You can also apply the annotation to methods with arbitrary names and/or multiple
arguments:</p>
<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> MovieRecommender {

    <span class="hl-keyword">private</span> MovieCatalog movieCatalog;

    <span class="hl-keyword">private</span> CustomerPreferenceDao customerPreferenceDao;

    <em><span class="hl-annotation" style="color: gray">@Autowired</span></em>
    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> prepare(MovieCatalog movieCatalog,
            CustomerPreferenceDao customerPreferenceDao) {
        <span class="hl-keyword">this</span>.movieCatalog = movieCatalog;
        <span class="hl-keyword">this</span>.customerPreferenceDao = customerPreferenceDao;
    }

    <span class="hl-comment">// ...</span>

}</pre>

<p>You can apply <code class="literal">@Autowired</code> to constructors and fields:</p>
<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> MovieRecommender {

    <em><span class="hl-annotation" style="color: gray">@Autowired</span></em>
    <span class="hl-keyword">private</span> MovieCatalog movieCatalog;

    <span class="hl-keyword">private</span> CustomerPreferenceDao customerPreferenceDao;

    <em><span class="hl-annotation" style="color: gray">@Autowired</span></em>
    <span class="hl-keyword">public</span> MovieRecommender(CustomerPreferenceDao customerPreferenceDao) {
        <span class="hl-keyword">this</span>.customerPreferenceDao = customerPreferenceDao;
    }

    <span class="hl-comment">// ...</span>

}</pre>

<p>It is also possible to provide <span class="emphasis"><em>all</em></span> beans of a particular type from the
<code class="literal">ApplicationContext</code> by adding the annotation to a field or method that expects an array
of that type:</p>
<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> MovieRecommender {

    <em><span class="hl-annotation" style="color: gray">@Autowired</span></em>
    <span class="hl-keyword">private</span> MovieCatalog[] movieCatalogs;

    <span class="hl-comment">// ...</span>

}</pre>

<p>The same applies for typed collections:</p>
<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> MovieRecommender {

    <span class="hl-keyword">private</span> Set&lt;MovieCatalog&gt; movieCatalogs;

    <em><span class="hl-annotation" style="color: gray">@Autowired</span></em>
    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> setMovieCatalogs(Set&lt;MovieCatalog&gt; movieCatalogs) {
        <span class="hl-keyword">this</span>.movieCatalogs = movieCatalogs;
    }

    <span class="hl-comment">// ...</span>

}</pre>

<div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="images/tip.png"></td><th align="left">Tip</th></tr><tr><td align="left" valign="top">
<p>Your beans can implement the <code class="literal">org.springframework.core.Ordered</code> interface or either use
the <code class="literal">@Order</code> or standard <code class="literal">@Priority</code> annotation if you want items in the array or list
to be sorted into a specific order.</p>
</td></tr></table></div>

<p>Even typed Maps can be autowired as long as the expected key type is <code class="literal">String</code>. The Map
values will contain all beans of the expected type, and the keys will contain the
corresponding bean names:</p>
<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> MovieRecommender {

    <span class="hl-keyword">private</span> Map&lt;String, MovieCatalog&gt; movieCatalogs;

    <em><span class="hl-annotation" style="color: gray">@Autowired</span></em>
    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> setMovieCatalogs(Map&lt;String, MovieCatalog&gt; movieCatalogs) {
        <span class="hl-keyword">this</span>.movieCatalogs = movieCatalogs;
    }

    <span class="hl-comment">// ...</span>

}</pre>

<p>By default, the autowiring fails whenever <span class="emphasis"><em>zero</em></span> candidate beans are available; the
default behavior is to treat annotated methods, constructors, and fields as
indicating <span class="emphasis"><em>required</em></span> dependencies. This behavior can be changed as demonstrated below.</p>
<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> SimpleMovieLister {

    <span class="hl-keyword">private</span> MovieFinder movieFinder;

    <em><span class="hl-annotation" style="color: gray">@Autowired(required=false)</span></em>
    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> setMovieFinder(MovieFinder movieFinder) {
        <span class="hl-keyword">this</span>.movieFinder = movieFinder;
    }

    <span class="hl-comment">// ...</span>

}</pre>

<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p>Only <span class="emphasis"><em>one annotated constructor per-class</em></span> can be marked as <span class="emphasis"><em>required</em></span>, but multiple
non-required constructors can be annotated. In that case, each is considered among the
candidates and Spring uses the <span class="emphasis"><em>greediest</em></span> constructor whose dependencies can be
satisfied, that is the constructor that has the largest number of arguments.</p>
<p><code class="literal">@Autowired</code>'s <span class="emphasis"><em>required</em></span> attribute is recommended over the <code class="literal">@Required</code> annotation.
The <span class="emphasis"><em>required</em></span> attribute indicates that the property is not required for autowiring
purposes, the property is ignored if it cannot be autowired. <code class="literal">@Required</code>, on the other
hand, is stronger in that it enforces the property that was set by any means supported
by the container. If no value is injected, a corresponding exception is raised.</p>
</td></tr></table></div>

<p>You can also use <code class="literal">@Autowired</code> for interfaces that are well-known resolvable
dependencies: <code class="literal">BeanFactory</code>, <code class="literal">ApplicationContext</code>, <code class="literal">Environment</code>, <code class="literal">ResourceLoader</code>,
<code class="literal">ApplicationEventPublisher</code>, and <code class="literal">MessageSource</code>. These interfaces and their extended
interfaces, such as <code class="literal">ConfigurableApplicationContext</code> or <code class="literal">ResourcePatternResolver</code>, are
automatically resolved, with no special setup necessary.</p>
<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> MovieRecommender {

    <em><span class="hl-annotation" style="color: gray">@Autowired</span></em>
    <span class="hl-keyword">private</span> ApplicationContext context;

    <span class="hl-keyword">public</span> MovieRecommender() {
    }

    <span class="hl-comment">// ...</span>

}</pre>

<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p><code class="literal">@Autowired</code>, <code class="literal">@Inject</code>, <code class="literal">@Resource</code>, and <code class="literal">@Value</code> annotations are handled by a Spring
<code class="literal">BeanPostProcessor</code> implementations which in turn means that you <span class="emphasis"><em>cannot</em></span> apply these
annotations within your own <code class="literal">BeanPostProcessor</code> or <code class="literal">BeanFactoryPostProcessor</code> types (if
any). These types must be <span class="emphasis"><em>wired up</em></span> explicitly via XML or using a Spring <code class="literal">@Bean</code> method.</p>
</td></tr></table></div>

</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="beans-autowired-annotation-qualifiers" href="#beans-autowired-annotation-qualifiers"></a>5.9.3&nbsp;Fine-tuning annotation-based autowiring with qualifiers</h3></div></div></div>

<p>Because autowiring by type may lead to multiple candidates, it is often necessary to
have more control over the selection process. One way to accomplish this is with
Spring&#8217;s <code class="literal">@Qualifier</code> annotation. You can associate qualifier values with specific
arguments, narrowing the set of type matches so that a specific bean is chosen for each
argument. In the simplest case, this can be a plain descriptive value:</p>
<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> MovieRecommender {

    <em><span class="hl-annotation" style="color: gray">@Autowired</span></em>
    <span class="strong"><strong>@Qualifier("main")</strong></span>
    <span class="hl-keyword">private</span> MovieCatalog movieCatalog;

    <span class="hl-comment">// ...</span>

}</pre>

<p>The <code class="literal">@Qualifier</code> annotation can also be specified on individual constructor arguments or
method parameters:</p>
<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> MovieRecommender {

    <span class="hl-keyword">private</span> MovieCatalog movieCatalog;

    <span class="hl-keyword">private</span> CustomerPreferenceDao customerPreferenceDao;

    <em><span class="hl-annotation" style="color: gray">@Autowired</span></em>
    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> prepare(<span class="strong"><strong>@Qualifier("main")</strong></span>MovieCatalog movieCatalog,
            CustomerPreferenceDao customerPreferenceDao) {
        <span class="hl-keyword">this</span>.movieCatalog = movieCatalog;
        <span class="hl-keyword">this</span>.customerPreferenceDao = customerPreferenceDao;
    }

    <span class="hl-comment">// ...</span>

}</pre>

<p>The corresponding bean definitions appear as follows. The bean with qualifier value
"main" is wired with the constructor argument that is qualified with the same value.</p>
<pre class="programlisting"><span class="hl-directive" style="color: maroon">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="hl-tag">&lt;beans</span> <span class="hl-attribute">xmlns</span>=<span class="hl-value">"http://www.springframework.org/schema/beans"</span>
    <span class="hl-attribute">xmlns:xsi</span>=<span class="hl-value">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hl-attribute">xmlns:context</span>=<span class="hl-value">"http://www.springframework.org/schema/context"</span>
    <span class="hl-attribute">xsi:schemaLocation</span>=<span class="hl-value">"http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/context
        http://www.springframework.org/schema/context/spring-context.xsd"</span><span class="hl-tag">&gt;</span>

    <span class="hl-tag">&lt;context:annotation-config/&gt;</span>

    <span class="hl-tag">&lt;bean</span> <span class="hl-attribute">class</span>=<span class="hl-value">"example.SimpleMovieCatalog"</span><span class="hl-tag">&gt;</span>
        <span class="strong"><strong>&lt;qualifier value="main"/&gt;</strong></span>

        <span class="hl-comment">&lt;!-- inject any dependencies required by this bean --&gt;</span>
    <span class="hl-tag">&lt;/bean&gt;</span>

    <span class="hl-tag">&lt;bean</span> <span class="hl-attribute">class</span>=<span class="hl-value">"example.SimpleMovieCatalog"</span><span class="hl-tag">&gt;</span>
        <span class="strong"><strong>&lt;qualifier value="action"/&gt;</strong></span>

        <span class="hl-comment">&lt;!-- inject any dependencies required by this bean --&gt;</span>
    <span class="hl-tag">&lt;/bean&gt;</span>

    <span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"movieRecommender"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"example.MovieRecommender"</span><span class="hl-tag">/&gt;</span>

<span class="hl-tag">&lt;/beans&gt;</span></pre>

<p>For a fallback match, the bean name is considered a default qualifier value. Thus you
can define the bean with an id "main" instead of the nested qualifier element, leading
to the same matching result. However, although you can use this convention to refer to
specific beans by name, <code class="literal">@Autowired</code> is fundamentally about type-driven injection with
optional semantic qualifiers. This means that qualifier values, even with the bean name
fallback, always have narrowing semantics within the set of type matches; they do not
semantically express a reference to a unique bean id. Good qualifier values are "main"
or "EMEA" or "persistent", expressing characteristics of a specific component that are
independent from the bean id, which may be auto-generated in case of an anonymous bean
definition like the one in the preceding example.</p>
<p>Qualifiers also apply to typed collections, as discussed above, for example, to
<code class="literal">Set&lt;MovieCatalog&gt;</code>. In this case, all matching beans according to the declared
qualifiers are injected as a collection. This implies that qualifiers do not have to be
unique; they rather simply constitute filtering criteria. For example, you can define
multiple <code class="literal">MovieCatalog</code> beans with the same qualifier value "action"; all of which would
be injected into a <code class="literal">Set&lt;MovieCatalog&gt;</code> annotated with <code class="literal">@Qualifier("action")</code>.</p>
<div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="images/tip.png"></td><th align="left">Tip</th></tr><tr><td align="left" valign="top">
<p>If you intend to express annotation-driven injection by name, do not primarily use
<code class="literal">@Autowired</code>, even if is technically capable of referring to a bean name through
<code class="literal">@Qualifier</code> values. Instead, use the JSR-250 <code class="literal">@Resource</code> annotation, which is
semantically defined to identify a specific target component by its unique name, with
the declared type being irrelevant for the matching process.</p>
<p>As a specific consequence of this semantic difference, beans that are themselves defined
as a collection or map type cannot be injected through <code class="literal">@Autowired</code>, because type
matching is not properly applicable to them. Use <code class="literal">@Resource</code> for such beans, referring
to the specific collection or map bean by unique name.</p>
<p><code class="literal">@Autowired</code> applies to fields, constructors, and multi-argument methods, allowing for
narrowing through qualifier annotations at the parameter level. By contrast, <code class="literal">@Resource</code>
is supported only for fields and bean property setter methods with a single argument. As
a consequence, stick with qualifiers if your injection target is a constructor or a
multi-argument method.</p>
</td></tr></table></div>

<p>You can create your own custom qualifier annotations. Simply define an annotation and
provide the <code class="literal">@Qualifier</code> annotation within your definition:</p>
<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Target({ElementType.FIELD, ElementType.PARAMETER})</span></em>
<em><span class="hl-annotation" style="color: gray">@Retention(RetentionPolicy.RUNTIME)</span></em>
<span class="strong"><strong>@Qualifier</strong></span>
<span class="hl-keyword">public</span> <em><span class="hl-annotation" style="color: gray">@interface</span></em> Genre {

    String value();
}</pre>

<p>Then you can provide the custom qualifier on autowired fields and parameters:</p>
<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> MovieRecommender {

    <em><span class="hl-annotation" style="color: gray">@Autowired</span></em>
    <span class="strong"><strong>@Genre("Action")</strong></span>
    <span class="hl-keyword">private</span> MovieCatalog actionCatalog;
    <span class="hl-keyword">private</span> MovieCatalog comedyCatalog;

    <em><span class="hl-annotation" style="color: gray">@Autowired</span></em>
    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> setComedyCatalog(<span class="strong"><strong>@Genre("Comedy")</strong></span> MovieCatalog comedyCatalog) {
        <span class="hl-keyword">this</span>.comedyCatalog = comedyCatalog;
    }

    <span class="hl-comment">// ...</span>

}</pre>

<p>Next, provide the information for the candidate bean definitions. You can add
<code class="literal">&lt;qualifier/&gt;</code> tags as sub-elements of the <code class="literal">&lt;bean/&gt;</code> tag and then specify the <code class="literal">type</code> and
<code class="literal">value</code> to match your custom qualifier annotations. The type is matched against the
fully-qualified class name of the annotation. Or, as a convenience if no risk of
conflicting names exists, you can use the short class name. Both approaches are
demonstrated in the following example.</p>
<pre class="programlisting"><span class="hl-directive" style="color: maroon">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="hl-tag">&lt;beans</span> <span class="hl-attribute">xmlns</span>=<span class="hl-value">"http://www.springframework.org/schema/beans"</span>
    <span class="hl-attribute">xmlns:xsi</span>=<span class="hl-value">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hl-attribute">xmlns:context</span>=<span class="hl-value">"http://www.springframework.org/schema/context"</span>
    <span class="hl-attribute">xsi:schemaLocation</span>=<span class="hl-value">"http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/context
        http://www.springframework.org/schema/context/spring-context.xsd"</span><span class="hl-tag">&gt;</span>

    <span class="hl-tag">&lt;context:annotation-config/&gt;</span>

    <span class="hl-tag">&lt;bean</span> <span class="hl-attribute">class</span>=<span class="hl-value">"example.SimpleMovieCatalog"</span><span class="hl-tag">&gt;</span>
        <span class="strong"><strong>&lt;qualifier type="Genre" value="Action"/&gt;</strong></span>
        <span class="hl-comment">&lt;!-- inject any dependencies required by this bean --&gt;</span>
    <span class="hl-tag">&lt;/bean&gt;</span>

    <span class="hl-tag">&lt;bean</span> <span class="hl-attribute">class</span>=<span class="hl-value">"example.SimpleMovieCatalog"</span><span class="hl-tag">&gt;</span>
        <span class="strong"><strong>_&lt;qualifier type="example.Genre" value="Comedy"/&gt;</strong></span>
        <span class="hl-comment">&lt;!-- inject any dependencies required by this bean --&gt;</span>
    <span class="hl-tag">&lt;/bean&gt;</span>

    <span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"movieRecommender"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"example.MovieRecommender"</span><span class="hl-tag">/&gt;</span>

<span class="hl-tag">&lt;/beans&gt;</span></pre>

<p>In <a class="xref" href="beans.html#beans-classpath-scanning" title="5.10&nbsp;Classpath scanning and managed components">Section&nbsp;5.10, &#8220;Classpath scanning and managed components&#8221;</a>, you will see an annotation-based alternative to
providing the qualifier metadata in XML. Specifically, see <a class="xref" href="beans.html#beans-scanning-qualifiers" title="5.10.8&nbsp;Providing qualifier metadata with annotations">Section&nbsp;5.10.8, &#8220;Providing qualifier metadata with annotations&#8221;</a>.</p>
<p>In some cases, it may be sufficient to use an annotation without a value. This may be
useful when the annotation serves a more generic purpose and can be applied across
several different types of dependencies. For example, you may provide an <span class="emphasis"><em>offline</em></span>
catalog that would be searched when no Internet connection is available. First define
the simple annotation:</p>
<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Target({ElementType.FIELD, ElementType.PARAMETER})</span></em>
<em><span class="hl-annotation" style="color: gray">@Retention(RetentionPolicy.RUNTIME)</span></em>
<em><span class="hl-annotation" style="color: gray">@Qualifier</span></em>
<span class="hl-keyword">public</span> <em><span class="hl-annotation" style="color: gray">@interface</span></em> Offline {

}</pre>

<p>Then add the annotation to the field or property to be autowired:</p>
<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> MovieRecommender {

    <em><span class="hl-annotation" style="color: gray">@Autowired</span></em>
    <span class="strong"><strong>@Offline</strong></span>
    <span class="hl-keyword">private</span> MovieCatalog offlineCatalog;

    <span class="hl-comment">// ...</span>

}</pre>

<p>Now the bean definition only needs a qualifier <code class="literal">type</code>:</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">class</span>=<span class="hl-value">"example.SimpleMovieCatalog"</span><span class="hl-tag">&gt;</span>
    <span class="strong"><strong>&lt;qualifier type="Offline"/&gt;</strong></span>
    <span class="hl-comment">&lt;!-- inject any dependencies required by this bean --&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span></pre>

<p>You can also define custom qualifier annotations that accept named attributes in
addition to or instead of the simple <code class="literal">value</code> attribute. If multiple attribute values are
then specified on a field or parameter to be autowired, a bean definition must match
<span class="emphasis"><em>all</em></span> such attribute values to be considered an autowire candidate. As an example,
consider the following annotation definition:</p>
<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Target({ElementType.FIELD, ElementType.PARAMETER})</span></em>
<em><span class="hl-annotation" style="color: gray">@Retention(RetentionPolicy.RUNTIME)</span></em>
<em><span class="hl-annotation" style="color: gray">@Qualifier</span></em>
<span class="hl-keyword">public</span> <em><span class="hl-annotation" style="color: gray">@interface</span></em> MovieQualifier {

    String genre();

    Format format();

}</pre>

<p>In this case <code class="literal">Format</code> is an enum:</p>
<pre class="programlisting"><span class="hl-keyword">public</span> enum Format {
    VHS, DVD, BLURAY
}</pre>

<p>The fields to be autowired are annotated with the custom qualifier and include values
for both attributes: <code class="literal">genre</code> and <code class="literal">format</code>.</p>
<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> MovieRecommender {

    <em><span class="hl-annotation" style="color: gray">@Autowired</span></em>
    <em><span class="hl-annotation" style="color: gray">@MovieQualifier(format=Format.VHS, genre="Action")</span></em>
    <span class="hl-keyword">private</span> MovieCatalog actionVhsCatalog;

    <em><span class="hl-annotation" style="color: gray">@Autowired</span></em>
    <em><span class="hl-annotation" style="color: gray">@MovieQualifier(format=Format.VHS, genre="Comedy")</span></em>
    <span class="hl-keyword">private</span> MovieCatalog comedyVhsCatalog;

    <em><span class="hl-annotation" style="color: gray">@Autowired</span></em>
    <em><span class="hl-annotation" style="color: gray">@MovieQualifier(format=Format.DVD, genre="Action")</span></em>
    <span class="hl-keyword">private</span> MovieCatalog actionDvdCatalog;

    <em><span class="hl-annotation" style="color: gray">@Autowired</span></em>
    <em><span class="hl-annotation" style="color: gray">@MovieQualifier(format=Format.BLURAY, genre="Comedy")</span></em>
    <span class="hl-keyword">private</span> MovieCatalog comedyBluRayCatalog;

    <span class="hl-comment">// ...</span>

}</pre>

<p>Finally, the bean definitions should contain matching qualifier values. This example
also demonstrates that bean <span class="emphasis"><em>meta</em></span> attributes may be used instead of the
<code class="literal">&lt;qualifier/&gt;</code> sub-elements. If available, the <code class="literal">&lt;qualifier/&gt;</code> and its attributes take
precedence, but the autowiring mechanism falls back on the values provided within the
<code class="literal">&lt;meta/&gt;</code> tags if no such qualifier is present, as in the last two bean definitions in
the following example.</p>
<pre class="programlisting"><span class="hl-directive" style="color: maroon">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="hl-tag">&lt;beans</span> <span class="hl-attribute">xmlns</span>=<span class="hl-value">"http://www.springframework.org/schema/beans"</span>
    <span class="hl-attribute">xmlns:xsi</span>=<span class="hl-value">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hl-attribute">xmlns:context</span>=<span class="hl-value">"http://www.springframework.org/schema/context"</span>
    <span class="hl-attribute">xsi:schemaLocation</span>=<span class="hl-value">"http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/context
        http://www.springframework.org/schema/context/spring-context.xsd"</span><span class="hl-tag">&gt;</span>

    <span class="hl-tag">&lt;context:annotation-config/&gt;</span>

    <span class="hl-tag">&lt;bean</span> <span class="hl-attribute">class</span>=<span class="hl-value">"example.SimpleMovieCatalog"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;qualifier</span> <span class="hl-attribute">type</span>=<span class="hl-value">"MovieQualifier"</span><span class="hl-tag">&gt;</span>
            <span class="hl-tag">&lt;attribute</span> <span class="hl-attribute">key</span>=<span class="hl-value">"format"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"VHS"</span><span class="hl-tag">/&gt;</span>
            <span class="hl-tag">&lt;attribute</span> <span class="hl-attribute">key</span>=<span class="hl-value">"genre"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"Action"</span><span class="hl-tag">/&gt;</span>
        <span class="hl-tag">&lt;/qualifier&gt;</span>
        <span class="hl-comment">&lt;!-- inject any dependencies required by this bean --&gt;</span>
    <span class="hl-tag">&lt;/bean&gt;</span>

    <span class="hl-tag">&lt;bean</span> <span class="hl-attribute">class</span>=<span class="hl-value">"example.SimpleMovieCatalog"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;qualifier</span> <span class="hl-attribute">type</span>=<span class="hl-value">"MovieQualifier"</span><span class="hl-tag">&gt;</span>
            <span class="hl-tag">&lt;attribute</span> <span class="hl-attribute">key</span>=<span class="hl-value">"format"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"VHS"</span><span class="hl-tag">/&gt;</span>
            <span class="hl-tag">&lt;attribute</span> <span class="hl-attribute">key</span>=<span class="hl-value">"genre"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"Comedy"</span><span class="hl-tag">/&gt;</span>
        <span class="hl-tag">&lt;/qualifier&gt;</span>
        <span class="hl-comment">&lt;!-- inject any dependencies required by this bean --&gt;</span>
    <span class="hl-tag">&lt;/bean&gt;</span>

    <span class="hl-tag">&lt;bean</span> <span class="hl-attribute">class</span>=<span class="hl-value">"example.SimpleMovieCatalog"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;meta</span> <span class="hl-attribute">key</span>=<span class="hl-value">"format"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"DVD"</span><span class="hl-tag">/&gt;</span>
        <span class="hl-tag">&lt;meta</span> <span class="hl-attribute">key</span>=<span class="hl-value">"genre"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"Action"</span><span class="hl-tag">/&gt;</span>
        <span class="hl-comment">&lt;!-- inject any dependencies required by this bean --&gt;</span>
    <span class="hl-tag">&lt;/bean&gt;</span>

    <span class="hl-tag">&lt;bean</span> <span class="hl-attribute">class</span>=<span class="hl-value">"example.SimpleMovieCatalog"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;meta</span> <span class="hl-attribute">key</span>=<span class="hl-value">"format"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"BLURAY"</span><span class="hl-tag">/&gt;</span>
        <span class="hl-tag">&lt;meta</span> <span class="hl-attribute">key</span>=<span class="hl-value">"genre"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"Comedy"</span><span class="hl-tag">/&gt;</span>
        <span class="hl-comment">&lt;!-- inject any dependencies required by this bean --&gt;</span>
    <span class="hl-tag">&lt;/bean&gt;</span>

<span class="hl-tag">&lt;/beans&gt;</span></pre>

</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="beans-generics-as-qualifiers" href="#beans-generics-as-qualifiers"></a>5.9.4&nbsp;Using generics as autowiring qualifiers</h3></div></div></div>

<p>In addition to the <code class="literal">@Qualifier</code> annotation, it is also possible to use Java generic types
as an implicit form of qualification. For example, suppose you have the following
configuration:</p>
<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Configuration</span></em>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> MyConfiguration {

    <em><span class="hl-annotation" style="color: gray">@Bean</span></em>
    <span class="hl-keyword">public</span> StringStore stringStore() {
        <span class="hl-keyword">return</span> <span class="hl-keyword">new</span> StringStore();
    }

    <em><span class="hl-annotation" style="color: gray">@Bean</span></em>
    <span class="hl-keyword">public</span> IntegerStore integerStore() {
        <span class="hl-keyword">return</span> <span class="hl-keyword">new</span> IntegerStore();
    }

}</pre>

<p>Assuming that beans above implement a generic interface, i.e. <code class="literal">Store&lt;String&gt;</code> and
<code class="literal">Store&lt;Integer&gt;</code>, you can <code class="literal">@Autowire</code> the <code class="literal">Store</code> interface and the <span class="emphasis"><em>generic</em></span> will
be used as a qualifier:</p>
<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Autowired</span></em>
<span class="hl-keyword">private</span> Store&lt;String&gt; s1; <span class="hl-comment">// &lt;String&gt; qualifier, injects the stringStore bean</span>

<em><span class="hl-annotation" style="color: gray">@Autowired</span></em>
<span class="hl-keyword">private</span> Store&lt;Integer&gt; s2; <span class="hl-comment">// &lt;Integer&gt; qualifier, injects the integerStore bean</span></pre>

<p>Generic qualifiers also apply when autowiring Lists, Maps and Arrays:</p>
<pre class="programlisting"><span class="hl-comment">// Inject all Store beans as long as they have an &lt;Integer&gt; generic</span>
<span class="hl-comment">// Store&lt;String&gt; beans will not appear in this list</span>
<em><span class="hl-annotation" style="color: gray">@Autowired</span></em>
<span class="hl-keyword">private</span> List&lt;Store&lt;Integer&gt;&gt; s;</pre>

</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="beans-custom-autowire-configurer" href="#beans-custom-autowire-configurer"></a>5.9.5&nbsp;CustomAutowireConfigurer</h3></div></div></div>

<p>The
<a class="ulink" href="http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/beans/factory/annotation/CustomAutowireConfigurer.html" target="_top"><code class="literal">CustomAutowireConfigurer</code></a>
is a <code class="literal">BeanFactoryPostProcessor</code> that enables you to register your own custom qualifier
annotation types even if they are not annotated with Spring&#8217;s <code class="literal">@Qualifier</code> annotation.</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"customAutowireConfigurer"</span>
        <span class="hl-attribute">class</span>=<span class="hl-value">"org.springframework.beans.factory.annotation.CustomAutowireConfigurer"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"customQualifierTypes"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;set&gt;</span>
            <span class="hl-tag">&lt;value&gt;</span>example.CustomQualifier<span class="hl-tag">&lt;/value&gt;</span>
        <span class="hl-tag">&lt;/set&gt;</span>
    <span class="hl-tag">&lt;/property&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span></pre>

<p>The <code class="literal">AutowireCandidateResolver</code> determines autowire candidates by:</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
the <code class="literal">autowire-candidate</code> value of each bean definition
</li><li class="listitem">
any <code class="literal">default-autowire-candidates</code> pattern(s) available on the <code class="literal">&lt;beans/&gt;</code> element
</li><li class="listitem">
the presence of <code class="literal">@Qualifier</code> annotations and any custom annotations registered
with the <code class="literal">CustomAutowireConfigurer</code>
</li></ul></div>

<p>When multiple beans qualify as autowire candidates, the determination of a "primary" is
the following: if exactly one bean definition among the candidates has a <code class="literal">primary</code>
attribute set to <code class="literal">true</code>, it will be selected.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="beans-resource-annotation" href="#beans-resource-annotation"></a>5.9.6&nbsp;@Resource</h3></div></div></div>

<p>Spring also supports injection using the JSR-250 <code class="literal">@Resource</code> annotation on fields or
bean property setter methods. This is a common pattern in Java EE 5 and 6, for example
in JSF 1.2 managed beans or JAX-WS 2.0 endpoints. Spring supports this pattern for
Spring-managed objects as well.</p>
<p><code class="literal">@Resource</code> takes a name attribute, and by default Spring interprets that value as the
bean name to be injected. In other words, it follows <span class="emphasis"><em>by-name</em></span> semantics, as
demonstrated in this example:</p>
<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> SimpleMovieLister {

    <span class="hl-keyword">private</span> MovieFinder movieFinder;

    <span class="strong"><strong>@Resource(name="myMovieFinder")</strong></span>
    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> setMovieFinder(MovieFinder movieFinder) {
        <span class="hl-keyword">this</span>.movieFinder = movieFinder;
    }

}</pre>

<p>If no name is specified explicitly, the default name is derived from the field name or
setter method. In case of a field, it takes the field name; in case of a setter method,
it takes the bean property name. So the following example is going to have the bean with
name "movieFinder" injected into its setter method:</p>
<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> SimpleMovieLister {

    <span class="hl-keyword">private</span> MovieFinder movieFinder;

    <span class="strong"><strong>@Resource</strong></span>
    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> setMovieFinder(MovieFinder movieFinder) {
        <span class="hl-keyword">this</span>.movieFinder = movieFinder;
    }

}</pre>

<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p>The name provided with the annotation is resolved as a bean name by the
<code class="literal">ApplicationContext</code> of which the <code class="literal">CommonAnnotationBeanPostProcessor</code> is aware. The
names can be resolved through JNDI if you configure Spring&#8217;s
<a class="ulink" href="http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/jndi/support/SimpleJndiBeanFactory.html" target="_top"><code class="literal">SimpleJndiBeanFactory</code></a>
explicitly. However, it is recommended that you rely on the default behavior and simply
use Spring&#8217;s JNDI lookup capabilities to preserve the level of indirection.</p>
</td></tr></table></div>

<p>In the exclusive case of <code class="literal">@Resource</code> usage with no explicit name specified, and similar
to <code class="literal">@Autowired</code>, <code class="literal">@Resource</code> finds a primary type match instead of a specific named bean
and resolves well-known resolvable dependencies: the <code class="literal">BeanFactory</code>,
<code class="literal">ApplicationContext</code>, <code class="literal">ResourceLoader</code>, <code class="literal">ApplicationEventPublisher</code>, and <code class="literal">MessageSource</code>
interfaces.</p>
<p>Thus in the following example, the <code class="literal">customerPreferenceDao</code> field first looks for a bean
named customerPreferenceDao, then falls back to a primary type match for the type
<code class="literal">CustomerPreferenceDao</code>. The "context" field is injected based on the known resolvable
dependency type <code class="literal">ApplicationContext</code>.</p>
<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> MovieRecommender {

    <em><span class="hl-annotation" style="color: gray">@Resource</span></em>
    <span class="hl-keyword">private</span> CustomerPreferenceDao customerPreferenceDao;

    <em><span class="hl-annotation" style="color: gray">@Resource</span></em>
    <span class="hl-keyword">private</span> ApplicationContext context;

    <span class="hl-keyword">public</span> MovieRecommender() {
    }

    <span class="hl-comment">// ...</span>

}</pre>

</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="beans-postconstruct-and-predestroy-annotations" href="#beans-postconstruct-and-predestroy-annotations"></a>5.9.7&nbsp;@PostConstruct and @PreDestroy</h3></div></div></div>

<p>The <code class="literal">CommonAnnotationBeanPostProcessor</code> not only recognizes the <code class="literal">@Resource</code> annotation
but also the JSR-250 <span class="emphasis"><em>lifecycle</em></span> annotations. Introduced in Spring 2.5, the support
for these annotations offers yet another alternative to those described in
<a class="link" href="beans.html#beans-factory-lifecycle-initializingbean" title="&#21021;&#22987;&#21270;&#22238;&#35843;&#20989;&#25968;">initialization callbacks</a> and
<a class="link" href="beans.html#beans-factory-lifecycle-disposablebean" title="&#26512;&#26500;&#22238;&#35843;&#20989;&#25968;">destruction callbacks</a>. Provided that the
<code class="literal">CommonAnnotationBeanPostProcessor</code> is registered within the Spring
<code class="literal">ApplicationContext</code>, a method carrying one of these annotations is invoked at the same
point in the lifecycle as the corresponding Spring lifecycle interface method or
explicitly declared callback method. In the example below, the cache will be
pre-populated upon initialization and cleared upon destruction.</p>
<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> CachingMovieLister {

    <em><span class="hl-annotation" style="color: gray">@PostConstruct</span></em>
    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> populateMovieCache() {
        <span class="hl-comment">// populates the movie cache upon initialization...</span>
    }

    <em><span class="hl-annotation" style="color: gray">@PreDestroy</span></em>
    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> clearMovieCache() {
        <span class="hl-comment">// clears the movie cache upon destruction...</span>
    }

}</pre>

<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p>For details about the effects of combining various lifecycle mechanisms, see
<a class="xref" href="beans.html#beans-factory-lifecycle-combined-effects" title="&#32452;&#21512;&#29983;&#21629;&#21608;&#26399;&#26426;&#21046;">the section called &#8220;&#32452;&#21512;&#29983;&#21629;&#21608;&#26399;&#26426;&#21046;&#8221;</a>.</p>
</td></tr></table></div>

</div>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="beans-classpath-scanning" href="#beans-classpath-scanning"></a>5.10&nbsp;Classpath scanning and managed components</h2></div></div></div>

<p>Most examples in this chapter use XML to specify the configuration metadata that
produces each <code class="literal">BeanDefinition</code> within the Spring container. The previous section
(<a class="xref" href="beans.html#beans-annotation-config" title="5.9&nbsp;Annotation-based container configuration">Section&nbsp;5.9, &#8220;Annotation-based container configuration&#8221;</a>) demonstrates how to provide a lot of the configuration
metadata through source-level annotations. Even in those examples, however, the "base"
bean definitions are explicitly defined in the XML file, while the annotations only
drive the dependency injection. This section describes an option for implicitly
detecting the <span class="emphasis"><em>candidate components</em></span> by scanning the classpath. Candidate components
are classes that match against a filter criteria and have a corresponding bean
definition registered with the container. This removes the need to use XML to perform
bean registration, instead you can use annotations (for example @Component), AspectJ
type expressions, or your own custom filter criteria to select which classes will have
bean definitions registered with the container.</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p>Starting with Spring 3.0, many features provided by the Spring JavaConfig project are
part of the core Spring Framework. This allows you to define beans using Java rather
than using the traditional XML files. Take a look at the <code class="literal">@Configuration</code>, <code class="literal">@Bean</code>,
<code class="literal">@Import</code>, and <code class="literal">@DependsOn</code> annotations for examples of how to use these new features.</p>
</td></tr></table></div>

<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="beans-stereotype-annotations" href="#beans-stereotype-annotations"></a>5.10.1&nbsp;@Component and further stereotype annotations</h3></div></div></div>

<p>The <code class="literal">@Repository</code> annotation is a marker for any class that fulfills the role or
<span class="emphasis"><em>stereotype</em></span> (also known as Data Access Object or DAO) of a repository. Among the uses
of this marker is the automatic translation of exceptions as described in
<a class="xref" href="orm.html#orm-exception-translation" title="14.2.2&nbsp;&#24322;&#24120;&#36716;&#21270;">Section&nbsp;14.2.2, &#8220;&#24322;&#24120;&#36716;&#21270;&#8221;</a>.</p>
<p>Spring provides further stereotype annotations: <code class="literal">@Component</code>, <code class="literal">@Service</code>, and
<code class="literal">@Controller</code>. <code class="literal">@Component</code> is a generic stereotype for any Spring-managed component.
<code class="literal">@Repository</code>, <code class="literal">@Service</code>, and <code class="literal">@Controller</code> are specializations of <code class="literal">@Component</code> for
more specific use cases, for example, in the persistence, service, and presentation
layers, respectively. Therefore, you can annotate your component classes with
<code class="literal">@Component</code>, but by annotating them with <code class="literal">@Repository</code>, <code class="literal">@Service</code>, or <code class="literal">@Controller</code>
instead, your classes are more properly suited for processing by tools or associating
with aspects. For example, these stereotype annotations make ideal targets for
pointcuts. It is also possible that <code class="literal">@Repository</code>, <code class="literal">@Service</code>, and <code class="literal">@Controller</code> may
carry additional semantics in future releases of the Spring Framework. Thus, if you are
choosing between using <code class="literal">@Component</code> or <code class="literal">@Service</code> for your service layer, <code class="literal">@Service</code> is
clearly the better choice. Similarly, as stated above, <code class="literal">@Repository</code> is already
supported as a marker for automatic exception translation in your persistence layer.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="beans-meta-annotations" href="#beans-meta-annotations"></a>5.10.2&nbsp;Meta-annotations</h3></div></div></div>

<p>Many of the annotations provided by Spring can be used as "meta-annotations" in
your own code. A meta-annotation is simply an annotation, that can be applied to another
annotation. For example, The <code class="literal">@Service</code> annotation mentioned above is meta-annotated with
with <code class="literal">@Component</code>:</p>
<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Target({ElementType.TYPE})</span></em>
<em><span class="hl-annotation" style="color: gray">@Retention(RetentionPolicy.RUNTIME)</span></em>
<em><span class="hl-annotation" style="color: gray">@Documented</span></em>
<span class="strong"><strong>@Component</strong></span> <span class="hl-comment">// Spring will see this and treat @Service in the same way as @Component</span>
<span class="hl-keyword">public</span> <em><span class="hl-annotation" style="color: gray">@interface</span></em> Service {

    <span class="hl-comment">// ....</span>

}</pre>

<p>Meta-annotations can also be combined together to create <span class="emphasis"><em>composed annotations</em></span>. For
example, the <code class="literal">@RestController</code> annotation from Spring MVC is <span class="emphasis"><em>composed</em></span> of
<code class="literal">@Controller</code> and <code class="literal">@ResponseBody</code>.</p>
<p>With the exception of <code class="literal">value()</code>, meta-annotated types may redeclare attributes from the
source annotation to allow user customization. This can be particularly useful when you
want to only expose a subset of the source annotation attributes. For example, here is a
custom <code class="literal">@Scope</code> annotation that defines <code class="literal">session</code> scope, but still allows customization
of the <code class="literal">proxyMode</code>.</p>
<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Target({ElementType.TYPE})</span></em>
<em><span class="hl-annotation" style="color: gray">@Retention(RetentionPolicy.RUNTIME)</span></em>
<em><span class="hl-annotation" style="color: gray">@Documented</span></em>
<span class="strong"><strong>@Scope("session")</strong></span>
<span class="hl-keyword">public</span> <em><span class="hl-annotation" style="color: gray">@interface</span></em> SessionScope {

    ScopedProxyMode proxyMode() <span class="hl-keyword">default</span> ScopedProxyMode.DEFAULT

}</pre>

</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="beans-scanning-autodetection" href="#beans-scanning-autodetection"></a>5.10.3&nbsp;Automatically detecting classes and registering bean definitions</h3></div></div></div>

<p>Spring can automatically detect stereotyped classes and register corresponding
<code class="literal">BeanDefinition</code>s with the <code class="literal">ApplicationContext</code>. For example, the following two classes
are eligible for such autodetection:</p>
<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Service</span></em>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> SimpleMovieLister {

    <span class="hl-keyword">private</span> MovieFinder movieFinder;

    <em><span class="hl-annotation" style="color: gray">@Autowired</span></em>
    <span class="hl-keyword">public</span> SimpleMovieLister(MovieFinder movieFinder) {
        <span class="hl-keyword">this</span>.movieFinder = movieFinder;
    }

}</pre>

<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Repository</span></em>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> JpaMovieFinder <span class="hl-keyword">implements</span> MovieFinder {
    <span class="hl-comment">// implementation elided for clarity</span>
}</pre>

<p>To autodetect these classes and register the corresponding beans, you need to add
<code class="literal">@ComponentScan</code> to your <code class="literal">@Configuration</code> class, where the <code class="literal">basePackages</code> attribute
is a common parent package for the two classes. (Alternatively, you can specify a
comma-separated list that includes the parent package of each class.)</p>
<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Configuration</span></em>
<em><span class="hl-annotation" style="color: gray">@ComponentScan(basePackages = "org.example")</span></em>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> AppConfig  {
    ...
}</pre>

<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p>for concision, the above may have used the <code class="literal">value</code> attribute of the
annotation, i.e. <code class="literal">ComponentScan("org.example")</code></p>
</td></tr></table></div>

<p>The following is an alternative using XML</p>
<pre class="programlisting"><span class="hl-directive" style="color: maroon">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="hl-tag">&lt;beans</span> <span class="hl-attribute">xmlns</span>=<span class="hl-value">"http://www.springframework.org/schema/beans"</span>
    <span class="hl-attribute">xmlns:xsi</span>=<span class="hl-value">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hl-attribute">xmlns:context</span>=<span class="hl-value">"http://www.springframework.org/schema/context"</span>
    <span class="hl-attribute">xsi:schemaLocation</span>=<span class="hl-value">"http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/context
        http://www.springframework.org/schema/context/spring-context.xsd"</span><span class="hl-tag">&gt;</span>

    <span class="hl-tag">&lt;context:component-scan</span> <span class="hl-attribute">base-package</span>=<span class="hl-value">"org.example"</span><span class="hl-tag">/&gt;</span>

<span class="hl-tag">&lt;/beans&gt;</span></pre>

<div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="images/tip.png"></td><th align="left">Tip</th></tr><tr><td align="left" valign="top">
<p>The use of <code class="literal">&lt;context:component-scan&gt;</code> implicitly enables the functionality of
<code class="literal">&lt;context:annotation-config&gt;</code>. There is usually no need to include the
<code class="literal">&lt;context:annotation-config&gt;</code> element when using <code class="literal">&lt;context:component-scan&gt;</code>.</p>
</td></tr></table></div>

<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p>The scanning of classpath packages requires the presence of corresponding directory
entries in the classpath. When you build JARs with Ant, make sure that you do <span class="emphasis"><em>not</em></span>
activate the files-only switch of the JAR task. Also, classpath directories may not
get exposed based on security policies in some environments, e.g. standalone apps on
JDK 1.7.0_45 and higher (which requires <span class="emphasis"><em>Trusted-Library</em></span> setup in your manifests; see
<a class="ulink" href="http://stackoverflow.com/questions/19394570/java-jre-7u45-breaks-classloader-getresources)" target="_top">http://stackoverflow.com/questions/19394570/java-jre-7u45-breaks-classloader-getresources)</a>.</p>
</td></tr></table></div>

<p>Furthermore, the <code class="literal">AutowiredAnnotationBeanPostProcessor</code> and
<code class="literal">CommonAnnotationBeanPostProcessor</code> are both included implicitly when you use the
component-scan element. That means that the two components are autodetected <span class="emphasis"><em>and</em></span>
wired together - all without any bean configuration metadata provided in XML.</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p>You can disable the registration of <code class="literal">AutowiredAnnotationBeanPostProcessor</code> and
<code class="literal">CommonAnnotationBeanPostProcessor</code> by including the <span class="emphasis"><em>annotation-config</em></span> attribute
with a value of false.</p>
</td></tr></table></div>

</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="beans-scanning-filters" href="#beans-scanning-filters"></a>5.10.4&nbsp;Using filters to customize scanning</h3></div></div></div>

<p>By default, classes annotated with <code class="literal">@Component</code>, <code class="literal">@Repository</code>, <code class="literal">@Service</code>,
<code class="literal">@Controller</code>, or a custom annotation that itself is annotated with <code class="literal">@Component</code> are the
only detected candidate components. However, you can modify and extend this behavior
simply by applying custom filters. Add them as <span class="emphasis"><em>includeFilters</em></span> or <span class="emphasis"><em>excludeFilters</em></span>
parameters of the <code class="literal">@ComponentScan</code> annotation (or as <span class="emphasis"><em>include-filter</em></span> or <span class="emphasis"><em>exclude-filter</em></span>
sub-elements of the <code class="literal">component-scan</code> element). Each filter element requires the <code class="literal">type</code>
and <code class="literal">expression</code> attributes. The following table describes the filtering options.</p>
<div class="table"><a name="beans-scanning-filters-tbl" href="#beans-scanning-filters-tbl"></a><p class="title"><b>Table&nbsp;5.5.&nbsp;Filter Types</b></p><div class="table-contents">

  <table summary="Filter Types" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="col_1"><col class="col_2"><col class="col_3"></colgroup><thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">Filter Type</th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">Example Expression</th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top">Description</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>annotation (default)</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">org.example.SomeAnnotation</code></p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>An annotation to be present at the type level in target components.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>assignable</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">org.example.SomeClass</code></p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>A class (or interface) that the target components are assignable to (extend/implement).</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>aspectj</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">org.example..*Service+</code></p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>An AspectJ type expression to be matched by the target components.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>regex</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">org\.example\.Default.*</code></p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>A regex expression to be matched by the target components class names.</p></td></tr><tr><td style="border-right: 0.5pt solid ; " align="left" valign="top"><p>custom</p></td><td style="border-right: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">org.example.MyTypeFilter</code></p></td><td style="" align="left" valign="top"><p>A custom implementation of the <code class="literal">org.springframework.core.type .TypeFilter</code> interface.</p></td></tr></tbody></table>
</div></div><br class="table-break">

<p>The following example shows the configuration ignoring all <code class="literal">@Repository</code> annotations
and using "stub" repositories instead.</p>
<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Configuration</span></em>
<em><span class="hl-annotation" style="color: gray">@ComponentScan(basePackages = "org.example",
        includeFilters = @Filter(type = FilterType.REGEX, pattern = ".*Stub.*Repository"),
        excludeFilters = @Filter(Repository.class))</span></em>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> AppConfig {
    ...
}</pre>

<p>and the equivalent using XML</p>
<pre class="programlisting"><span class="hl-tag">&lt;beans&gt;</span>
    <span class="hl-tag">&lt;context:component-scan</span> <span class="hl-attribute">base-package</span>=<span class="hl-value">"org.example"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;context:include-filter</span> <span class="hl-attribute">type</span>=<span class="hl-value">"regex"</span>
                <span class="hl-attribute">expression</span>=<span class="hl-value">".*Stub.*Repository"</span><span class="hl-tag">/&gt;</span>
        <span class="hl-tag">&lt;context:exclude-filter</span> <span class="hl-attribute">type</span>=<span class="hl-value">"annotation"</span>
                <span class="hl-attribute">expression</span>=<span class="hl-value">"org.springframework.stereotype.Repository"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;/context:component-scan&gt;</span>
<span class="hl-tag">&lt;/beans&gt;</span></pre>

<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p>You can also disable the default filters by setting <code class="literal">useDefaultFilters=false</code> on the annotation or
providing <code class="literal">use-default-filters="false"</code> as an attribute of the &lt;component-scan/&gt; element. This
will in effect disable automatic detection of classes annotated with <code class="literal">@Component</code>, <code class="literal">@Repository</code>,
<code class="literal">@Service</code>, or <code class="literal">@Controller</code>.</p>
</td></tr></table></div>

</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="beans-factorybeans-annotations" href="#beans-factorybeans-annotations"></a>5.10.5&nbsp;Defining bean metadata within components</h3></div></div></div>

<p>Spring components can also contribute bean definition metadata to the container. You do
this with the same <code class="literal">@Bean</code> annotation used to define bean metadata within
<code class="literal">@Configuration</code> annotated classes. Here is a simple example:</p>
<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Component</span></em>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> FactoryMethodComponent {

    <em><span class="hl-annotation" style="color: gray">@Bean</span></em>
    <em><span class="hl-annotation" style="color: gray">@Qualifier("public")</span></em>
    <span class="hl-keyword">public</span> TestBean publicInstance() {
        <span class="hl-keyword">return</span> <span class="hl-keyword">new</span> TestBean(<span class="hl-string">"publicInstance"</span>);
    }

    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> doWork() {
        <span class="hl-comment">// Component method implementation omitted</span>
    }

}</pre>

<p>This class is a Spring component that has application-specific code contained in its
<code class="literal">doWork()</code> method. However, it also contributes a bean definition that has a factory
method referring to the method <code class="literal">publicInstance()</code>. The <code class="literal">@Bean</code> annotation identifies the
factory method and other bean definition properties, such as a qualifier value through
the <code class="literal">@Qualifier</code> annotation. Other method level annotations that can be specified are
<code class="literal">@Scope</code>, <code class="literal">@Lazy</code>, and custom qualifier annotations.</p>
<div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="images/tip.png"></td><th align="left">Tip</th></tr><tr><td align="left" valign="top">
<p>In addition to its role for component initialization, the <code class="literal">@Lazy</code> annotation may also be
placed on injection points marked with <code class="literal">@Autowired</code> or <code class="literal">@Inject</code>. In this context, it
leads to the injection of a lazy-resolution proxy.</p>
</td></tr></table></div>

<p>Autowired fields and methods are supported as previously discussed, with additional
support for autowiring of <code class="literal">@Bean</code> methods:</p>
<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Component</span></em>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> FactoryMethodComponent {

    <span class="hl-keyword">private</span> <span class="hl-keyword">static</span> <span class="hl-keyword">int</span> i;

    <em><span class="hl-annotation" style="color: gray">@Bean</span></em>
    <em><span class="hl-annotation" style="color: gray">@Qualifier("public")</span></em>
    <span class="hl-keyword">public</span> TestBean publicInstance() {
        <span class="hl-keyword">return</span> <span class="hl-keyword">new</span> TestBean(<span class="hl-string">"publicInstance"</span>);
    }

    <span class="hl-comment">// use of a custom qualifier and autowiring of method parameters</span>

    <em><span class="hl-annotation" style="color: gray">@Bean</span></em>
    <span class="hl-keyword">protected</span> TestBean protectedInstance(
            <em><span class="hl-annotation" style="color: gray">@Qualifier("public")</span></em> TestBean spouse,
            <em><span class="hl-annotation" style="color: gray">@Value("#{privateInstance.age}")</span></em> String country) {
        TestBean tb = <span class="hl-keyword">new</span> TestBean(<span class="hl-string">"protectedInstance"</span>, <span class="hl-number">1</span>);
        tb.setSpouse(spouse);
        tb.setCountry(country);
        <span class="hl-keyword">return</span> tb;
    }

    <em><span class="hl-annotation" style="color: gray">@Bean</span></em>
    <em><span class="hl-annotation" style="color: gray">@Scope(BeanDefinition.SCOPE_SINGLETON)</span></em>
    <span class="hl-keyword">private</span> TestBean privateInstance() {
        <span class="hl-keyword">return</span> <span class="hl-keyword">new</span> TestBean(<span class="hl-string">"privateInstance"</span>, i++);
    }

    <em><span class="hl-annotation" style="color: gray">@Bean</span></em>
    <em><span class="hl-annotation" style="color: gray">@Scope(value = WebApplicationContext.SCOPE_SESSION, proxyMode = ScopedProxyMode.TARGET_CLASS)</span></em>
    <span class="hl-keyword">public</span> TestBean requestScopedInstance() {
        <span class="hl-keyword">return</span> <span class="hl-keyword">new</span> TestBean(<span class="hl-string">"requestScopedInstance"</span>, <span class="hl-number">3</span>);
    }

}</pre>

<p>The example autowires the <code class="literal">String</code> method parameter <code class="literal">country</code> to the value of the <code class="literal">Age</code>
property on another bean named <code class="literal">privateInstance</code>. A Spring Expression Language element
defines the value of the property through the notation <code class="literal">#{ &lt;expression&gt; }</code>. For <code class="literal">@Value</code>
annotations, an expression resolver is preconfigured to look for bean names when
resolving expression text.</p>
<p>The <code class="literal">@Bean</code> methods in a Spring component are processed differently than their
counterparts inside a Spring <code class="literal">@Configuration</code> class. The difference is that <code class="literal">@Component</code>
classes are not enhanced with CGLIB to intercept the invocation of methods and fields.
CGLIB proxying is the means by which invoking methods or fields within <code class="literal">@Bean</code> methods
in <code class="literal">@Configuration</code> classes creates bean metadata references to collaborating objects;
such methods are <span class="emphasis"><em>not</em></span> invoked with normal Java semantics. In contrast, invoking a
method or field in an <code class="literal">@Bean</code> method within a <code class="literal">@Component</code> class <span class="emphasis"><em>has</em></span> standard Java
semantics.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="beans-scanning-name-generator" href="#beans-scanning-name-generator"></a>5.10.6&nbsp;Naming autodetected components</h3></div></div></div>

<p>When a component is autodetected as part of the scanning process, its bean name is
generated by the <code class="literal">BeanNameGenerator</code> strategy known to that scanner. By default, any
Spring stereotype annotation ( <code class="literal">@Component</code>, <code class="literal">@Repository</code>, <code class="literal">@Service</code>, and
<code class="literal">@Controller</code>) that contains a <code class="literal">name</code> value will thereby provide that name to the
corresponding bean definition.</p>
<p>If such an annotation contains no <code class="literal">name</code> value or for any other detected component (such
as those discovered by custom filters), the default bean name generator returns the
uncapitalized non-qualified class name. For example, if the following two components
were detected, the names would be myMovieLister and movieFinderImpl:</p>
<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Service("myMovieLister")</span></em>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> SimpleMovieLister {
    <span class="hl-comment">// ...</span>
}</pre>

<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Repository</span></em>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> MovieFinderImpl <span class="hl-keyword">implements</span> MovieFinder {
    <span class="hl-comment">// ...</span>
}</pre>

<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p>If you do not want to rely on the default bean-naming strategy, you can provide a custom
bean-naming strategy. First, implement the
<a class="ulink" href="http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/beans/factory/support/BeanNameGenerator.html" target="_top"><code class="literal">BeanNameGenerator</code></a>
interface, and be sure to include a default no-arg constructor. Then, provide the
fully-qualified class name when configuring the scanner:</p>
</td></tr></table></div>

<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Configuration</span></em>
<em><span class="hl-annotation" style="color: gray">@ComponentScan(basePackages = "org.example", nameGenerator = MyNameGenerator.class)</span></em>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> AppConfig {
    ...
}</pre>

<pre class="programlisting"><span class="hl-tag">&lt;beans&gt;</span>
    <span class="hl-tag">&lt;context:component-scan</span> <span class="hl-attribute">base-package</span>=<span class="hl-value">"org.example"</span>
        <span class="hl-attribute">name-generator</span>=<span class="hl-value">"org.example.MyNameGenerator"</span><span class="hl-tag"> /&gt;</span>
<span class="hl-tag">&lt;/beans&gt;</span></pre>

<p>As a general rule, consider specifying the name with the annotation whenever other
components may be making explicit references to it. On the other hand, the
auto-generated names are adequate whenever the container is responsible for wiring.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="beans-scanning-scope-resolver" href="#beans-scanning-scope-resolver"></a>5.10.7&nbsp;Providing a scope for autodetected components</h3></div></div></div>

<p>As with Spring-managed components in general, the default and most common scope for
autodetected components is singleton. However, sometimes you need other scopes, which
Spring 2.5 provides with a new <code class="literal">@Scope</code> annotation. Simply provide the name of the scope
within the annotation:</p>
<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Scope("prototype")</span></em>
<em><span class="hl-annotation" style="color: gray">@Repository</span></em>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> MovieFinderImpl <span class="hl-keyword">implements</span> MovieFinder {
    <span class="hl-comment">// ...</span>
}</pre>

<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p>To provide a custom strategy for scope resolution rather than relying on the
annotation-based approach, implement the
<a class="ulink" href="http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/context/annotation/ScopeMetadataResolver.html" target="_top"><code class="literal">ScopeMetadataResolver</code></a>
interface, and be sure to include a default no-arg constructor. Then, provide the
fully-qualified class name when configuring the scanner:</p>
</td></tr></table></div>

<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Configuration</span></em>
<em><span class="hl-annotation" style="color: gray">@ComponentScan(basePackages = "org.example", scopeResolver = MyScopeResolver.class)</span></em>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> AppConfig {
    ...
}</pre>

<pre class="programlisting"><span class="hl-tag">&lt;beans&gt;</span>
    <span class="hl-tag">&lt;context:component-scan</span> <span class="hl-attribute">base-package</span>=<span class="hl-value">"org.example"</span>
            <span class="hl-attribute">scope-resolver</span>=<span class="hl-value">"org.example.MyScopeResolver"</span><span class="hl-tag"> /&gt;</span>
<span class="hl-tag">&lt;/beans&gt;</span></pre>

<p>When using certain non-singleton scopes, it may be necessary to generate proxies for the
scoped objects. The reasoning is described in <a class="xref" href="beans.html#beans-factory-scopes-other-injection" title="&#23558;&#19978;&#36848;&#20316;&#29992;&#22495;&#30340;bean&#20316;&#20026;&#20381;&#36182;">the section called &#8220;&#23558;&#19978;&#36848;&#20316;&#29992;&#22495;&#30340;bean&#20316;&#20026;&#20381;&#36182;&#8221;</a>.
For this purpose, a <span class="emphasis"><em>scoped-proxy</em></span> attribute is available on the component-scan
element. The three possible values are: no, interfaces, and targetClass. For example,
the following configuration will result in standard JDK dynamic proxies:</p>
<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Configuration</span></em>
<em><span class="hl-annotation" style="color: gray">@ComponentScan(basePackages = "org.example", scopedProxy = ScopedProxyMode.INTERFACES)</span></em>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> AppConfig {
    ...
}</pre>

<pre class="programlisting"><span class="hl-tag">&lt;beans&gt;</span>
    <span class="hl-tag">&lt;context:component-scan</span> <span class="hl-attribute">base-package</span>=<span class="hl-value">"org.example"</span>
        <span class="hl-attribute">scoped-proxy</span>=<span class="hl-value">"interfaces"</span><span class="hl-tag"> /&gt;</span>
<span class="hl-tag">&lt;/beans&gt;</span></pre>

</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="beans-scanning-qualifiers" href="#beans-scanning-qualifiers"></a>5.10.8&nbsp;Providing qualifier metadata with annotations</h3></div></div></div>

<p>The <code class="literal">@Qualifier</code> annotation is discussed in <a class="xref" href="beans.html#beans-autowired-annotation-qualifiers" title="5.9.3&nbsp;Fine-tuning annotation-based autowiring with qualifiers">Section&nbsp;5.9.3, &#8220;Fine-tuning annotation-based autowiring with qualifiers&#8221;</a>.
The examples in that section demonstrate the use of the <code class="literal">@Qualifier</code> annotation and
custom qualifier annotations to provide fine-grained control when you resolve autowire
candidates. Because those examples were based on XML bean definitions, the qualifier
metadata was provided on the candidate bean definitions using the <code class="literal">qualifier</code> or <code class="literal">meta</code>
sub-elements of the <code class="literal">bean</code> element in the XML. When relying upon classpath scanning for
autodetection of components, you provide the qualifier metadata with type-level
annotations on the candidate class. The following three examples demonstrate this
technique:</p>
<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Component</span></em>
<span class="strong"><strong>@Qualifier("Action")</strong></span>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> ActionMovieCatalog <span class="hl-keyword">implements</span> MovieCatalog {
    <span class="hl-comment">// ...</span>
}</pre>

<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Component</span></em>
<span class="strong"><strong>@Genre("Action")</strong></span>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> ActionMovieCatalog <span class="hl-keyword">implements</span> MovieCatalog {
    <span class="hl-comment">// ...</span>
}</pre>

<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Component</span></em>
<span class="strong"><strong>@Offline</strong></span>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> CachingMovieCatalog <span class="hl-keyword">implements</span> MovieCatalog {
    <span class="hl-comment">// ...</span>
}</pre>

<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p>As with most annotation-based alternatives, keep in mind that the annotation metadata is
bound to the class definition itself, while the use of XML allows for multiple beans
<span class="emphasis"><em>of the same type</em></span> to provide variations in their qualifier metadata, because that
metadata is provided per-instance rather than per-class.</p>
</td></tr></table></div>

</div>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="beans-standard-annotations" href="#beans-standard-annotations"></a>5.11&nbsp;Using JSR 330 Standard Annotations</h2></div></div></div>

<p>Starting with Spring 3.0, Spring offers support for JSR-330 standard annotations
(Dependency Injection). Those annotations are scanned in the same way as the Spring
annotations. You just need to have the relevant jars in your classpath.</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p>If you are using Maven, the <code class="literal">javax.inject</code> artifact is available in the standard Maven
repository (
<a class="ulink" href="http://repo1.maven.org/maven2/javax/inject/javax.inject/1/" target="_top">http://repo1.maven.org/maven2/javax/inject/javax.inject/1/</a>).
You can add the following dependency to your file pom.xml:</p>
<pre class="programlisting"><span class="hl-tag">&lt;dependency&gt;</span>
    <span class="hl-tag">&lt;groupId&gt;</span>javax.inject<span class="hl-tag">&lt;/groupId&gt;</span>
    <span class="hl-tag">&lt;artifactId&gt;</span>javax.inject<span class="hl-tag">&lt;/artifactId&gt;</span>
    <span class="hl-tag">&lt;version&gt;</span>1<span class="hl-tag">&lt;/version&gt;</span>
<span class="hl-tag">&lt;/dependency&gt;</span></pre>

</td></tr></table></div>

<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="beans-inject-named" href="#beans-inject-named"></a>5.11.1&nbsp;Dependency Injection with @Inject and @Named</h3></div></div></div>

<p>Instead of <code class="literal">@Autowired</code>, <code class="literal">@javax.inject.Inject</code> may be used as follows:</p>
<pre class="programlisting"><span class="hl-keyword">import</span> javax.inject.Inject;

<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> SimpleMovieLister {

    <span class="hl-keyword">private</span> MovieFinder movieFinder;

    <em><span class="hl-annotation" style="color: gray">@Inject</span></em>
    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> setMovieFinder(MovieFinder movieFinder) {
        <span class="hl-keyword">this</span>.movieFinder = movieFinder;
    }

    <span class="hl-comment">// ...</span>

}</pre>

<p>As with <code class="literal">@Autowired</code>, it is possible to use <code class="literal">@Inject</code> at the class-level, field-level,
method-level and constructor-argument level. If you would like to use a qualified name
for the dependency that should be injected, you should use the <code class="literal">@Named</code> annotation as
follows:</p>
<pre class="programlisting"><span class="hl-keyword">import</span> javax.inject.Inject;
<span class="hl-keyword">import</span> javax.inject.Named;

<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> SimpleMovieLister {

    <span class="hl-keyword">private</span> MovieFinder movieFinder;

    <em><span class="hl-annotation" style="color: gray">@Inject</span></em>
    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> setMovieFinder(<em><span class="hl-annotation" style="color: gray">@Named("main")</span></em> MovieFinder movieFinder) {
        <span class="hl-keyword">this</span>.movieFinder = movieFinder;
    }

    <span class="hl-comment">// ...</span>

}</pre>

</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="beans-named" href="#beans-named"></a>5.11.2&nbsp;@Named: a standard equivalent to the @Component annotation</h3></div></div></div>

<p>Instead of <code class="literal">@Component</code>, <code class="literal">@javax.inject.Named</code> may be used as follows:</p>
<pre class="programlisting"><span class="hl-keyword">import</span> javax.inject.Inject;
<span class="hl-keyword">import</span> javax.inject.Named;

<em><span class="hl-annotation" style="color: gray">@Named("movieListener")</span></em>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> SimpleMovieLister {

    <span class="hl-keyword">private</span> MovieFinder movieFinder;

    <em><span class="hl-annotation" style="color: gray">@Inject</span></em>
    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> setMovieFinder(MovieFinder movieFinder) {
        <span class="hl-keyword">this</span>.movieFinder = movieFinder;
    }

    <span class="hl-comment">// ...</span>

}</pre>

<p>It is very common to use <code class="literal">@Component</code> without
specifying a name for the component. <code class="literal">@Named</code>
can be used in a similar fashion:</p>
<pre class="programlisting"><span class="hl-keyword">import</span> javax.inject.Inject;
<span class="hl-keyword">import</span> javax.inject.Named;

<em><span class="hl-annotation" style="color: gray">@Named</span></em>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> SimpleMovieLister {

    <span class="hl-keyword">private</span> MovieFinder movieFinder;

    <em><span class="hl-annotation" style="color: gray">@Inject</span></em>
    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> setMovieFinder(MovieFinder movieFinder) {
        <span class="hl-keyword">this</span>.movieFinder = movieFinder;
    }

    <span class="hl-comment">// ...</span>

}</pre>

<p>When using <code class="literal">@Named</code>, it is possible to use
component-scanning in the exact same way as when using Spring annotations:</p>
<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Configuration</span></em>
<em><span class="hl-annotation" style="color: gray">@ComponentScan(basePackages = "org.example")</span></em>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> AppConfig  {
    ...
}</pre>

</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="beans-standard-annotations-limitations" href="#beans-standard-annotations-limitations"></a>5.11.3&nbsp;Limitations of the standard approach</h3></div></div></div>

<p>When working with standard annotations, it is important to know that some significant
features are not available as shown in the table below:</p>
<div class="table"><a name="annotations-comparison" href="#annotations-comparison"></a><p class="title"><b>Table&nbsp;5.6.&nbsp;Spring annotations vs. standard annotations</b></p><div class="table-contents">

  <table summary="Spring annotations vs. standard annotations" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="col_1"><col class="col_2"><col class="col_3"></colgroup><thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">Spring</th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">javax.inject.*</th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top">javax.inject restrictions / comments</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>@Autowired</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>@Inject</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>@Inject has no <span class="emphasis"><em>required</em></span> attribute</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>@Component</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>@Named</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>-</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>@Scope("singleton")</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>@Singleton</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>The JSR-330 default scope is like Spring&#8217;s <code class="literal">prototype</code>. However, in order to keep it
  consistent with Spring&#8217;s general defaults, a JSR-330 bean declared in the Spring
  container is a <code class="literal">singleton</code> by default. In order to use a scope other than <code class="literal">singleton</code>,
  you should use Spring&#8217;s <code class="literal">@Scope</code> annotation.
</p><p><code class="literal">javax.inject</code> also provides a
<a class="ulink" href="http://download.oracle.com/javaee/6/api/javax/inject/Scope.html" target="_top">@Scope</a> annotation.
Nevertheless, this one is only intended to be used for creating your own annotations.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>@Qualifier</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>@Named</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>-</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>@Value</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>-</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>no equivalent</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>@Required</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>-</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>no equivalent</p></td></tr><tr><td style="border-right: 0.5pt solid ; " align="left" valign="top"><p>@Lazy</p></td><td style="border-right: 0.5pt solid ; " align="left" valign="top"><p>-</p></td><td style="" align="left" valign="top"><p>no equivalent</p></td></tr></tbody></table>
</div></div><br class="table-break">

</div>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="beans-java" href="#beans-java"></a>5.12&nbsp;&#22522;&#20110;Java&#65288;Java-based&#65289;&#30340;&#23481;&#22120;&#37197;&#32622;</h2></div></div></div>

<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="beans-java-basic-concepts" href="#beans-java-basic-concepts"></a>5.12.1&nbsp;&#22522;&#26412;&#27010;&#24565;: @Bean and @Configuration</h3></div></div></div>

<p>Spring&#26032;&#30340;Java&#37197;&#32622;&#25903;&#25345;&#20013;&#26680;&#24515;&#26500;&#20214;&#26159; <code class="literal">@Configuration</code> &#27880;&#37322;&#31867;&#21644; <code class="literal">@Bean</code> &#27880;&#37322;&#26041;&#27861;&#12290;</p>
<p><code class="literal">@Bean</code> &#27880;&#37322;&#26159;&#29992;&#26469;&#34920;&#31034;&#19968;&#20010;&#26041;&#27861;&#23454;&#20363;&#21270;&#65292;&#37197;&#32622;&#21644;&#21021;&#22987;&#21270;&#19968;&#20010;&#30001;Spring IoC&#23481;&#22120;&#31649;&#29702;&#30340;&#26032;&#30340;&#23545;&#35937;&#12290;&#23545;&#20110;&#37027;&#20123;&#29087;&#24713;Spring&#30340; <code class="literal">&lt;beans/&gt;</code> XML &#37197;&#32622;&#65292;
<code class="literal">@Bean</code> &#27880;&#37322;&#21644; <code class="literal">&lt;bean/&gt;</code> &#19968;&#26679;&#36215;&#30528;&#21516;&#26679;&#30340;&#20316;&#29992;&#12290;&#20320;&#21487;&#20197;&#20351;&#29992; <code class="literal">@Bean</code> &#27880;&#37322;&#20219;&#20309;Spring <code class="literal">@Component</code> &#30340;&#26041;&#27861;&#65292;&#20294;&#26159;&#65292;
&#26368;&#32463;&#24120;&#20351;&#29992;&#30340;&#26159; <code class="literal">@Configuration</code> &#27880;&#37322;bean&#12290;</p>
<p>&#29992; <code class="literal">@Configuration</code> &#27880;&#37322;&#19968;&#20010;&#31867;&#34920;&#26126;&#23427;&#30340;&#20027;&#35201;&#30446;&#30340;&#26159;&#20316;&#20026;bean&#23450;&#20041;&#30340;&#26469;&#28304;&#12290;&#27492;&#22806;&#65292; <code class="literal">@Configuration</code> &#27880;&#37322;&#30340;&#31867;&#20801;&#35768;inter-bean&#20381;&#36182;&#20851;&#31995;
&#22312;&#30456;&#21516;&#30340;&#31867;&#20013;&#65292;&#36890;&#36807;&#31616;&#21333;&#22320;&#35843;&#29992;&#20854;&#20182; <code class="literal">@Bean</code> &#26041;&#27861;&#34987;&#23450;&#20041;&#12290;&#26368;&#31616;&#21333;&#30340; <code class="literal">@Configuration</code> &#31867;&#23450;&#20041;&#22914;&#19979;&#65306;</p>
<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Configuration</span></em>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> AppConfig {

    <em><span class="hl-annotation" style="color: gray">@Bean</span></em>
    <span class="hl-keyword">public</span> MyService myService() {
        <span class="hl-keyword">return</span> <span class="hl-keyword">new</span> MyServiceImpl();
    }

}</pre>

<p>&#19978;&#38754;&#30340; <code class="literal">AppConfig</code> &#31867;&#30456;&#24403;&#20110;&#19979;&#38754;&#30340;Spring <code class="literal">&lt;beans/&gt;</code> XML&#65306;</p>
<pre class="programlisting"><span class="hl-tag">&lt;beans&gt;</span>
    <span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"myService"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"com.acme.services.MyServiceImpl"</span><span class="hl-tag">/&gt;</span>
<span class="hl-tag">&lt;/beans&gt;</span></pre>

<p>The <code class="literal">@Bean</code> and <code class="literal">@Configuration</code> annotations will be discussed in depth in the sections
below. First, however, we&#8217;ll cover the various ways of creating a spring container using
Java-based configuration.</p>
<div class="sidebar"><div class="titlepage"><div><div><p class="title"><b>Full @Configuration vs <span class="emphasis"><em>lite</em></span> @Beans mode?</b></p></div></div></div>

<p>When <code class="literal">@Bean</code> methods are declared within classes that are <span class="emphasis"><em>not</em></span> annotated with
<code class="literal">@Configuration</code> they are referred to as being processed in a <span class="emphasis"><em>lite</em></span> mode. For example,
bean methods declared in a <code class="literal">@Component</code> or even in a <span class="emphasis"><em>plain old class</em></span> will be
considered <span class="emphasis"><em>lite</em></span>.</p>
<p>Unlike full <code class="literal">@Configuration</code>, lite <code class="literal">@Bean</code> methods cannot easily declare inter-bean
dependencies. Usually one <code class="literal">@Bean</code> method should not invoke another <code class="literal">@Bean</code> method when
operating in <span class="emphasis"><em>lite</em></span> mode.</p>
<p>Only using <code class="literal">@Bean</code> methods within <code class="literal">@Configuration</code> classes is a recommended approach of
ensuring that <span class="emphasis"><em>full</em></span> mode is always used. This will prevent the same <code class="literal">@Bean</code> method from
accidentally being invoked multiple times and helps to reduce subtle bugs that can be
hard to track down when operating in <span class="emphasis"><em>lite</em></span> mode.</p>
</div>

</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="beans-java-instantiating-container" href="#beans-java-instantiating-container"></a>5.12.2&nbsp;Instantiating the Spring container using AnnotationConfigApplicationContext</h3></div></div></div>

<p>The sections below document Spring&#8217;s <code class="literal">AnnotationConfigApplicationContext</code>, new in Spring
3.0. This versatile <code class="literal">ApplicationContext</code> implementation is capable of accepting not only
<code class="literal">@Configuration</code> classes as input, but also plain <code class="literal">@Component</code> classes and classes
annotated with JSR-330 metadata.</p>
<p>When <code class="literal">@Configuration</code> classes are provided as input, the <code class="literal">@Configuration</code> class itself
is registered as a bean definition, and all declared <code class="literal">@Bean</code> methods within the class
are also registered as bean definitions.</p>
<p>When <code class="literal">@Component</code> and JSR-330 classes are provided, they are registered as bean
definitions, and it is assumed that DI metadata such as <code class="literal">@Autowired</code> or <code class="literal">@Inject</code> are
used within those classes where necessary.</p>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-java-instantiating-container-contstructor" href="#beans-java-instantiating-container-contstructor"></a>Simple construction</h4></div></div></div>

<p>In much the same way that Spring XML files are used as input when instantiating a
<code class="literal">ClassPathXmlApplicationContext</code>, <code class="literal">@Configuration</code> classes may be used as input when
instantiating an <code class="literal">AnnotationConfigApplicationContext</code>. This allows for completely
XML-free usage of the Spring container:</p>
<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">static</span> <span class="hl-keyword">void</span> main(String[] args) {
    ApplicationContext ctx = <span class="hl-keyword">new</span> AnnotationConfigApplicationContext(AppConfig.<span class="hl-keyword">class</span>);
    MyService myService = ctx.getBean(MyService.<span class="hl-keyword">class</span>);
    myService.doStuff();
}</pre>

<p>As mentioned above, <code class="literal">AnnotationConfigApplicationContext</code> is not limited to working only
with <code class="literal">@Configuration</code> classes. Any <code class="literal">@Component</code> or JSR-330 annotated class may be supplied
as input to the constructor. For example:</p>
<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">static</span> <span class="hl-keyword">void</span> main(String[] args) {
    ApplicationContext ctx = <span class="hl-keyword">new</span> AnnotationConfigApplicationContext(MyServiceImpl.<span class="hl-keyword">class</span>, Dependency1.<span class="hl-keyword">class</span>, Dependency2.<span class="hl-keyword">class</span>);
    MyService myService = ctx.getBean(MyService.<span class="hl-keyword">class</span>);
    myService.doStuff();
}</pre>

<p>The above assumes that <code class="literal">MyServiceImpl</code>, <code class="literal">Dependency1</code> and <code class="literal">Dependency2</code> use Spring
dependency injection annotations such as <code class="literal">@Autowired</code>.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-java-instantiating-container-register" href="#beans-java-instantiating-container-register"></a>Building the container programmatically using register(Class&lt;?&gt;&#8230;)</h4></div></div></div>

<p>An <code class="literal">AnnotationConfigApplicationContext</code> may be instantiated using a no-arg constructor
and then configured using the <code class="literal">register()</code> method. This approach is particularly useful
when programmatically building an <code class="literal">AnnotationConfigApplicationContext</code>.</p>
<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">static</span> <span class="hl-keyword">void</span> main(String[] args) {
    AnnotationConfigApplicationContext ctx = <span class="hl-keyword">new</span> AnnotationConfigApplicationContext();
    ctx.register(AppConfig.<span class="hl-keyword">class</span>, OtherConfig.<span class="hl-keyword">class</span>);
    ctx.register(AdditionalConfig.<span class="hl-keyword">class</span>);
    ctx.refresh();
    MyService myService = ctx.getBean(MyService.<span class="hl-keyword">class</span>);
    myService.doStuff();
}</pre>

</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-java-instantiating-container-scan" href="#beans-java-instantiating-container-scan"></a>Enabling component scanning with scan(String&#8230;)</h4></div></div></div>

<p>To enable component scanning, just annotate your <code class="literal">@Configuration</code> class as follows:</p>
<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Configuration</span></em>
<em><span class="hl-annotation" style="color: gray">@ComponentScan(basePackages = "com.acme")</span></em>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> AppConfig  {
    ...
}</pre>

<div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="images/tip.png"></td><th align="left">Tip</th></tr><tr><td align="left" valign="top">
<p>Experienced Spring users will be familiar with the XML declaration equivalent from
Spring&#8217;s <code class="literal">context:</code> namespace</p>
<pre class="programlisting"><span class="hl-tag">&lt;beans&gt;</span>
    <span class="hl-tag">&lt;context:component-scan</span> <span class="hl-attribute">base-package</span>=<span class="hl-value">"com.acme"</span><span class="hl-tag">/&gt;</span>
<span class="hl-tag">&lt;/beans&gt;</span></pre>

</td></tr></table></div>

<p>In the example above, the <code class="literal">com.acme</code> package will be scanned, looking for any
<code class="literal">@Component</code>-annotated classes, and those classes will be registered as Spring bean
definitions within the container. <code class="literal">AnnotationConfigApplicationContext</code> exposes the
<code class="literal">scan(String...)</code> method to allow for the same component-scanning functionality:</p>
<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">static</span> <span class="hl-keyword">void</span> main(String[] args) {
    AnnotationConfigApplicationContext ctx = <span class="hl-keyword">new</span> AnnotationConfigApplicationContext();
    ctx.scan(<span class="hl-string">"com.acme"</span>);
    ctx.refresh();
    MyService myService = ctx.getBean(MyService.<span class="hl-keyword">class</span>);
}</pre>

<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p>Remember that <code class="literal">@Configuration</code> classes are <a class="link" href="beans.html#beans-meta-annotations" title="5.10.2&nbsp;Meta-annotations">meta-annotated</a>
with <code class="literal">@Component</code>, so they are candidates for component-scanning! In the example above,
assuming that <code class="literal">AppConfig</code> is declared within the <code class="literal">com.acme</code> package (or any package
underneath), it will be picked up during the call to <code class="literal">scan()</code>, and upon <code class="literal">refresh()</code> all
its <code class="literal">@Bean</code> methods will be processed and registered as bean definitions within the
container.</p>
</td></tr></table></div>

</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-java-instantiating-container-web" href="#beans-java-instantiating-container-web"></a>&#20351;&#29992;AnnotationConfigWebApplicationContext&#25903;&#25345;Web&#24212;&#29992;</h4></div></div></div>

<p><code class="literal">AnnotationConfigWebApplicationContext</code>&#26159;&#19968;&#20010;<code class="literal">AnnotationConfigApplicationContext</code>&#30340;<code class="literal">WebApplicationContext</code>&#21464;&#31181;&#12290;&#36825;&#20010;&#23454;&#29616;&#21487;&#20197;&#29992;&#20110;&#24403;&#37197;&#32622;Spring <code class="literal">ContextLoaderListener</code> servlet&#30417;&#21548;&#65292;Spring MVC&#30340;<code class="literal">DispatcherServlet</code>&#31561;&#31561;&#12290;&#19979;&#38754;&#26159;&#19968;&#20010;<code class="literal">web.xml</code>&#30340;&#29255;&#27573;&#65292;&#37197;&#32622;&#20102;&#19968;&#20010;&#20856;&#22411;&#30340;Spring MVC web&#24212;&#29992;&#65292;&#27880;&#24847;<code class="literal">contextClass</code>&#30340;context-param&#21644;init-param&#65306;</p>
<pre class="programlisting"><span class="hl-tag">&lt;web-app&gt;</span>
    <span class="hl-comment">&lt;!-- &#37197;&#32622;ContextLoaderListener&#20351;&#29992;AnnotationConfigWebApplicationContext
        &#26367;&#25442;&#40664;&#35748;&#30340;XmlWebApplicationContext --&gt;</span>
    <span class="hl-tag">&lt;context-param&gt;</span>
        <span class="hl-tag">&lt;param-name&gt;</span>contextClass<span class="hl-tag">&lt;/param-name&gt;</span>
        <span class="hl-tag">&lt;param-value&gt;</span>
            org.springframework.web.context.support.AnnotationConfigWebApplicationContext
        <span class="hl-tag">&lt;/param-value&gt;</span>
    <span class="hl-tag">&lt;/context-param&gt;</span>

    <span class="hl-comment">&lt;!-- &#37197;&#32622;&#22810;&#20010;&#36335;&#24452;&#24517;&#39035;&#20351;&#29992;&#36887;&#21495;&#25110;&#31354;&#26684;&#20998;&#38548;&#30340;&#20840;&#38480;&#23450;&#21517;&#31216;&#30340;@Configuration&#27880;&#35299;&#31867;&#65292;
        &#20063;&#21487;&#20197;&#20351;&#29992;&#21253;&#21517;&#26469;&#33258;&#21160;&#25195;&#25551;&#32452;&#20214; --&gt;</span>
    <span class="hl-tag">&lt;context-param&gt;</span>
        <span class="hl-tag">&lt;param-name&gt;</span>contextConfigLocation<span class="hl-tag">&lt;/param-name&gt;</span>
        <span class="hl-tag">&lt;param-value&gt;</span>com.acme.AppConfig<span class="hl-tag">&lt;/param-value&gt;</span>
    <span class="hl-tag">&lt;/context-param&gt;</span>

    <span class="hl-comment">&lt;!-- &#20687;&#24179;&#24120;&#19968;&#26679;&#20351;&#29992;ContextLoaderListener&#21551;&#21160;&#26681;&#24212;&#29992;&#19978;&#19979;&#25991; --&gt;</span>
    <span class="hl-tag">&lt;listener&gt;</span>
        <span class="hl-tag">&lt;listener-class&gt;</span>org.springframework.web.context.ContextLoaderListener<span class="hl-tag">&lt;/listener-class&gt;</span>
    <span class="hl-tag">&lt;/listener&gt;</span>

    <span class="hl-comment">&lt;!-- &#20687;&#24179;&#24120;&#19968;&#26679;&#23450;&#20041;Spring MVC DispatcherServlet --&gt;</span>
    <span class="hl-tag">&lt;servlet&gt;</span>
        <span class="hl-tag">&lt;servlet-name&gt;</span>dispatcher<span class="hl-tag">&lt;/servlet-name&gt;</span>
        <span class="hl-tag">&lt;servlet-class&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="hl-tag">&lt;/servlet-class&gt;</span>
        <span class="hl-comment">&lt;!-- &#37197;&#32622;DispatcherServlet&#20351;&#29992;AnnotationConfigWebApplicationContext
            &#26367;&#25442;&#40664;&#35748;&#30340;XmlWebApplicationContext --&gt;</span>
        <span class="hl-tag">&lt;init-param&gt;</span>
            <span class="hl-tag">&lt;param-name&gt;</span>contextClass<span class="hl-tag">&lt;/param-name&gt;</span>
            <span class="hl-tag">&lt;param-value&gt;</span>
                org.springframework.web.context.support.AnnotationConfigWebApplicationContext
            <span class="hl-tag">&lt;/param-value&gt;</span>
        <span class="hl-tag">&lt;/init-param&gt;</span>
        <span class="hl-comment">&lt;!-- &#21516;&#19978;&#38754;&#19968;&#26679;&#37197;&#32622;&#36335;&#24452; --&gt;</span>
        <span class="hl-tag">&lt;init-param&gt;</span>
            <span class="hl-tag">&lt;param-name&gt;</span>contextConfigLocation<span class="hl-tag">&lt;/param-name&gt;</span>
            <span class="hl-tag">&lt;param-value&gt;</span>com.acme.web.MvcConfig<span class="hl-tag">&lt;/param-value&gt;</span>
        <span class="hl-tag">&lt;/init-param&gt;</span>
    <span class="hl-tag">&lt;/servlet&gt;</span>

    <span class="hl-comment">&lt;!-- &#23558;&#25152;&#26377;/app/* &#30340;&#35831;&#27714;&#26144;&#23556;&#21040;dispatcher --&gt;</span>
    <span class="hl-tag">&lt;servlet-mapping&gt;</span>
        <span class="hl-tag">&lt;servlet-name&gt;</span>dispatcher<span class="hl-tag">&lt;/servlet-name&gt;</span>
        <span class="hl-tag">&lt;url-pattern&gt;</span>/app/*<span class="hl-tag">&lt;/url-pattern&gt;</span>
    <span class="hl-tag">&lt;/servlet-mapping&gt;</span>
<span class="hl-tag">&lt;/web-app&gt;</span></pre>

</div>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="beans-java-bean-annotation" href="#beans-java-bean-annotation"></a>5.12.3&nbsp;&#20351;&#29992;@Bean&#27880;&#35299;</h3></div></div></div>

<p><code class="literal">@Bean</code>&#26159;&#19968;&#20010;&#26041;&#27861;&#32423;&#21035;&#30340;&#27880;&#35299;&#65292;&#31867;&#20284;&#20110;XML`&lt;bean/&gt;<code class="literal">&#20803;&#32032;&#12290;
&#36825;&#20010;&#27880;&#35299;&#25903;&#25345;&#19968;&#20123;&#30001;</code>&lt;bean/&gt;<code class="literal">&#25552;&#20379;&#30340;&#23646;&#24615;&#65292;&#20363;&#22914;&#65306;
&lt;&lt;beans-factory-lifecycle-initializingbean,init-method&gt;&gt;,
&lt;&lt;beans-factory-lifecycle-disposablebean,destroy-method&gt;&gt;,
&lt;&lt;beans-factory-autowire,autowiring&gt;&gt; &#21644; `name</code>.</p>
<p>&#20320;&#21487;&#20197;&#22312;&#20351;&#29992;<code class="literal">@Configuration</code>&#25110;<code class="literal">@Component</code>&#30340;&#27880;&#35299;&#31867;&#20013;&#20351;&#29992;<code class="literal">@Bean</code>&#27880;&#35299;&#12290;</p>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-java-declaring-a-bean" href="#beans-java-declaring-a-bean"></a>Declaring a bean</h4></div></div></div>

<p>To declare a bean, simply annotate a method with the <code class="literal">@Bean</code> annotation. You use this
method to register a bean definition within an <code class="literal">ApplicationContext</code> of the type
specified as the method&#8217;s return value. By default, the bean name will be the same as
the method name. The following is a simple example of a <code class="literal">@Bean</code> method declaration:</p>
<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Configuration</span></em>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> AppConfig {

    <em><span class="hl-annotation" style="color: gray">@Bean</span></em>
    <span class="hl-keyword">public</span> TransferService transferService() {
        <span class="hl-keyword">return</span> <span class="hl-keyword">new</span> TransferServiceImpl();
    }

}</pre>

<p>The preceding configuration is exactly equivalent to the following Spring XML:</p>
<pre class="programlisting"><span class="hl-tag">&lt;beans&gt;</span>
    <span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"transferService"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"com.acme.TransferServiceImpl"</span><span class="hl-tag">/&gt;</span>
<span class="hl-tag">&lt;/beans&gt;</span></pre>

<p>Both declarations make a bean named <code class="literal">transferService</code> available in the
<code class="literal">ApplicationContext</code>, bound to an object instance of type <code class="literal">TransferServiceImpl</code>:</p>

<pre class="literallayout">transferService -&gt; com.acme.TransferServiceImpl</pre>

</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-java-lifecycle-callbacks" href="#beans-java-lifecycle-callbacks"></a>Receiving lifecycle callbacks</h4></div></div></div>

<p>Any classes defined with the <code class="literal">@Bean</code> annotation support the regular lifecycle callbacks
and can use the <code class="literal">@PostConstruct</code> and <code class="literal">@PreDestroy</code> annotations from JSR-250, see
<a class="link" href="beans.html#beans-postconstruct-and-predestroy-annotations" title="5.9.7&nbsp;@PostConstruct and @PreDestroy">JSR-250 annotations</a> for further
details.</p>
<p>The regular Spring <a class="link" href="beans.html#beans-factory-nature" title="5.6&nbsp;&#23450;&#21046;bean&#29305;&#24615;">lifecycle</a> callbacks are fully supported as
well. If a bean implements <code class="literal">InitializingBean</code>, <code class="literal">DisposableBean</code>, or <code class="literal">Lifecycle</code>, their
respective methods are called by the container.</p>
<p>The standard set of <code class="literal">*Aware</code> interfaces such as <a class="link" href="beans.html#beans-beanfactory" title="5.16&nbsp;The BeanFactory">BeanFactoryAware</a>,
<a class="link" href="beans.html#beans-factory-aware" title="5.6.2&nbsp;ApplicationContextAware and BeanNameAware">BeanNameAware</a>,
<a class="link" href="beans.html#context-functionality-messagesource" title="5.15.1&nbsp;Internationalization using MessageSource">MessageSourceAware</a>,
<a class="link" href="beans.html#beans-factory-aware" title="5.6.2&nbsp;ApplicationContextAware and BeanNameAware">ApplicationContextAware</a>, and so on are also fully supported.</p>
<p>The <code class="literal">@Bean</code> annotation supports specifying arbitrary initialization and destruction
callback methods, much like Spring XML&#8217;s <code class="literal">init-method</code> and <code class="literal">destroy-method</code> attributes
on the <code class="literal">bean</code> element:</p>
<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> Foo {
    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> init() {
        <span class="hl-comment">// initialization logic</span>
    }
}

<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> Bar {
    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> cleanup() {
        <span class="hl-comment">// destruction logic</span>
    }
}

<em><span class="hl-annotation" style="color: gray">@Configuration</span></em>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> AppConfig {

    <em><span class="hl-annotation" style="color: gray">@Bean(initMethod = "init")</span></em>
    <span class="hl-keyword">public</span> Foo foo() {
        <span class="hl-keyword">return</span> <span class="hl-keyword">new</span> Foo();
    }

    <em><span class="hl-annotation" style="color: gray">@Bean(destroyMethod = "cleanup")</span></em>
    <span class="hl-keyword">public</span> Bar bar() {
        <span class="hl-keyword">return</span> <span class="hl-keyword">new</span> Bar();
    }

}</pre>

<p>Of course, in the case of <code class="literal">Foo</code> above, it would be equally as valid to call the <code class="literal">init()</code>
method directly during construction:</p>
<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Configuration</span></em>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> AppConfig {
    <em><span class="hl-annotation" style="color: gray">@Bean</span></em>
    <span class="hl-keyword">public</span> Foo foo() {
        Foo foo = <span class="hl-keyword">new</span> Foo();
        foo.init();
    <span class="hl-keyword">return</span> foo;
    }

    <span class="hl-comment">// ...</span>

}</pre>

<div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="images/tip.png"></td><th align="left">Tip</th></tr><tr><td align="left" valign="top">
<p>When you work directly in Java, you can do anything you like with your objects and do
not always need to rely on the container lifecycle!</p>
</td></tr></table></div>

</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-java-specifying-bean-scope" href="#beans-java-specifying-bean-scope"></a>Specifying bean scope</h4></div></div></div>

<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="beans-java-available-scopes" href="#beans-java-available-scopes"></a>Using the @Scope annotation</h5></div></div></div>

<p>You can specify that your beans defined with the <code class="literal">@Bean</code> annotation should have a
specific scope. You can use any of the standard scopes specified in the
<a class="link" href="beans.html#beans-factory-scopes" title="5.5&nbsp;Bean&#20316;&#29992;&#22495;">Bean Scopes</a> section.</p>
<p>The default scope is <code class="literal">singleton</code>, but you can override this with the <code class="literal">@Scope</code> annotation:</p>
<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Configuration</span></em>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> MyConfiguration {

    <em><span class="hl-annotation" style="color: gray">@Bean</span></em>
    <span class="strong"><strong>@Scope("prototype")</strong></span>
    <span class="hl-keyword">public</span> Encryptor encryptor() {
        <span class="hl-comment">// ...</span>
    }

}</pre>

</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="beans-java-scoped-proxy" href="#beans-java-scoped-proxy"></a>@Scope and scoped-proxy</h5></div></div></div>

<p>Spring offers a convenient way of working with scoped dependencies through
<a class="link" href="beans.html#beans-factory-scopes-other-injection" title="&#23558;&#19978;&#36848;&#20316;&#29992;&#22495;&#30340;bean&#20316;&#20026;&#20381;&#36182;">scoped proxies</a>. The easiest way to create such
a proxy when using the XML configuration is the <code class="literal">&lt;aop:scoped-proxy/&gt;</code> element.
Configuring your beans in Java with a @Scope annotation offers equivalent support with
the proxyMode attribute. The default is no proxy ( <code class="literal">ScopedProxyMode.NO</code>), but you can
specify <code class="literal">ScopedProxyMode.TARGET_CLASS</code> or <code class="literal">ScopedProxyMode.INTERFACES</code>.</p>
<p>If you port the scoped proxy example from the XML reference documentation (see preceding
link) to our <code class="literal">@Bean</code> using Java, it would look like the following:</p>
<pre class="programlisting"><span class="hl-comment">// an HTTP Session-scoped bean exposed as a proxy</span>
<em><span class="hl-annotation" style="color: gray">@Bean</span></em>
<span class="strong"><strong>@Scope(value = "session", proxyMode = ScopedProxyMode.TARGET_CLASS)</strong></span>
<span class="hl-keyword">public</span> UserPreferences userPreferences() {
    <span class="hl-keyword">return</span> <span class="hl-keyword">new</span> UserPreferences();
}

<em><span class="hl-annotation" style="color: gray">@Bean</span></em>
<span class="hl-keyword">public</span> Service userService() {
    UserService service = <span class="hl-keyword">new</span> SimpleUserService();
    <span class="hl-comment">// a reference to the proxied userPreferences bean</span>
    service.setUserPreferences(userPreferences());
    <span class="hl-keyword">return</span> service;
}</pre>

</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-java-customizing-bean-naming" href="#beans-java-customizing-bean-naming"></a>Customizing bean naming</h4></div></div></div>

<p>By default, configuration classes use a <code class="literal">@Bean</code> method&#8217;s name as the name of the
resulting bean. This functionality can be overridden, however, with the <code class="literal">name</code> attribute.</p>
<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Configuration</span></em>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> AppConfig {

    <em><span class="hl-annotation" style="color: gray">@Bean(name = "myFoo")</span></em>
    <span class="hl-keyword">public</span> Foo foo() {
        <span class="hl-keyword">return</span> <span class="hl-keyword">new</span> Foo();
    }

}</pre>

</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-java-bean-aliasing" href="#beans-java-bean-aliasing"></a>Bean aliasing</h4></div></div></div>

<p>As discussed in <a class="xref" href="beans.html#beans-beanname" title="5.3.1&nbsp;bean&#30340;&#21629;&#21517;">Section&nbsp;5.3.1, &#8220;bean&#30340;&#21629;&#21517;&#8221;</a>, it is sometimes desirable to give a single bean
multiple names, otherwise known as<span class="emphasis"><em>bean aliasing</em></span>. The <code class="literal">name</code> attribute of the <code class="literal">@Bean</code>
annotation accepts a String array for this purpose.</p>
<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Configuration</span></em>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> AppConfig {

    <em><span class="hl-annotation" style="color: gray">@Bean(name = { "dataSource", "subsystemA-dataSource", "subsystemB-dataSource" })</span></em>
    <span class="hl-keyword">public</span> DataSource dataSource() {
        <span class="hl-comment">// instantiate, configure and return DataSource bean...</span>
    }

}</pre>

</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-java-bean-description" href="#beans-java-bean-description"></a>Bean description</h4></div></div></div>

<p>Sometimes it is helpful to provide a more detailed textual description of a bean. This can
be particularly useful when beans are exposed (perhaps via JMX) for monitoring purposes.</p>
<p>To add a description to a <code class="literal">@Bean</code> the
<a class="ulink" href="http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/context/annotation/Description.html" target="_top"><code class="literal">@Description</code></a>
annotation can be used:</p>
<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Configuration</span></em>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> AppConfig {

    <em><span class="hl-annotation" style="color: gray">@Bean</span></em>
    <span class="strong"><strong>@Description("Provides a basic example of a bean")</strong></span>
    <span class="hl-keyword">public</span> Foo foo() {
        <span class="hl-keyword">return</span> <span class="hl-keyword">new</span> Foo();
    }

}</pre>

</div>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="beans-java-configuration-annotation" href="#beans-java-configuration-annotation"></a>5.12.4&nbsp;Using the @Configuration annotation</h3></div></div></div>

<p><code class="literal">@Configuration</code> is a class-level annotation indicating that an object is a source of
bean definitions. <code class="literal">@Configuration</code> classes declare beans via public <code class="literal">@Bean</code> annotated
methods. Calls to <code class="literal">@Bean</code> methods on <code class="literal">@Configuration</code> classes can also be used to define
inter-bean dependencies. See <a class="xref" href="beans.html#beans-java-basic-concepts" title="5.12.1&nbsp;&#22522;&#26412;&#27010;&#24565;: @Bean and @Configuration">Section&nbsp;5.12.1, &#8220;&#22522;&#26412;&#27010;&#24565;: @Bean and @Configuration&#8221;</a> for a general introduction.</p>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-java-injecting-dependencies" href="#beans-java-injecting-dependencies"></a>Injecting inter-bean dependencies</h4></div></div></div>

<p>When <code class="literal">@Bean</code>s have dependencies on one another, expressing that dependency is as simple
as having one bean method call another:</p>
<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Configuration</span></em>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> AppConfig {

    <em><span class="hl-annotation" style="color: gray">@Bean</span></em>
    <span class="hl-keyword">public</span> Foo foo() {
        <span class="hl-keyword">return</span> <span class="hl-keyword">new</span> Foo(bar());
    }

    <em><span class="hl-annotation" style="color: gray">@Bean</span></em>
    <span class="hl-keyword">public</span> Bar bar() {
        <span class="hl-keyword">return</span> <span class="hl-keyword">new</span> Bar();
    }

}</pre>

<p>In the example above, the <code class="literal">foo</code> bean receives a reference to <code class="literal">bar</code> via constructor
injection.</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p>This method of declaring inter-bean dependencies only works when the <code class="literal">@Bean</code> method is
declared within a <code class="literal">@Configuration</code> class. You cannot declare inter-bean dependencies
using plain <code class="literal">@Component</code> classes.</p>
</td></tr></table></div>

</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-java-method-injection" href="#beans-java-method-injection"></a>Lookup method injection</h4></div></div></div>

<p>As noted earlier, <a class="link" href="beans.html#beans-factory-method-injection" title="5.4.6&nbsp;&#26041;&#27861;&#27880;&#20837;">lookup method injection</a> is an
advanced feature that you should use rarely. It is useful in cases where a
singleton-scoped bean has a dependency on a prototype-scoped bean. Using Java for this
type of configuration provides a natural means for implementing this pattern.</p>
<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">abstract</span> <span class="hl-keyword">class</span> CommandManager {
    <span class="hl-keyword">public</span> Object process(Object commandState) {
        <span class="hl-comment">// grab a new instance of the appropriate Command interface</span>
        Command command = createCommand();

        <span class="hl-comment">// set the state on the (hopefully brand new) Command instance</span>
        command.setState(commandState);
    <span class="hl-keyword">return</span> command.execute();
    }

    <span class="hl-comment">// okay... but where is the implementation of this method?</span>
    <span class="hl-keyword">protected</span> <span class="hl-keyword">abstract</span> Command createCommand();
}</pre>

<p>Using Java-configuration support , you can create a subclass of <code class="literal">CommandManager</code> where
the abstract <code class="literal">createCommand()</code> method is overridden in such a way that it looks up a new
(prototype) command object:</p>
<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Bean</span></em>
<em><span class="hl-annotation" style="color: gray">@Scope("prototype")</span></em>
<span class="hl-keyword">public</span> AsyncCommand asyncCommand() {
    AsyncCommand command = <span class="hl-keyword">new</span> AsyncCommand();
    <span class="hl-comment">// inject dependencies here as required</span>
    <span class="hl-keyword">return</span> command;
}

<em><span class="hl-annotation" style="color: gray">@Bean</span></em>
<span class="hl-keyword">public</span> CommandManager commandManager() {
    <span class="hl-comment">// return new anonymous implementation of CommandManager with command() overridden</span>
    <span class="hl-comment">// to return a new prototype Command object</span>
    <span class="hl-keyword">return</span> <span class="hl-keyword">new</span> CommandManager() {
        <span class="hl-keyword">protected</span> Command createCommand() {
            <span class="hl-keyword">return</span> asyncCommand();
        }
    }
}</pre>

</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-java-further-information-java-config" href="#beans-java-further-information-java-config"></a>Further information about how Java-based configuration works internally</h4></div></div></div>

<p>The following example shows a <code class="literal">@Bean</code> annotated method being called twice:</p>
<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Configuration</span></em>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> AppConfig {

    <em><span class="hl-annotation" style="color: gray">@Bean</span></em>
    <span class="hl-keyword">public</span> ClientService clientService1() {
        ClientServiceImpl clientService = <span class="hl-keyword">new</span> ClientServiceImpl();
        clientService.setClientDao(clientDao());
        <span class="hl-keyword">return</span> clientService;
    }

    <em><span class="hl-annotation" style="color: gray">@Bean</span></em>
    <span class="hl-keyword">public</span> ClientService clientService2() {
        ClientServiceImpl clientService = <span class="hl-keyword">new</span> ClientServiceImpl();
        clientService.setClientDao(clientDao());
        <span class="hl-keyword">return</span> clientService;
    }

    <em><span class="hl-annotation" style="color: gray">@Bean</span></em>
    <span class="hl-keyword">public</span> ClientDao clientDao() {
        <span class="hl-keyword">return</span> <span class="hl-keyword">new</span> ClientDaoImpl();
    }

}</pre>

<p><code class="literal">clientDao()</code> has been called once in <code class="literal">clientService1()</code> and once in <code class="literal">clientService2()</code>.
Since this method creates a new instance of <code class="literal">ClientDaoImpl</code> and returns it, you would
normally expect having 2 instances (one for each service). That definitely would be
problematic: in Spring, instantiated beans have a <code class="literal">singleton</code> scope by default. This is
where the magic comes in: All <code class="literal">@Configuration</code> classes are subclassed at startup-time
with <code class="literal">CGLIB</code>. In the subclass, the child method checks the container first for any
cached (scoped) beans before it calls the parent method and creates a new instance. Note
that as of Spring 3.2, it is no longer necessary to add CGLIB to your classpath because
CGLIB classes have been repackaged under org.springframework and included directly
within the spring-core JAR.</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p>The behavior could be different according to the scope of your bean. We are talking
about singletons here.</p>
</td></tr></table></div>

<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p>There are a few restrictions due to the fact that CGLIB dynamically adds features at
startup-time:</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
Configuration classes should not be final
</li><li class="listitem">
They should have a constructor with no arguments
</li></ul></div>

</td></tr></table></div>

</div>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="beans-java-composing-configuration-classes" href="#beans-java-composing-configuration-classes"></a>5.12.5&nbsp;Composing Java-based configurations</h3></div></div></div>

<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-java-using-import" href="#beans-java-using-import"></a>Using the @Import annotation</h4></div></div></div>

<p>Much as the <code class="literal">&lt;import/&gt;</code> element is used within Spring XML files to aid in modularizing
configurations, the <code class="literal">@Import</code> annotation allows for loading <code class="literal">@Bean</code> definitions from
another configuration class:</p>
<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Configuration</span></em>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> ConfigA {

     <em><span class="hl-annotation" style="color: gray">@Bean</span></em>
    <span class="hl-keyword">public</span> A a() {
        <span class="hl-keyword">return</span> <span class="hl-keyword">new</span> A();
    }

}

<em><span class="hl-annotation" style="color: gray">@Configuration</span></em>
<em><span class="hl-annotation" style="color: gray">@Import(ConfigA.class)</span></em>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> ConfigB {

    <em><span class="hl-annotation" style="color: gray">@Bean</span></em>
    <span class="hl-keyword">public</span> B b() {
        <span class="hl-keyword">return</span> <span class="hl-keyword">new</span> B();
    }

}</pre>

<p>Now, rather than needing to specify both <code class="literal">ConfigA.class</code> and <code class="literal">ConfigB.class</code> when
instantiating the context, only <code class="literal">ConfigB</code> needs to be supplied explicitly:</p>
<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">static</span> <span class="hl-keyword">void</span> main(String[] args) {
    ApplicationContext ctx = <span class="hl-keyword">new</span> AnnotationConfigApplicationContext(ConfigB.<span class="hl-keyword">class</span>);

    <span class="hl-comment">// now both beans A and B will be available...</span>
    A a = ctx.getBean(A.<span class="hl-keyword">class</span>);
    B b = ctx.getBean(B.<span class="hl-keyword">class</span>);
}</pre>

<p>This approach simplifies container instantiation, as only one class needs to be dealt
with, rather than requiring the developer to remember a potentially large number of
<code class="literal">@Configuration</code> classes during construction.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="beans-java-injecting-imported-beans" href="#beans-java-injecting-imported-beans"></a>Injecting dependencies on imported @Bean definitions</h5></div></div></div>

<p>The example above works, but is simplistic. In most practical scenarios, beans will have
dependencies on one another across configuration classes. When using XML, this is not an
issue, per se, because there is no compiler involved, and one can simply declare
<code class="literal">ref="someBean"</code> and trust that Spring will work it out during container initialization.
Of course, when using <code class="literal">@Configuration</code> classes, the Java compiler places constraints on
the configuration model, in that references to other beans must be valid Java syntax.</p>
<p>Fortunately, solving this problem is simple. Remember that <code class="literal">@Configuration</code> classes are
ultimately just another bean in the container - this means that they can take advantage
of <code class="literal">@Autowired</code> injection metadata just like any other bean!</p>
<p>Let&#8217;s consider a more real-world scenario with several <code class="literal">@Configuration</code> classes, each
depending on beans declared in the others:</p>
<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Configuration</span></em>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> ServiceConfig {

    <em><span class="hl-annotation" style="color: gray">@Autowired</span></em>
    <span class="hl-keyword">private</span> AccountRepository accountRepository;

    <em><span class="hl-annotation" style="color: gray">@Bean</span></em>
    <span class="hl-keyword">public</span> TransferService transferService() {
        <span class="hl-keyword">return</span> <span class="hl-keyword">new</span> TransferServiceImpl(accountRepository);
    }

}

<em><span class="hl-annotation" style="color: gray">@Configuration</span></em>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> RepositoryConfig {

    <em><span class="hl-annotation" style="color: gray">@Autowired</span></em>
    <span class="hl-keyword">private</span> DataSource dataSource;

    <em><span class="hl-annotation" style="color: gray">@Bean</span></em>
    <span class="hl-keyword">public</span> AccountRepository accountRepository() {
        <span class="hl-keyword">return</span> <span class="hl-keyword">new</span> JdbcAccountRepository(dataSource);
    }

}

<em><span class="hl-annotation" style="color: gray">@Configuration</span></em>
<em><span class="hl-annotation" style="color: gray">@Import({ServiceConfig.class, RepositoryConfig.class})</span></em>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> SystemTestConfig {

    <em><span class="hl-annotation" style="color: gray">@Bean</span></em>
    <span class="hl-keyword">public</span> DataSource dataSource() {
        <span class="hl-comment">// return new DataSource</span>
    }

}

<span class="hl-keyword">public</span> <span class="hl-keyword">static</span> <span class="hl-keyword">void</span> main(String[] args) {
    ApplicationContext ctx = <span class="hl-keyword">new</span> AnnotationConfigApplicationContext(SystemTestConfig.<span class="hl-keyword">class</span>);
    <span class="hl-comment">// everything wires up across configuration classes...</span>
    TransferService transferService = ctx.getBean(TransferService.<span class="hl-keyword">class</span>);
    transferService.transfer(<span class="hl-number">100.00</span>, <span class="hl-string">"A123"</span>, <span class="hl-string">"C456"</span>);
}</pre>

<p>In the scenario above, using <code class="literal">@Autowired</code> works well and provides the desired
modularity, but determining exactly where the autowired bean definitions are declared is
still somewhat ambiguous. For example, as a developer looking at <code class="literal">ServiceConfig</code>, how do
you know exactly where the <code class="literal">@Autowired AccountRepository</code> bean is declared? It&#8217;s not
explicit in the code, and this may be just fine. Remember that the
<a class="ulink" href="https://spring.io/tools/sts" target="_top">Spring Tool Suite</a> provides tooling that
can render graphs showing how everything is wired up - that may be all you need. Also,
your Java IDE can easily find all declarations and uses of the <code class="literal">AccountRepository</code> type,
and will quickly show you the location of <code class="literal">@Bean</code> methods that return that type.</p>
<p>In cases where this ambiguity is not acceptable and you wish to have direct navigation
from within your IDE from one <code class="literal">@Configuration</code> class to another, consider autowiring the
configuration classes themselves:</p>
<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Configuration</span></em>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> ServiceConfig {

    <em><span class="hl-annotation" style="color: gray">@Autowired</span></em>
    <span class="hl-keyword">private</span> RepositoryConfig repositoryConfig;

    <em><span class="hl-annotation" style="color: gray">@Bean</span></em>
    <span class="hl-keyword">public</span> TransferService transferService() {
        <span class="hl-comment">// navigate </span><span class="emphasis"><em>through</em></span> the config <span class="hl-keyword">class</span> to the <em><span class="hl-annotation" style="color: gray">@Bean</span></em> method!
        <span class="hl-keyword">return</span> <span class="hl-keyword">new</span> TransferServiceImpl(repositoryConfig.accountRepository());
    }

}</pre>

<p>In the situation above, it is completely explicit where <code class="literal">AccountRepository</code> is defined.
However, <code class="literal">ServiceConfig</code> is now tightly coupled to <code class="literal">RepositoryConfig</code>; that&#8217;s the
tradeoff. This tight coupling can be somewhat mitigated by using interface-based or
abstract class-based <code class="literal">@Configuration</code> classes. Consider the following:</p>
<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Configuration</span></em>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> ServiceConfig {

    <em><span class="hl-annotation" style="color: gray">@Autowired</span></em>
    <span class="hl-keyword">private</span> RepositoryConfig repositoryConfig;

    <em><span class="hl-annotation" style="color: gray">@Bean</span></em>
    <span class="hl-keyword">public</span> TransferService transferService() {
        <span class="hl-keyword">return</span> <span class="hl-keyword">new</span> TransferServiceImpl(repositoryConfig.accountRepository());
    }
}

<em><span class="hl-annotation" style="color: gray">@Configuration</span></em>
<span class="hl-keyword">public</span> <span class="hl-keyword">interface</span> RepositoryConfig {

    <em><span class="hl-annotation" style="color: gray">@Bean</span></em>
    AccountRepository accountRepository();

}

<em><span class="hl-annotation" style="color: gray">@Configuration</span></em>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> DefaultRepositoryConfig <span class="hl-keyword">implements</span> RepositoryConfig {

    <em><span class="hl-annotation" style="color: gray">@Bean</span></em>
    <span class="hl-keyword">public</span> AccountRepository accountRepository() {
        <span class="hl-keyword">return</span> <span class="hl-keyword">new</span> JdbcAccountRepository(...);
    }

}

<em><span class="hl-annotation" style="color: gray">@Configuration</span></em>
<em><span class="hl-annotation" style="color: gray">@Import({ServiceConfig.class, DefaultRepositoryConfig.class})</span></em> <span class="hl-comment">// import the concrete config!</span>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> SystemTestConfig {

    <em><span class="hl-annotation" style="color: gray">@Bean</span></em>
    <span class="hl-keyword">public</span> DataSource dataSource() {
        <span class="hl-comment">// return DataSource</span>
    }

}

<span class="hl-keyword">public</span> <span class="hl-keyword">static</span> <span class="hl-keyword">void</span> main(String[] args) {
    ApplicationContext ctx = <span class="hl-keyword">new</span> AnnotationConfigApplicationContext(SystemTestConfig.<span class="hl-keyword">class</span>);
    TransferService transferService = ctx.getBean(TransferService.<span class="hl-keyword">class</span>);
    transferService.transfer(<span class="hl-number">100.00</span>, <span class="hl-string">"A123"</span>, <span class="hl-string">"C456"</span>);
}</pre>

<p>Now <code class="literal">ServiceConfig</code> is loosely coupled with respect to the concrete
<code class="literal">DefaultRepositoryConfig</code>, and built-in IDE tooling is still useful: it will be easy for
the developer to get a type hierarchy of <code class="literal">RepositoryConfig</code> implementations. In this
way, navigating <code class="literal">@Configuration</code> classes and their dependencies becomes no different
than the usual process of navigating interface-based code.</p>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-java-conditional" href="#beans-java-conditional"></a>Conditionally including @Configuration classes or @Beans</h4></div></div></div>

<p>It is often useful to conditionally enable to disable a complete <code class="literal">@Configuration</code> class,
or even individual <code class="literal">@Bean</code> methods, based on some arbitrary system state. One common
example of this it to use the <code class="literal">@Profile</code> annotation to active beans only when a specific
profile has been enabled in the Spring <code class="literal">Environment</code> (see <a class="xref" href="beans.html#beans-definition-profiles" title="5.13.1&nbsp;Bean&#23450;&#20041;&#37197;&#32622;&#25991;&#20214;">Section&nbsp;5.13.1, &#8220;Bean&#23450;&#20041;&#37197;&#32622;&#25991;&#20214;&#8221;</a>
for details).</p>
<p>The <code class="literal">@Profile</code> annotation is actually implemented using a much more flexible annotation
called <a class="ulink" href="http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/context/annotation/Conditional.html" target="_top"><code class="literal">@Conditional</code></a>.
The <code class="literal">@Conditional</code> annotation indicates specific
<code class="literal">org.springframework.context.annotation.Condition</code> implementations that should be
consulted before a <code class="literal">@Bean</code> is registered.</p>
<p>Implementations of the <code class="literal">Condition</code> interface simply provide a <code class="literal">matches(...)</code>
method that returns <code class="literal">true</code> or <code class="literal">false</code>. For example, here is the actual
<code class="literal">Condition</code> implementation used for <code class="literal">@Profile</code>:</p>
<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Override</span></em>
<span class="hl-keyword">public</span> <span class="hl-keyword">boolean</span> matches(ConditionContext context, AnnotatedTypeMetadata metadata) {
    <span class="hl-keyword">if</span> (context.getEnvironment() != null) {
        <span class="hl-comment">// Read the @Profile annotation attributes</span>
        MultiValueMap&lt;String, Object&gt; attrs = metadata.getAllAnnotationAttributes(Profile.<span class="hl-keyword">class</span>.getName());
        <span class="hl-keyword">if</span> (attrs != null) {
            <span class="hl-keyword">for</span> (Object value : attrs.get(<span class="hl-string">"value"</span>)) {
                <span class="hl-keyword">if</span> (context.getEnvironment().acceptsProfiles(((String[]) value))) {
                    <span class="hl-keyword">return</span> true;
                }
            }
            <span class="hl-keyword">return</span> false;
        }
    }
    <span class="hl-keyword">return</span> true;
}</pre>

<p>See the <a class="ulink" href="http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/context/annotation/Conditional.html" target="_top">
<code class="literal">@Conditional</code> javadocs</a> for more detail.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-java-combining" href="#beans-java-combining"></a>Combining Java and XML configuration</h4></div></div></div>

<p>Spring&#8217;s <code class="literal">@Configuration</code> class support does not aim to be a 100% complete replacement
for Spring XML. Some facilities such as Spring XML namespaces remain an ideal way to
configure the container. In cases where XML is convenient or necessary, you have a
choice: either instantiate the container in an "XML-centric" way using, for example,
<code class="literal">ClassPathXmlApplicationContext</code>, or in a "Java-centric" fashion using
<code class="literal">AnnotationConfigApplicationContext</code> and the <code class="literal">@ImportResource</code> annotation to import XML
as needed.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="beans-java-combining-xml-centric" href="#beans-java-combining-xml-centric"></a>XML-centric use of @Configuration classes</h5></div></div></div>

<p>It may be preferable to bootstrap the Spring container from XML and include
<code class="literal">@Configuration</code> classes in an ad-hoc fashion. For example, in a large existing codebase
that uses Spring XML, it will be easier to create <code class="literal">@Configuration</code> classes on an
as-needed basis and include them from the existing XML files. Below you&#8217;ll find the
options for using <code class="literal">@Configuration</code> classes in this kind of "XML-centric" situation.</p>
<p>Remember that <code class="literal">@Configuration</code> classes are ultimately just bean definitions in the
container. In this example, we create a <code class="literal">@Configuration</code> class named <code class="literal">AppConfig</code> and
include it within <code class="literal">system-test-config.xml</code> as a <code class="literal">&lt;bean/&gt;</code> definition. Because
<code class="literal">&lt;context:annotation-config/&gt;</code> is switched on, the container will recognize the
<code class="literal">@Configuration</code> annotation, and process the <code class="literal">@Bean</code> methods declared in <code class="literal">AppConfig</code>
properly.</p>
<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Configuration</span></em>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> AppConfig {

    <em><span class="hl-annotation" style="color: gray">@Autowired</span></em>
    <span class="hl-keyword">private</span> DataSource dataSource;

    <em><span class="hl-annotation" style="color: gray">@Bean</span></em>
    <span class="hl-keyword">public</span> AccountRepository accountRepository() {
        <span class="hl-keyword">return</span> <span class="hl-keyword">new</span> JdbcAccountRepository(dataSource);
    }

    <em><span class="hl-annotation" style="color: gray">@Bean</span></em>
    <span class="hl-keyword">public</span> TransferService transferService() {
        <span class="hl-keyword">return</span> <span class="hl-keyword">new</span> TransferService(accountRepository());
    }

}</pre>

<pre class="programlisting">system-test-config.xml
<span class="hl-tag">&lt;beans&gt;</span>
    <span class="hl-comment">&lt;!-- enable processing of annotations such as @Autowired and @Configuration --&gt;</span>
    <span class="hl-tag">&lt;context:annotation-config/&gt;</span>
    <span class="hl-tag">&lt;context:property-placeholder</span> <span class="hl-attribute">location</span>=<span class="hl-value">"classpath:/com/acme/jdbc.properties"</span><span class="hl-tag">/&gt;</span>

    <span class="hl-tag">&lt;bean</span> <span class="hl-attribute">class</span>=<span class="hl-value">"com.acme.AppConfig"</span><span class="hl-tag">/&gt;</span>

    <span class="hl-tag">&lt;bean</span> <span class="hl-attribute">class</span>=<span class="hl-value">"org.springframework.jdbc.datasource.DriverManagerDataSource"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"url"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"${jdbc.url}"</span><span class="hl-tag">/&gt;</span>
        <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"username"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"${jdbc.username}"</span><span class="hl-tag">/&gt;</span>
        <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"password"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"${jdbc.password}"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;/bean&gt;</span>
<span class="hl-tag">&lt;/beans&gt;</span></pre>


<pre class="literallayout">jdbc.properties
jdbc.url=jdbc:hsqldb:hsql://localhost/xdb
jdbc.username=sa
jdbc.password=</pre>

<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">static</span> <span class="hl-keyword">void</span> main(String[] args) {
    ApplicationContext ctx = <span class="hl-keyword">new</span> ClassPathXmlApplicationContext(<span class="hl-string">"classpath:/com/acme/system-test-config.xml"</span>);
    TransferService transferService = ctx.getBean(TransferService.<span class="hl-keyword">class</span>);
    <span class="hl-comment">// ...</span>
}</pre>

<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p>In <code class="literal">system-test-config.xml</code> above, the <code class="literal">AppConfig&lt;bean/&gt;</code> does not declare an <code class="literal">id</code>
element. While it would be acceptable to do so, it is unnecessary given that no other
bean will ever refer to it, and it is unlikely that it will be explicitly fetched from
the container by name. Likewise with the <code class="literal">DataSource</code> bean - it is only ever autowired
by type, so an explicit bean id is not strictly required.</p>
</td></tr></table></div>

<p>Because <code class="literal">@Configuration</code> is meta-annotated with <code class="literal">@Component</code>, <code class="literal">@Configuration</code>-annotated
classes are automatically candidates for component scanning. Using the same scenario as
above, we can redefine <code class="literal">system-test-config.xml</code> to take advantage of component-scanning.
Note that in this case, we don&#8217;t need to explicitly declare
<code class="literal">&lt;context:annotation-config/&gt;</code>, because <code class="literal">&lt;context:component-scan/&gt;</code> enables all the same
functionality.</p>
<pre class="programlisting">system-test-config.xml
<span class="hl-tag">&lt;beans&gt;</span>
    <span class="hl-comment">&lt;!-- picks up and registers AppConfig as a bean definition --&gt;</span>
    <span class="hl-tag">&lt;context:component-scan</span> <span class="hl-attribute">base-package</span>=<span class="hl-value">"com.acme"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;context:property-placeholder</span> <span class="hl-attribute">location</span>=<span class="hl-value">"classpath:/com/acme/jdbc.properties"</span><span class="hl-tag">/&gt;</span>

    <span class="hl-tag">&lt;bean</span> <span class="hl-attribute">class</span>=<span class="hl-value">"org.springframework.jdbc.datasource.DriverManagerDataSource"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"url"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"${jdbc.url}"</span><span class="hl-tag">/&gt;</span>
        <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"username"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"${jdbc.username}"</span><span class="hl-tag">/&gt;</span>
        <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"password"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"${jdbc.password}"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;/bean&gt;</span>
<span class="hl-tag">&lt;/beans&gt;</span></pre>

</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="beans-java-combining-java-centric" href="#beans-java-combining-java-centric"></a>@Configuration class-centric use of XML with @ImportResource</h5></div></div></div>

<p>In applications where <code class="literal">@Configuration</code> classes are the primary mechanism for configuring
the container, it will still likely be necessary to use at least some XML. In these
scenarios, simply use <code class="literal">@ImportResource</code> and define only as much XML as is needed. Doing
so achieves a "Java-centric" approach to configuring the container and keeps XML to a
bare minimum.</p>
<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Configuration</span></em>
<em><span class="hl-annotation" style="color: gray">@ImportResource("classpath:/com/acme/properties-config.xml")</span></em>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> AppConfig {

    <em><span class="hl-annotation" style="color: gray">@Value("${jdbc.url}")</span></em>
    <span class="hl-keyword">private</span> String url;

    <em><span class="hl-annotation" style="color: gray">@Value("${jdbc.username}")</span></em>
    <span class="hl-keyword">private</span> String username;

    <em><span class="hl-annotation" style="color: gray">@Value("${jdbc.password}")</span></em>
    <span class="hl-keyword">private</span> String password;

    <em><span class="hl-annotation" style="color: gray">@Bean</span></em>
    <span class="hl-keyword">public</span> DataSource dataSource() {
        <span class="hl-keyword">return</span> <span class="hl-keyword">new</span> DriverManagerDataSource(url, username, password);
    }

}</pre>

<pre class="programlisting">properties-config.xml
<span class="hl-tag">&lt;beans&gt;</span>
    <span class="hl-tag">&lt;context:property-placeholder</span> <span class="hl-attribute">location</span>=<span class="hl-value">"classpath:/com/acme/jdbc.properties"</span><span class="hl-tag">/&gt;</span>
<span class="hl-tag">&lt;/beans&gt;</span></pre>


<pre class="literallayout">jdbc.properties
jdbc.url=jdbc:hsqldb:hsql://localhost/xdb
jdbc.username=sa
jdbc.password=</pre>

<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">static</span> <span class="hl-keyword">void</span> main(String[] args) {
    ApplicationContext ctx = <span class="hl-keyword">new</span> AnnotationConfigApplicationContext(AppConfig.<span class="hl-keyword">class</span>);
    TransferService transferService = ctx.getBean(TransferService.<span class="hl-keyword">class</span>);
    <span class="hl-comment">// ...</span>
}</pre>

</div>
</div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="beans-environment" href="#beans-environment"></a>5.13&nbsp;Environment&#25277;&#35937;</h2></div></div></div>

<p><a class="ulink" href="http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/core/env/Environment.html" target="_top"><code class="literal">Environment</code></a>
&#26159;&#38598;&#25104;&#22312;&#23481;&#22120;&#20013;&#30340;&#25277;&#35937;&#65292;&#20182;&#21253;&#21547;&#20102;&#20004;&#20010;&#20004;&#20010;&#26041;&#38754;&#65306;<a class="link" href="beans.html#beans-definition-profiles" title="5.13.1&nbsp;Bean&#23450;&#20041;&#37197;&#32622;&#25991;&#20214;"><span class="emphasis"><em>profiles</em></span></a>
&#21644; <a class="link" href="beans.html#beans-property-source-abstraction" title="5.13.3&nbsp;PropertySource&#30340;&#25277;&#35937;"><span class="emphasis"><em>properties</em></span></a>.</p>
<p><span class="emphasis"><em>profile</em></span>&#26159;&#19968;&#20010;&#21629;&#21517;&#65292;&#26159;&#19968;&#32452;&#36923;&#36753;&#19978;bean&#23450;&#20041;&#30340;&#32452;&#65292;&#21482;&#26377;&#30456;&#24212;&#30340;profile&#34987;&#28608;&#27963;&#30340;&#24773;&#20917;&#19979;&#25165;&#20250;&#36215;&#20316;&#29992;&#12290;&#21487;&#20197;&#36890;&#36807;XML&#25110;&#32773;&#27880;&#35299;&#23558;bean&#20998;&#37197;&#32473;&#19968;&#20010;profile&#65292;<code class="literal">Environment</code>&#23545;&#35937;&#22312;profile&#20013;&#30340;&#35282;&#33394;&#26159;&#21028;&#26029;&#21738;&#19968;&#20010;profile&#24212;&#35813;&#22312;&#24403;&#21069;&#28608;&#27963;&#21644;&#21738;&#19968;&#20010;profile&#24212;&#35813;&#22312;&#40664;&#35748;&#24773;&#20917;&#19979;&#28608;&#27963;&#12290;</p>
<p>&#23646;&#24615;&#22312;&#20960;&#20046;&#25152;&#26377;&#24212;&#29992;&#20013;&#37117;&#25198;&#28436;&#20102;&#38750;&#24120;&#37325;&#35201;&#30340;&#35282;&#33394;&#65292;&#24182;&#19988;&#21487;&#33021;&#26469;&#28304;&#20110;&#21508;&#31181;&#21508;&#26679;&#30340;&#36164;&#28304;&#65306;&#23646;&#24615;&#25991;&#20214;&#65292;JVM&#31995;&#32479;&#23646;&#24615;&#65292;&#31995;&#32479;&#29615;&#22659;&#21464;&#37327;&#65292;JNDI&#65292;servlet&#19978;&#19979;&#25991;&#21442;&#25968;&#65292;&#28857;&#23545;&#28857;&#30340;&#23646;&#24615;&#23545;&#35937;&#65292;&#26144;&#23556;&#31561;&#31561;&#12290;<code class="literal">Environment</code>&#23545;&#35937;&#22312;&#23646;&#24615;&#20013;&#30340;&#35282;&#33394;&#26159;&#25552;&#20379;&#19968;&#20010;&#26041;&#20415;&#30340;&#26381;&#21153;&#25509;&#21475;&#26469;&#37197;&#32622;&#23646;&#24615;&#36164;&#28304;&#21644;&#35299;&#20915;&#23427;&#20204;&#30340;&#23646;&#24615;&#12290;</p>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="beans-definition-profiles" href="#beans-definition-profiles"></a>5.13.1&nbsp;Bean&#23450;&#20041;&#37197;&#32622;&#25991;&#20214;</h3></div></div></div>

<p>Beand&#23450;&#20041;&#37197;&#32622;&#25991;&#20214;&#26159;&#26680;&#24515;&#23481;&#22120;&#30340;&#19968;&#31181;&#26426;&#21046;&#65292;&#23427;&#20801;&#35768;&#20026;&#19981;&#21516;&#30340;bean&#22312;&#19981;&#21516;&#30340;&#29615;&#22659;&#20013;&#27880;&#20876;&#12290;
<span class="emphasis"><em>environment</em></span>&#36825;&#20010;&#35789;&#21487;&#20197;&#24847;&#21619;&#30528;&#19981;&#21516;&#30340;&#20107;&#24773;&#19981;&#21516;&#30340;&#29992;&#25143;&#65292;&#32780;&#19988;&#36825;&#20010;&#21151;&#33021;&#21487;&#20197;&#24110;&#21161;&#24456;&#22810;&#29992;&#20363;&#65292;&#21253;&#25324;&#65306;</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
&#22312;&#24037;&#20316;&#20013;&#20351;&#29992;&#20869;&#23384;&#25968;&#25454;&#28304;&#24182;&#19988;&#22312;QA&#21644;&#29983;&#20135;&#29615;&#22659;&#20013;&#36890;&#36807;JDNI&#26597;&#25214;&#30456;&#21516;&#30340;&#25968;&#25454;&#28304;
</li><li class="listitem">
&#21482;&#26377;&#24403;&#37096;&#32626;&#24212;&#29992;&#21040;&#19968;&#20010;&#24615;&#33021;&#27979;&#35797;&#29615;&#22659;&#26102;&#27880;&#20876;&#30417;&#35270;&#24037;&#20855;
</li><li class="listitem">
&#32473;&#23458;&#25143;A&#27880;&#20876;&#23450;&#21046;&#30340;bean&#23454;&#29616;&#32780;&#19981;&#38656;&#35201;&#32473;&#23458;&#25143;B&#26102;
</li></ul></div>

<p>&#25105;&#20204;&#32771;&#34385;&#31532;&#19968;&#31181;&#24773;&#20917;&#65292;&#22312;&#19968;&#20010;&#38656;&#35201;<code class="literal">DataSource</code>&#30340;&#23454;&#38469;&#24212;&#29992;&#20013;&#12290;&#22312;&#27979;&#35797;&#29615;&#22659;&#26102;&#65292;&#37197;&#32622;&#21487;&#33021;&#20687;&#19979;&#38754;&#36825;&#26679;&#65306;</p>
<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Bean</span></em>
<span class="hl-keyword">public</span> DataSource dataSource() {
    <span class="hl-keyword">return</span> <span class="hl-keyword">new</span> EmbeddedDatabaseBuilder()
        .setType(EmbeddedDatabaseType.HSQL)
        .addScript(<span class="hl-string">"my-schema.sql"</span>)
        .addScript(<span class="hl-string">"my-test-data.sql"</span>)
        .build();
}</pre>

<p>&#29616;&#22312;&#25105;&#20204;&#32771;&#34385;&#22914;&#20309;&#23558;&#36825;&#20010;&#24212;&#29992;&#37096;&#32626;&#21040;QA&#25110;&#32773;&#29983;&#20135;&#29615;&#22659;&#65292;&#20551;&#35774;&#24212;&#29992;&#31243;&#24207;&#30340;&#25968;&#25454;&#28304;&#23558;&#22312;&#29983;&#20135;&#24212;&#29992;&#26381;&#21153;&#22120;&#30340;JNDI&#30446;&#24405;&#20013;&#27880;&#20876;&#65292;&#25105;&#20204;&#30340;<code class="literal">dataSource</code> bean&#29616;&#22312;&#30475;&#36215;&#26469;&#20687;&#36825;&#26679;&#65306;</p>
<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Bean</span></em>
<span class="hl-keyword">public</span> DataSource dataSource() <span class="hl-keyword">throws</span> Exception {
    Context ctx = <span class="hl-keyword">new</span> InitialContext();
    <span class="hl-keyword">return</span> (DataSource) ctx.lookup(<span class="hl-string">"java:comp/env/jdbc/datasource"</span>);
}</pre>

<p>&#29616;&#22312;&#30340;&#38382;&#39064;&#26159;&#22914;&#20309;&#22522;&#20110;&#24403;&#21069;&#29615;&#22659;&#22312;&#36825;&#20004;&#20010;&#21464;&#20307;&#20043;&#38388;&#20999;&#25442;&#12290;&#38543;&#30528;&#26102;&#38388;&#30340;&#25512;&#31227;&#65292;Spring&#29992;&#25143;&#35774;&#35745;&#20102;&#22810;&#31181;&#26041;&#27861;&#26469;&#23436;&#25104;&#36825;&#20214;&#20107;&#12290;&#36890;&#24120;&#20381;&#38752;&#31995;&#32479;&#29615;&#22659;&#21464;&#37327;&#30340;&#32452;&#21512;&#21644;XML`&lt;import/&gt;<code class="literal">&#35821;&#21477;&#21253;&#21547;</code>${placeholder}`&#26631;&#35760;&#26469;&#35299;&#20915;&#27491;&#30830;&#30340;&#37197;&#32622;&#25991;&#20214;&#36335;&#24452;&#12290;Bean&#23450;&#20041;&#37197;&#32622;&#25991;&#20214;&#26159;&#19968;&#20010;&#26680;&#24515;&#23481;&#22120;&#30340;&#21151;&#33021;&#65292;&#23427;&#25552;&#20379;&#20102;&#35299;&#20915;&#36825;&#20010;&#38382;&#39064;&#30340;&#26041;&#27861;&#12290;</p>
<p>&#22914;&#26524;&#25105;&#20204;&#24402;&#32435;&#19978;&#38754;&#36825;&#20010;&#22522;&#20110;&#29615;&#22659;bean&#23450;&#20041;&#30340;&#20363;&#23376;&#65292;&#25105;&#20204;&#38656;&#35201;&#22312;&#26576;&#20123;&#24773;&#20917;&#19979;&#27880;&#20876;&#26576;&#20123;bean&#65292;&#32780;&#19981;&#26159;&#20854;&#20182;&#30340;&#12290;&#20320;&#21487;&#33021;&#24819;&#22312;A&#24773;&#20917;&#19979;&#27880;&#20876;&#19968;&#20010;bean&#23450;&#20041;&#30340;&#37197;&#32622;&#65292;&#22312;B&#24773;&#20917;&#19979;&#27880;&#20876;&#21478;&#19968;&#20010;&#37197;&#32622;&#12290;&#25105;&#20204;&#20808;&#30475;&#30475;&#22914;&#20309;&#26356;&#26032;&#37197;&#32622;&#26469;&#21453;&#26144;&#36825;&#19968;&#38656;&#27714;&#12290;</p>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-definition-profiles-java" href="#beans-definition-profiles-java"></a>@Profile</h4></div></div></div>

<p><a class="ulink" href="http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/context/annotation/Profile.html" target="_top"><code class="literal">@Profile</code></a>
&#27880;&#35299;&#29992;&#20110;&#24403;&#19968;&#20010;&#25110;&#22810;&#20010;&#37197;&#32622;&#25991;&#20214;&#28608;&#27963;&#30340;&#26102;&#20505;&#65292;&#29992;&#26469;&#25351;&#23450;&#32452;&#20214;&#26159;&#21542;&#26377;&#36164;&#26684;&#27880;&#20876;&#12290;&#20351;&#29992;&#19978;&#38754;&#30340;&#20363;&#23376;&#65292;&#25105;&#20204;&#21487;&#20197;&#25353;&#22914;&#19979;&#26041;&#24335;&#37325;&#20889;<span class="emphasis"><em>dataSource</em></span>&#37197;&#32622;&#65306;</p>
<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Configuration</span></em>
<span class="strong"><strong>@Profile("dev")</strong></span>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> StandaloneDataConfig {

    <em><span class="hl-annotation" style="color: gray">@Bean</span></em>
    <span class="hl-keyword">public</span> DataSource dataSource() {
        <span class="hl-keyword">return</span> <span class="hl-keyword">new</span> EmbeddedDatabaseBuilder()
            .setType(EmbeddedDatabaseType.HSQL)
            .addScript(<span class="hl-string">"classpath:com/bank/config/sql/schema.sql"</span>)
            .addScript(<span class="hl-string">"classpath:com/bank/config/sql/test-data.sql"</span>)
            .build();
    }
}</pre>

<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Configuration</span></em>
<span class="strong"><strong>@Profile("production")</strong></span>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> JndiDataConfig {

    <em><span class="hl-annotation" style="color: gray">@Bean</span></em>
    <span class="hl-keyword">public</span> DataSource dataSource() <span class="hl-keyword">throws</span> Exception {
        Context ctx = <span class="hl-keyword">new</span> InitialContext();
        <span class="hl-keyword">return</span> (DataSource) ctx.lookup(<span class="hl-string">"java:comp/env/jdbc/datasource"</span>);
    }
}</pre>

<p><code class="literal">@Profile</code> &#21487;&#20197;&#29992;&#20316;&#20803;&#27880;&#35299;&#65292;&#21487;&#20197;&#29992;&#26469;&#32534;&#20889;&#33258;&#23450;&#20041;&#30340;&#27880;&#35299;&#12290;&#19979;&#38754;&#30340;&#20363;&#23376;&#23450;&#20041;&#20102;&#19968;&#20010;&#33258;&#23450;&#20041;&#30340;<code class="literal">@Production</code>&#27880;&#35299;&#65292;&#21487;&#20197;&#29992;&#26469;&#26367;&#20195;<code class="literal">@Profile("production")</code>:</p>
<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Target(ElementType.TYPE)</span></em>
<em><span class="hl-annotation" style="color: gray">@Retention(RetentionPolicy.RUNTIME)</span></em>
<span class="strong"><strong>@Profile("production")</strong></span>
<span class="hl-keyword">public</span> <em><span class="hl-annotation" style="color: gray">@interface</span></em> Production {
}</pre>

<p><code class="literal">@Profile</code> &#21487;&#20197;&#29992;&#22312;&#26041;&#27861;&#32423;&#21035;&#65292;&#21487;&#20197;&#21482;&#21253;&#21547;&#37197;&#32622;&#31867;&#20013;&#30340;&#19968;&#20010;&#29305;&#27530;&#30340;bean&#65306;</p>
<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Configuration</span></em>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> AppConfig {

    <em><span class="hl-annotation" style="color: gray">@Bean</span></em>
    <span class="strong"><strong>@Profile("dev")</strong></span>
    <span class="hl-keyword">public</span> DataSource devDataSource() {
        <span class="hl-keyword">return</span> <span class="hl-keyword">new</span> EmbeddedDatabaseBuilder()
            .setType(EmbeddedDatabaseType.HSQL)
            .addScript(<span class="hl-string">"classpath:com/bank/config/sql/schema.sql"</span>)
            .addScript(<span class="hl-string">"classpath:com/bank/config/sql/test-data.sql"</span>)
            .build();
    }

    <em><span class="hl-annotation" style="color: gray">@Bean</span></em>
    <span class="strong"><strong>@Profile("production")</strong></span>
    <span class="hl-keyword">public</span> DataSource productionDataSource() <span class="hl-keyword">throws</span> Exception {
        Context ctx = <span class="hl-keyword">new</span> InitialContext();
        <span class="hl-keyword">return</span> (DataSource) ctx.lookup(<span class="hl-string">"java:comp/env/jdbc/datasource"</span>);
    }
}</pre>

<p>[&#25552;&#31034;]</p>
<div class="informalexample">
<p>&#22914;&#26524;&#24102;<code class="literal">@Configuration</code>&#30340;&#31867;&#34987;&#26631;&#35760;&#20102;<code class="literal">@Profile</code>&#65292;&#37027;&#20040;&#21482;&#26377;&#24403;&#36825;&#20010;&#37197;&#32622;&#26159;&#28608;&#27963;&#29366;&#24577;&#30340;&#26102;&#20505;&#65292;&#36825;&#20010;&#31867;&#20013;&#26631;&#35760;<code class="literal">@Bean</code>&#30340;&#26041;&#27861;&#21644;<code class="literal">@Import</code>&#20851;&#32852;&#30340;&#31867;&#25165;&#26377;&#25928;&#65292;&#21542;&#21017;&#23601;&#20250;&#34987;&#24573;&#30053;&#12290;
&#22914;&#26524;&#19968;&#20010;<code class="literal">@Component</code>&#25110;<code class="literal">@Configuration</code>&#31867;&#26631;&#35760;&#20102;<code class="literal">@Profile({"p1", "p2"})</code>&#65292;&#36825;&#26679;&#30340;&#31867;&#21482;&#26377;&#24403;<span class="emphasis"><em>p1</em></span>&#21644;&#65288;&#25110;&#65289;<span class="emphasis"><em>p2</em></span>&#28608;&#27963;&#30340;&#26102;&#20505;&#25165;&#26377;&#25928;&#12290;&#22914;&#26524;&#19968;&#20010;&#37197;&#32622;&#20351;&#29992;&#20102;<code class="literal">!</code>&#21069;&#32512;&#65292;&#21482;&#26377;&#24403;&#36825;&#20010;&#37197;&#32622;&#19981;&#28608;&#27963;&#30340;&#26102;&#20505;&#25165;&#26377;&#25928;&#12290;&#20363;&#22914;<code class="literal">@Profile({"p1", "!p2"})</code>&#65292;&#21482;&#26377;&#24403;<span class="emphasis"><em>p1</em></span>&#28608;&#27963;&#65292;<span class="emphasis"><em>p2</em></span>&#19981;&#28608;&#27963;&#30340;&#26102;&#20505;&#25165;&#26377;&#25928;&#12290;</p>
</div>

</div>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="beans-definition-profiles-xml" href="#beans-definition-profiles-xml"></a>5.13.2&nbsp;XML&#30340;Bean&#23450;&#20041;&#37197;&#32622;&#25991;&#20214;</h3></div></div></div>

<p>XML&#23545;&#24212;&#30340;&#37197;&#32622;&#20803;&#32032;<code class="literal">&lt;beans&gt;</code>&#26032;&#22686;&#20102;<code class="literal">profile</code>&#23646;&#24615;&#65292;&#25105;&#20204;&#19978;&#38754;&#30340;&#37197;&#32622;&#31034;&#20363;&#21487;&#20197;&#37325;&#20889;&#20026;&#19979;&#38754;&#30340;&#20004;&#20010;XML&#25991;&#20214;&#65306;</p>
<pre class="programlisting"><span class="hl-tag">&lt;beans</span> <span class="hl-attribute">profile</span>=<span class="hl-value">"dev"</span>
    <span class="hl-attribute">xmlns</span>=<span class="hl-value">"http://www.springframework.org/schema/beans"</span>
    <span class="hl-attribute">xmlns:xsi</span>=<span class="hl-value">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hl-attribute">xmlns:jdbc</span>=<span class="hl-value">"http://www.springframework.org/schema/jdbc"</span>
    <span class="hl-attribute">xsi:schemaLocation</span>=<span class="hl-value">"..."</span><span class="hl-tag">&gt;</span>

    <span class="hl-tag">&lt;jdbc:embedded-database</span> <span class="hl-attribute">id</span>=<span class="hl-value">"dataSource"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;jdbc:script</span> <span class="hl-attribute">location</span>=<span class="hl-value">"classpath:com/bank/config/sql/schema.sql"</span><span class="hl-tag">/&gt;</span>
        <span class="hl-tag">&lt;jdbc:script</span> <span class="hl-attribute">location</span>=<span class="hl-value">"classpath:com/bank/config/sql/test-data.sql"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;/jdbc:embedded-database&gt;</span>
<span class="hl-tag">&lt;/beans&gt;</span></pre>

<pre class="programlisting"><span class="hl-tag">&lt;beans</span> <span class="hl-attribute">profile</span>=<span class="hl-value">"production"</span>
    <span class="hl-attribute">xmlns</span>=<span class="hl-value">"http://www.springframework.org/schema/beans"</span>
    <span class="hl-attribute">xmlns:xsi</span>=<span class="hl-value">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hl-attribute">xmlns:jee</span>=<span class="hl-value">"http://www.springframework.org/schema/jee"</span>
    <span class="hl-attribute">xsi:schemaLocation</span>=<span class="hl-value">"..."</span><span class="hl-tag">&gt;</span>

    <span class="hl-tag">&lt;jee:jndi-lookup</span> <span class="hl-attribute">id</span>=<span class="hl-value">"dataSource"</span> <span class="hl-attribute">jndi-name</span>=<span class="hl-value">"java:comp/env/jdbc/datasource"</span><span class="hl-tag">/&gt;</span>
<span class="hl-tag">&lt;/beans&gt;</span></pre>

<p>&#36824;&#21487;&#20197;&#36991;&#20813;&#20998;&#24320;&#20889;&#65292;&#23558;<code class="literal">&lt;beans/&gt;</code>&#20803;&#32032;&#37117;&#20889;&#21040;&#21516;&#19968;&#20010;&#25991;&#20214;&#20013;&#65306;</p>
<pre class="programlisting"><span class="hl-tag">&lt;beans</span> <span class="hl-attribute">xmlns</span>=<span class="hl-value">"http://www.springframework.org/schema/beans"</span>
    <span class="hl-attribute">xmlns:xsi</span>=<span class="hl-value">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hl-attribute">xmlns:jdbc</span>=<span class="hl-value">"http://www.springframework.org/schema/jdbc"</span>
    <span class="hl-attribute">xmlns:jee</span>=<span class="hl-value">"http://www.springframework.org/schema/jee"</span>
    <span class="hl-attribute">xsi:schemaLocation</span>=<span class="hl-value">"..."</span><span class="hl-tag">&gt;</span>

    <span class="hl-comment">&lt;!-- &#20854;&#20182; bean &#23450;&#20041;&#65292;beans&#21482;&#33021;&#20889;&#22312;&#26368;&#21518;&#38754; --&gt;</span>

    <span class="hl-tag">&lt;beans</span> <span class="hl-attribute">profile</span>=<span class="hl-value">"dev"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;jdbc:embedded-database</span> <span class="hl-attribute">id</span>=<span class="hl-value">"dataSource"</span><span class="hl-tag">&gt;</span>
            <span class="hl-tag">&lt;jdbc:script</span> <span class="hl-attribute">location</span>=<span class="hl-value">"classpath:com/bank/config/sql/schema.sql"</span><span class="hl-tag">/&gt;</span>
            <span class="hl-tag">&lt;jdbc:script</span> <span class="hl-attribute">location</span>=<span class="hl-value">"classpath:com/bank/config/sql/test-data.sql"</span><span class="hl-tag">/&gt;</span>
        <span class="hl-tag">&lt;/jdbc:embedded-database&gt;</span>
    <span class="hl-tag">&lt;/beans&gt;</span>

    <span class="hl-tag">&lt;beans</span> <span class="hl-attribute">profile</span>=<span class="hl-value">"production"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;jee:jndi-lookup</span> <span class="hl-attribute">id</span>=<span class="hl-value">"dataSource"</span> <span class="hl-attribute">jndi-name</span>=<span class="hl-value">"java:comp/env/jdbc/datasource"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;/beans&gt;</span>
<span class="hl-tag">&lt;/beans&gt;</span></pre>

<p><code class="literal">spring-bean.xsd</code>&#24378;&#21046;&#20801;&#35768;&#23558;<code class="literal">&lt;beans&gt;</code>&#20803;&#32032;&#23450;&#20041;&#22312;&#25991;&#20214;&#30340;&#26368;&#21518;&#38754;&#65292;&#36825;&#26377;&#21161;&#20110;&#22312;XML&#25991;&#20214;&#20013;&#25552;&#20379;&#28789;&#27963;&#30340;&#26041;&#24335;&#32780;&#21448;&#19981;&#24341;&#36215;&#28151;&#20081;&#12290;</p>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-definition-profiles-enable" href="#beans-definition-profiles-enable"></a>&#21551;&#29992;&#37197;&#32622;&#25991;&#20214;</h4></div></div></div>

<p>&#29616;&#22312;&#25105;&#20204;&#24050;&#32463;&#26356;&#26032;&#20102;&#25105;&#20204;&#30340;&#37197;&#32622;&#65292;&#25105;&#20204;&#36824;&#38656;&#35201;&#25351;&#31034;&#37027;&#20010;&#37197;&#32622;&#25991;&#20214;&#22788;&#20110;&#28608;&#27963;&#29366;&#24577;&#12290;&#22914;&#26524;&#25105;&#20204;&#29616;&#22312;&#21551;&#21160;&#25105;&#20204;&#30340;&#31034;&#20363;&#31243;&#24207;&#65292;&#25105;&#20204;&#20250;&#30475;&#21040;&#25243;&#20986;<code class="literal">NoSuchBeanDefinitionException</code>&#24322;&#24120;&#65292;&#22240;&#20026;&#25105;&#20204;&#30340;&#23481;&#22120;&#25214;&#19981;&#21040;&#21517;&#20026;<code class="literal">dataSource</code>&#30340;bean&#23545;&#35937;&#12290;</p>
<p>&#28608;&#27963;&#37197;&#32622;&#25991;&#20214;&#21487;&#20197;&#37319;&#21462;&#22810;&#31181;&#26041;&#24335;&#65292;&#20294;&#26159;&#26368;&#30452;&#25509;&#30340;&#26041;&#24335;&#23601;&#26159;&#20197;&#32534;&#31243;&#30340;&#26041;&#24335;&#20351;&#29992;<code class="literal">ApplicationContext</code> API&#65306;</p>
<pre class="programlisting">AnnotationConfigApplicationContext ctx = <span class="hl-keyword">new</span> AnnotationConfigApplicationContext();
ctx.getEnvironment().setActiveProfiles(<span class="hl-string">"dev"</span>);
ctx.register(SomeConfig.<span class="hl-keyword">class</span>, StandaloneDataConfig.<span class="hl-keyword">class</span>, JndiDataConfig.<span class="hl-keyword">class</span>);
ctx.refresh();</pre>

<p>&#27492;&#22806;&#65292;&#37197;&#32622;&#25991;&#20214;&#36824;&#21487;&#20197;&#20197;&#22768;&#26126;&#30340;&#26041;&#24335;&#36890;&#36807;<code class="literal">spring.profiles.active</code>&#23646;&#24615;&#26469;&#28608;&#27963;&#65292;&#21487;&#20197;&#36890;&#36807;&#31995;&#32479;&#29615;&#22659;&#21464;&#37327;&#65292;JVM&#31995;&#32479;&#23646;&#24615;&#65292;<code class="literal">web.xml</code>&#20013;&#30340;servlet&#19978;&#19979;&#25991;&#21442;&#25968;&#65292;&#29978;&#33267;&#26159;JNDI&#20013;&#30340;&#19968;&#20010;&#26465;&#30446;&#26469;&#35774;&#32622;(<a class="xref" href="beans.html#beans-property-source-abstraction" title="5.13.3&nbsp;PropertySource&#30340;&#25277;&#35937;">Section&nbsp;5.13.3, &#8220;PropertySource&#30340;&#25277;&#35937;&#8221;</a>)&#12290;</p>
<p>&#27880;&#24847;&#65292;&#37197;&#32622;&#25991;&#20214;&#19981;&#26159;&#8220;&#20108;&#36873;&#19968;&#8221;&#30340;&#65307;&#20320;&#21487;&#20197;&#19968;&#27425;&#28608;&#27963;&#22810;&#20010;&#37197;&#32622;&#25991;&#20214;&#12290;&#20197;&#32534;&#31243;&#26041;&#24335;&#65292;&#21482;&#38656;&#35201;&#22312;<code class="literal">setActiveProfiles()</code>&#26041;&#27861;&#25552;&#20379;&#22810;&#20010;&#37197;&#32622;&#25991;&#20214;&#30340;&#21517;&#23383;&#21363;&#21487;&#65292;&#36825;&#37324;&#25509;&#25910;&#30340;<code class="literal">String...</code>&#21487;&#21464;&#21442;&#25968;&#65306;</p>
<pre class="programlisting">ctx.getEnvironment().setActiveProfiles(<span class="hl-string">"profile1"</span>, <span class="hl-string">"profile2"</span>);</pre>

<p>&#22768;&#26126;&#24418;&#24335;&#20013;&#65292;<code class="literal">spring.profiles.active</code>&#21487;&#20197;&#25509;&#25910;&#36887;&#21495;&#38548;&#24320;&#30340;&#37197;&#32622;&#21517;&#23383;&#21015;&#34920;&#65306;</p>
<pre class="programlisting">-Dspring.profiles.active=<span class="hl-string">"profile1,profile2"</span></pre>

</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="beans-definition-profiles-default" href="#beans-definition-profiles-default"></a>&#40664;&#35748;&#37197;&#32622;</h4></div></div></div>

<p><span class="emphasis"><em>default</em></span>&#37197;&#32622;&#25991;&#20214;&#20195;&#34920;&#30340;&#26159;&#40664;&#35748;&#21551;&#29992;&#30340;&#37197;&#32622;&#25991;&#20214;&#12290;&#32771;&#34385;&#20197;&#19979;&#65306;</p>
<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Configuration</span></em>
<span class="strong"><strong>@Profile("default")</strong></span>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> DefaultDataConfig {

    <em><span class="hl-annotation" style="color: gray">@Bean</span></em>
    <span class="hl-keyword">public</span> DataSource dataSource() {
        <span class="hl-keyword">return</span> <span class="hl-keyword">new</span> EmbeddedDatabaseBuilder()
            .setType(EmbeddedDatabaseType.HSQL)
            .addScript(<span class="hl-string">"classpath:com/bank/config/sql/schema.sql"</span>)
            .build();
    }
}</pre>

<p>&#22914;&#26524;&#27809;&#26377;&#37197;&#32622;&#25991;&#20214;&#28608;&#27963;&#65292;&#19978;&#38754;&#30340;<code class="literal">dataSource</code>&#23601;&#20250;&#34987;&#21019;&#24314;&#12290;&#36825;&#25552;&#20379;&#20102;&#19968;&#31181;&#40664;&#35748;&#30340;&#26041;&#24335;&#12290;&#22914;&#26524;&#26377;&#20219;&#20309;&#19968;&#20010;&#37197;&#32622;&#25991;&#20214;&#21551;&#29992;&#65292;<span class="emphasis"><em>default</em></span>&#37197;&#32622;&#23601;&#19981;&#20250;&#29983;&#25928;&#12290;</p>
<p>&#40664;&#35748;&#37197;&#32622;&#25991;&#20214;&#30340;&#21517;&#23383;(<code class="literal">default</code>)&#21487;&#20197;&#36890;&#36807;<code class="literal">Environment</code>&#30340;<code class="literal">setDefaultProfiles</code>&#26041;&#27861;&#25110;&#32773;<code class="literal">spring.profiles.default</code>&#23646;&#24615;&#20462;&#25913;&#12290;</p>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="beans-property-source-abstraction" href="#beans-property-source-abstraction"></a>5.13.3&nbsp;PropertySource&#30340;&#25277;&#35937;</h3></div></div></div>

<p>Spring&#30340;&#25277;&#35937;&#29615;&#22659;&#25552;&#20379;&#20102;&#19968;&#20010;&#21487;&#37197;&#32622;&#30340;&#23646;&#24615;&#28304;&#30340;&#23618;&#27425;&#32467;&#26500;&#30340;&#25628;&#32034;&#25805;&#20316;&#12290;&#20026;&#20102;&#20805;&#20998;&#35828;&#26126;&#65292;&#32771;&#34385;&#19979;&#38754;&#30340;&#24773;&#20917;&#65306;</p>
<pre class="programlisting">ApplicationContext ctx = <span class="hl-keyword">new</span> GenericApplicationContext();
Environment env = ctx.getEnvironment();
<span class="hl-keyword">boolean</span> containsFoo = env.containsProperty(<span class="hl-string">"foo"</span>);
System.out.println(<span class="hl-string">"Does my environment contain the </span><span class="emphasis"><em>'foo</em></span><span class="hl-string">' property? " + containsFoo);</span></pre>

<p>&#22312;&#19978;&#38754;&#30340;&#20195;&#30721;&#29255;&#27573;&#20013;&#65292;&#25105;&#20204;&#30475;&#21040;&#20102;&#19968;&#31181;&#39640;&#23618;&#27425;&#30340;&#26041;&#24335;&#26469;&#35810;&#38382;Spring&#24403;&#21069;&#30340;&#29615;&#22659;&#20013;&#26159;&#21542;&#23450;&#20041;&#20102;<code class="literal">foo</code>&#23646;&#24615;&#12290;
&#20026;&#20102;&#35299;&#31572;&#36825;&#20010;&#38382;&#39064;&#65292;<code class="literal">Environment</code>&#23545;&#35937;&#25191;&#34892;&#20102;&#19968;&#32452;http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/core/env/PropertySource.html[<code class="literal">PropertySource</code>]&#23545;&#35937;&#19978;&#30340;&#25628;&#32034;&#12290;
<code class="literal">PropertySource</code>&#26159;&#19968;&#20010;&#31616;&#21333;&#30340;&#25277;&#35937;&#22312;&#20219;&#20309;&#28304;&#19978;&#30340;&#38190;&#20540;&#23545;&#65292;Spring&#30340;http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/core/env/StandardEnvironment.html[<code class="literal">StandardEnvironment</code>]
&#37197;&#32622;&#20102;&#20004;&#20010;&#23646;&#24615;&#28304;&#23545;&#35937;&#8201;&#8212;&#8201;&#19968;&#32452;&#26159;JVM&#31995;&#32479;&#23646;&#24615;(<span class="emphasis"><em>a la</em></span> <code class="literal">System.getProperties()</code>)&#65292;&#21478;&#19968;&#32452;&#26159;&#31995;&#32479;&#29615;&#22659;&#21464;&#37327;(<span class="emphasis"><em>a la</em></span> <code class="literal">System.getenv()</code>)&#12290;</p>
<p>[&#27880;&#24847;]</p>
<div class="informalexample">
<p>These default property sources are present for <code class="literal">StandardEnvironment</code>, for use in standalone
applications. <a class="ulink" href="http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/web/context/support/StandardServletEnvironment.html" target="_top"><code class="literal">StandardServletEnvironment</code></a>
is populated with additional default property sources including servlet config and servlet
context parameters. <a class="ulink" href="http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/web/portlet/context/StandardPortletEnvironment.html" target="_top"><code class="literal">StandardPortletEnvironment</code></a>
similarly has access to portlet config and portlet context parameters as property sources.
Both can optionally enable a <a class="ulink" href="http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/jndi/JndiPropertySource.html" target="_top"><code class="literal">JndiPropertySource</code></a>.
See Javadoc for details.</p>
</div>

<p>Concretely, when using the <code class="literal">StandardEnvironment</code>, the call to <code class="literal">env.containsProperty("foo")</code>
will return true if a <code class="literal">foo</code> system property or <code class="literal">foo</code> environment variable is present at
runtime.</p>
<div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="images/tip.png"></td><th align="left">Tip</th></tr><tr><td align="left" valign="top">
<p>The search performed is hierarchical. By default, system properties have precedence over
environment variables, so if the <code class="literal">foo</code> property happens to be set in both places during
a call to <code class="literal">env.getProperty("foo")</code>, the system property value will <span class="emphasis"><em>win</em></span> and be returned
preferentially over the environment variable.</p>
</td></tr></table></div>

<p>Most importantly, the entire mechanism is configurable. Perhaps you have a custom source
of properties that you&#8217;d like to integrate into this search. No problem&#8201;&#8212;&#8201;simply implement
and instantiate your own <code class="literal">PropertySource</code> and add it to the set of <code class="literal">PropertySources</code> for the
current <code class="literal">Environment</code>:</p>
<pre class="programlisting">ConfigurableApplicationContext ctx = <span class="hl-keyword">new</span> GenericApplicationContext();
MutablePropertySources sources = ctx.getEnvironment().getPropertySources();
sources.addFirst(<span class="hl-keyword">new</span> MyPropertySource());</pre>

<p>In the code above, <code class="literal">MyPropertySource</code> has been added with highest precedence in the
search. If it contains a  <code class="literal">foo</code> property, it will be detected and returned ahead of
any <code class="literal">foo</code> property in any other <code class="literal">PropertySource</code>. The
<a class="ulink" href="http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/core/env/MutablePropertySources.html" target="_top"><code class="literal">MutablePropertySources</code></a>
API exposes a number of methods that allow for precise manipulation of the set of
property sources.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="__propertysource" href="#__propertysource"></a>5.13.4&nbsp;@PropertySource</h3></div></div></div>

<p>The <a class="ulink" href="http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/context/annotation/PropertySource.html" target="_top"><code class="literal">@PropertySource</code></a>
annotation provides a convenient and declarative mechanism for adding a <code class="literal">PropertySource</code>
to Spring&#8217;s <code class="literal">Environment</code>.</p>
<p>Given a file "app.properties" containing the key/value pair <code class="literal">testbean.name=myTestBean</code>,
the following <code class="literal">@Configuration</code> class uses <code class="literal">@PropertySource</code> in such a way that
a call to <code class="literal">testBean.getName()</code> will return "myTestBean".</p>
<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Configuration</span></em>
<span class="strong"><strong>@PropertySource("classpath:/com/myco/app.properties")</strong></span>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> AppConfig {
    <em><span class="hl-annotation" style="color: gray">@Autowired</span></em>
    Environment env;

    <em><span class="hl-annotation" style="color: gray">@Bean</span></em>
    <span class="hl-keyword">public</span> TestBean testBean() {
        TestBean testBean = <span class="hl-keyword">new</span> TestBean();
        testBean.setName(env.getProperty(<span class="hl-string">"testbean.name"</span>));
        <span class="hl-keyword">return</span> testBean;
    }
}</pre>

<p>Any <code class="literal">${...}</code> placeholders present in a <code class="literal">@PropertySource</code> resource location will
be resolved against the set of property sources already registered against the
environment. For example:</p>
<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Configuration</span></em>
<em><span class="hl-annotation" style="color: gray">@PropertySource("classpath:/com/${my.placeholder:default/path}/app.properties")</span></em>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> AppConfig {
    <em><span class="hl-annotation" style="color: gray">@Autowired</span></em>
    Environment env;

    <em><span class="hl-annotation" style="color: gray">@Bean</span></em>
    <span class="hl-keyword">public</span> TestBean testBean() {
        TestBean testBean = <span class="hl-keyword">new</span> TestBean();
        testBean.setName(env.getProperty(<span class="hl-string">"testbean.name"</span>));
        <span class="hl-keyword">return</span> testBean;
    }
}</pre>

<p>Assuming that "my.placeholder" is present in one of the property sources already
registered, e.g. system properties or environment variables, the placeholder will
be resolved to the corresponding value. If not, then "default/path" will be used
as a default. If no default is specified and a property cannot be resolved, an
<code class="literal">IllegalArgumentException</code> will be thrown.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_placeholder_resolution_in_statements" href="#_placeholder_resolution_in_statements"></a>5.13.5&nbsp;Placeholder resolution in statements</h3></div></div></div>

<p>Historically, the value of placeholders in elements could be resolved only against
JVM system properties or environment variables. No longer is this the case. Because
the Environment abstraction is integrated throughout the container, it&#8217;s easy to
route resolution of placeholders through it. This means that you may configure the
resolution process in any way you like: change the precedence of searching through
system properties and environment variables, or remove them entirely; add your
own property sources to the mix as appropriate.</p>
<p>Concretely, the following statement works regardless of where the <code class="literal">customer</code>
property is defined, as long as it is available in the <code class="literal">Environment</code>:</p>
<pre class="programlisting"><span class="hl-tag">&lt;beans&gt;</span>
    <span class="hl-tag">&lt;import</span> <span class="hl-attribute">resource</span>=<span class="hl-value">"com/bank/service/${customer}-config.xml"</span><span class="hl-tag">/&gt;</span>
<span class="hl-tag">&lt;/beans&gt;</span></pre>

</div>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="context-load-time-weaver" href="#context-load-time-weaver"></a>5.14&nbsp;&#27880;&#20876;&#19968;&#20010;LoadTimeWeaver</h2></div></div></div>

<p>Spring&#20351;&#29992;<code class="literal">LoadTimeWeaver</code>&#21160;&#24577;&#36716;&#25442;&#24050;&#32463;&#21152;&#36733;&#21040;JVM&#34394;&#25311;&#26426;&#20013;&#30340;&#31867;&#12290;</p>
<p>&#20320;&#21487;&#20197;&#22312;<code class="literal">@Configuration</code>&#31867;&#19978;&#22686;&#21152;<code class="literal">@EnableLoadTimeWeaving</code>&#27880;&#35299;&#26469;&#21551;&#29992;&#35813;&#21151;&#33021;&#65306;</p>
<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Configuration</span></em>
<em><span class="hl-annotation" style="color: gray">@EnableLoadTimeWeaving</span></em>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> AppConfig {

}</pre>

<p>&#25110;&#32773;&#22312;XML&#37197;&#32622;&#20013;&#20351;&#29992;<code class="literal">context:load-time-weaver</code>&#20803;&#32032;&#65306;</p>
<pre class="programlisting"><span class="hl-tag">&lt;beans&gt;</span>
    <span class="hl-tag">&lt;context:load-time-weaver/&gt;</span>
<span class="hl-tag">&lt;/beans&gt;</span></pre>

<p>&#24403;<code class="literal">ApplicationContext</code>&#21551;&#29992;&#35813;&#21151;&#33021;&#21518;&#65292;&#25152;&#26377;<code class="literal">ApplicationContext</code>&#20013;&#30340;bean&#37117;&#21487;&#20197;&#23454;&#29616;<code class="literal">LoadTimeWeaverAware</code>&#25509;&#21475;&#65292;&#20174;&#32780;&#33719;&#24471;&#23545;&#35813;&#21152;&#36733;&#26102;&#32455;&#20837;&#22120;&#23454;&#20363;&#30340;&#24341;&#29992;&#12290;
&#24403;&#32467;&#21512;<a class="link" href="orm.html#orm-jpa" title="14.5&nbsp;JPA">Spring&#30340;JPA &#25903;&#25345;</a>&#30340;&#26102;&#20505;&#29305;&#21035;&#30340;&#26377;&#29992;&#65292;JPA&#31867;&#36716;&#25442;&#21487;&#33021;&#38656;&#35201;&#21152;&#36733;&#26102;&#30340;&#32455;&#20837;&#12290;&#26597;&#38405;<code class="literal">LocalContainerEntityManagerFactoryBean</code>&#24110;&#21161;&#25991;&#26723;&#33719;&#24471;&#26356;&#22810;&#32454;&#33410;&#65292;&#26356;&#22810;AspectJ&#35013;&#36733;&#26102;&#32455;&#20837;&#65292;&#26597;&#30475;<a class="xref" href="aop.html#aop-aj-ltw" title="9.8.4&nbsp;Load-time weaving with AspectJ in the Spring Framework">Section&nbsp;9.8.4, &#8220;Load-time weaving with AspectJ in the Spring Framework&#8221;</a>&#12290;</p>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="context-introduction" href="#context-introduction"></a>5.15&nbsp;ApplicationContext &#30340;&#38468;&#21152;&#21151;&#33021;</h2></div></div></div>

<p>&#25105;&#20204;&#22312;&#26412;&#31456;&#30340;&#20171;&#32461;&#20013;&#35752;&#35770;&#36807;&#65292;<code class="literal">org.springframework.beans.factory</code> &#21253;&#25552;&#20379;&#20102;&#31649;&#29702;&#21644;&#25805;&#20316; bean &#30340;&#22522;&#26412;&#21151;&#33021;&#65292;&#21253;&#25324;&#32534;&#31243;&#26041;&#24335;&#12290;<code class="literal">org.springframework.context</code> &#21253;&#22686;&#21152;&#20102; <a class="ulink" href="http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/context/ApplicationContext.html" target="_top"><code class="literal">ApplicationContext</code></a> &#25509;&#21475;&#12290;&#23427;&#32487;&#25215;&#20102; <code class="literal">BeanFactory</code> &#25509;&#21475;&#65292;&#38500;&#20102;&#25193;&#23637;&#20854;&#20182;&#25509;&#21475;&#22806;&#36824;&#25552;&#20379;&#20102;&#26356;&#20026; <span class="emphasis"><em>application
framework-oriented style</em></span> &#30340;&#38468;&#21152;&#21151;&#33021;&#12290;&#24456;&#22810;&#20154;&#36890;&#36807;&#23436;&#20840;&#30340;&#22768;&#26126;&#26041;&#24335;&#26469;&#20351;&#29992; <code class="literal">ApplicationContext</code>&#65292;&#32780;&#38750;&#32534;&#31243;&#24335;&#22320;&#21019;&#24314;&#23427;&#65292;&#20294;&#26159;&#36824;&#21487;&#20197;&#20381;&#38752;&#31867;&#20284; <code class="literal">ContextLoader</code> &#36825;&#26679;&#30340;&#30340;&#25903;&#25345;&#31867;&#26469;&#33258;&#21160;&#21021;&#22987;&#21270; <code class="literal">ApplicationContext</code>&#65292;&#24182;&#23558;&#23427;&#20316;&#20026; Java EE web &#24212;&#29992;&#31243;&#24207;&#30340;&#26222;&#36890;&#30340;&#21551;&#21160;&#36807;&#31243;&#30340;&#19968;&#37096;&#20998;&#12290;</p>
<p>&#22312;&#26356;&#20026;&#38754;&#21521;&#26694;&#26550;&#30340;&#39118;&#26684;&#19978;&#65292;&#20026;&#20102;&#22686;&#24378; <code class="literal">BeanFactory</code> &#30340;&#21151;&#33021;&#65292;context &#21253;&#36824;&#25552;&#20379;&#20102;&#20197;&#19979;&#21151;&#33021;&#65306;</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
&#36890;&#36807; <code class="literal">MessageSource</code> &#25509;&#21475;&#65292;<span class="emphasis"><em>&#35775;&#38382; i18n &#26679;&#24335;&#30340;&#20449;&#24687;</em></span>&#12290;
</li><li class="listitem">
&#36890;&#36807; <code class="literal">ResourceLoader</code> &#25509;&#21475;&#65292;<span class="emphasis"><em>&#35775;&#38382;&#36164;&#28304;</em></span>&#65292;&#27604;&#22914; URL &#21644;&#25991;&#20214;&#12290;
</li><li class="listitem">
<span class="emphasis"><em>Event publication</em></span> to beans implementing the <code class="literal">ApplicationListener</code> interface,
through the use of the <code class="literal">ApplicationEventPublisher</code> interface.
</li><li class="listitem">
&#36890;&#36807; <code class="literal">HierarchicalBeanFactory</code> &#25509;&#21475;&#65292;<span class="emphasis"><em>&#21152;&#36733;&#22810;&#20010;&#65288;&#20998;&#23618;&#65289;&#19978;&#19979;&#25991;</em></span>&#65292;&#36825;&#26679;&#20351;&#24471;&#27599;&#19968;&#20010;&#19978;&#19979;&#25991;&#21487;&#20197;&#20851;&#27880;&#29305;&#23450;&#30340;&#23618;&#65292;&#27604;&#22914; web &#23618;&#12290;
</li></ul></div>

<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="context-functionality-messagesource" href="#context-functionality-messagesource"></a>5.15.1&nbsp;Internationalization using MessageSource</h3></div></div></div>

<p>The <code class="literal">ApplicationContext</code> interface extends an interface called <code class="literal">MessageSource</code>, and
therefore provides internationalization (i18n) functionality. Spring also provides the
interface <code class="literal">HierarchicalMessageSource</code>, which can resolve messages hierarchically.
Together these interfaces provide the foundation upon which Spring effects message
resolution. The methods defined on these interfaces include:</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<code class="literal">String getMessage(String code, Object[] args, String default, Locale loc)</code>: The basic
method used to retrieve a message from the <code class="literal">MessageSource</code>. When no message is found
for the specified locale, the default message is used. Any arguments passed in become
replacement values, using the <code class="literal">MessageFormat</code> functionality provided by the standard
library.
</li><li class="listitem">
<code class="literal">String getMessage(String code, Object[] args, Locale loc)</code>: Essentially the same as
the previous method, but with one difference: no default message can be specified; if
the message cannot be found, a <code class="literal">NoSuchMessageException</code> is thrown.
</li><li class="listitem">
<code class="literal">String getMessage(MessageSourceResolvable resolvable, Locale locale)</code>: All properties
used in the preceding methods are also wrapped in a class named
<code class="literal">MessageSourceResolvable</code>, which you can use with this method.
</li></ul></div>

<p>When an <code class="literal">ApplicationContext</code> is loaded, it automatically searches for a <code class="literal">MessageSource</code>
bean defined in the context. The bean must have the name <code class="literal">messageSource</code>. If such a bean
is found, all calls to the preceding methods are delegated to the message source. If no
message source is found, the <code class="literal">ApplicationContext</code> attempts to find a parent containing a
bean with the same name. If it does, it uses that bean as the <code class="literal">MessageSource</code>. If the
<code class="literal">ApplicationContext</code> cannot find any source for messages, an empty
<code class="literal">DelegatingMessageSource</code> is instantiated in order to be able to accept calls to the
methods defined above.</p>
<p>Spring provides two <code class="literal">MessageSource</code> implementations, <code class="literal">ResourceBundleMessageSource</code> and
<code class="literal">StaticMessageSource</code>. Both implement <code class="literal">HierarchicalMessageSource</code> in order to do nested
messaging. The <code class="literal">StaticMessageSource</code> is rarely used but provides programmatic ways to
add messages to the source. The <code class="literal">ResourceBundleMessageSource</code> is shown in the following
example:</p>
<pre class="programlisting"><span class="hl-tag">&lt;beans&gt;</span>
    <span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"messageSource"</span>
            <span class="hl-attribute">class</span>=<span class="hl-value">"org.springframework.context.support.ResourceBundleMessageSource"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"basenames"</span><span class="hl-tag">&gt;</span>
            <span class="hl-tag">&lt;list&gt;</span>
                <span class="hl-tag">&lt;value&gt;</span>format<span class="hl-tag">&lt;/value&gt;</span>
                <span class="hl-tag">&lt;value&gt;</span>exceptions<span class="hl-tag">&lt;/value&gt;</span>
                <span class="hl-tag">&lt;value&gt;</span>windows<span class="hl-tag">&lt;/value&gt;</span>
            <span class="hl-tag">&lt;/list&gt;</span>
        <span class="hl-tag">&lt;/property&gt;</span>
    <span class="hl-tag">&lt;/bean&gt;</span>
<span class="hl-tag">&lt;/beans&gt;</span></pre>

<p>In the example it is assumed you have three resource bundles defined in your classpath
called <code class="literal">format</code>, <code class="literal">exceptions</code> and <code class="literal">windows</code>. Any request to resolve a message will be
handled in the JDK standard way of resolving messages through ResourceBundles. For the
purposes of the example, assume the contents of two of the above resource bundle files
are&#8230;</p>
<pre class="programlisting"># in format.properties
message=Alligators rock!</pre>

<pre class="programlisting"># in exceptions.properties
argument.required=The <span class="emphasis"><em>{0}</em></span> argument is required.</pre>

<p>A program to execute the <code class="literal">MessageSource</code> functionality is shown in the next example.
Remember that all <code class="literal">ApplicationContext</code> implementations are also <code class="literal">MessageSource</code>
implementations and so can be cast to the <code class="literal">MessageSource</code> interface.</p>
<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">static</span> <span class="hl-keyword">void</span> main(String[] args) {
    MessageSource resources = <span class="hl-keyword">new</span> ClassPathXmlApplicationContext(<span class="hl-string">"beans.xml"</span>);
    String message = resources.getMessage(<span class="hl-string">"message"</span>, null, <span class="hl-string">"Default"</span>, null);
    System.out.println(message);
}</pre>

<p>The resulting output from the above program will be&#8230;</p>

<pre class="literallayout">Alligators rock!</pre>

<p>So to summarize, the <code class="literal">MessageSource</code> is defined in a file called <code class="literal">beans.xml</code>, which
exists at the root of your classpath. The <code class="literal">messageSource</code> bean definition refers to a
number of resource bundles through its <code class="literal">basenames</code> property. The three files that are
passed in the list to the <code class="literal">basenames</code> property exist as files at the root of your
classpath and are called <code class="literal">format.properties</code>, <code class="literal">exceptions.properties</code>, and
<code class="literal">windows.properties</code> respectively.</p>
<p>The next example shows arguments passed to the message lookup; these arguments will be
converted into Strings and inserted into placeholders in the lookup message.</p>
<pre class="programlisting"><span class="hl-tag">&lt;beans&gt;</span>

    <span class="hl-comment">&lt;!-- this MessageSource is being used in a web application --&gt;</span>
    <span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"messageSource"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"org.springframework.context.support.ResourceBundleMessageSource"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"basename"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"exceptions"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;/bean&gt;</span>

    <span class="hl-comment">&lt;!-- lets inject the above MessageSource into this POJO --&gt;</span>
    <span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"example"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"com.foo.Example"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"messages"</span> <span class="hl-attribute">ref</span>=<span class="hl-value">"messageSource"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;/bean&gt;</span>

<span class="hl-tag">&lt;/beans&gt;</span></pre>

<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> Example {

    <span class="hl-keyword">private</span> MessageSource messages;

    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> setMessages(MessageSource messages) {
        <span class="hl-keyword">this</span>.messages = messages;
    }

    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> execute() {
        String message = <span class="hl-keyword">this</span>.messages.getMessage(<span class="hl-string">"argument.required"</span>,
            <span class="hl-keyword">new</span> Object [] {<span class="hl-string">"userDao"</span>}, <span class="hl-string">"Required"</span>, null);
        System.out.println(message);
    }

}</pre>

<p>The resulting output from the invocation of the <code class="literal">execute()</code> method will be&#8230;</p>

<pre class="literallayout">The userDao argument is required.</pre>

<p>With regard to internationalization (i18n), Spring&#8217;s various <code class="literal">MessageResource</code>
implementations follow the same locale resolution and fallback rules as the standard JDK
<code class="literal">ResourceBundle</code>. In short, and continuing with the example <code class="literal">messageSource</code> defined
previously, if you want to resolve messages against the British (<code class="literal">en-GB</code>) locale, you
would create files called <code class="literal">format_en_GB.properties</code>, <code class="literal">exceptions_en_GB.properties</code>, and
<code class="literal">windows_en_GB.properties</code> respectively.</p>
<p>Typically, locale resolution is managed by the surrounding environment of the
application. In this example, the locale against which (British) messages will be
resolved is specified manually.</p>

<pre class="literallayout"># in exceptions_en_GB.properties
argument.required=Ebagum lad, the <span class="emphasis"><em>{0}</em></span> argument is required, I say, required.</pre>

<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">static</span> <span class="hl-keyword">void</span> main(<span class="hl-keyword">final</span> String[] args) {
    MessageSource resources = <span class="hl-keyword">new</span> ClassPathXmlApplicationContext(<span class="hl-string">"beans.xml"</span>);
    String message = resources.getMessage(<span class="hl-string">"argument.required"</span>,
        <span class="hl-keyword">new</span> Object [] {<span class="hl-string">"userDao"</span>}, <span class="hl-string">"Required"</span>, Locale.UK);
    System.out.println(message);
}</pre>

<p>The resulting output from the running of the above program will be&#8230;</p>

<pre class="literallayout">Ebagum lad, the <span class="emphasis"><em>userDao</em></span> argument is required, I say, required.</pre>

<p>You can also use the <code class="literal">MessageSourceAware</code> interface to acquire a reference to any
<code class="literal">MessageSource</code> that has been defined. Any bean that is defined in an
<code class="literal">ApplicationContext</code> that implements the <code class="literal">MessageSourceAware</code> interface is injected with
the application context&#8217;s <code class="literal">MessageSource</code> when the bean is created and configured.</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p><span class="emphasis"><em>As an alternative to <code class="literal">ResourceBundleMessageSource</code>, Spring provides a
<code class="literal">ReloadableResourceBundleMessageSource</code> class. This variant supports the same bundle
file format but is more flexible than the standard JDK based
<code class="literal">ResourceBundleMessageSource</code> implementation.</em></span> In particular, it allows for reading
files from any Spring resource location (not just from the classpath) and supports hot
reloading of bundle property files (while efficiently caching them in between). Check
out the <code class="literal">ReloadableResourceBundleMessageSource</code> javadocs for details.</p>
</td></tr></table></div>

</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="context-functionality-events" href="#context-functionality-events"></a>5.15.2&nbsp;Standard and Custom Events</h3></div></div></div>

<p>Event handling in the <code class="literal">ApplicationContext</code> is provided through the <code class="literal">ApplicationEvent</code>
class and <code class="literal">ApplicationListener</code> interface. If a bean that implements the
<code class="literal">ApplicationListener</code> interface is deployed into the context, every time an
<code class="literal">ApplicationEvent</code> gets published to the <code class="literal">ApplicationContext</code>, that bean is notified.
Essentially, this is the standard <span class="emphasis"><em>Observer</em></span> design pattern. Spring provides the
following standard events:</p>
<div class="table"><a name="beans-ctx-events-tbl" href="#beans-ctx-events-tbl"></a><p class="title"><b>Table&nbsp;5.7.&nbsp;Built-in Events</b></p><div class="table-contents">

  <table summary="Built-in Events" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="col_1"><col class="col_2"></colgroup><thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">Event</th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top">Explanation</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">ContextRefreshedEvent</code></p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Published when the <code class="literal">ApplicationContext</code> is initialized or refreshed, for example,
  using the <code class="literal">refresh()</code> method on the <code class="literal">ConfigurableApplicationContext</code> interface.
  "Initialized" here means that all beans are loaded, post-processor beans are detected
  and activated, singletons are pre-instantiated, and the <code class="literal">ApplicationContext</code> object is
  ready for use. As long as the context has not been closed, a refresh can be triggered
  multiple times, provided that the chosen <code class="literal">ApplicationContext</code> actually supports such
  "hot" refreshes. For example, <code class="literal">XmlWebApplicationContext</code> supports hot refreshes, but
  <code class="literal">GenericApplicationContext</code> does not.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">ContextStartedEvent</code></p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Published when the <code class="literal">ApplicationContext</code> is started, using the <code class="literal">start()</code> method on the
  <code class="literal">ConfigurableApplicationContext</code> interface. "Started" here means that all <code class="literal">Lifecycle</code>
  beans receive an explicit start signal. Typically this signal is used to restart beans
  after an explicit stop, but it may also be used to start components that have not been
  configured for autostart , for example, components that have not already started on
  initialization.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">ContextStoppedEvent</code></p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Published when the <code class="literal">ApplicationContext</code> is stopped, using the <code class="literal">stop()</code> method on the
  <code class="literal">ConfigurableApplicationContext</code> interface. "Stopped" here means that all <code class="literal">Lifecycle</code>
  beans receive an explicit stop signal. A stopped context may be restarted through a
  <code class="literal">start()</code> call.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">ContextClosedEvent</code></p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Published when the <code class="literal">ApplicationContext</code> is closed, using the <code class="literal">close()</code> method on the
  <code class="literal">ConfigurableApplicationContext</code> interface. "Closed" here means that all singleton
  beans are destroyed. A closed context reaches its end of life; it cannot be refreshed
  or restarted.</p></td></tr><tr><td style="border-right: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">RequestHandledEvent</code></p></td><td style="" align="left" valign="top"><p>A web-specific event telling all beans that an HTTP request has been serviced. This
  event is published <span class="emphasis"><em>after</em></span> the request is complete. This event is only applicable to
  web applications using Spring&#8217;s <code class="literal">DispatcherServlet</code>.</p></td></tr></tbody></table>
</div></div><br class="table-break">

<p>You can also create and publish your own custom events. This example demonstrates a
simple class that extends Spring&#8217;s <code class="literal">ApplicationEvent</code> base class:</p>
<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> BlackListEvent <span class="hl-keyword">extends</span> ApplicationEvent {

    <span class="hl-keyword">private</span> <span class="hl-keyword">final</span> String address;
    <span class="hl-keyword">private</span> <span class="hl-keyword">final</span> String test;

    <span class="hl-keyword">public</span> BlackListEvent(Object source, String address, String test) {
        <span class="hl-keyword">super</span>(source);
        <span class="hl-keyword">this</span>.address = address;
        <span class="hl-keyword">this</span>.test = test;
    }

    <span class="hl-comment">// accessor and other methods...</span>

}</pre>

<p>To publish a custom <code class="literal">ApplicationEvent</code>, call the <code class="literal">publishEvent()</code> method on an
<code class="literal">ApplicationEventPublisher</code>. Typically this is done by creating a class that implements
<code class="literal">ApplicationEventPublisherAware</code> and registering it as a Spring bean. The following
example demonstrates such a class:</p>
<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> EmailService <span class="hl-keyword">implements</span> ApplicationEventPublisherAware {

    <span class="hl-keyword">private</span> List&lt;String&gt; blackList;
    <span class="hl-keyword">private</span> ApplicationEventPublisher publisher;

    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> setBlackList(List&lt;String&gt; blackList) {
        <span class="hl-keyword">this</span>.blackList = blackList;
    }

    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> setApplicationEventPublisher(ApplicationEventPublisher publisher) {
        <span class="hl-keyword">this</span>.publisher = publisher;
    }

    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> sendEmail(String address, String text) {
        <span class="hl-keyword">if</span> (blackList.contains(address)) {
            BlackListEvent event = <span class="hl-keyword">new</span> BlackListEvent(<span class="hl-keyword">this</span>, address, text);
            publisher.publishEvent(event);
            <span class="hl-keyword">return</span>;
        }
        <span class="hl-comment">// send email...</span>
    }

}</pre>

<p>At configuration time, the Spring container will detect that <code class="literal">EmailService</code> implements
<code class="literal">ApplicationEventPublisherAware</code> and will automatically call
<code class="literal">setApplicationEventPublisher()</code>. In reality, the parameter passed in will be the Spring
container itself; you&#8217;re simply interacting with the application context via its
<code class="literal">ApplicationEventPublisher</code> interface.</p>
<p>To receive the custom <code class="literal">ApplicationEvent</code>, create a class that implements
<code class="literal">ApplicationListener</code> and register it as a Spring bean. The following example
demonstrates such a class:</p>
<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> BlackListNotifier <span class="hl-keyword">implements</span> ApplicationListener&lt;BlackListEvent&gt; {

    <span class="hl-keyword">private</span> String notificationAddress;

    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> setNotificationAddress(String notificationAddress) {
        <span class="hl-keyword">this</span>.notificationAddress = notificationAddress;
    }

    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> onApplicationEvent(BlackListEvent event) {
        <span class="hl-comment">// notify appropriate parties via notificationAddress...</span>
    }

}</pre>

<p>Notice that <code class="literal">ApplicationListener</code> is generically parameterized with the type of your
custom event, <code class="literal">BlackListEvent</code>. This means that the <code class="literal">onApplicationEvent()</code> method can
remain type-safe, avoiding any need for downcasting. You may register as many event
listeners as you wish, but note that by default event listeners receive events
synchronously. This means the <code class="literal">publishEvent()</code> method blocks until all listeners have
finished processing the event. One advantage of this synchronous and single-threaded
approach is that when a listener receives an event, it operates inside the transaction
context of the publisher if a transaction context is available. If another strategy for
event publication becomes necessary, refer to the JavaDoc for Spring&#8217;s
<code class="literal">ApplicationEventMulticaster</code> interface.</p>
<p>The following example shows the bean definitions used to register and configure each of
the classes above:</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"emailService"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"example.EmailService"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"blackList"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;list&gt;</span>
            <span class="hl-tag">&lt;value&gt;</span>known.spammer@example.org<span class="hl-tag">&lt;/value&gt;</span>
            <span class="hl-tag">&lt;value&gt;</span>known.hacker@example.org<span class="hl-tag">&lt;/value&gt;</span>
            <span class="hl-tag">&lt;value&gt;</span>john.doe@example.org<span class="hl-tag">&lt;/value&gt;</span>
        <span class="hl-tag">&lt;/list&gt;</span>
    <span class="hl-tag">&lt;/property&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span>

<span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"blackListNotifier"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"example.BlackListNotifier"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"notificationAddress"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"blacklist@example.org"</span><span class="hl-tag">/&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span></pre>

<p>Putting it all together, when the <code class="literal">sendEmail()</code> method of the <code class="literal">emailService</code> bean is
called, if there are any emails that should be blacklisted, a custom event of type
<code class="literal">BlackListEvent</code> is published. The <code class="literal">blackListNotifier</code> bean is registered as an
<code class="literal">ApplicationListener</code> and thus receives the <code class="literal">BlackListEvent</code>, at which point it can
notify appropriate parties.</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p>Spring&#8217;s eventing mechanism is designed for simple communication between Spring beans
within the same application context. However, for more sophisticated enterprise
integration needs, the separately-maintained
<a class="ulink" href="http://projects.spring.io/spring-integration/" target="_top">Spring Integration</a> project provides
complete support for building lightweight,
<a class="ulink" href="http://www.enterpriseintegrationpatterns.com" target="_top">pattern-oriented</a>, event-driven
architectures that build upon the well-known Spring programming model.</p>
</td></tr></table></div>

</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="context-functionality-resources" href="#context-functionality-resources"></a>5.15.3&nbsp;Convenient access to low-level resources</h3></div></div></div>

<p>For optimal usage and understanding of application contexts, users should generally
familiarize themselves with Spring&#8217;s <code class="literal">Resource</code> abstraction, as described in the chapter
<a class="xref" href="resources.html" title="6.&nbsp;Resources">Chapter&nbsp;6, <i>Resources</i></a>.</p>
<p>An application context is a <code class="literal">ResourceLoader</code>, which can be used to load <code class="literal">Resource</code>s. A
<code class="literal">Resource</code> is essentially a more feature rich version of the JDK class <code class="literal">java.net.URL</code>,
in fact, the implementations of the <code class="literal">Resource</code> wrap an instance of <code class="literal">java.net.URL</code> where
appropriate. A <code class="literal">Resource</code> can obtain low-level resources from almost any location in a
transparent fashion, including from the classpath, a filesystem location, anywhere
describable with a standard URL, and some other variations. If the resource location
string is a simple path without any special prefixes, where those resources come from is
specific and appropriate to the actual application context type.</p>
<p>You can configure a bean deployed into the application context to implement the special
callback interface, <code class="literal">ResourceLoaderAware</code>, to be automatically called back at
initialization time with the application context itself passed in as the
<code class="literal">ResourceLoader</code>. You can also expose properties of type <code class="literal">Resource</code>, to be used to
access static resources; they will be injected into it like any other properties. You
can specify those <code class="literal">Resource</code> properties as simple String paths, and rely on a special
JavaBean <code class="literal">PropertyEditor</code> that is automatically registered by the context, to convert
those text strings to actual <code class="literal">Resource</code> objects when the bean is deployed.</p>
<p>The location path or paths supplied to an <code class="literal">ApplicationContext</code> constructor are actually
resource strings, and in simple form are treated appropriately to the specific context
implementation. <code class="literal">ClassPathXmlApplicationContext</code> treats a simple location path as a
classpath location. You can also use location paths (resource strings) with special
prefixes to force loading of definitions from the classpath or a URL, regardless of the
actual context type.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="context-create" href="#context-create"></a>5.15.4&nbsp;web &#24212;&#29992;&#31243;&#24207;&#20013; ApplicationContext &#30340;&#20415;&#21033;&#23454;&#20363;&#21270;</h3></div></div></div>

<p>&#20320;&#21487;&#20197;&#22768;&#26126;&#24335;&#22320;&#21019;&#24314; <code class="literal">ApplicationContext</code> &#23454;&#20363;&#65292;&#27604;&#22914;&#36890;&#36807; <code class="literal">ContextLoader</code>&#12290;&#24403;&#28982;&#20320;&#20063;&#21487;&#20197;&#32534;&#31243;&#24335;&#22320;&#21019;&#24314; <code class="literal">ApplicationContext</code> &#23454;&#20363;&#65292;&#21482;&#38656;&#35201;&#20351;&#29992;&#19968;&#20010; <code class="literal">ApplicationContext</code> &#23454;&#29616;&#12290;</p>
<p>&#20320;&#21487;&#20197;&#20351;&#29992; <code class="literal">ContextLoaderListener</code> &#26469;&#27880;&#20876;&#19968;&#20010; <code class="literal">ApplicationContext</code>&#65292;&#22914;&#19979;&#65306;</p>
<pre class="programlisting"><span class="hl-tag">&lt;context-param&gt;</span>
    <span class="hl-tag">&lt;param-name&gt;</span>contextConfigLocation<span class="hl-tag">&lt;/param-name&gt;</span>
    <span class="hl-tag">&lt;param-value&gt;</span>/WEB-INF/daoContext.xml /WEB-INF/applicationContext.xml<span class="hl-tag">&lt;/param-value&gt;</span>
<span class="hl-tag">&lt;/context-param&gt;</span>

<span class="hl-tag">&lt;listener&gt;</span>
    <span class="hl-tag">&lt;listener-class&gt;</span>org.springframework.web.context.ContextLoaderListener<span class="hl-tag">&lt;/listener-class&gt;</span>
<span class="hl-tag">&lt;/listener&gt;</span></pre>

<p>&#35813;&#30417;&#21548;&#22120;&#20250;&#26816;&#26597; <code class="literal">contextConfigLocation</code> &#21442;&#25968;&#12290;&#22914;&#26524;&#35813;&#21442;&#25968;&#19981;&#23384;&#22312;&#65292;&#30417;&#21548;&#22120;&#20250;&#20351;&#29992; <code class="literal">/WEB-INF/applicationContext.xml</code> &#20316;&#20026;&#40664;&#35748;&#20540;&#12290;&#22914;&#26524;&#35813;&#21442;&#25968;<span class="emphasis"><em>&#23384;&#22312;</em></span>&#65292;&#35813;&#30417;&#21548;&#22120;&#36890;&#36807;&#20351;&#29992;&#39044;&#32622;&#30340;&#20998;&#38548;&#31526;&#65288;&#36887;&#21495;&#65292;&#20998;&#21495;&#21644;&#31354;&#30333;&#31526;&#65289;&#26469;&#20998;&#38548;&#23383;&#31526;&#20018;&#65292;&#24182;&#20351;&#29992;&#20998;&#38548;&#21518;&#30340;&#20540;&#20316;&#20026;&#35201;&#26597;&#25214;&#30340;&#24212;&#29992;&#19978;&#19979;&#25991;&#30340;&#36335;&#24452;&#12290;&#21516;&#26102;&#25903;&#25345; Ant &#39118;&#26684;&#30340;&#36335;&#24452;&#27169;&#24335;&#12290;&#27604;&#22914; <code class="literal">/WEB-INF/*Context.xml</code> &#34920;&#31034;&#20301;&#20110; "WEB-INF" &#30446;&#24405;&#19979;&#19988;&#21517;&#31216;&#20197; "Context.xml" &#20316;&#20026;&#32467;&#23614;&#30340;&#25152;&#26377;&#25991;&#20214;&#65292;<code class="literal">/WEB-INF/**/*Context.xml</code> &#34920;&#31034; "WEB-INF" &#19979;&#30340;&#20219;&#24847;&#23376;&#30446;&#24405;&#19979;&#30340;&#25152;&#26377;&#36825;&#31867;&#25991;&#20214;&#12290;</p>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="context-deploy-rar" href="#context-deploy-rar"></a>5.15.5&nbsp;Deploying a Spring ApplicationContext as a Java EE RAR file</h3></div></div></div>

<p>It is possible to deploy a Spring ApplicationContext as a RAR file, encapsulating the
context and all of its required bean classes and library JARs in a Java EE RAR deployment
unit. This is the equivalent of bootstrapping a standalone ApplicationContext, just hosted
in Java EE environment, being able to access the Java EE servers facilities. RAR deployment
is  more natural alternative to scenario of deploying a headless WAR file, in effect, a WAR
file without any HTTP entry points that is used only for bootstrapping a Spring
ApplicationContext in a Java EE environment.</p>
<p>RAR deployment is ideal for application contexts that do not need HTTP entry points but
rather consist only of message endpoints and scheduled jobs. Beans in such a context can
use application server resources such as the JTA transaction manager and JNDI-bound JDBC
DataSources and JMS ConnectionFactory instances, and may also register with the
platform&#8217;s JMX server - all through Spring&#8217;s standard transaction management and JNDI
and JMX support facilities. Application components can also interact with the
application server&#8217;s JCA WorkManager through Spring&#8217;s <code class="literal">TaskExecutor</code> abstraction.</p>
<p>Check out the JavaDoc of the
<a class="ulink" href="http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/jca/context/SpringContextResourceAdapter.html" target="_top"><code class="literal">SpringContextResourceAdapter</code></a>
class for the configuration details involved in RAR deployment.</p>
<p><span class="emphasis"><em>For a simple deployment of a Spring ApplicationContext as a Java EE RAR file:</em></span> package
all application classes into a RAR file, which is a standard JAR file with a different
file extension. Add all required library JARs into the root of the RAR archive. Add a
"META-INF/ra.xml" deployment descriptor (as shown in <code class="literal">SpringContextResourceAdapter</code>'s
JavaDoc) and the corresponding Spring XML bean definition file(s) (typically
"META-INF/applicationContext.xml"), and drop the resulting RAR file into your
application server&#8217;s deployment directory.</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p>Such RAR deployment units are usually self-contained; they do not expose components to
the outside world, not even to other modules of the same application. Interaction with a
RAR-based ApplicationContext usually occurs through JMS destinations that it shares with
other modules. A RAR-based ApplicationContext may also, for example, schedule some jobs,
reacting to new files in the file system (or the like). If it needs to allow synchronous
access from the outside, it could for example export RMI endpoints, which of course may
be used by other application modules on the same machine.</p>
</td></tr></table></div>

</div>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="beans-beanfactory" href="#beans-beanfactory"></a>5.16&nbsp;The BeanFactory</h2></div></div></div>

<p>The <code class="literal">BeanFactory</code> provides the underlying basis for Spring&#8217;s IoC functionality but it is
only used directly in integration with other third-party frameworks and is now largely
historical in nature for most users of Spring. The <code class="literal">BeanFactory</code> and related interfaces,
such as <code class="literal">BeanFactoryAware</code>, <code class="literal">InitializingBean</code>, <code class="literal">DisposableBean</code>, are still present in
Spring for the purposes of backward compatibility with the large number of third-party
frameworks that integrate with Spring. Often third-party components that can not use
more modern equivalents such as <code class="literal">@PostConstruct</code> or <code class="literal">@PreDestroy</code> in order to remain
compatible with JDK 1.4 or to avoid a dependency on JSR-250.</p>
<p>This section provides additional background into the differences between the
<code class="literal">BeanFactory</code> and <code class="literal">ApplicationContext</code> and how one might access the IoC container
directly through a classic singleton lookup.</p>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="context-introduction-ctx-vs-beanfactory" href="#context-introduction-ctx-vs-beanfactory"></a>5.16.1&nbsp;BeanFactory or ApplicationContext?</h3></div></div></div>

<p>Use an <code class="literal">ApplicationContext</code> unless you have a good reason for not doing so.</p>
<p>Because the <code class="literal">ApplicationContext</code> includes all functionality of the <code class="literal">BeanFactory</code>, it is
generally recommended over the <code class="literal">BeanFactory</code>, except for a few situations such as in an
<code class="literal">Applet</code> where memory consumption might be critical and a few extra kilobytes might make
a difference. However, for most typical enterprise applications and systems, the
<code class="literal">ApplicationContext</code> is what you will want to use. Spring makes <span class="emphasis"><em>heavy</em></span>
use of the <a class="link" href="beans.html#beans-factory-extension-bpp" title="5.8.1&nbsp;&#20351;&#29992;BeanPostProcessor&#33258;&#23450;&#20041;beans"><code class="literal">BeanPostProcessor</code> extension point</a> (to
effect proxying and so on). If you use only a plain <code class="literal">BeanFactory</code>, a fair amount of
support such as transactions and AOP will not take effect, at least not without some
extra steps on your part. This situation could be confusing because nothing is actually
wrong with the configuration.</p>
<p>The following table lists features provided by the <code class="literal">BeanFactory</code> and
<code class="literal">ApplicationContext</code> interfaces and implementations.</p>
<div class="table"><a name="context-introduction-ctx-vs-beanfactory-feature-matrix" href="#context-introduction-ctx-vs-beanfactory-feature-matrix"></a><p class="title"><b>Table&nbsp;5.8.&nbsp;Feature Matrix</b></p><div class="table-contents">

  <table summary="Feature Matrix" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="col_1"><col class="col_2"><col class="col_3"></colgroup><thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">Feature</th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><code class="literal">BeanFactory</code></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><code class="literal">ApplicationContext</code></th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Bean instantiation/wiring</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Yes</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Yes</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Automatic <code class="literal">BeanPostProcessor</code> registration</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>No</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Yes</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Automatic <code class="literal">BeanFactoryPostProcessor</code> registration</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>No</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Yes</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Convenient <code class="literal">MessageSource</code> access (for i18n)</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>No</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Yes</p></td></tr><tr><td style="border-right: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">ApplicationEvent</code> publication</p></td><td style="border-right: 0.5pt solid ; " align="left" valign="top"><p>No</p></td><td style="" align="left" valign="top"><p>Yes</p></td></tr></tbody></table>
</div></div><br class="table-break">

<p>To explicitly register a bean post-processor with a <code class="literal">BeanFactory</code> implementation, you
must write code like this:</p>
<pre class="programlisting">ConfigurableBeanFactory factory = <span class="hl-keyword">new</span> XmlBeanFactory(...);

<span class="hl-comment">// now register any needed BeanPostProcessor instances</span>
MyBeanPostProcessor postProcessor = <span class="hl-keyword">new</span> MyBeanPostProcessor();
factory.addBeanPostProcessor(postProcessor);

<span class="hl-comment">// now start using the factory</span></pre>

<p>To explicitly register a <code class="literal">BeanFactoryPostProcessor</code> when using a <code class="literal">BeanFactory</code>
implementation, you must write code like this:</p>
<pre class="programlisting">XmlBeanFactory factory = <span class="hl-keyword">new</span> XmlBeanFactory(<span class="hl-keyword">new</span> FileSystemResource(<span class="hl-string">"beans.xml"</span>));

<span class="hl-comment">// bring in some property values from a Properties file</span>
PropertyPlaceholderConfigurer cfg = <span class="hl-keyword">new</span> PropertyPlaceholderConfigurer();
cfg.setLocation(<span class="hl-keyword">new</span> FileSystemResource(<span class="hl-string">"jdbc.properties"</span>));

<span class="hl-comment">// now actually do the replacement</span>
cfg.postProcessBeanFactory(factory);</pre>

<p>In both cases, the explicit registration step is inconvenient, which is one reason why
the various <code class="literal">ApplicationContext</code> implementations are preferred above plain <code class="literal">BeanFactory</code>
implementations in the vast majority of Spring-backed applications, especially when
using <code class="literal">BeanFactoryPostProcessors</code> and <code class="literal">BeanPostProcessors</code>. These mechanisms implement
important functionality such as property placeholder replacement and AOP.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="beans-servicelocator" href="#beans-servicelocator"></a>5.16.2&nbsp;Glue code and the evil singleton</h3></div></div></div>

<p>It is best to write most application code in a dependency-injection (DI) style, where
that code is served out of a Spring IoC container, has its own dependencies supplied by
the container when it is created, and is completely unaware of the container. However,
for the small glue layers of code that are sometimes needed to tie other code together,
you sometimes need a singleton (or quasi-singleton) style access to a Spring IoC
container. For example, third-party code may try to construct new objects directly (
<code class="literal">Class.forName()</code> style), without the ability to get these objects out of a Spring IoC
container.If the object constructed by the third-party code is a small stub or proxy,
which then uses a singleton style access to a Spring IoC container to get a real object
to delegate to, then inversion of control has still been achieved for the majority of
the code (the object coming out of the container). Thus most code is still unaware of
the container or how it is accessed, and remains decoupled from other code, with all
ensuing benefits. EJBs may also use this stub/proxy approach to delegate to a plain Java
implementation object, retrieved from a Spring IoC container. While the Spring IoC
container itself ideally does not have to be a singleton, it may be unrealistic in terms
of memory usage or initialization times (when using beans in the Spring IoC container
such as a Hibernate <code class="literal">SessionFactory</code>) for each bean to use its own, non-singleton Spring
IoC container.</p>
<p>Looking up the application context in a service locator style is sometimes the only
option for accessing shared Spring-managed components, such as in an EJB 2.1
environment, or when you want to share a single ApplicationContext as a parent to
WebApplicationContexts across WAR files. In this case you should look into using the
utility class
<a class="ulink" href="http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/context/access/ContextSingletonBeanFactoryLocator.html" target="_top"><code class="literal">ContextSingletonBeanFactoryLocator</code></a>
locator that is described in this
<a class="ulink" href="https://spring.io/blog/2007/06/11/using-a-shared-parent-application-context-in-a-multi-war-spring-application/" target="_top">Spring
team blog entry</a>.</p>
</div>
</div>
<div class="footnotes"><br><hr style="width:100; text-align:left;margin-left: 0"><div id="ftn.d5e956" class="footnote"><p><a href="#d5e956" class="simpara"><sup class="simpara">[1] </sup></a>See <a class="xref" href="overview.html#background-ioc" title="&#32972;&#26223;">&#32972;&#26223;</a> </p></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="spring-core.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="spring-core.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="resources.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Part&nbsp;III.&nbsp;&#26680;&#24515;&#25216;&#26415;&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;6.&nbsp;Resources</td></tr></table></div></body></html>