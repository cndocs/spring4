<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>17.&nbsp;&#35270;&#22270;&#25216;&#26415;</title><link rel="stylesheet" type="text/css" href="css/manual-multipage.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><link rel="home" href="index.html" title="Spring Framework Reference Documentation"><link rel="up" href="spring-web.html" title="Part&nbsp;V.&nbsp;The Web"><link rel="prev" href="mvc.html" title="16.&nbsp;Web MVC &#26694;&#26550;"><link rel="next" href="web-integration.html" title="18.&nbsp;&#21516;&#20854;&#20182;web&#26694;&#26550;&#38598;&#25104;"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">17.&nbsp;&#35270;&#22270;&#25216;&#26415;</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="mvc.html">Prev</a>&nbsp;</td><th width="60%" align="center">Part&nbsp;V.&nbsp;The Web</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="web-integration.html">Next</a></td></tr></table><hr></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a name="view" href="#view"></a>17.&nbsp;&#35270;&#22270;&#25216;&#26415;</h2></div></div></div>

<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="view-introduction" href="#view-introduction"></a>17.1&nbsp;&#31616;&#20171;</h2></div></div></div>

<p>Spring&#30340;&#19968;&#20010;&#25797;&#38271;&#39046;&#22495;&#22312;&#20110;&#65292;&#25226;&#35270;&#22270;&#23618;&#25216;&#26415;&#21644;MVC&#26694;&#26550;&#30340;&#20854;&#20313;&#37096;&#20998;&#20998;&#31163;&#24320;&#26469;&#12290;
&#20363;&#22914;&#65292;&#36873;&#25321;&#20351;&#29992;Velocity&#25110;&#32773;XSLT&#26469;&#20195;&#26367;&#24050;&#26377;&#30340;JSP&#26041;&#24335;&#21482;&#38656;&#35201;&#22312;&#37197;&#32622;&#19978;&#20570;&#25913;&#21160;&#23601;&#21487;&#20197;&#20102;&#12290;
 &#26412;&#31456;&#28085;&#30422;&#20102;&#21644;Spring&#21327;&#21516;&#24037;&#20316;&#30340;&#20027;&#27969;view&#23618;&#25216;&#26415;&#24182;&#31616;&#35201;&#20171;&#32461;&#20102;&#22914;&#20309;&#22686;&#21152;&#26032;&#30340;&#26041;&#24335;&#12290;
 &#36825;&#37324;&#20551;&#35774;&#20320;&#24050;&#32463;&#29087;&#24713;<a class="xref" href="mvc.html#mvc-viewresolver" title="16.5&nbsp;&#35270;&#22270;&#35299;&#26512;">Section&nbsp;16.5, &#8220;&#35270;&#22270;&#35299;&#26512;&#8221;</a>&#31456;&#33410;&#30340;&#30693;&#35782;&#65292;&#37027;&#37324;&#35762;&#36848;&#20102;view&#23618;&#19982;MVC&#26694;&#26550;&#21327;&#20316;&#30340;&#22522;&#30784;&#12290;</p>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="view-jsp" href="#view-jsp"></a>17.2&nbsp;JSP &amp; JSTL</h2></div></div></div>

<p>Spring&#20026;JSP&#21644;JSTL&#36825;&#20123;view&#23618;&#25216;&#26415;&#25552;&#20379;&#20102;&#20960;&#20010;&#24320;&#31665;&#21363;&#29992;&#30340;&#35299;&#20915;&#26041;&#26696;&#12290;
&#20351;&#29992;JSP&#21644;JSTL&#30340;&#65292;&#37319;&#29992;WebApplicationContext&#20013;&#23450;&#20041;&#30340;&#26222;&#36890;&#35270;&#22270;&#35299;&#26512;&#22120;&#21363;&#21487;&#65307;
&#27492;&#22806;&#65292;&#20320;&#24403;&#28982;&#36824;&#24471;&#33258;&#24049;&#20889;&#19968;&#20123;&#23454;&#38469;&#20570;&#28210;&#26579;&#30340;JSP&#39029;&#38754;&#12290;</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p>&#35774;&#32622;&#24212;&#29992;&#31243;&#24207;&#20351;&#29992;JSTL&#26159;&#19968;&#31181;&#24120;&#35265;&#30340;&#38169;&#35823;&#65292;&#20027;&#35201;&#22312;&#19981;&#21516;&#30340;Servlet&#35268;&#33539;&#65292;JSP&#21644;JSTL&#29256;&#26412;&#19978;&#20250;&#24341;&#36215;&#28151;&#20081;&#65292;
&#36825;&#24847;&#21619;&#30528;&#22914;&#20309;&#27491;&#30830;&#30340;&#22768;&#26126;&#36825;&#20123;&#26631;&#31614;&#24211;&#12290;&#36825;&#31687;&#25991;&#31456;http://www.mularien.com/blog/2008/04/24/how-to-reference-and-use-jstl-in-your-web-application/[How
to Reference and Use JSTL in your Web Application]&#20250;&#25552;&#20379;&#32473;&#25105;&#20204;&#19968;&#20123;&#26377;&#29992;&#30340;&#25351;&#23548;&#26469;&#36991;&#20813;&#19968;&#20123;&#24120;&#35265;&#30340;&#38519;&#38449;&#12290;
&#38656;&#35201;&#27880;&#24847;&#30340;&#26159;&#65292;Spring 3.0&#25903;&#25345;&#30340;Servlet&#26368;&#20302;&#29256;&#26412;&#26159;2.4&#65288;JSP 2.0,JSTL 1.1&#65289;&#65292;&#36825;&#26679;&#20250;&#22312;&#19968;&#23450;&#33539;&#22260;&#20869;&#20943;&#23569;&#19968;&#20123;&#28151;&#20081;&#12290;</p>
</td></tr></table></div>

<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="view-jsp-resolver" href="#view-jsp-resolver"></a>17.2.1&nbsp;&#35270;&#22270;&#35299;&#26512;&#22120;</h3></div></div></div>

<p>&#19982;&#22312;Spring&#20013;&#37319;&#29992;&#30340;&#20219;&#20309;&#20854;&#20182;&#35270;&#22270;&#25216;&#26415;&#19968;&#26679;&#65292;&#20351;&#29992;JSP&#38656;&#35201;&#19968;&#20010;&#35270;&#22270;&#35299;&#26512;&#22120;&#26469;&#35299;&#26512;&#20320;&#30340;&#35270;&#22270;&#65292;
&#24120;&#29992;&#30340;&#26159;<code class="literal">InternalResourceViewResolver</code>&#21644; <code class="literal">ResourceBundleViewResolver</code>&#12290;
&#23427;&#20204;&#37117;&#22768;&#26126;&#22312;<code class="literal">WebApplicationContext</code>&#20013;&#65306;</p>
<pre class="programlisting"><span class="hl-comment">&lt;!-- the ResourceBundleViewResolver --&gt;</span>
<span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"viewResolver"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"org.springframework.web.servlet.view.ResourceBundleViewResolver"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"basename"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"views"</span><span class="hl-tag">/&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span>

# And a sample properties file is uses (views.properties in WEB-INF/classes):
welcome.(class)=org.springframework.web.servlet.view.JstlView
welcome.url=/WEB-INF/jsp/welcome.jsp

productList.(class)=org.springframework.web.servlet.view.JstlView
productList.url=/WEB-INF/jsp/productlist.jsp</pre>

<p>&#27491;&#22914;&#20320;&#25152;&#30475;&#21040;&#30340;&#65292; <code class="literal">ResourceBundleViewResolver</code>&#38656;&#35201;&#19968;&#20010;&#23646;&#24615;&#25991;&#20214;&#26469;&#23450;&#20041;view&#21517;&#31216;&#23545;&#24212;&#26144;&#23556;&#21040;&#21040;&#19968;&#20010;class&#21644;&#19968;&#20010;URL&#65292;
&#20351;&#29992; <code class="literal">ResourceBundleViewResolver</code>&#65292;&#21487;&#20197;&#21482;&#20351;&#29992;&#19968;&#20010;&#35299;&#26512;&#22120;&#26469;&#28151;&#29992;&#19981;&#21516;&#31867;&#22411;&#30340;&#35270;&#22270;&#25216;&#26415;&#12290;.</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"viewResolver"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"viewClass"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"org.springframework.web.servlet.view.JstlView"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"prefix"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"/WEB-INF/jsp/"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"suffix"</span> <span class="hl-attribute">value</span>=<span class="hl-value">".jsp"</span><span class="hl-tag">/&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span></pre>

<p>&#22914;&#19978;&#20363;&#25152;&#31034;&#65292; &#29992;JSP&#26102;&#21487;&#20197;&#37197;&#32622;&#19968;&#20010;<code class="literal">InternalResourceBundleViewResolver</code>&#12290;&#20316;&#20026;&#19968;&#20010;&#26368;&#20339;&#23454;&#36341;&#65292;&#25105;&#20204;&#24378;&#28872;&#25512;&#33616;&#20320;&#29992; WEB-INF&#19979;&#30340;&#19968;&#20010;&#30446;&#24405;&#26469;&#23384;&#25918;JSP&#25991;&#20214;&#65292;&#20174;&#32780;&#36991;&#20813;&#34987;&#23458;&#25143;&#31471;&#30452;&#25509;&#35775;&#38382;&#12290;</p>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="view-jsp-jstl" href="#view-jsp-jstl"></a>17.2.2&nbsp;<span class="emphasis"><em>Plain-old</em></span> JSPs versus JSTL</h3></div></div></div>

<p>&#20351;&#29992;JSTL&#26102;&#65292;&#24517;&#39035;&#20351;&#29992;&#19968;&#20010;&#29305;&#21035;&#30340;view&#31867;<code class="literal">JstlView</code>&#65292;&#22240;&#20026;JSTL&#38656;&#35201;&#19968;&#20123;&#20934;&#22791;&#24037;&#20316;&#65292;&#28982;&#21518;&#20687;I18N&#36825;&#26679;&#30340;&#29305;&#24615;&#25165;&#33021;&#24037;&#20316;&#12290;</p>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="view-jsp-tags" href="#view-jsp-tags"></a>17.2.3&nbsp;&#24110;&#21161;&#31616;&#21270;&#24320;&#21457;&#30340;&#39069;&#22806;&#30340;&#26631;&#31614;</h3></div></div></div>

<p>&#21069;&#38754;&#30340;&#31456;&#33410;&#20013;&#25552;&#21040;&#36807;&#65292;Spring&#25552;&#20379;&#20102;&#20174;&#35831;&#27714;&#21442;&#25968;&#21040;&#21629;&#20196;&#23545;&#35937;&#30340;&#25968;&#25454;&#32465;&#23450;&#12290;&#20026;&#20102;&#31616;&#21270;&#19982;&#25968;&#25454;&#32465;&#23450;&#29305;&#24615;&#37197;&#21512;&#20351;&#29992;&#30340;JSP&#39029;&#38754;&#30340;&#24320;&#21457;&#65292;Spring&#25552;&#20379;&#20102;&#19968;&#20123;&#26631;&#31614;&#35753;&#20107;&#24773;&#21464;&#24471;&#26356;&#31616;&#21333;&#12290;
&#36825;&#20123;&#26631;&#31614;&#37117;&#25552;&#20379;&#20102; <span class="emphasis"><em>HTML escaping</em></span>&#30340;&#29305;&#24615;&#65292;&#33021;&#22815;&#25171;&#24320;&#25110;&#20851;&#38381;&#23383;&#31526;&#36716;&#30721;&#30340;&#21151;&#33021;&#12290;
&#26631;&#31614;&#24211;&#25551;&#36848;&#31526;(TLD)&#21253;&#21547;&#22312;<code class="literal">spring-webmvc.jar</code>&#20013;&#12290;&#20851;&#20110;&#27599;&#20010;tag&#30340;&#26356;&#22810;&#35814;&#32454;&#20449;&#24687;&#35831;&#21442;&#38405;&#38468;&#24405;<a class="xref" href="spring.tld.html" title="35.&nbsp;spring.tld">Chapter&nbsp;35, <i>spring.tld</i></a>&#12290;</p>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="view-jsp-formtaglib" href="#view-jsp-formtaglib"></a>17.2.4&nbsp;&#20351;&#29992;Spring&#25552;&#20379;&#30340;&#34920;&#21333;&#26631;&#31614;&#24211;</h3></div></div></div>

<p>&#22312;2.0&#30340;&#29256;&#26412;&#20013;&#65292;&#24403;&#20351;&#29992;JSP&#21644;Spring Web MVS&#30340;&#26102;&#20505;&#65292;Srping&#25552;&#20379;&#20102;&#19968;&#32452;&#20840;&#38754;&#30340;&#29992;&#20110;&#22788;&#29702;&#34920;&#21333;&#20803;&#32032;&#36827;&#34892;&#25968;&#25454;&#32465;&#23450;&#30340;&#26631;&#31614;&#12290;
&#27599;&#20010;&#26631;&#31614;&#37117;&#25552;&#20379;&#20102;&#25903;&#25345;&#35774;&#32622;&#23545;&#24212;HTML&#26631;&#31614;&#30340;&#23646;&#24615;&#65292;&#20351;&#24471;&#26631;&#31614;&#29087;&#24713;&#19988;&#30452;&#35266;&#30340;&#20351;&#29992;&#12290;&#26631;&#31614;&#29983;&#25104;&#30340;HTML&#20860;&#23481;HTML 4.01/XHTML 1.0&#25991;&#26723;&#26631;&#20934;&#12290;</p>
<p>&#19981;&#20687;&#20854;&#20182;&#30340;form/input&#26631;&#31614;&#24211;&#65292;Spring&#30340;&#34920;&#21333;&#34920;&#21333;&#26631;&#31614;&#24211;&#38598;&#25104;&#22312;Spring Web MVC&#20013;&#65292;&#33021;&#22815;&#35753;&#26631;&#31614;&#35775;&#38382;&#21629;&#20196;&#23545;&#35937;&#20197;&#21450;&#24341;&#29992;&#25968;&#25454;&#22312;&#20320;&#30340;&#22788;&#29702;&#25511;&#21046;&#22120;&#20013;&#12290;
&#27491;&#22914;&#25509;&#19979;&#26469;&#30475;&#21040;&#30340;&#20363;&#23376;&#65292;&#36825;&#20123;form&#26631;&#31614;&#20351;&#24471;&#20351;&#29992;JSPs&#24320;&#21457;&#26356;&#23481;&#26131;&#12289;&#26356;&#26131;&#20110;&#38405;&#35835;&#21644;&#32500;&#25252;&#12290;</p>
<p>&#35753;&#25105;&#20204;&#36890;&#36807;&#19968;&#20010;&#20363;&#23376;&#20102;&#35299;&#27599;&#20010;&#26631;&#31614;&#26159;&#22914;&#20309;&#20351;&#29992;&#30340;&#12290;&#25105;&#20204;&#24050;&#32463;&#21253;&#21547;&#20102;&#29983;&#25104;&#22909;&#30340;html&#29255;&#27573;&#65292;&#26576;&#20123;&#26631;&#31614;&#38656;&#35201;&#26356;&#36827;&#19968;&#27493;&#30340;&#25506;&#35752;&#12290;</p>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="view-jsp-formtaglib-configuration" href="#view-jsp-formtaglib-configuration"></a>&#37197;&#32622;</h4></div></div></div>

<p>&#36825;&#20123;&#34920;&#21333;&#26631;&#31614;&#24211;&#25414;&#32465;&#22312;<code class="literal">spring-webmvc.jar</code>&#20013;&#12290;&#36825;&#20123;&#26631;&#31614;&#24211;&#30340;&#25551;&#36848;&#31526;&#34987;&#31216;&#20026;<code class="literal">spring-form.tld</code>&#12290;</p>
<p>&#20351;&#29992;&#36825;&#20010;&#26631;&#31614;&#24211;&#65292;&#38656;&#35201;&#25226;&#19979;&#38754;&#36825;&#27573;&#20195;&#30721;&#21152;&#21040;&#20320;&#30340;JSP&#39029;&#38754;&#30340;&#26368;&#39030;&#31471;&#65306;</p>
<pre class="programlisting"><span class="hl-tag">&lt;%@</span> <span class="hl-attribute">taglib</span> <span class="hl-attribute">prefix</span>=<span class="hl-value">"form"</span> <span class="hl-attribute">uri</span>=<span class="hl-value">"http://www.springframework.org/tags/form"</span> <span class="hl-attribute">%&gt;</span></pre>

<p>&#36825;&#37324;&#30340;<code class="literal">form</code>&#23601;&#26159;&#20320;&#35201;&#20351;&#29992;&#30340;&#36825;&#20123;&#26631;&#31614;&#21517;&#31216;&#30340;&#21069;&#32512;&#12290;</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="view-jsp-formtaglib-formtag" href="#view-jsp-formtaglib-formtag"></a>&#34920;&#21333;&#26631;&#31614;</h4></div></div></div>

<p>&#36825;&#20123;&#26631;&#31614;&#28210;&#26579;&#20102;&#19968;&#20010;HTML <span class="emphasis"><em>form</em></span>&#26631;&#31614;&#24182;&#19988;&#20844;&#24320;&#20102;&#19968;&#20010;&#32465;&#23450;&#36335;&#24452;&#20869;&#26631;&#31614;&#29992;&#20110;&#32465;&#23450;&#12290;
&#23427;&#25226;&#21629;&#20196;&#23545;&#35937;&#25918;&#32622;&#21040;<code class="literal">PageContext</code>&#20013;&#65292;&#36825;&#26679;&#21629;&#20196;&#23545;&#35937;&#23545;&#33021;&#34987;&#36825;&#20123;&#20869;&#37096;&#26631;&#31614;&#35775;&#38382;&#12290;
<span class="emphasis"><em>&#24211;&#20013;&#25152;&#26377;&#20854;&#20182;&#26631;&#31614;&#37117;&#26159;&#36825;&#20010;<code class="literal">form</code>&#26631;&#31614;&#30340;&#23884;&#22871;&#26631;&#31614;</em></span>&#12290;</p>
<p>&#20551;&#35774;&#25105;&#20204;&#26377;&#19968;&#20010;&#39046;&#22495;&#23545;&#35937;<code class="literal">User</code>&#12290;&#26159;&#19968;&#20010;&#21253;&#21547;&#23646;&#24615;&#30340;JavaBean&#65292;&#20363;&#22914;<code class="literal">firstName</code>&#21644;<code class="literal">lastName</code>&#12290;
&#25105;&#20204;&#25226;&#23427;&#20316;&#20026;&#34920;&#21333;&#25511;&#21046;&#22120;&#30340;&#34920;&#21333;&#22238;&#20256;&#23545;&#35937;&#36820;&#22238;&#21040;<code class="literal">form.jsp</code>&#12290;&#19979;&#38754;&#36825;&#20010;&#20363;&#23376;&#23601;&#26159;<code class="literal">form.jsp</code>&#30340;&#24418;&#24335;&#65306;</p>
<pre class="programlisting"><span class="hl-tag">&lt;form:form&gt;</span>
    <span class="hl-tag">&lt;table&gt;</span>
        <span class="hl-tag">&lt;tr&gt;</span>
            <span class="hl-tag">&lt;td&gt;</span>First Name:<span class="hl-tag">&lt;/td&gt;</span>
            <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;form:input</span> <span class="hl-attribute">path</span>=<span class="hl-value">"firstName"</span><span class="hl-tag"> /&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
        <span class="hl-tag">&lt;/tr&gt;</span>
        <span class="hl-tag">&lt;tr&gt;</span>
            <span class="hl-tag">&lt;td&gt;</span>Last Name:<span class="hl-tag">&lt;/td&gt;</span>
            <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;form:input</span> <span class="hl-attribute">path</span>=<span class="hl-value">"lastName"</span><span class="hl-tag"> /&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
        <span class="hl-tag">&lt;/tr&gt;</span>
        <span class="hl-tag">&lt;tr&gt;</span>
            <span class="hl-tag">&lt;td</span> <span class="hl-attribute">colspan</span>=<span class="hl-value">"2"</span><span class="hl-tag">&gt;</span>
                <span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"submit"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"Save Changes"</span><span class="hl-tag"> /&gt;</span>
            <span class="hl-tag">&lt;/td&gt;</span>
        <span class="hl-tag">&lt;/tr&gt;</span>
    <span class="hl-tag">&lt;/table&gt;</span>
<span class="hl-tag">&lt;/form:form&gt;</span></pre>

<p>&#36890;&#36807;&#39029;&#38754;&#25511;&#21046;&#22120;&#65292;<code class="literal">firstName</code>&#21644;<code class="literal">lastName</code>&#30340;&#20540;&#20174;&#25918;&#32622;&#22312;<code class="literal">PageContext</code>&#20013;&#30340;&#21629;&#20196;&#23545;&#35937;&#20013;&#26816;&#32034;&#20986;&#26469;&#12290;
&#32487;&#32493;&#38405;&#35835;&#26356;&#22797;&#26434;&#30340;&#20363;&#23376;&#65292;&#20102;&#35299;&#22914;&#20309;&#20351;&#29992;<code class="literal">form</code>&#26631;&#31614;&#30340;&#20869;&#37096;&#26631;&#31614;&#12290;</p>
<p>&#29983;&#25104;&#30340;HTML&#23601;&#26159;&#19968;&#20010;&#26631;&#20934;&#30340;&#34920;&#21333;&#65306;</p>
<pre class="programlisting"><span class="hl-tag">&lt;form</span> <span class="hl-attribute">method</span>=<span class="hl-value">"POST"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;table&gt;</span>
        <span class="hl-tag">&lt;tr&gt;</span>
            <span class="hl-tag">&lt;td&gt;</span>First Name:<span class="hl-tag">&lt;/td&gt;</span>
            <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;input</span> <span class="hl-attribute">name</span>=<span class="hl-value">"firstName"</span> <span class="hl-attribute">type</span>=<span class="hl-value">"text"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"Harry"</span><span class="hl-tag">/&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
        <span class="hl-tag">&lt;/tr&gt;</span>
        <span class="hl-tag">&lt;tr&gt;</span>
            <span class="hl-tag">&lt;td&gt;</span>Last Name:<span class="hl-tag">&lt;/td&gt;</span>
            <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;input</span> <span class="hl-attribute">name</span>=<span class="hl-value">"lastName"</span> <span class="hl-attribute">type</span>=<span class="hl-value">"text"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"Potter"</span><span class="hl-tag">/&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
        <span class="hl-tag">&lt;/tr&gt;</span>
        <span class="hl-tag">&lt;tr&gt;</span>
            <span class="hl-tag">&lt;td</span> <span class="hl-attribute">colspan</span>=<span class="hl-value">"2"</span><span class="hl-tag">&gt;</span>
                <span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"submit"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"Save Changes"</span><span class="hl-tag"> /&gt;</span>
            <span class="hl-tag">&lt;/td&gt;</span>
        <span class="hl-tag">&lt;/tr&gt;</span>
    <span class="hl-tag">&lt;/table&gt;</span>
<span class="hl-tag">&lt;/form&gt;</span></pre>

<p>&#21069;&#38754;&#30340;JSP&#20013;&#20551;&#23450;&#22238;&#20256;&#23545;&#35937;&#30340;&#21629;&#21517;&#21464;&#37327;&#23601;&#26159;<code class="literal">'command'</code>&#12290;&#22914;&#26524;&#20320;&#20197;&#21478;&#22806;&#19968;&#20010;&#21517;&#31216;&#25226;&#34920;&#21333;&#22238;&#20256;&#23545;&#35937;&#25918;&#21040;model&#37324;
&#65288;&#32477;&#23545;&#26159;&#19968;&#20010;&#26368;&#20339;&#30340;&#20363;&#23376;&#65289;&#65292;&#37027;&#20040;&#20320;&#21487;&#20197;&#23558;&#34920;&#21333;&#32465;&#23450;&#21040;&#21629;&#21517;&#21464;&#37327;&#65292;&#23601;&#20687;&#19979;&#38754;&#36825;&#26679;&#65306;</p>
<pre class="programlisting"><span class="hl-tag">&lt;form:form</span> <span class="hl-attribute">commandName</span>=<span class="hl-value">"user"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;table&gt;</span>
        <span class="hl-tag">&lt;tr&gt;</span>
            <span class="hl-tag">&lt;td&gt;</span>First Name:<span class="hl-tag">&lt;/td&gt;</span>
            <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;form:input</span> <span class="hl-attribute">path</span>=<span class="hl-value">"firstName"</span><span class="hl-tag"> /&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
        <span class="hl-tag">&lt;/tr&gt;</span>
        <span class="hl-tag">&lt;tr&gt;</span>
            <span class="hl-tag">&lt;td&gt;</span>Last Name:<span class="hl-tag">&lt;/td&gt;</span>
            <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;form:input</span> <span class="hl-attribute">path</span>=<span class="hl-value">"lastName"</span><span class="hl-tag"> /&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
        <span class="hl-tag">&lt;/tr&gt;</span>
        <span class="hl-tag">&lt;tr&gt;</span>
            <span class="hl-tag">&lt;td</span> <span class="hl-attribute">colspan</span>=<span class="hl-value">"2"</span><span class="hl-tag">&gt;</span>
                <span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"submit"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"Save Changes"</span><span class="hl-tag"> /&gt;</span>
            <span class="hl-tag">&lt;/td&gt;</span>
        <span class="hl-tag">&lt;/tr&gt;</span>
    <span class="hl-tag">&lt;/table&gt;</span>
<span class="hl-tag">&lt;/form:form&gt;</span></pre>

</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="view-jsp-formtaglib-inputtag" href="#view-jsp-formtaglib-inputtag"></a>input &#26631;&#31614;</h4></div></div></div>

<p>&#36825;&#20010;&#26631;&#31614;&#40664;&#35748;&#36890;&#36807;&#32465;&#23450;&#30340;&#20540;&#21644; type=<span class="emphasis"><em>text</em></span> &#28210;&#26579; HTML <span class="emphasis"><em>input</em></span> &#26631;&#31614;&#12290;&#20851;&#20110;&#20363;&#23376;&#21487;&#20197;&#21442;&#32771; <a class="xref" href="view.html#view-jsp-formtaglib-formtag" title="&#34920;&#21333;&#26631;&#31614;">the section called &#8220;&#34920;&#21333;&#26631;&#31614;&#8221;</a>&#12290;&#20174; Spring 3.1 &#24320;&#22987;&#65292;&#20320;&#21487;&#20197;&#20351;&#29992;&#20854;&#23427;&#31867;&#22411;&#65292;&#20363;&#22914;HTML5&#20013;&#23450;&#20041;&#30340; <span class="emphasis"><em>email</em></span>, <span class="emphasis"><em>tel</em></span>, <span class="emphasis"><em>date</em></span> &#31561;&#31561;&#12290;</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="view-jsp-formtaglib-checkboxtag" href="#view-jsp-formtaglib-checkboxtag"></a>checkbox &#26631;&#31614;</h4></div></div></div>

<p>&#36825;&#20010;&#26631;&#31614;&#36890;&#36807; <span class="emphasis"><em>checkbox</em></span> &#31867;&#22411;&#26469;&#28210;&#26579; HTML <span class="emphasis"><em>input</em></span> &#26631;&#31614;&#12290;</p>
<p>&#20551;&#35774;&#25105;&#20204;&#30340; <code class="literal">&#29992;&#25143;(User)</code> &#26377;&#35746;&#38405;&#26102;&#20107;&#36164;&#35759;&#21644;&#20854;&#20182;&#30340;&#19968;&#20123;&#29233;&#22909;&#12290;&#19979;&#38754;&#26159;&#19968;&#20010;&#20851;&#20110; <code class="literal">Preferences</code> &#31867;&#30340;&#20363;&#23376;&#65306;</p>
<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> Preferences {

    <span class="hl-keyword">private</span> <span class="hl-keyword">boolean</span> receiveNewsletter;
    <span class="hl-keyword">private</span> String[] interests;
    <span class="hl-keyword">private</span> String favouriteWord;

    <span class="hl-keyword">public</span> <span class="hl-keyword">boolean</span> isReceiveNewsletter() {
        <span class="hl-keyword">return</span> receiveNewsletter;
    }

    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> setReceiveNewsletter(<span class="hl-keyword">boolean</span> receiveNewsletter) {
        <span class="hl-keyword">this</span>.receiveNewsletter = receiveNewsletter;
    }

    <span class="hl-keyword">public</span> String[] getInterests() {
        <span class="hl-keyword">return</span> interests;
    }

    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> setInterests(String[] interests) {
        <span class="hl-keyword">this</span>.interests = interests;
    }

    <span class="hl-keyword">public</span> String getFavouriteWord() {
        <span class="hl-keyword">return</span> favouriteWord;
    }

    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> setFavouriteWord(String favouriteWord) {
        <span class="hl-keyword">this</span>.favouriteWord = favouriteWord;
    }
}</pre>

<p><code class="literal">form.jsp</code> &#20687;&#19979;&#38754;&#36825;&#26679;:</p>
<pre class="programlisting"><span class="hl-tag">&lt;form:form&gt;</span>
    <span class="hl-tag">&lt;table&gt;</span>
        <span class="hl-tag">&lt;tr&gt;</span>
            <span class="hl-tag">&lt;td&gt;</span>&#26159;&#21542;&#35746;&#38405;&#26102;&#20107;&#36164;&#35759;&#65311;:<span class="hl-tag">&lt;/td&gt;</span>
            <span class="hl-tag">&lt;%--</span> <span class="hl-attribute">&#26041;&#24335;</span> <span class="hl-attribute">1:</span> <span class="hl-attribute">&#23646;&#24615;&#26159;</span> <span class="hl-attribute">java.lang.Boolean</span> <span class="hl-attribute">&#31867;&#22411;&#30340;</span> <span class="hl-attribute">--%&gt;</span>
            <span class="hl-attribute">&lt;td&gt;&lt;form:checkbox</span> <span class="hl-attribute">path</span>=<span class="hl-value">"preferences.receiveNewsletter"</span><span class="hl-tag">/&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
        <span class="hl-tag">&lt;/tr&gt;</span>

        <span class="hl-tag">&lt;tr&gt;</span>
            <span class="hl-tag">&lt;td&gt;</span>&#20852;&#36259;:<span class="hl-tag">&lt;/td&gt;</span>
            <span class="hl-tag">&lt;%--</span> <span class="hl-attribute">&#26041;&#24335;</span> <span class="hl-attribute">2:</span> <span class="hl-attribute">&#23646;&#24615;&#26159;&#25968;&#32452;&#25110;&#32773;</span> <span class="hl-attribute">java.util.Collection</span> <span class="hl-attribute">&#31867;&#22411;&#30340;</span> <span class="hl-attribute">--%&gt;</span>
            <span class="hl-attribute">&lt;td&gt;</span>
                <span class="hl-attribute">&#39745;&#22320;&#22855;&#29699;&#36187;:</span> <span class="hl-attribute">&lt;form:checkbox</span> <span class="hl-attribute">path</span>=<span class="hl-value">"preferences.interests"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"Quidditch"</span><span class="hl-tag">/&gt;</span>
                &#33609;&#33647;&#23398;: <span class="hl-tag">&lt;form:checkbox</span> <span class="hl-attribute">path</span>=<span class="hl-value">"preferences.interests"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"Herbology"</span><span class="hl-tag">/&gt;</span>
                &#40657;&#39764;&#27861;&#38450;&#24481;&#26415;: <span class="hl-tag">&lt;form:checkbox</span> <span class="hl-attribute">path</span>=<span class="hl-value">"preferences.interests"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"Defence Against the Dark Arts"</span><span class="hl-tag">/&gt;</span>
            <span class="hl-tag">&lt;/td&gt;</span>
        <span class="hl-tag">&lt;/tr&gt;</span>

        <span class="hl-tag">&lt;tr&gt;</span>
            <span class="hl-tag">&lt;td&gt;</span>&#26368;&#21916;&#27426;&#30340;&#21333;&#35789;:<span class="hl-tag">&lt;/td&gt;</span>
            <span class="hl-tag">&lt;%--</span> <span class="hl-attribute">&#26041;&#24335;</span> <span class="hl-attribute">3:</span> <span class="hl-attribute">&#23646;&#24615;&#26159;</span> <span class="hl-attribute">java.lang.Object</span> <span class="hl-attribute">&#31867;&#22411;&#30340;</span> <span class="hl-attribute">--%&gt;</span>
            <span class="hl-attribute">&lt;td&gt;</span>
                <span class="hl-attribute">&#39764;&#27861;:</span> <span class="hl-attribute">&lt;form:checkbox</span> <span class="hl-attribute">path</span>=<span class="hl-value">"preferences.favouriteWord"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"Magic"</span><span class="hl-tag">/&gt;</span>
            <span class="hl-tag">&lt;/td&gt;</span>
        <span class="hl-tag">&lt;/tr&gt;</span>
    <span class="hl-tag">&lt;/table&gt;</span>
<span class="hl-tag">&lt;/form:form&gt;</span></pre>

<p><code class="literal">checkbox</code> &#26631;&#31614;&#26377;&#19977;&#31181;&#26041;&#24335;&#26469;&#28385;&#36275;&#20320;&#23545; checkbox &#30340;&#20960;&#20046;&#25152;&#26377;&#30340;&#38656;&#35201;&#12290;</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
&#31532;&#19968;&#31181;&#26041;&#24335; - &#24403;&#32465;&#23450;&#30340;&#20540;&#30340;&#31867;&#22411;&#26159; <code class="literal">java.lang.Boolean</code>&#65292;&#22914;&#26524;&#20540;&#26159;  <code class="literal">true</code>&#65292;&#37027;&#20040; <code class="literal">input(checkbox)</code>&#20250;&#34987;&#26631;&#35760;&#20026; <span class="emphasis"><em>checked</em></span>&#12290;<code class="literal">value</code> &#23646;&#24615;&#30340;&#20540;&#23545;&#24212; <code class="literal">setValue(Object)</code> &#30340;&#35299;&#26512;&#20540;&#12290;
</li><li class="listitem">
&#31532;&#20108;&#31181;&#26041;&#24335; - &#24403;&#32465;&#23450;&#30340;&#20540;&#30340;&#31867;&#22411;&#26159; <code class="literal">array</code> &#25110;&#32773; <code class="literal">java.util.Collection</code>, &#22914;&#26524;&#32465;&#23450;&#30340; <code class="literal">Collection</code> &#20013;&#23384;&#22312;&#36890;&#36807; <code class="literal">setValue(Object)</code> &#37197;&#32622;&#30340;&#20540;&#65292;&#37027;&#20040; <code class="literal">input(checkbox)</code>&#20250;&#34987;&#26631;&#35760;&#20026; <span class="emphasis"><em>checked</em></span>&#12290;
</li><li class="listitem">
&#31532;&#19977;&#31181;&#26041;&#24335; - &#23545;&#20110;&#20854;&#23427;&#32465;&#23450;&#30340;&#31867;&#22411;&#65292;&#22914;&#26524;&#32465;&#23450;&#30340;&#20540;&#21644;&#36890;&#36807; <code class="literal">setValue(Object)</code> &#37197;&#32622;&#30340;&#20540;&#30456;&#31561;&#65292;&#37027;&#20040; <code class="literal">input(checkbox)</code>&#20250;&#34987;&#26631;&#35760;&#20026; <span class="emphasis"><em>checked</em></span>&#12290;
</li></ul></div>

<p>&#38656;&#35201;&#27880;&#24847;&#30340;&#26159;&#65292;&#19981;&#31649;&#29992;&#21738;&#31181;&#26041;&#24335;&#65292;&#37117;&#20250;&#29983;&#25104;&#21516;&#26679;&#30340; HTML &#32467;&#26500;&#12290;&#19979;&#38754;&#26159;&#19968;&#20010;&#20851;&#20110; checkbox &#30340; HTML &#29255;&#27573;&#65306;</p>
<pre class="programlisting"><span class="hl-tag">&lt;tr&gt;</span>
    <span class="hl-tag">&lt;td&gt;</span>&#20852;&#36259;:<span class="hl-tag">&lt;/td&gt;</span>
    <span class="hl-tag">&lt;td&gt;</span>
        &#39745;&#22320;&#22855;&#29699;&#36187;: <span class="hl-tag">&lt;input</span> <span class="hl-attribute">name</span>=<span class="hl-value">"preferences.interests"</span> <span class="hl-attribute">type</span>=<span class="hl-value">"checkbox"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"Quidditch"</span><span class="hl-tag">/&gt;</span>
        <span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"hidden"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"1"</span> <span class="hl-attribute">name</span>=<span class="hl-value">"_preferences.interests"</span><span class="hl-tag">/&gt;</span>
        &#33609;&#33647;&#23398;: <span class="hl-tag">&lt;input</span> <span class="hl-attribute">name</span>=<span class="hl-value">"preferences.interests"</span> <span class="hl-attribute">type</span>=<span class="hl-value">"checkbox"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"Herbology"</span><span class="hl-tag">/&gt;</span>
        <span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"hidden"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"1"</span> <span class="hl-attribute">name</span>=<span class="hl-value">"_preferences.interests"</span><span class="hl-tag">/&gt;</span>
        &#40657;&#39764;&#27861;&#38450;&#24481;&#26415;: <span class="hl-tag">&lt;input</span> <span class="hl-attribute">name</span>=<span class="hl-value">"preferences.interests"</span> <span class="hl-attribute">type</span>=<span class="hl-value">"checkbox"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"Defence Against the Dark Arts"</span><span class="hl-tag">/&gt;</span>
        <span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"hidden"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"1"</span> <span class="hl-attribute">name</span>=<span class="hl-value">"_preferences.interests"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;/td&gt;</span>
<span class="hl-tag">&lt;/tr&gt;</span></pre>

<p>&#20320;&#21487;&#33021;&#19981;&#24076;&#26395;&#30475;&#21040;&#38468;&#21152;&#22312;&#27599;&#20010; checkbox &#21518;&#38754;&#30340;&#38544;&#34255;&#22495;&#12290;&#20294;&#26159;&#24403; HTML &#39029;&#38754;&#20013;&#30340; checkbox <span class="emphasis"><em>&#19981;(not)</em></span>&#34987;&#36873;&#20013;&#65292;
&#22312;&#25552;&#20132;&#34920;&#21333;&#26102;&#65292;&#23427;&#23601;&#19981;&#20250;&#20570;&#20026; HTTP &#35831;&#27714;&#21442;&#25968;&#30340;&#19968;&#37096;&#20998;&#34987;&#21457;&#36865;&#21040;&#26381;&#21153;&#31471;&#12290;&#25152;&#20197;&#65292;&#20026;&#20102;&#20445;&#35777; Spring &#34920;&#21333;&#25968;&#25454;&#32465;&#23450;&#33021;&#27491;&#24120;&#24037;&#20316;&#65292;
&#25105;&#20204;&#24517;&#39035;&#38656;&#35201;&#19968;&#20010;&#24037;&#20316;&#21306;&#26469;&#35299;&#20915;&#36825;&#20010;&#24618;&#24322;&#30340;&#38382;&#39064;(quirk)&#12290;<code class="literal">checkbox</code> &#26631;&#31614;&#36981;&#24490;&#29616;&#26377;&#30340; Spring &#24815;&#20363;&#65292;
&#27599;&#20010; checkbox &#30456;&#23545;&#24212;&#30340;&#38544;&#34255;&#21442;&#25968;&#37117;&#21152;&#19978;&#19968;&#20010;&#19979;&#21010;&#32447;("_")&#21069;&#32512;&#12290;&#36890;&#36807;&#36825;&#26679;&#20570;&#65292;&#21487;&#20197;&#26377;&#25928;&#30340;&#21578;&#35785; Spring&#65292;
&#8220;<span class="emphasis"><em>&#36825;&#20010; checkbox &#22312;&#34920;&#21333;&#20013;&#26159;&#21487;&#35265;&#30340;&#65292;&#24182;&#19988;&#26080;&#35770;&#23427;&#30340;&#20540;&#26159;&#20160;&#20040;&#25105;&#37117;&#24076;&#26395;&#34987;&#32465;&#23450;&#34920;&#21333;&#25968;&#25454;&#20013;(the checkbox was visible in the form and I want my object to
which the form data will be bound to reflect the state of the checkbox no matter what)</em></span>&#8221;&#12290;</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="view-jsp-formtaglib-checkboxestag" href="#view-jsp-formtaglib-checkboxestag"></a>The checkboxes tag</h4></div></div></div>

<p>This tag renders multiple HTML <span class="emphasis"><em>input</em></span> tags with type <span class="emphasis"><em>checkbox</em></span>.</p>
<p>Building on the example from the previous <code class="literal">checkbox</code> tag section. Sometimes you prefer
not to have to list all the possible hobbies in your JSP page. You would rather provide
a list at runtime of the available options and pass that in to the tag. That is the
purpose of the <code class="literal">checkboxes</code> tag. You pass in an <code class="literal">Array</code>, a <code class="literal">List</code> or a <code class="literal">Map</code> containing
the available options in the "items" property. Typically the bound property is a
collection so it can hold multiple values selected by the user. Below is an example of
the JSP using this tag:</p>
<pre class="programlisting"><span class="hl-tag">&lt;form:form&gt;</span>
    <span class="hl-tag">&lt;table&gt;</span>
        <span class="hl-tag">&lt;tr&gt;</span>
            <span class="hl-tag">&lt;td&gt;</span>Interests:<span class="hl-tag">&lt;/td&gt;</span>
            <span class="hl-tag">&lt;td&gt;</span>
                <span class="hl-tag">&lt;%--</span> <span class="hl-attribute">Property</span> <span class="hl-attribute">is</span> <span class="hl-attribute">of</span> <span class="hl-attribute">an</span> <span class="hl-attribute">array</span> <span class="hl-attribute">or</span> <span class="hl-attribute">of</span> <span class="hl-attribute">type</span> <span class="hl-attribute">java.util.Collection</span> <span class="hl-attribute">--%&gt;</span>
                <span class="hl-attribute">&lt;form:checkboxes</span> <span class="hl-attribute">path</span>=<span class="hl-value">"preferences.interests"</span> <span class="hl-attribute">items</span>=<span class="hl-value">"${interestList}"</span><span class="hl-tag">/&gt;</span>
            <span class="hl-tag">&lt;/td&gt;</span>
        <span class="hl-tag">&lt;/tr&gt;</span>
    <span class="hl-tag">&lt;/table&gt;</span>
<span class="hl-tag">&lt;/form:form&gt;</span></pre>

<p>This example assumes that the "interestList" is a <code class="literal">List</code> available as a model attribute
containing strings of the values to be selected from. In the case where you use a Map,
the map entry key will be used as the value and the map entry&#8217;s value will be used as
the label to be displayed. You can also use a custom object where you can provide the
property names for the value using "itemValue" and the label using "itemLabel".</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="view-jsp-formtaglib-radiobuttontag" href="#view-jsp-formtaglib-radiobuttontag"></a>The radiobutton tag</h4></div></div></div>

<p>This tag renders an HTML <span class="emphasis"><em>input</em></span> tag with type <span class="emphasis"><em>radio</em></span>.</p>
<p>A typical usage pattern will involve multiple tag instances bound to the same property
but with different values.</p>
<pre class="programlisting"><span class="hl-tag">&lt;tr&gt;</span>
    <span class="hl-tag">&lt;td&gt;</span>Sex:<span class="hl-tag">&lt;/td&gt;</span>
    <span class="hl-tag">&lt;td&gt;</span>
        Male: <span class="hl-tag">&lt;form:radiobutton</span> <span class="hl-attribute">path</span>=<span class="hl-value">"sex"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"M"</span><span class="hl-tag">/&gt;</span> <span class="hl-tag">&lt;br/&gt;</span>
        Female: <span class="hl-tag">&lt;form:radiobutton</span> <span class="hl-attribute">path</span>=<span class="hl-value">"sex"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"F"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;/td&gt;</span>
<span class="hl-tag">&lt;/tr&gt;</span></pre>

</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="view-jsp-formtaglib-radiobuttonstag" href="#view-jsp-formtaglib-radiobuttonstag"></a>The radiobuttons tag</h4></div></div></div>

<p>This tag renders multiple HTML <span class="emphasis"><em>input</em></span> tags with type <span class="emphasis"><em>radio</em></span>.</p>
<p>Just like the <code class="literal">checkboxes</code> tag above, you might want to pass in the available options as
a runtime variable. For this usage you would use the <code class="literal">radiobuttons</code> tag. You pass in an
<code class="literal">Array</code>, a <code class="literal">List</code> or a <code class="literal">Map</code> containing the available options in the "items" property.
In the case where you use a Map, the map entry key will be used as the value and the map
entry&#8217;s value will be used as the label to be displayed. You can also use a custom
object where you can provide the property names for the value using "itemValue" and the
label using "itemLabel".</p>
<pre class="programlisting"><span class="hl-tag">&lt;tr&gt;</span>
    <span class="hl-tag">&lt;td&gt;</span>Sex:<span class="hl-tag">&lt;/td&gt;</span>
    <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;form:radiobuttons</span> <span class="hl-attribute">path</span>=<span class="hl-value">"sex"</span> <span class="hl-attribute">items</span>=<span class="hl-value">"${sexOptions}"</span><span class="hl-tag">/&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
<span class="hl-tag">&lt;/tr&gt;</span></pre>

</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="view-jsp-formtaglib-passwordtag" href="#view-jsp-formtaglib-passwordtag"></a>The password tag</h4></div></div></div>

<p>This tag renders an HTML <span class="emphasis"><em>input</em></span> tag with type <span class="emphasis"><em>password</em></span> using the bound value.</p>
<pre class="programlisting"><span class="hl-tag">&lt;tr&gt;</span>
    <span class="hl-tag">&lt;td&gt;</span>Password:<span class="hl-tag">&lt;/td&gt;</span>
    <span class="hl-tag">&lt;td&gt;</span>
        <span class="hl-tag">&lt;form:password</span> <span class="hl-attribute">path</span>=<span class="hl-value">"password"</span><span class="hl-tag"> /&gt;</span>
    <span class="hl-tag">&lt;/td&gt;</span>
<span class="hl-tag">&lt;/tr&gt;</span></pre>

<p>Please note that by default, the password value is <span class="emphasis"><em>not</em></span> shown. If you do want the
password value to be shown, then set the value of the <code class="literal">'showPassword'</code> attribute to
true, like so.</p>
<pre class="programlisting"><span class="hl-tag">&lt;tr&gt;</span>
    <span class="hl-tag">&lt;td&gt;</span>Password:<span class="hl-tag">&lt;/td&gt;</span>
    <span class="hl-tag">&lt;td&gt;</span>
        <span class="hl-tag">&lt;form:password</span> <span class="hl-attribute">path</span>=<span class="hl-value">"password"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"^76525bvHGq"</span> <span class="hl-attribute">showPassword</span>=<span class="hl-value">"true"</span><span class="hl-tag"> /&gt;</span>
    <span class="hl-tag">&lt;/td&gt;</span>
<span class="hl-tag">&lt;/tr&gt;</span></pre>

</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="view-jsp-formtaglib-selecttag" href="#view-jsp-formtaglib-selecttag"></a>The select tag</h4></div></div></div>

<p>This tag renders an HTML <span class="emphasis"><em>select</em></span> element. It supports data binding to the selected
option as well as the use of nested <code class="literal">option</code> and <code class="literal">options</code> tags.</p>
<p>Let&#8217;s assume a <code class="literal">User</code> has a list of skills.</p>
<pre class="programlisting"><span class="hl-tag">&lt;tr&gt;</span>
    <span class="hl-tag">&lt;td&gt;</span>Skills:<span class="hl-tag">&lt;/td&gt;</span>
    <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;form:select</span> <span class="hl-attribute">path</span>=<span class="hl-value">"skills"</span> <span class="hl-attribute">items</span>=<span class="hl-value">"${skills}"</span><span class="hl-tag">/&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
<span class="hl-tag">&lt;/tr&gt;</span></pre>

<p>If the <code class="literal">User's</code> skill were in Herbology, the HTML source of the <span class="emphasis"><em>Skills</em></span> row would look
like:</p>
<pre class="programlisting"><span class="hl-tag">&lt;tr&gt;</span>
    <span class="hl-tag">&lt;td&gt;</span>Skills:<span class="hl-tag">&lt;/td&gt;</span>
    <span class="hl-tag">&lt;td&gt;</span>
        <span class="hl-tag">&lt;select</span> <span class="hl-attribute">name</span>=<span class="hl-value">"skills"</span> <span class="hl-attribute">multiple</span>=<span class="hl-value">"true"</span><span class="hl-tag">&gt;</span>
            <span class="hl-tag">&lt;option</span> <span class="hl-attribute">value</span>=<span class="hl-value">"Potions"</span><span class="hl-tag">&gt;</span>Potions<span class="hl-tag">&lt;/option&gt;</span>
            <span class="hl-tag">&lt;option</span> <span class="hl-attribute">value</span>=<span class="hl-value">"Herbology"</span> <span class="hl-attribute">selected</span>=<span class="hl-value">"selected"</span><span class="hl-tag">&gt;</span>Herbology<span class="hl-tag">&lt;/option&gt;</span>
            <span class="hl-tag">&lt;option</span> <span class="hl-attribute">value</span>=<span class="hl-value">"Quidditch"</span><span class="hl-tag">&gt;</span>Quidditch<span class="hl-tag">&lt;/option&gt;</span>
        <span class="hl-tag">&lt;/select&gt;</span>
    <span class="hl-tag">&lt;/td&gt;</span>
<span class="hl-tag">&lt;/tr&gt;</span></pre>

</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="view-jsp-formtaglib-optiontag" href="#view-jsp-formtaglib-optiontag"></a>The option tag</h4></div></div></div>

<p>This tag renders an HTML <span class="emphasis"><em>option</em></span>. It sets <span class="emphasis"><em>selected</em></span> as appropriate based on the bound
value.</p>
<pre class="programlisting"><span class="hl-tag">&lt;tr&gt;</span>
    <span class="hl-tag">&lt;td&gt;</span>House:<span class="hl-tag">&lt;/td&gt;</span>
    <span class="hl-tag">&lt;td&gt;</span>
        <span class="hl-tag">&lt;form:select</span> <span class="hl-attribute">path</span>=<span class="hl-value">"house"</span><span class="hl-tag">&gt;</span>
            <span class="hl-tag">&lt;form:option</span> <span class="hl-attribute">value</span>=<span class="hl-value">"Gryffindor"</span><span class="hl-tag">/&gt;</span>
            <span class="hl-tag">&lt;form:option</span> <span class="hl-attribute">value</span>=<span class="hl-value">"Hufflepuff"</span><span class="hl-tag">/&gt;</span>
            <span class="hl-tag">&lt;form:option</span> <span class="hl-attribute">value</span>=<span class="hl-value">"Ravenclaw"</span><span class="hl-tag">/&gt;</span>
            <span class="hl-tag">&lt;form:option</span> <span class="hl-attribute">value</span>=<span class="hl-value">"Slytherin"</span><span class="hl-tag">/&gt;</span>
        <span class="hl-tag">&lt;/form:select&gt;</span>
    <span class="hl-tag">&lt;/td&gt;</span>
<span class="hl-tag">&lt;/tr&gt;</span></pre>

<p>If the <code class="literal">User's</code> house was in Gryffindor, the HTML source of the <span class="emphasis"><em>House</em></span> row would look
like:</p>
<pre class="programlisting"><span class="hl-tag">&lt;tr&gt;</span>
    <span class="hl-tag">&lt;td&gt;</span>House:<span class="hl-tag">&lt;/td&gt;</span>
    <span class="hl-tag">&lt;td&gt;</span>
        <span class="hl-tag">&lt;select</span> <span class="hl-attribute">name</span>=<span class="hl-value">"house"</span><span class="hl-tag">&gt;</span>
            <span class="hl-tag">&lt;option</span> <span class="hl-attribute">value</span>=<span class="hl-value">"Gryffindor"</span> <span class="hl-attribute">selected</span>=<span class="hl-value">"selected"</span><span class="hl-tag">&gt;</span>Gryffindor<span class="hl-tag">&lt;/option&gt;</span>
            <span class="hl-tag">&lt;option</span> <span class="hl-attribute">value</span>=<span class="hl-value">"Hufflepuff"</span><span class="hl-tag">&gt;</span>Hufflepuff<span class="hl-tag">&lt;/option&gt;</span>
            <span class="hl-tag">&lt;option</span> <span class="hl-attribute">value</span>=<span class="hl-value">"Ravenclaw"</span><span class="hl-tag">&gt;</span>Ravenclaw<span class="hl-tag">&lt;/option&gt;</span>
            <span class="hl-tag">&lt;option</span> <span class="hl-attribute">value</span>=<span class="hl-value">"Slytherin"</span><span class="hl-tag">&gt;</span>Slytherin<span class="hl-tag">&lt;/option&gt;</span>
        <span class="hl-tag">&lt;/select&gt;</span>
    <span class="hl-tag">&lt;/td&gt;</span>
<span class="hl-tag">&lt;/tr&gt;</span></pre>

</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="view-jsp-formtaglib-optionstag" href="#view-jsp-formtaglib-optionstag"></a>The options tag</h4></div></div></div>

<p>This tag renders a list of HTML <span class="emphasis"><em>option</em></span> tags. It sets the <span class="emphasis"><em>selected</em></span> attribute as
appropriate based on the bound value.</p>
<pre class="programlisting"><span class="hl-tag">&lt;tr&gt;</span>
    <span class="hl-tag">&lt;td&gt;</span>Country:<span class="hl-tag">&lt;/td&gt;</span>
    <span class="hl-tag">&lt;td&gt;</span>
        <span class="hl-tag">&lt;form:select</span> <span class="hl-attribute">path</span>=<span class="hl-value">"country"</span><span class="hl-tag">&gt;</span>
            <span class="hl-tag">&lt;form:option</span> <span class="hl-attribute">value</span>=<span class="hl-value">"-"</span> <span class="hl-attribute">label</span>=<span class="hl-value">"--Please Select"</span><span class="hl-tag">/&gt;</span>
            <span class="hl-tag">&lt;form:options</span> <span class="hl-attribute">items</span>=<span class="hl-value">"${countryList}"</span> <span class="hl-attribute">itemValue</span>=<span class="hl-value">"code"</span> <span class="hl-attribute">itemLabel</span>=<span class="hl-value">"name"</span><span class="hl-tag">/&gt;</span>
        <span class="hl-tag">&lt;/form:select&gt;</span>
    <span class="hl-tag">&lt;/td&gt;</span>
<span class="hl-tag">&lt;/tr&gt;</span></pre>

<p>If the <code class="literal">User</code> lived in the UK, the HTML source of the <span class="emphasis"><em>Country</em></span> row would look like:</p>
<pre class="programlisting"><span class="hl-tag">&lt;tr&gt;</span>
    <span class="hl-tag">&lt;td&gt;</span>Country:<span class="hl-tag">&lt;/td&gt;</span>
    <span class="hl-tag">&lt;td&gt;</span>
        <span class="hl-tag">&lt;select</span> <span class="hl-attribute">name</span>=<span class="hl-value">"country"</span><span class="hl-tag">&gt;</span>
            <span class="hl-tag">&lt;option</span> <span class="hl-attribute">value</span>=<span class="hl-value">"-"</span><span class="hl-tag">&gt;</span>--Please Select<span class="hl-tag">&lt;/option&gt;</span>
            <span class="hl-tag">&lt;option</span> <span class="hl-attribute">value</span>=<span class="hl-value">"AT"</span><span class="hl-tag">&gt;</span>Austria<span class="hl-tag">&lt;/option&gt;</span>
            <span class="hl-tag">&lt;option</span> <span class="hl-attribute">value</span>=<span class="hl-value">"UK"</span> <span class="hl-attribute">selected</span>=<span class="hl-value">"selected"</span><span class="hl-tag">&gt;</span>United Kingdom<span class="hl-tag">&lt;/option&gt;</span>
            <span class="hl-tag">&lt;option</span> <span class="hl-attribute">value</span>=<span class="hl-value">"US"</span><span class="hl-tag">&gt;</span>United States<span class="hl-tag">&lt;/option&gt;</span>
        <span class="hl-tag">&lt;/select&gt;</span>
    <span class="hl-tag">&lt;/td&gt;</span>
<span class="hl-tag">&lt;/tr&gt;</span></pre>

<p>As the example shows, the combined usage of an <code class="literal">option</code> tag with the <code class="literal">options</code> tag
generates the same standard HTML, but allows you to explicitly specify a value in the
JSP that is for display only (where it belongs) such as the default string in the
example: "-- Please Select".</p>
<p>The <code class="literal">items</code> attribute is typically populated with a collection or array of item objects.
<code class="literal">itemValue</code> and <code class="literal">itemLabel</code> simply refer to bean properties of those item objects, if
specified; otherwise, the item objects themselves will be stringified. Alternatively,
you may specify a <code class="literal">Map</code> of items, in which case the map keys are interpreted as option
values and the map values correspond to option labels. If <code class="literal">itemValue</code> and/or <code class="literal">itemLabel</code>
happen to be specified as well, the item value property will apply to the map key and
the item label property will apply to the map value.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="view-jsp-formtaglib-textAreatag" href="#view-jsp-formtaglib-textAreatag"></a>The textarea tag</h4></div></div></div>

<p>This tag renders an HTML <span class="emphasis"><em>textarea</em></span>.</p>
<pre class="programlisting"><span class="hl-tag">&lt;tr&gt;</span>
    <span class="hl-tag">&lt;td&gt;</span>Notes:<span class="hl-tag">&lt;/td&gt;</span>
    <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;form:textarea</span> <span class="hl-attribute">path</span>=<span class="hl-value">"notes"</span> <span class="hl-attribute">rows</span>=<span class="hl-value">"3"</span> <span class="hl-attribute">cols</span>=<span class="hl-value">"20"</span><span class="hl-tag"> /&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
    <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;form:errors</span> <span class="hl-attribute">path</span>=<span class="hl-value">"notes"</span><span class="hl-tag"> /&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
<span class="hl-tag">&lt;/tr&gt;</span></pre>

</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="view-jsp-formtaglib-hiddeninputtag" href="#view-jsp-formtaglib-hiddeninputtag"></a>The hidden tag</h4></div></div></div>

<p>This tag renders an HTML <span class="emphasis"><em>input</em></span> tag with type <span class="emphasis"><em>hidden</em></span> using the bound value. To submit
an unbound hidden value, use the HTML <code class="literal">input</code> tag with type <span class="emphasis"><em>hidden</em></span>.</p>
<pre class="programlisting"><span class="hl-tag">&lt;form:hidden</span> <span class="hl-attribute">path</span>=<span class="hl-value">"house"</span><span class="hl-tag"> /&gt;</span>

</pre>

<p>If we choose to submit the <span class="emphasis"><em>house</em></span> value as a hidden one, the HTML would look like:</p>
<pre class="programlisting"><span class="hl-tag">&lt;input</span> <span class="hl-attribute">name</span>=<span class="hl-value">"house"</span> <span class="hl-attribute">type</span>=<span class="hl-value">"hidden"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"Gryffindor"</span><span class="hl-tag">/&gt;</span>

</pre>

</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="view-jsp-formtaglib-errorstag" href="#view-jsp-formtaglib-errorstag"></a>The errors tag</h4></div></div></div>

<p>This tag renders field errors in an HTML <span class="emphasis"><em>span</em></span> tag. It provides access to the errors
created in your controller or those that were created by any validators associated with
your controller.</p>
<p>Let&#8217;s assume we want to display all error messages for the <code class="literal">firstName</code> and <code class="literal">lastName</code>
fields once we submit the form. We have a validator for instances of the <code class="literal">User</code> class
called <code class="literal">UserValidator</code>.</p>
<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> UserValidator <span class="hl-keyword">implements</span> Validator {

    <span class="hl-keyword">public</span> <span class="hl-keyword">boolean</span> supports(Class candidate) {
        <span class="hl-keyword">return</span> User.<span class="hl-keyword">class</span>.isAssignableFrom(candidate);
    }

    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> validate(Object obj, Errors errors) {
        ValidationUtils.rejectIfEmptyOrWhitespace(errors, <span class="hl-string">"firstName"</span>, <span class="hl-string">"required"</span>, <span class="hl-string">"Field is required."</span>);
        ValidationUtils.rejectIfEmptyOrWhitespace(errors, <span class="hl-string">"lastName"</span>, <span class="hl-string">"required"</span>, <span class="hl-string">"Field is required."</span>);
    }
}</pre>

<p>The <code class="literal">form.jsp</code> would look like:</p>
<pre class="programlisting"><span class="hl-tag">&lt;form:form&gt;</span>
    <span class="hl-tag">&lt;table&gt;</span>
        <span class="hl-tag">&lt;tr&gt;</span>
            <span class="hl-tag">&lt;td&gt;</span>First Name:<span class="hl-tag">&lt;/td&gt;</span>
            <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;form:input</span> <span class="hl-attribute">path</span>=<span class="hl-value">"firstName"</span><span class="hl-tag"> /&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
            <span class="hl-tag">&lt;%--</span> <span class="hl-attribute">Show</span> <span class="hl-attribute">errors</span> <span class="hl-attribute">for</span> <span class="hl-attribute">firstName</span> <span class="hl-attribute">field</span> <span class="hl-attribute">--%&gt;</span>
            <span class="hl-attribute">&lt;td&gt;&lt;form:errors</span> <span class="hl-attribute">path</span>=<span class="hl-value">"firstName"</span><span class="hl-tag"> /&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
        <span class="hl-tag">&lt;/tr&gt;</span>

        <span class="hl-tag">&lt;tr&gt;</span>
            <span class="hl-tag">&lt;td&gt;</span>Last Name:<span class="hl-tag">&lt;/td&gt;</span>
            <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;form:input</span> <span class="hl-attribute">path</span>=<span class="hl-value">"lastName"</span><span class="hl-tag"> /&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
            <span class="hl-tag">&lt;%--</span> <span class="hl-attribute">Show</span> <span class="hl-attribute">errors</span> <span class="hl-attribute">for</span> <span class="hl-attribute">lastName</span> <span class="hl-attribute">field</span> <span class="hl-attribute">--%&gt;</span>
            <span class="hl-attribute">&lt;td&gt;&lt;form:errors</span> <span class="hl-attribute">path</span>=<span class="hl-value">"lastName"</span><span class="hl-tag"> /&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
        <span class="hl-tag">&lt;/tr&gt;</span>
        <span class="hl-tag">&lt;tr&gt;</span>
            <span class="hl-tag">&lt;td</span> <span class="hl-attribute">colspan</span>=<span class="hl-value">"3"</span><span class="hl-tag">&gt;</span>
                <span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"submit"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"Save Changes"</span><span class="hl-tag"> /&gt;</span>
            <span class="hl-tag">&lt;/td&gt;</span>
        <span class="hl-tag">&lt;/tr&gt;</span>
    <span class="hl-tag">&lt;/table&gt;</span>
<span class="hl-tag">&lt;/form:form&gt;</span></pre>

<p>If we submit a form with empty values in the <code class="literal">firstName</code> and <code class="literal">lastName</code> fields, this is
what the HTML would look like:</p>
<pre class="programlisting"><span class="hl-tag">&lt;form</span> <span class="hl-attribute">method</span>=<span class="hl-value">"POST"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;table&gt;</span>
        <span class="hl-tag">&lt;tr&gt;</span>
            <span class="hl-tag">&lt;td&gt;</span>First Name:<span class="hl-tag">&lt;/td&gt;</span>
            <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;input</span> <span class="hl-attribute">name</span>=<span class="hl-value">"firstName"</span> <span class="hl-attribute">type</span>=<span class="hl-value">"text"</span> <span class="hl-attribute">value</span>=<span class="hl-value">""</span><span class="hl-tag">/&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
            <span class="hl-tag">&lt;%--</span> <span class="hl-attribute">Associated</span> <span class="hl-attribute">errors</span> <span class="hl-attribute">to</span> <span class="hl-attribute">firstName</span> <span class="hl-attribute">field</span> <span class="hl-attribute">displayed</span> <span class="hl-attribute">--%&gt;</span>
            <span class="hl-attribute">&lt;td&gt;&lt;span</span> <span class="hl-attribute">name</span>=<span class="hl-value">"firstName.errors"</span><span class="hl-tag">&gt;</span>Field is required.<span class="hl-tag">&lt;/span&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
        <span class="hl-tag">&lt;/tr&gt;</span>

        <span class="hl-tag">&lt;tr&gt;</span>
            <span class="hl-tag">&lt;td&gt;</span>Last Name:<span class="hl-tag">&lt;/td&gt;</span>
            <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;input</span> <span class="hl-attribute">name</span>=<span class="hl-value">"lastName"</span> <span class="hl-attribute">type</span>=<span class="hl-value">"text"</span> <span class="hl-attribute">value</span>=<span class="hl-value">""</span><span class="hl-tag">/&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
            <span class="hl-tag">&lt;%--</span> <span class="hl-attribute">Associated</span> <span class="hl-attribute">errors</span> <span class="hl-attribute">to</span> <span class="hl-attribute">lastName</span> <span class="hl-attribute">field</span> <span class="hl-attribute">displayed</span> <span class="hl-attribute">--%&gt;</span>
            <span class="hl-attribute">&lt;td&gt;&lt;span</span> <span class="hl-attribute">name</span>=<span class="hl-value">"lastName.errors"</span><span class="hl-tag">&gt;</span>Field is required.<span class="hl-tag">&lt;/span&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
        <span class="hl-tag">&lt;/tr&gt;</span>
        <span class="hl-tag">&lt;tr&gt;</span>
            <span class="hl-tag">&lt;td</span> <span class="hl-attribute">colspan</span>=<span class="hl-value">"3"</span><span class="hl-tag">&gt;</span>
                <span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"submit"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"Save Changes"</span><span class="hl-tag"> /&gt;</span>
            <span class="hl-tag">&lt;/td&gt;</span>
        <span class="hl-tag">&lt;/tr&gt;</span>
    <span class="hl-tag">&lt;/table&gt;</span>
<span class="hl-tag">&lt;/form&gt;</span></pre>

<p>What if we want to display the entire list of errors for a given page? The example below
shows that the <code class="literal">errors</code> tag also supports some basic wildcarding functionality.</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<code class="literal">path="*"</code> - displays all errors
</li><li class="listitem">
<code class="literal">path="lastName"</code> - displays all errors associated with the <code class="literal">lastName</code> field
</li><li class="listitem">
if <code class="literal">path</code> is omitted - object errors only are displayed
</li></ul></div>

<p>The example below will display a list of errors at the top of the page, followed by
field-specific errors next to the fields:</p>
<pre class="programlisting"><span class="hl-tag">&lt;form:form&gt;</span>
    <span class="hl-tag">&lt;form:errors</span> <span class="hl-attribute">path</span>=<span class="hl-value">"*"</span> <span class="hl-attribute">cssClass</span>=<span class="hl-value">"errorBox"</span><span class="hl-tag"> /&gt;</span>
    <span class="hl-tag">&lt;table&gt;</span>
        <span class="hl-tag">&lt;tr&gt;</span>
            <span class="hl-tag">&lt;td&gt;</span>First Name:<span class="hl-tag">&lt;/td&gt;</span>
            <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;form:input</span> <span class="hl-attribute">path</span>=<span class="hl-value">"firstName"</span><span class="hl-tag"> /&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
            <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;form:errors</span> <span class="hl-attribute">path</span>=<span class="hl-value">"firstName"</span><span class="hl-tag"> /&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
        <span class="hl-tag">&lt;/tr&gt;</span>
        <span class="hl-tag">&lt;tr&gt;</span>
            <span class="hl-tag">&lt;td&gt;</span>Last Name:<span class="hl-tag">&lt;/td&gt;</span>
            <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;form:input</span> <span class="hl-attribute">path</span>=<span class="hl-value">"lastName"</span><span class="hl-tag"> /&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
            <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;form:errors</span> <span class="hl-attribute">path</span>=<span class="hl-value">"lastName"</span><span class="hl-tag"> /&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
        <span class="hl-tag">&lt;/tr&gt;</span>
        <span class="hl-tag">&lt;tr&gt;</span>
            <span class="hl-tag">&lt;td</span> <span class="hl-attribute">colspan</span>=<span class="hl-value">"3"</span><span class="hl-tag">&gt;</span>
                <span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"submit"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"Save Changes"</span><span class="hl-tag"> /&gt;</span>
            <span class="hl-tag">&lt;/td&gt;</span>
        <span class="hl-tag">&lt;/tr&gt;</span>
    <span class="hl-tag">&lt;/table&gt;</span>
<span class="hl-tag">&lt;/form:form&gt;</span></pre>

<p>The HTML would look like:</p>
<pre class="programlisting"><span class="hl-tag">&lt;form</span> <span class="hl-attribute">method</span>=<span class="hl-value">"POST"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;span</span> <span class="hl-attribute">name</span>=<span class="hl-value">"*.errors"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"errorBox"</span><span class="hl-tag">&gt;</span>Field is required.<span class="hl-tag">&lt;br/&gt;</span>Field is required.<span class="hl-tag">&lt;/span&gt;</span>
    <span class="hl-tag">&lt;table&gt;</span>
        <span class="hl-tag">&lt;tr&gt;</span>
            <span class="hl-tag">&lt;td&gt;</span>First Name:<span class="hl-tag">&lt;/td&gt;</span>
            <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;input</span> <span class="hl-attribute">name</span>=<span class="hl-value">"firstName"</span> <span class="hl-attribute">type</span>=<span class="hl-value">"text"</span> <span class="hl-attribute">value</span>=<span class="hl-value">""</span><span class="hl-tag">/&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
            <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;span</span> <span class="hl-attribute">name</span>=<span class="hl-value">"firstName.errors"</span><span class="hl-tag">&gt;</span>Field is required.<span class="hl-tag">&lt;/span&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
        <span class="hl-tag">&lt;/tr&gt;</span>

        <span class="hl-tag">&lt;tr&gt;</span>
            <span class="hl-tag">&lt;td&gt;</span>Last Name:<span class="hl-tag">&lt;/td&gt;</span>
            <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;input</span> <span class="hl-attribute">name</span>=<span class="hl-value">"lastName"</span> <span class="hl-attribute">type</span>=<span class="hl-value">"text"</span> <span class="hl-attribute">value</span>=<span class="hl-value">""</span><span class="hl-tag">/&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
            <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;span</span> <span class="hl-attribute">name</span>=<span class="hl-value">"lastName.errors"</span><span class="hl-tag">&gt;</span>Field is required.<span class="hl-tag">&lt;/span&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
        <span class="hl-tag">&lt;/tr&gt;</span>
        <span class="hl-tag">&lt;tr&gt;</span>
            <span class="hl-tag">&lt;td</span> <span class="hl-attribute">colspan</span>=<span class="hl-value">"3"</span><span class="hl-tag">&gt;</span>
                <span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"submit"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"Save Changes"</span><span class="hl-tag"> /&gt;</span>
            <span class="hl-tag">&lt;/td&gt;</span>
        <span class="hl-tag">&lt;/tr&gt;</span>
<span class="hl-tag">&lt;/form&gt;</span></pre>

</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="rest-method-conversion" href="#rest-method-conversion"></a>HTTP Method Conversion</h4></div></div></div>

<p>A key principle of REST is the use of the Uniform Interface. This means that all
resources (URLs) can be manipulated using the same four HTTP methods: GET, PUT, POST,
and DELETE. For each method, the HTTP specification defines the exact semantics. For
instance, a GET should always be a safe operation, meaning that is has no side effects,
and a PUT or DELETE should be idempotent, meaning that you can repeat these operations
over and over again, but the end result should be the same. While HTTP defines these
four methods, HTML only supports two: GET and POST. Fortunately, there are two possible
workarounds: you can either use JavaScript to do your PUT or DELETE, or simply do a POST
with the <span class="emphasis"><em>real</em></span> method as an additional parameter (modeled as a hidden input field in an
HTML form). This latter trick is what Spring&#8217;s <code class="literal">HiddenHttpMethodFilter</code> does. This
filter is a plain Servlet Filter and therefore it can be used in combination with any
web framework (not just Spring MVC). Simply add this filter to your web.xml, and a POST
with a hidden _method parameter will be converted into the corresponding HTTP method
request.</p>
<p>To support HTTP method conversion the Spring MVC form tag was updated to support setting
the HTTP method. For example, the following snippet taken from the updated Petclinic
sample</p>
<pre class="programlisting"><span class="hl-tag">&lt;form:form</span> <span class="hl-attribute">method</span>=<span class="hl-value">"delete"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;p</span> <span class="hl-attribute">class</span>=<span class="hl-value">"submit"</span><span class="hl-tag">&gt;</span><span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"submit"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"Delete Pet"</span><span class="hl-tag">/&gt;</span><span class="hl-tag">&lt;/p&gt;</span>
<span class="hl-tag">&lt;/form:form&gt;</span></pre>

<p>This will actually perform an HTTP POST, with the <span class="emphasis"><em>real</em></span> DELETE method hidden behind a
request parameter, to be picked up by the <code class="literal">HiddenHttpMethodFilter</code>, as defined in
web.xml:</p>
<pre class="programlisting">&lt;filter&gt;
    &lt;filter-name&gt;httpMethodFilter&lt;/filter-name&gt;
    &lt;filter-<span class="hl-keyword">class</span>&gt;org.springframework.web.filter.HiddenHttpMethodFilter&lt;/filter-<span class="hl-keyword">class</span>&gt;
&lt;/filter&gt;

&lt;filter-mapping&gt;
    &lt;filter-name&gt;httpMethodFilter&lt;/filter-name&gt;
    &lt;servlet-name&gt;petclinic&lt;/servlet-name&gt;
&lt;/filter-mapping&gt;</pre>

<p>The corresponding <code class="literal">@Controller</code> method is shown below:</p>
<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@RequestMapping(method = RequestMethod.DELETE)</span></em>
<span class="hl-keyword">public</span> String deletePet(<em><span class="hl-annotation" style="color: gray">@PathVariable</span></em> <span class="hl-keyword">int</span> ownerId, <em><span class="hl-annotation" style="color: gray">@PathVariable</span></em> <span class="hl-keyword">int</span> petId) {
    <span class="hl-keyword">this</span>.clinic.deletePet(petId);
    <span class="hl-keyword">return</span> <span class="hl-string">"redirect:/owners/"</span> + ownerId;
}</pre>

</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="view-jsp-formtaglib-html5" href="#view-jsp-formtaglib-html5"></a>HTML5 Tags</h4></div></div></div>

<p>Starting with Spring 3, the Spring form tag library allows entering dynamic attributes,
which means you can enter any HTML5 specific attributes.</p>
<p>In Spring 3.1, the form input tag supports entering a type attribute other than <span class="emphasis"><em>text</em></span>.
This is intended to allow rendering new HTML5 specific input types such as <span class="emphasis"><em>email</em></span>,
<span class="emphasis"><em>date</em></span>, <span class="emphasis"><em>range</em></span>, and others. Note that entering type=<span class="emphasis"><em>text</em></span> is not required since <span class="emphasis"><em>text</em></span>
is the default type.</p>
</div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="view-tiles" href="#view-tiles"></a>17.3&nbsp;Tiles</h2></div></div></div>

<p>It is possible to integrate Tiles - just as any other view technology - in web
applications using Spring. The following describes in a broad way how to do this.</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p>This section focuses on Spring&#8217;s support for Tiles v3 in the
<code class="literal">org.springframework.web.servlet.view.tiles3</code> package.</p>
</td></tr></table></div>

<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="view-tiles-dependencies" href="#view-tiles-dependencies"></a>17.3.1&nbsp;Dependencies</h3></div></div></div>

<p>To be able to use Tiles, you have to add a dependency on Tiles version 3.0.1 or higher
and <a class="ulink" href="http://tiles.apache.org/framework/dependency-management.html" target="_top">its transitive dependencies</a>
to your project.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="view-tiles-integrate" href="#view-tiles-integrate"></a>17.3.2&nbsp;How to integrate Tiles</h3></div></div></div>

<p>To be able to use Tiles, you have to configure it using files containing definitions
(for basic information on definitions and other Tiles concepts, please have a look at
<a class="ulink" href="http://tiles.apache.org" target="_top">http://tiles.apache.org</a>). In Spring this is done using the <code class="literal">TilesConfigurer</code>. Have a
look at the following piece of example ApplicationContext configuration:</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"tilesConfigurer"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"org.springframework.web.servlet.view.tiles3.TilesConfigurer"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"definitions"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;list&gt;</span>
            <span class="hl-tag">&lt;value&gt;</span>/WEB-INF/defs/general.xml<span class="hl-tag">&lt;/value&gt;</span>
            <span class="hl-tag">&lt;value&gt;</span>/WEB-INF/defs/widgets.xml<span class="hl-tag">&lt;/value&gt;</span>
            <span class="hl-tag">&lt;value&gt;</span>/WEB-INF/defs/administrator.xml<span class="hl-tag">&lt;/value&gt;</span>
            <span class="hl-tag">&lt;value&gt;</span>/WEB-INF/defs/customer.xml<span class="hl-tag">&lt;/value&gt;</span>
            <span class="hl-tag">&lt;value&gt;</span>/WEB-INF/defs/templates.xml<span class="hl-tag">&lt;/value&gt;</span>
        <span class="hl-tag">&lt;/list&gt;</span>
    <span class="hl-tag">&lt;/property&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span></pre>

<p>As you can see, there are five files containing definitions, which are all located in
the <code class="literal">'WEB-INF/defs'</code> directory. At initialization of the <code class="literal">WebApplicationContext</code>, the
files will be loaded and the definitions factory will be initialized. After that has
been done, the Tiles includes in the definition files can be used as views within your
Spring web application. To be able to use the views you have to have a <code class="literal">ViewResolver</code>
just as with any other view technology used with Spring. Below you can find two
possibilities, the <code class="literal">UrlBasedViewResolver</code> and the <code class="literal">ResourceBundleViewResolver</code>.</p>
<p>You can specify locale specific Tiles definitions by adding an underscore and then
the locale. For example:</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"tilesConfigurer"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"org.springframework.web.servlet.view.tiles3.TilesConfigurer"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"definitions"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;list&gt;</span>
            <span class="hl-tag">&lt;value&gt;</span>/WEB-INF/defs/tiles.xml<span class="hl-tag">&lt;/value&gt;</span>
            <span class="hl-tag">&lt;value&gt;</span>/WEB-INF/defs/tiles_fr_FR.xml<span class="hl-tag">&lt;/value&gt;</span>
        <span class="hl-tag">&lt;/list&gt;</span>
    <span class="hl-tag">&lt;/property&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span></pre>

<p>With this configuration, <code class="literal">tiles_fr_FR.xml</code> will be used for requests with the <code class="literal">fr_FR</code> locale,
and <code class="literal">tiles.xml</code> will be used by default.</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p>Since underscores are used to indicate locales, it is recommended to avoid using
them otherwise in the file names for Tiles definitions.</p>
</td></tr></table></div>

<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="view-tiles-url" href="#view-tiles-url"></a>UrlBasedViewResolver</h4></div></div></div>

<p>The <code class="literal">UrlBasedViewResolver</code> instantiates the given <code class="literal">viewClass</code> for each view it has to
resolve.</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"viewResolver"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"org.springframework.web.servlet.view.UrlBasedViewResolver"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"viewClass"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"org.springframework.web.servlet.view.tiles3.TilesView"</span><span class="hl-tag">/&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span></pre>

</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="view-tiles-resource" href="#view-tiles-resource"></a>ResourceBundleViewResolver</h4></div></div></div>

<p>The <code class="literal">ResourceBundleViewResolver</code> has to be provided with a property file containing
viewnames and viewclasses the resolver can use:</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"viewResolver"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"org.springframework.web.servlet.view.ResourceBundleViewResolver"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"basename"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"views"</span><span class="hl-tag">/&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span></pre>

<pre class="programlisting">...
welcomeView.(<span class="hl-keyword">class</span>)=org.springframework.web.servlet.view.tiles3.TilesView
welcomeView.url=welcome (<span class="hl-keyword">this</span> is the name of a Tiles definition)

vetsView.(<span class="hl-keyword">class</span>)=org.springframework.web.servlet.view.tiles3.TilesView
vetsView.url=vetsView (again, <span class="hl-keyword">this</span> is the name of a Tiles definition)

findOwnersForm.(<span class="hl-keyword">class</span>)=org.springframework.web.servlet.view.JstlView
findOwnersForm.url=/WEB-INF/jsp/findOwners.jsp
...</pre>

<p>As you can see, when using the <code class="literal">ResourceBundleViewResolver</code>, you can easily mix
different view technologies.</p>
<p>Note that the <code class="literal">TilesView</code> class supports JSTL (the JSP Standard Tag Library) out of the
box.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="view-tiles-preparer" href="#view-tiles-preparer"></a>SimpleSpringPreparerFactory and SpringBeanPreparerFactory</h4></div></div></div>

<p>As an advanced feature, Spring also supports two special Tiles <code class="literal">PreparerFactory</code>
implementations. Check out the Tiles documentation for details on how to use
<code class="literal">ViewPreparer</code> references in your Tiles definition files.</p>
<p>Specify <code class="literal">SimpleSpringPreparerFactory</code> to autowire ViewPreparer instances based on
specified preparer classes, applying Spring&#8217;s container callbacks as well as applying
configured Spring BeanPostProcessors. If Spring&#8217;s context-wide annotation-config has
been activated, annotations in ViewPreparer classes will be automatically detected and
applied. Note that this expects preparer <span class="emphasis"><em>classes</em></span> in the Tiles definition files, just
like the default <code class="literal">PreparerFactory</code> does.</p>
<p>Specify <code class="literal">SpringBeanPreparerFactory</code> to operate on specified preparer <span class="emphasis"><em>names</em></span> instead
of classes, obtaining the corresponding Spring bean from the DispatcherServlet&#8217;s
application context. The full bean creation process will be in the control of the Spring
application context in this case, allowing for the use of explicit dependency injection
configuration, scoped beans etc. Note that you need to define one Spring bean definition
per preparer name (as used in your Tiles definitions).</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"tilesConfigurer"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"org.springframework.web.servlet.view.tiles3.TilesConfigurer"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"definitions"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;list&gt;</span>
            <span class="hl-tag">&lt;value&gt;</span>/WEB-INF/defs/general.xml<span class="hl-tag">&lt;/value&gt;</span>
            <span class="hl-tag">&lt;value&gt;</span>/WEB-INF/defs/widgets.xml<span class="hl-tag">&lt;/value&gt;</span>
            <span class="hl-tag">&lt;value&gt;</span>/WEB-INF/defs/administrator.xml<span class="hl-tag">&lt;/value&gt;</span>
            <span class="hl-tag">&lt;value&gt;</span>/WEB-INF/defs/customer.xml<span class="hl-tag">&lt;/value&gt;</span>
            <span class="hl-tag">&lt;value&gt;</span>/WEB-INF/defs/templates.xml<span class="hl-tag">&lt;/value&gt;</span>
        <span class="hl-tag">&lt;/list&gt;</span>
    <span class="hl-tag">&lt;/property&gt;</span>

    <span class="hl-comment">&lt;!-- resolving preparer names as Spring bean definition names --&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"preparerFactoryClass"</span>
            <span class="hl-attribute">value</span>=<span class="hl-value">"org.springframework.web.servlet.view.tiles3.SpringBeanPreparerFactory"</span><span class="hl-tag">/&gt;</span>

<span class="hl-tag">&lt;/bean&gt;</span></pre>

</div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="view-velocity" href="#view-velocity"></a>17.4&nbsp;Velocity &amp; FreeMarker</h2></div></div></div>

<p><a class="ulink" href="http://velocity.apache.org" target="_top">Velocity</a> &#21644; <a class="ulink" href="http://www.freemarker.org" target="_top">FreeMarker</a> &#26159;&#20004;&#31181;&#21487;&#20197;&#29992;&#20110;
Spring MVC&#24212;&#29992;&#20013;&#30340;&#35270;&#22270;&#23618;&#25216;&#26415;&#30340;&#27169;&#26495;&#35821;&#35328;. &#20182;&#20204;&#24456;&#30456;&#20284;&#24182;&#19988;&#20351;&#29992;&#36215;&#26469;&#20063;&#26377;&#31867;&#20284;&#30340;&#38656;&#27714;, &#25152;&#20197;&#22312;&#36825;&#37324;&#19968;&#24182;&#35752;&#35770;.
&#20851;&#20110;&#20004;&#20010;&#35821;&#35328;&#22312;&#35821;&#20041;&#19982;&#21477;&#27861;&#19978;&#30340;&#21306;&#21035;, &#35831;&#26597;&#30475; <a class="ulink" href="http://www.freemarker.org" target="_top">FreeMarker</a>.</p>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="view-velocity-dependencies" href="#view-velocity-dependencies"></a>17.4.1&nbsp;&#20381;&#36182;</h3></div></div></div>

<p>&#20320;&#30340;web&#24212;&#29992;&#38656;&#35201;&#20998;&#21035;&#21253;&#21547;<code class="literal">velocity-1.x.x.jar</code>&#25110;&#32773;<code class="literal">freemarker-2.x.jar</code>&#26469;&#20351;&#29992;Velocity&#25110;&#32773;FreeMarker,
&#24182;&#19988;&#23545;&#20110;Velocity&#20320;&#36824;&#38656;&#35201;<code class="literal">commons-collections.jar</code>. &#36890;&#24120;&#20182;&#20204;&#37117;&#20250;&#34987;&#25918;&#22312;&#25991;&#20214;&#22841;<code class="literal">WEB-INF/lib</code>&#20013;, &#36825;&#26679;
&#20182;&#20204;&#23601;&#20250;&#34987;Java EE&#26381;&#21153;&#22120;&#21152;&#36733;&#24182;&#25918;&#36827;&#24212;&#29992;&#30340;classpath&#20013;. &#24456;&#26174;&#28982;&#26159;&#20551;&#23450;&#20320;&#20063;&#24050;&#32463;&#23558;<code class="literal">spring-webmvc.jar</code>&#25918;&#21040;&#20102;
&#20320;&#24212;&#29992;&#30340;<code class="literal">'WEB-INF/lib'</code>&#25991;&#20214;&#22841;&#30340;! &#22914;&#26524;&#20320;&#25171;&#31639;&#22312;Velocity&#30340;&#35270;&#22270;&#20013;&#20351;&#29992;Spring&#30340;<span class="emphasis"><em>dateToolAttribute</em></span>&#25110;&#32773;
<span class="emphasis"><em>numberToolAttribute</em></span>, &#20320;&#36824;&#38656;&#35201;&#21253;&#21547;&#36827;<code class="literal">velocity-tools-generic-1.x.jar</code>.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="view-velocity-contextconfig" href="#view-velocity-contextconfig"></a>17.4.2&nbsp;&#19978;&#19979;&#25991;&#37197;&#32622;</h3></div></div></div>

<p>&#19968;&#20010;&#21512;&#36866;&#30340;&#37197;&#32622;&#26159;&#36890;&#36807;&#28155;&#21152;&#30456;&#20851;&#37197;&#32622;bean&#21021;&#22987;&#21270;&#21040;&#20320;&#30340;<code class="literal">'*-servlet.xml'</code>, &#23601;&#20687;&#19979;&#38754;&#36825;&#26679;:</p>
<pre class="programlisting"><span class="hl-comment">&lt;!--
&#36825;&#20010;bean&#22312;&#19968;&#20010;&#27169;&#26495;&#26681;&#30446;&#24405;&#22522;&#30784;&#19978;&#20026;&#25105;&#20204;&#35774;&#32622;&#19968;&#20010;Velocity&#29615;&#22659;. &#21487;&#36873;&#30340;, &#19968;&#20010;properties&#25991;&#20214;&#21487;&#20197;&#25351;&#23450;&#26469;
&#23545;Velocity&#29615;&#22659;&#36827;&#34892;&#26356;&#22810;&#30340;&#25511;&#21046;, &#20294;&#26159;&#40664;&#35748;&#30340;&#29992;&#26469;&#20570;&#22522;&#20110;&#25991;&#20214;&#30340;&#27169;&#26495;&#21152;&#36733;&#24050;&#32463;&#22815;&#20102;.
--&gt;</span>
<span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"velocityConfig"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"org.springframework.web.servlet.view.velocity.VelocityConfigurer"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"resourceLoaderPath"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"/WEB-INF/velocity/"</span><span class="hl-tag">/&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span>

<span class="hl-comment">&lt;!--
&#35270;&#22270;&#22788;&#29702;&#20063;&#21487;&#20197;&#36890;&#36807;ResourceBundles&#25110;&#32773;XML&#25991;&#20214;. &#22914;&#26524;&#20320;&#38656;&#35201;&#26681;&#25454;Locale&#26469;&#20351;&#29992;&#19981;&#21516;&#30340;&#35270;&#22270;&#22788;&#29702;, &#20320;&#38656;&#35201;&#20351;&#29992;&#36164;&#28304;&#32465;&#23450;&#22788;&#29702;&#22120;.
--&gt;</span>
<span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"viewResolver"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"org.springframework.web.servlet.view.velocity.VelocityViewResolver"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"cache"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"true"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"prefix"</span> <span class="hl-attribute">value</span>=<span class="hl-value">""</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"suffix"</span> <span class="hl-attribute">value</span>=<span class="hl-value">".vm"</span><span class="hl-tag">/&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span></pre>

<pre class="programlisting"><span class="hl-comment">&lt;!-- freemarker &#37197;&#32622; --&gt;</span>
<span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"freemarkerConfig"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"org.springframework.web.servlet.view.freemarker.FreeMarkerConfigurer"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"templateLoaderPath"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"/WEB-INF/freemarker/"</span><span class="hl-tag">/&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span>

<span class="hl-comment">&lt;!--
&#35270;&#22270;&#22788;&#29702;&#20063;&#21487;&#20197;&#36890;&#36807;ResourceBundles&#25110;&#32773;XML&#25991;&#20214;. &#22914;&#26524;&#20320;&#38656;&#35201;&#26681;&#25454;Locale&#26469;&#20351;&#29992;&#19981;&#21516;&#30340;&#35270;&#22270;&#22788;&#29702;, &#20320;&#38656;&#35201;&#20351;&#29992;&#36164;&#28304;&#32465;&#23450;&#22788;&#29702;&#22120;.
--&gt;</span>
<span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"viewResolver"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"org.springframework.web.servlet.view.freemarker.FreeMarkerViewResolver"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"cache"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"true"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"prefix"</span> <span class="hl-attribute">value</span>=<span class="hl-value">""</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"suffix"</span> <span class="hl-attribute">value</span>=<span class="hl-value">".ftl"</span><span class="hl-tag">/&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span></pre>

<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p>&#23545;&#20110;&#38750;web&#24212;&#29992;, &#28155;&#21152;<code class="literal">VelocityConfigurationFactoryBean</code>&#25110;&#32773;<code class="literal">FreeMarkerConfigurationFactoryBean</code>
&#21040;&#20320;&#30340;&#24212;&#29992;&#19978;&#19979;&#25991;&#30340;&#23450;&#20041;&#25991;&#20214;.</p>
</td></tr></table></div>

</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="view-velocity-createtemplates" href="#view-velocity-createtemplates"></a>17.4.3&nbsp;&#21019;&#24314;&#27169;&#26495;</h3></div></div></div>

<p>&#20320;&#25152;&#26377;&#30340;&#27169;&#26495;&#38656;&#35201;&#25918;&#32622;&#22312;&#21069;&#38754;&#30340;<code class="literal">*Configurer</code> bean&#25152;&#25351;&#26126;&#30340;&#30446;&#24405;&#20013;. &#26412;&#25991;&#26723;&#27809;&#26377;&#28085;&#30422;&#21019;&#24314;&#37027;&#20004;&#31181;&#35821;&#35328;&#30340;&#27169;&#26495;&#30340;&#32454;
&#33410;--&#35831;&#21040;&#20182;&#20204;&#30340;&#30456;&#20851;&#32593;&#31449;&#26597;&#30475;&#30456;&#20851;&#20449;&#24687;. &#22914;&#26524;&#20320;&#20687;&#25512;&#33616;&#22320;&#37027;&#26679;&#20351;&#29992;&#35270;&#22270;&#22788;&#29702;&#22120;, &#37027;&#20040;&#35270;&#22270;&#30340;&#36923;&#36753;&#21517;&#31216;&#21644;&#27169;&#26495;&#25991;&#20214;&#21517;&#31216;
&#30340;&#23545;&#24212;&#20851;&#31995;&#23601;&#20687;JSP&#25991;&#20214;&#30340;<code class="literal">InternalResourceViewResolver</code>&#30456;&#20284;. &#25152;&#20197;&#22914;&#26524;&#20320;&#30340;&#25511;&#21046;&#22120;&#36820;&#22238;&#19968;&#20010;ModelAndView
&#30340;&#23545;&#35937;, &#21253;&#21547;&#19968;&#20010;&#21517;&#20026;"welcome"&#30340;&#35270;&#22270;&#21517;&#31216;, &#37027;&#20040;&#22788;&#29702;&#22120;&#23601;&#20250;&#36866;&#24403;&#22320;&#21435;&#23547;&#25214;<code class="literal">/WEB-INF/freemarker/welcome.ftl</code>
&#25110;&#32773;<code class="literal">/WEB-INF/velocity/welcome.vm</code>.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="view-velocity-advancedconfig" href="#view-velocity-advancedconfig"></a>17.4.4&nbsp;&#39640;&#32423;&#37197;&#32622;</h3></div></div></div>

<p>&#19978;&#38754;&#25351;&#26126;&#30340;&#22522;&#30784;&#37197;&#32622;&#23545;&#20110;&#22823;&#22810;&#25968;&#30340;&#24212;&#29992;&#38656;&#27714;&#26159;&#28385;&#36275;&#30340;, &#20294;&#26159;&#39069;&#22806;&#30340;&#37197;&#32622;&#36873;&#39033;&#23545;&#20110;&#19981;&#23547;&#24120;&#25110;&#39640;&#32423;&#30340;&#38656;&#27714;&#26159;&#21487;&#29992;&#30340;.</p>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="view-velocity-example-velocityproperties" href="#view-velocity-example-velocityproperties"></a>velocity.properties</h4></div></div></div>

<p>&#36825;&#20010;&#25991;&#20214;&#23436;&#20840;&#26159;&#21487;&#36873;&#30340;, &#20294;&#26159;&#22914;&#26524;&#25351;&#23450;&#20102;, &#25152;&#21253;&#21547;&#30340;&#20540;&#26159;&#30452;&#25509;&#20256;&#36882;&#32473;Velocity&#30340;&#36816;&#34892;&#26102;&#26469;&#37197;&#32622;velocity&#30340;. &#21482;&#26377;&#22312;
&#39640;&#32423;&#37197;&#32622;&#20013;&#25165;&#20250;&#38656;&#35201;, &#22914;&#26524;&#25351;&#23450;&#20102;&#36825;&#20010;&#25991;&#20214;, &#35831;&#22312;&#19978;&#38754;&#37197;&#32622;&#30340;<code class="literal">VelocityConfigurer</code> bean&#20013;&#25351;&#23450;&#20301;&#32622;.</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"velocityConfig"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"org.springframework.web.servlet.view.velocity.VelocityConfigurer"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"configLocation"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"/WEB-INF/velocity.properties"</span><span class="hl-tag">/&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span></pre>

<p>&#22791;&#36873;&#22320;, &#20320;&#21487;&#20197;&#30452;&#25509;&#23558;velocity&#23646;&#24615;&#37197;&#32622;&#22312;Velocity&#37197;&#32622;bean&#23450;&#20041;&#20013;, &#20351;&#29992;&#19979;&#38754;&#30340;&#34892;&#20869;&#37197;&#32622;&#21363;&#21487;.</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"velocityConfig"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"org.springframework.web.servlet.view.velocity.VelocityConfigurer"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"velocityProperties"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;props&gt;</span>
            <span class="hl-tag">&lt;prop</span> <span class="hl-attribute">key</span>=<span class="hl-value">"resource.loader"</span><span class="hl-tag">&gt;</span>file<span class="hl-tag">&lt;/prop&gt;</span>
            <span class="hl-tag">&lt;prop</span> <span class="hl-attribute">key</span>=<span class="hl-value">"file.resource.loader.class"</span><span class="hl-tag">&gt;</span>
                org.apache.velocity.runtime.resource.loader.FileResourceLoader
            <span class="hl-tag">&lt;/prop&gt;</span>
            <span class="hl-tag">&lt;prop</span> <span class="hl-attribute">key</span>=<span class="hl-value">"file.resource.loader.path"</span><span class="hl-tag">&gt;</span>${webapp.root}/WEB-INF/velocity<span class="hl-tag">&lt;/prop&gt;</span>
            <span class="hl-tag">&lt;prop</span> <span class="hl-attribute">key</span>=<span class="hl-value">"file.resource.loader.cache"</span><span class="hl-tag">&gt;</span>false<span class="hl-tag">&lt;/prop&gt;</span>
        <span class="hl-tag">&lt;/props&gt;</span>
    <span class="hl-tag">&lt;/property&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span></pre>

<p>&#35831;&#21442;&#30475;
<a class="ulink" href="http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/ui/velocity/VelocityEngineFactory.html" target="_top">API&#25991;&#26723;</a>&#20102;&#35299;
Spring&#23545;&#20110;Velocity&#30340;&#37197;&#32622;, &#25110;&#32773;Velocity&#25991;&#26723;&#20013;&#30340;&#20363;&#23376;&#25110;&#32773;&#23427;&#33258;&#24049;&#20851;&#20110;<code class="literal">'velocity.properties'</code>&#25991;&#20214;&#30340;&#25551;&#36848;.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="views-freemarker" href="#views-freemarker"></a>FreeMarker</h4></div></div></div>

<p>FreeMarker&#30340;<span class="emphasis"><em>Settings</em></span>&#21644;<span class="emphasis"><em>SharedVariables</em></span>&#37117;&#21487;&#20197;&#30452;&#25509;&#36890;&#36807;&#22312;Spring&#37324;&#38754;&#37197;&#32622;<code class="literal">FreeMarkerConfigurer</code> bean
&#30340;&#21512;&#36866;&#30340;properties&#26469;&#20256;&#36882;&#32473;Spring&#31649;&#29702;&#30340;FreeMarker&#30340;<code class="literal">Configuration</code>&#23545;&#35937;. <code class="literal">freemarkerSettings</code>&#23646;&#24615;
&#38656;&#35201;&#19968;&#20010;<code class="literal">java.util.Properties</code>&#23545;&#35937;, <code class="literal">freemarkerVariables</code>&#23646;&#24615;&#38656;&#35201;&#19968;&#20010;<code class="literal">java.util.Map</code>&#23545;&#35937;.</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"freemarkerConfig"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"org.springframework.web.servlet.view.freemarker.FreeMarkerConfigurer"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"templateLoaderPath"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"/WEB-INF/freemarker/"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"freemarkerVariables"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;map&gt;</span>
            <span class="hl-tag">&lt;entry</span> <span class="hl-attribute">key</span>=<span class="hl-value">"xml_escape"</span> <span class="hl-attribute">value-ref</span>=<span class="hl-value">"fmXmlEscape"</span><span class="hl-tag">/&gt;</span>
        <span class="hl-tag">&lt;/map&gt;</span>
    <span class="hl-tag">&lt;/property&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span>

<span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"fmXmlEscape"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"freemarker.template.utility.XmlEscape"</span><span class="hl-tag">/&gt;</span></pre>

<p>&#26597;&#30475;FreeMarker&#30340;&#25991;&#26723;&#20102;&#35299;<code class="literal">Configuration</code>&#23545;&#35937;&#35814;&#32454;&#30340;&#35774;&#32622;&#21644;&#21464;&#37327;.</p>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="view-velocity-forms" href="#view-velocity-forms"></a>17.4.5&nbsp;&#32465;&#23450;&#25903;&#25345;&#21644;&#34920;&#21333;&#22788;&#29702;</h3></div></div></div>

<p>Spring&#23545;&#20110;JSP&#30340;&#20351;&#29992;&#25552;&#20379;&#20102;&#19968;&#20010;&#26631;&#31614;&#24211;&#21253;&#21547;(&#36890;&#24120;&#36824;&#26377;&#20854;&#20182;)&#19968;&#20010;<code class="literal">&lt;spring:bind/&gt;</code>&#26631;&#31614;. &#36825;&#20010;&#26631;&#31614;&#20027;&#35201;&#26159;&#29992;&#26469;
&#24320;&#21551;&#34920;&#21333;&#20013;&#26174;&#31034;&#21518;&#21488;&#23545;&#35937;&#30340;&#20540;&#20197;&#21450;&#22312;web&#20013;&#25110;&#32773;&#19994;&#21153;&#23618;&#30340;<code class="literal">Validator</code>&#22833;&#36133;&#30340;&#26102;&#20505;&#26174;&#31034;&#32467;&#26524;. &#20174;&#29256;&#26412;1.1&#24320;&#22987;, Spring
&#24050;&#32463;&#24320;&#22987;&#22312;Velocity&#21644;FreeMarker&#24320;&#21551;&#21516;&#26679;&#30340;&#26041;&#27861;&#25903;&#25345;, &#36890;&#36807;&#28155;&#21152;&#26041;&#20415;&#30340;&#23439;&#26469;&#29983;&#25104;&#34920;&#21333;&#30340;&#36755;&#20837;&#22495;.</p>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="view-bind-macros" href="#view-bind-macros"></a>The bind macros</h4></div></div></div>

<p>A standard set of macros are maintained within the <code class="literal">spring-webmvc.jar</code> file for both
languages, so they are always available to a suitably configured application.</p>
<p>Some of the macros defined in the Spring libraries are considered internal (private) but
no such scoping exists in the macro definitions making all macros visible to calling
code and user templates. The following sections concentrate only on the macros you need
to be directly calling from within your templates. If you wish to view the macro code
directly, the files are called spring.vm / spring.ftl and are in the packages
<code class="literal">org.springframework.web.servlet.view.velocity</code> or
<code class="literal">org.springframework.web.servlet.view.freemarker</code> respectively.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="view-simple-binding" href="#view-simple-binding"></a>Simple binding</h4></div></div></div>

<p>In your html forms (vm / ftl templates) that act as the <span class="emphasis"><em>formView</em></span> for a Spring form
controller, you can use code similar to the following to bind to field values and
display error messages for each input field in similar fashion to the JSP equivalent.
Note that the name of the command object is "command" by default, but can be overridden
in your MVC configuration by setting the <span class="emphasis"><em>commandName</em></span> bean property on your form
controller. Example code is shown below for the <code class="literal">personFormV</code> and <code class="literal">personFormF</code> views
configured earlier;</p>
<pre class="programlisting"><span class="hl-comment">&lt;!-- velocity macros are automatically available --&gt;</span>
<span class="hl-tag">&lt;html&gt;</span>
    ...
    <span class="hl-tag">&lt;form</span> <span class="hl-attribute">action</span>=<span class="hl-value">""</span> <span class="hl-attribute">method</span>=<span class="hl-value">"POST"</span><span class="hl-tag">&gt;</span>
        Name:
        #springBind( "command.name" )
        <span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"text"</span>
            <span class="hl-attribute">name</span>=<span class="hl-value">"${status.expression}"</span>
            <span class="hl-attribute">value</span>=<span class="hl-value">"$!status.value"</span><span class="hl-tag"> /&gt;</span><span class="hl-tag">&lt;br&gt;</span>
        #foreach($error in $status.errorMessages) <span class="hl-tag">&lt;b&gt;</span>$error<span class="hl-tag">&lt;/b&gt;</span> <span class="hl-tag">&lt;br&gt;</span> #end
        <span class="hl-tag">&lt;br&gt;</span>
        ...
        <span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"submit"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"submit"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;/form&gt;</span>
    ...
<span class="hl-tag">&lt;/html&gt;</span></pre>

<pre class="programlisting"><span class="hl-comment">&lt;!-- freemarker macros have to be imported into a namespace. We strongly
recommend sticking to </span><span class="emphasis"><em>spring</em></span> --&gt;
<span class="hl-tag">&lt;#import</span> <span class="hl-attribute">"/spring.ftl"</span> <span class="hl-attribute">as</span> <span class="hl-attribute">spring</span><span class="hl-tag"> /&gt;</span>
<span class="hl-tag">&lt;html&gt;</span>
    ...
    <span class="hl-tag">&lt;form</span> <span class="hl-attribute">action</span>=<span class="hl-value">""</span> <span class="hl-attribute">method</span>=<span class="hl-value">"POST"</span><span class="hl-tag">&gt;</span>
        Name:
        <span class="hl-tag">&lt;@spring.bind</span> <span class="hl-attribute">"command.name"</span><span class="hl-tag"> /&gt;</span>
        <span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"text"</span>
            <span class="hl-attribute">name</span>=<span class="hl-value">"${spring.status.expression}"</span>
            <span class="hl-attribute">value</span>=<span class="hl-value">"${spring.status.value?default("</span><span class="hl-attribute">")}"</span><span class="hl-tag"> /&gt;</span><span class="hl-tag">&lt;br&gt;</span>
        <span class="hl-tag">&lt;#list</span> <span class="hl-attribute">spring.status.errorMessages</span> <span class="hl-attribute">as</span> <span class="hl-attribute">error&gt;</span> <span class="hl-attribute">&lt;b&gt;${error}&lt;/b&gt;</span> <span class="hl-attribute">&lt;br&gt;</span> <span class="hl-attribute">&lt;/#list&gt;</span>
        <span class="hl-attribute">&lt;br&gt;</span>
        <span class="hl-attribute">...</span>
        <span class="hl-attribute">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"submit"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"submit"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;/form&gt;</span>
    ...
<span class="hl-tag">&lt;/html&gt;</span></pre>

<p><code class="literal">#springBind</code> / <code class="literal">&lt;@spring.bind&gt;</code> requires a <span class="emphasis"><em>path</em></span> argument which consists of the name
of your command object (it will be <span class="emphasis"><em>command</em></span> unless you changed it in your
FormController properties) followed by a period and the name of the field on the command
object you wish to bind to. Nested fields can be used too such as
"command.address.street". The <code class="literal">bind</code> macro assumes the default HTML escaping behavior
specified by the ServletContext parameter <code class="literal">defaultHtmlEscape</code> in web.xml</p>
<p>The optional form of the macro called <code class="literal">#springBindEscaped</code> / <code class="literal">&lt;@spring.bindEscaped&gt;</code>
takes a second argument and explicitly specifies whether HTML escaping should be used in
the status error messages or values. Set to true or false as required. Additional form
handling macros simplify the use of HTML escaping and these macros should be used
wherever possible. They are explained in the next section.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="views-form-macros" href="#views-form-macros"></a>Form input generation macros</h4></div></div></div>

<p>Additional convenience macros for both languages simplify both binding and form
generation (including validation error display). It is never necessary to use these
macros to generate form input fields, and they can be mixed and matched with simple HTML
or calls direct to the spring bind macros highlighted previously.</p>
<p>The following table of available macros show the VTL and FTL definitions and the
parameter list that each takes.</p>
<div class="table"><a name="views-macros-defs-tbl" href="#views-macros-defs-tbl"></a><p class="title"><b>Table&nbsp;17.1.&nbsp;Table of macro definitions</b></p><div class="table-contents">

  <table summary="Table of macro definitions" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="col_1"><col class="col_2"><col class="col_3"></colgroup><thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">macro</th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">VTL definition</th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top">FTL definition</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><span class="strong"><strong>message</strong></span> (output a string from a resource bundle based on the code parameter)</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>#springMessage($code)</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>&lt;@spring.message code/&gt;</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><span class="strong"><strong>messageText</strong></span> (output a string from a resource bundle based on the code parameter,
  falling back to the value of the default parameter)</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>#springMessageText($code $text)</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>&lt;@spring.messageText code, text/&gt;</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><span class="strong"><strong>url</strong></span> (prefix a relative URL with the application&#8217;s context root)</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>#springUrl($relativeUrl)</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>&lt;@spring.url relativeUrl/&gt;</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><span class="strong"><strong>formInput</strong></span> (standard input field for gathering user input)</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>#springFormInput($path $attributes)</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>&lt;@spring.formInput path, attributes, fieldType/&gt;</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><span class="strong"><strong>formHiddenInput </strong></span>* (hidden input field for submitting non-user input)</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>#springFormHiddenInput($path $attributes)</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>&lt;@spring.formHiddenInput path, attributes/&gt;</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><span class="strong"><strong>formPasswordInput</strong></span> * (standard input field for gathering passwords. Note that no
  value will ever be populated in fields of this type)</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>#springFormPasswordInput($path $attributes)</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>&lt;@spring.formPasswordInput path, attributes/&gt;</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><span class="strong"><strong>formTextarea</strong></span> (large text field for gathering long, freeform text input)</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>#springFormTextarea($path $attributes)</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>&lt;@spring.formTextarea path, attributes/&gt;</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><span class="strong"><strong>formSingleSelect</strong></span> (drop down box of options allowing a single required value to be
  selected)</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>#springFormSingleSelect( $path $options $attributes)</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>&lt;@spring.formSingleSelect path, options, attributes/&gt;</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><span class="strong"><strong>formMultiSelect</strong></span> (a list box of options allowing the user to select 0 or more values)</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>#springFormMultiSelect($path $options $attributes)</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>&lt;@spring.formMultiSelect path, options, attributes/&gt;</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><span class="strong"><strong>formRadioButtons</strong></span> (a set of radio buttons allowing a single selection to be made
  from the available choices)</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>#springFormRadioButtons($path $options $separator $attributes)</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>&lt;@spring.formRadioButtons path, options separator, attributes/&gt;</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><span class="strong"><strong>formCheckboxes</strong></span> (a set of checkboxes allowing 0 or more values to be selected)</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>#springFormCheckboxes($path $options $separator $attributes)</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>&lt;@spring.formCheckboxes path, options, separator, attributes/&gt;</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><span class="strong"><strong>formCheckbox</strong></span> (a single checkbox)</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>#springFormCheckbox($path $attributes)</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>&lt;@spring.formCheckbox path, attributes/&gt;</p></td></tr><tr><td style="border-right: 0.5pt solid ; " align="left" valign="top"><p><span class="strong"><strong>showErrors</strong></span> (simplify display of validation errors for the bound field)</p></td><td style="border-right: 0.5pt solid ; " align="left" valign="top"><p>#springShowErrors($separator $classOrStyle)</p></td><td style="" align="left" valign="top"><p>&lt;@spring.showErrors separator, classOrStyle/&gt;</p></td></tr></tbody></table>
</div></div><br class="table-break">

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
In FTL (FreeMarker), these two macros are not actually required as you can use the
normal <code class="literal">formInput</code> macro, specifying ' <code class="literal">hidden</code>' or ' <code class="literal">password</code>' as the value for the
<code class="literal">fieldType</code> parameter.
</li></ul></div>

<p>The parameters to any of the above macros have consistent meanings:</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
path: the name of the field to bind to (ie "command.name")
</li><li class="listitem">
options: a Map of all the available values that can be selected from in the input
field. The keys to the map represent the values that will be POSTed back from the form
and bound to the command object. Map objects stored against the keys are the labels
displayed on the form to the user and may be different from the corresponding values
posted back by the form. Usually such a map is supplied as reference data by the
controller. Any Map implementation can be used depending on required behavior. For
strictly sorted maps, a <code class="literal">SortedMap</code> such as a <code class="literal">TreeMap</code> with a suitable Comparator may
be used and for arbitrary Maps that should return values in insertion order, use a
<code class="literal">LinkedHashMap</code> or a <code class="literal">LinkedMap</code> from commons-collections.
</li><li class="listitem">
separator: where multiple options are available as discreet elements (radio buttons or
checkboxes), the sequence of characters used to separate each one in the list (ie
"&lt;br&gt;").
</li><li class="listitem">
attributes: an additional string of arbitrary tags or text to be included within the
HTML tag itself. This string is echoed literally by the macro. For example, in a
textarea field you may supply attributes as <span class="emphasis"><em>rows="5" cols="60"</em></span> or you could pass
style information such as <span class="emphasis"><em>style="border:1px solid silver"</em></span>.
</li><li class="listitem">
classOrStyle: for the showErrors macro, the name of the CSS class that the span tag
wrapping each error will use. If no information is supplied (or the value is empty)
then the errors will be wrapped in &lt;b&gt;&lt;/b&gt; tags.
</li></ul></div>

<p>Examples of the macros are outlined below some in FTL and some in VTL. Where usage
differences exist between the two languages, they are explained in the notes.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="views-form-macros-input" href="#views-form-macros-input"></a>Input Fields</h5></div></div></div>

<pre class="programlisting"><span class="hl-comment">&lt;!-- the Name field example from above using form macros in VTL --&gt;</span>
...
Name:
#springFormInput("command.name" "")<span class="hl-tag">&lt;br&gt;</span>
#springShowErrors("<span class="hl-tag">&lt;br&gt;</span>" "")<span class="hl-tag">&lt;br&gt;</span></pre>

<p>The formInput macro takes the path parameter (command.name) and an additional attributes
parameter which is empty in the example above. The macro, along with all other form
generation macros, performs an implicit spring bind on the path parameter. The binding
remains valid until a new bind occurs so the showErrors macro doesn&#8217;t need to pass the
path parameter again - it simply operates on whichever field a bind was last created for.</p>
<p>The showErrors macro takes a separator parameter (the characters that will be used to
separate multiple errors on a given field) and also accepts a second parameter, this
time a class name or style attribute. Note that FreeMarker is able to specify default
values for the attributes parameter, unlike Velocity, and the two macro calls above
could be expressed as follows in FTL:</p>
<pre class="programlisting"><span class="hl-tag">&lt;@spring.formInput</span> <span class="hl-attribute">"command.name"/&gt;</span>
<span class="hl-attribute">&lt;@spring.showErrors</span> <span class="hl-attribute">"&lt;br&gt;"/&gt;</span></pre>

<p>Output is shown below of the form fragment generating the name field, and displaying a
validation error after the form was submitted with no value in the field. Validation
occurs through Spring&#8217;s Validation framework.</p>
<p>The generated HTML looks like this:</p>
<pre class="programlisting">Name:
&lt;input type="text" name="name" value=""&gt;
&lt;br&gt;
    &lt;b&gt;required&lt;/b&gt;
&lt;br&gt;
&lt;br&gt;</pre>

<p>The formTextarea macro works the same way as the formInput macro and accepts the same
parameter list. Commonly, the second parameter (attributes) will be used to pass style
information or rows and cols attributes for the textarea.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="views-form-macros-select" href="#views-form-macros-select"></a>Selection Fields</h5></div></div></div>

<p>Four selection field macros can be used to generate common UI value selection inputs in
your HTML forms.</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
formSingleSelect
</li><li class="listitem">
formMultiSelect
</li><li class="listitem">
formRadioButtons
</li><li class="listitem">
formCheckboxes
</li></ul></div>

<p>Each of the four macros accepts a Map of options containing the value for the form
field, and the label corresponding to that value. The value and the label can be the
same.</p>
<p>An example of radio buttons in FTL is below. The form backing object specifies a default
value of <span class="emphasis"><em>London</em></span> for this field and so no validation is necessary. When the form is
rendered, the entire list of cities to choose from is supplied as reference data in the
model under the name <span class="emphasis"><em>cityMap</em></span>.</p>
<pre class="programlisting">...
Town:
&lt;@spring.formRadioButtons "command.address.town", cityMap, "" /&gt;&lt;br&gt;&lt;br&gt;</pre>

<p>This renders a line of radio buttons, one for each value in <code class="literal">cityMap</code> using the
separator "". No additional attributes are supplied (the last parameter to the macro is
missing). The cityMap uses the same String for each key-value pair in the map. The map&#8217;s
keys are what the form actually submits as POSTed request parameters, map values are the
labels that the user sees. In the example above, given a list of three well known cities
and a default value in the form backing object, the HTML would be</p>
<pre class="programlisting">Town:
&lt;input type="radio" name="address.town" value="London"&gt;London&lt;/input&gt;
&lt;input type="radio" name="address.town" value="Paris" checked="checked"&gt;Paris&lt;/input&gt;
&lt;input type="radio" name="address.town" value="New York"&gt;New York&lt;/input&gt;</pre>

<p>If your application expects to handle cities by internal codes for example, the map of
codes would be created with suitable keys like the example below.</p>
<pre class="programlisting"><span class="hl-keyword">protected</span> Map referenceData(HttpServletRequest request) <span class="hl-keyword">throws</span> Exception {
    Map cityMap = <span class="hl-keyword">new</span> LinkedHashMap();
    cityMap.put(<span class="hl-string">"LDN"</span>, <span class="hl-string">"London"</span>);
    cityMap.put(<span class="hl-string">"PRS"</span>, <span class="hl-string">"Paris"</span>);
    cityMap.put(<span class="hl-string">"NYC"</span>, <span class="hl-string">"New York"</span>);

    Map m = <span class="hl-keyword">new</span> HashMap();
    m.put(<span class="hl-string">"cityMap"</span>, cityMap);
    <span class="hl-keyword">return</span> m;
}</pre>

<p>The code would now produce output where the radio values are the relevant codes but the
user still sees the more user friendly city names.</p>
<pre class="programlisting">Town:
&lt;input type="radio" name="address.town" value="LDN"&gt;London&lt;/input&gt;
&lt;input type="radio" name="address.town" value="PRS" checked="checked"&gt;Paris&lt;/input&gt;
&lt;input type="radio" name="address.town" value="NYC"&gt;New York&lt;/input&gt;</pre>

</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="views-form-macros-html-escaping" href="#views-form-macros-html-escaping"></a>HTML escaping and XHTML compliance</h4></div></div></div>

<p>Default usage of the form macros above will result in HTML tags that are HTML 4.01
compliant and that use the default value for HTML escaping defined in your web.xml as
used by Spring&#8217;s bind support. In order to make the tags XHTML compliant or to override
the default HTML escaping value, you can specify two variables in your template (or in
your model where they will be visible to your templates). The advantage of specifying
them in the templates is that they can be changed to different values later in the
template processing to provide different behavior for different fields in your form.</p>
<p>To switch to XHTML compliance for your tags, specify a value of <span class="emphasis"><em>true</em></span> for a
model/context variable named xhtmlCompliant:</p>
<pre class="programlisting"># for Velocity..
#set($springXhtmlCompliant = true)

&lt;-- for FreeMarker --&gt;
&lt;#assign xhtmlCompliant = true in spring&gt;</pre>

<p>Any tags generated by the Spring macros will now be XHTML compliant after processing
this directive.</p>
<p>In similar fashion, HTML escaping can be specified per field:</p>
<pre class="programlisting"><span class="hl-tag">&lt;#--</span> <span class="hl-attribute">until</span> <span class="hl-attribute">this</span> <span class="hl-attribute">point,</span> <span class="hl-attribute">default</span> <span class="hl-attribute">HTML</span> <span class="hl-attribute">escaping</span> <span class="hl-attribute">is</span> <span class="hl-attribute">used</span> <span class="hl-attribute">--&gt;</span>

<span class="hl-attribute">&lt;#assign</span> <span class="hl-attribute">htmlEscape</span> = <span class="hl-value">true</span> <span class="hl-attribute">in</span> <span class="hl-attribute">spring&gt;</span>
<span class="hl-attribute">&lt;#--</span> <span class="hl-attribute">next</span> <span class="hl-attribute">field</span> <span class="hl-attribute">will</span> <span class="hl-attribute">use</span> <span class="hl-attribute">HTML</span> <span class="hl-attribute">escaping</span> <span class="hl-attribute">--&gt;</span>
<span class="hl-attribute">&lt;@spring.formInput</span> <span class="hl-attribute">"command.name"</span><span class="hl-tag"> /&gt;</span>

<span class="hl-tag">&lt;#assign</span> <span class="hl-attribute">htmlEscape</span> = <span class="hl-value">false</span> <span class="hl-attribute">in</span> <span class="hl-attribute">spring&gt;</span>
<span class="hl-attribute">&lt;#--</span> <span class="hl-attribute">all</span> <span class="hl-attribute">future</span> <span class="hl-attribute">fields</span> <span class="hl-attribute">will</span> <span class="hl-attribute">be</span> <span class="hl-attribute">bound</span> <span class="hl-attribute">with</span> <span class="hl-attribute">HTML</span> <span class="hl-attribute">escaping</span> <span class="hl-attribute">off</span> <span class="hl-attribute">--&gt;</span></pre>

</div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="view-xslt" href="#view-xslt"></a>17.5&nbsp;XSLT</h2></div></div></div>

<p>XSLT is a transformation language for XML and is popular as a view technology within web
applications. XSLT can be a good choice as a view technology if your application
naturally deals with XML, or if your model can easily be converted to XML. The following
section shows how to produce an XML document as model data and have it transformed with
XSLT in a Spring Web MVC application.</p>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="view-xslt-firstwords" href="#view-xslt-firstwords"></a>17.5.1&nbsp;My First Words</h3></div></div></div>

<p>This example is a trivial Spring application that creates a list of words in the
<code class="literal">Controller</code> and adds them to the model map. The map is returned along with the view
name of our XSLT view. See <a class="xref" href="mvc.html#mvc-controller" title="16.3&nbsp;Implementing Controllers">Section&nbsp;16.3, &#8220;Implementing Controllers&#8221;</a> for details of Spring Web MVC&#8217;s
<code class="literal">Controller</code> interface. The XSLT view will turn the list of words into a simple XML
document ready for transformation.</p>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="view-xslt-beandefs" href="#view-xslt-beandefs"></a>Bean definitions</h4></div></div></div>

<p>Configuration is standard for a simple Spring application. The dispatcher servlet config
file contains a reference to a <code class="literal">ViewResolver</code>, URL mappings and a single controller
bean&#8230;</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"homeController"</span><span class="hl-attribute">class</span>=<span class="hl-value">"xslt.HomeController"</span><span class="hl-tag">/&gt;</span></pre>

<div class="orderedlist"><ol class="orderedlist" type="i"><li class="listitem">
that encapsulates our word generation logic.
</li></ol></div>

</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="view-xslt-controllercode" href="#view-xslt-controllercode"></a>Standard MVC controller code</h4></div></div></div>

<p>The controller logic is encapsulated in a subclass of <code class="literal">AbstractController</code>, with the
handler method being defined like so&#8230;</p>
<pre class="programlisting"><span class="hl-keyword">protected</span> ModelAndView handleRequestInternal(HttpServletRequest request,
        HttpServletResponse response) <span class="hl-keyword">throws</span> Exception {

    Map map = <span class="hl-keyword">new</span> HashMap();
    List wordList = <span class="hl-keyword">new</span> ArrayList();

    wordList.add(<span class="hl-string">"hello"</span>);
    wordList.add(<span class="hl-string">"world"</span>);

    map.put(<span class="hl-string">"wordList"</span>, wordList);

    <span class="hl-keyword">return</span> <span class="hl-keyword">new</span> ModelAndView(<span class="hl-string">"home"</span>, map);
}</pre>

<p>So far we&#8217;ve done nothing that&#8217;s XSLT specific. The model data has been created in the
same way as you would for any other Spring MVC application. Depending on the
configuration of the application now, that list of words could be rendered by JSP/JSTL
by having them added as request attributes, or they could be handled by Velocity by
adding the object to the <code class="literal">VelocityContext</code>. In order to have XSLT render them, they of
course have to be converted into an XML document somehow. There are software packages
available that will automatically <span class="emphasis"><em>domify</em></span> an object graph, but within Spring, you have
complete flexibility to create the DOM from your model in any way you choose. This
prevents the transformation of XML playing too great a part in the structure of your
model data which is a danger when using tools to manage the domification process.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="view-xslt-subclassing" href="#view-xslt-subclassing"></a>Convert the model data to XML</h4></div></div></div>

<p>In order to create a DOM document from our list of words or any other model data, we
must subclass the (provided)
<code class="literal">org.springframework.web.servlet.view.xslt.AbstractXsltView</code> class. In doing so, we must
also typically implement the abstract method <code class="literal">createXsltSource(..)</code> method. The first
parameter passed to this method is our model map. Here&#8217;s the complete listing of the
<code class="literal">HomePage</code> class in our trivial word application:</p>
<pre class="programlisting"><span class="hl-keyword">package</span> xslt;

<span class="hl-comment">// imports omitted for brevity</span>

<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> HomePage <span class="hl-keyword">extends</span> AbstractXsltView {

    <span class="hl-keyword">protected</span> Source createXsltSource(Map model, String rootName,
            HttpServletRequest request, HttpServletResponse response) <span class="hl-keyword">throws</span> Exception {

        Document document = DocumentBuilderFactory.newInstance().newDocumentBuilder().newDocument();
        Element root = document.createElement(rootName);

        List words = (List) model.get(<span class="hl-string">"wordList"</span>);
        <span class="hl-keyword">for</span> (Iterator it = words.iterator(); it.hasNext();) {
            String nextWord = (String) it.next();
            Element wordNode = document.createElement(<span class="hl-string">"word"</span>);
            Text textNode = document.createTextNode(nextWord);
            wordNode.appendChild(textNode);
            root.appendChild(wordNode);
        }
        <span class="hl-keyword">return</span> <span class="hl-keyword">new</span> DOMSource(root);
    }

}</pre>

<p>A series of parameter name/value pairs can optionally be defined by your subclass which
will be added to the transformation object. The parameter names must match those defined
in your XSLT template declared with <code class="literal">&lt;xsl:param
name="myParam"&gt;defaultValue&lt;/xsl:param&gt;</code>. To specify the parameters, override the
<code class="literal">getParameters()</code> method of the <code class="literal">AbstractXsltView</code> class and return a <code class="literal">Map</code> of the
name/value pairs. If your parameters need to derive information from the current
request, you can override the <code class="literal">getParameters(HttpServletRequest request)</code> method instead.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="view-xslt-viewdefinitions" href="#view-xslt-viewdefinitions"></a>Defining the view properties</h4></div></div></div>

<p>The views.properties file (or equivalent xml definition if you&#8217;re using an XML based
view resolver as we did in the Velocity examples above) looks like this for the one-view
application that is <span class="emphasis"><em>My First Words</em></span>:</p>

<pre class="literallayout">home.(class)=xslt.HomePage
home.stylesheetLocation=/WEB-INF/xsl/home.xslt
home.root=words</pre>

<p>Here, you can see how the view is tied in with the <code class="literal">HomePage</code> class just written which
handles the model domification in the first property <code class="literal">'.(class)'</code>. The
<code class="literal">'stylesheetLocation'</code> property points to the XSLT file which will handle the XML
transformation into HTML for us and the final property <code class="literal">'.root'</code> is the name that will
be used as the root of the XML document. This gets passed to the <code class="literal">HomePage</code> class above
in the second parameter to the <code class="literal">createXsltSource(..)</code> method(s).</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="view-xslt-transforming" href="#view-xslt-transforming"></a>Document transformation</h4></div></div></div>

<p>Finally, we have the XSLT code used for transforming the above document. As shown in the
above <code class="literal">'views.properties'</code> file, the stylesheet is called <code class="literal">'home.xslt'</code> and it lives in
the war file in the <code class="literal">'WEB-INF/xsl'</code> directory.</p>
<pre class="programlisting"><span class="hl-directive" style="color: maroon">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="hl-tag">&lt;xsl:stylesheet</span> <span class="hl-attribute">version</span>=<span class="hl-value">"1.0"</span> <span class="hl-attribute">xmlns:xsl</span>=<span class="hl-value">"http://www.w3.org/1999/XSL/Transform"</span><span class="hl-tag">&gt;</span>

    <span class="hl-tag">&lt;xsl:output</span> <span class="hl-attribute">method</span>=<span class="hl-value">"html"</span> <span class="hl-attribute">omit-xml-declaration</span>=<span class="hl-value">"yes"</span><span class="hl-tag">/&gt;</span>

    <span class="hl-tag">&lt;xsl:template</span> <span class="hl-attribute">match</span>=<span class="hl-value">"/"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;html&gt;</span>
            <span class="hl-tag">&lt;head&gt;</span><span class="hl-tag">&lt;title&gt;</span>Hello!<span class="hl-tag">&lt;/title&gt;</span><span class="hl-tag">&lt;/head&gt;</span>
            <span class="hl-tag">&lt;body&gt;</span>
                <span class="hl-tag">&lt;h1&gt;</span>My First Words<span class="hl-tag">&lt;/h1&gt;</span>
                <span class="hl-tag">&lt;xsl:apply-templates/&gt;</span>
            <span class="hl-tag">&lt;/body&gt;</span>
        <span class="hl-tag">&lt;/html&gt;</span>
    <span class="hl-tag">&lt;/xsl:template&gt;</span>

    <span class="hl-tag">&lt;xsl:template</span> <span class="hl-attribute">match</span>=<span class="hl-value">"word"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;xsl:value-of</span> <span class="hl-attribute">select</span>=<span class="hl-value">"."</span><span class="hl-tag">/&gt;</span><span class="hl-tag">&lt;br/&gt;</span>
    <span class="hl-tag">&lt;/xsl:template&gt;</span>

<span class="hl-tag">&lt;/xsl:stylesheet&gt;</span></pre>

</div>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="view-xslt-summary" href="#view-xslt-summary"></a>17.5.2&nbsp;Summary</h3></div></div></div>

<p>A summary of the files discussed and their location in the WAR file is shown in the
simplified WAR structure below.</p>

<pre class="literallayout">ProjectRoot
  |
  +- WebContent
      |
      +- WEB-INF
          |
          +- classes
          |    |
          |    +- xslt
          |    |   |
          |    |   +- HomePageController.class
          |    |   +- HomePage.class
          |    |
          |    +- views.properties
          |
          +- lib
          |   |
          |   +- spring-*.jar
          |
          +- xsl
          |   |
          |   +- home.xslt
          |
          +- frontcontroller-servlet.xml</pre>

<p>You will also need to ensure that an XML parser and an XSLT engine are available on the
classpath. JDK 1.4 provides them by default, and most Java EE containers will also make
them available by default, but it&#8217;s a possible source of errors to be aware of.</p>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="view-document" href="#view-document"></a>17.6&nbsp;Document views (PDF/Excel)</h2></div></div></div>

<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="view-document-intro" href="#view-document-intro"></a>17.6.1&nbsp;Introduction</h3></div></div></div>

<p>Returning an HTML page isn&#8217;t always the best way for the user to view the model output,
and Spring makes it simple to generate a PDF document or an Excel spreadsheet
dynamically from the model data. The document is the view and will be streamed from the
server with the correct content type to (hopefully) enable the client PC to run their
spreadsheet or PDF viewer application in response.</p>
<p>In order to use Excel views, you need to add the <span class="emphasis"><em>poi</em></span> library to your classpath, and
for PDF generation, the iText library.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="view-document-config" href="#view-document-config"></a>17.6.2&nbsp;Configuration and setup</h3></div></div></div>

<p>Document based views are handled in an almost identical fashion to XSLT views, and the
following sections build upon the previous one by demonstrating how the same controller
used in the XSLT example is invoked to render the same model as both a PDF document and
an Excel spreadsheet (which can also be viewed or manipulated in Open Office).</p>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="view-document-configviews" href="#view-document-configviews"></a>Document view definitions</h4></div></div></div>

<p>First, let&#8217;s amend the views.properties file (or xml equivalent) and add a simple view
definition for both document types. The entire file now looks like this with the XSLT
view shown from earlier:</p>

<pre class="literallayout">home.(class)=xslt.HomePage
home.stylesheetLocation=/WEB-INF/xsl/home.xslt
home.root=words

xl.(class)=excel.HomePage

pdf.(class)=pdf.HomePage</pre>

<p><span class="emphasis"><em>If you want to start with a template spreadsheet or a fillable PDF form to add your
model data to, specify the location as the <span class="emphasis"><em>url</em></span> property in the view definition</em></span></p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="view-document-configcontroller" href="#view-document-configcontroller"></a>Controller code</h4></div></div></div>

<p>The controller code we&#8217;ll use remains exactly the same from the XSLT example earlier
other than to change the name of the view to use. Of course, you could be clever and
have this selected based on a URL parameter or some other logic - proof that Spring
really is very good at decoupling the views from the controllers!</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="view-document-configsubclasses" href="#view-document-configsubclasses"></a>Subclassing for Excel views</h4></div></div></div>

<p>Exactly as we did for the XSLT example, we&#8217;ll subclass suitable abstract classes in
order to implement custom behavior in generating our output documents. For Excel, this
involves writing a subclass of
<code class="literal">org.springframework.web.servlet.view.document.AbstractExcelView</code> (for Excel files
generated by POI) or <code class="literal">org.springframework.web.servlet.view.document.AbstractJExcelView</code>
(for JExcelApi-generated Excel files) and implementing the <code class="literal">buildExcelDocument()</code> method.</p>
<p>Here&#8217;s the complete listing for our POI Excel view which displays the word list from the
model map in consecutive rows of the first column of a new spreadsheet:</p>
<pre class="programlisting"><span class="hl-keyword">package</span> excel;

<span class="hl-comment">// imports omitted for brevity</span>

<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> HomePage <span class="hl-keyword">extends</span> AbstractExcelView {

    <span class="hl-keyword">protected</span> <span class="hl-keyword">void</span> buildExcelDocument(Map model, HSSFWorkbook wb, HttpServletRequest req,
            HttpServletResponse resp) <span class="hl-keyword">throws</span> Exception {

        HSSFSheet sheet;
        HSSFRow sheetRow;
        HSSFCell cell;

        <span class="hl-comment">// Go to the first sheet</span>
        <span class="hl-comment">// getSheetAt: only if wb is created from an existing document</span>
        <span class="hl-comment">// sheet = wb.getSheetAt(0);</span>
        sheet = wb.createSheet(<span class="hl-string">"Spring"</span>);
        sheet.setDefaultColumnWidth((<span class="hl-keyword">short</span>) <span class="hl-number">12</span>);

        <span class="hl-comment">// write a text at A1</span>
        cell = getCell(sheet, <span class="hl-number">0</span>, <span class="hl-number">0</span>);
        setText(cell, <span class="hl-string">"Spring-Excel test"</span>);

        List words = (List) model.get(<span class="hl-string">"wordList"</span>);
        <span class="hl-keyword">for</span> (<span class="hl-keyword">int</span> i=<span class="hl-number">0</span>; i &lt; words.size(); i++) {
            cell = getCell(sheet, <span class="hl-number">2</span>+i, <span class="hl-number">0</span>);
            setText(cell, (String) words.get(i));
        }
    }

}</pre>

<p>And the following is a view generating the same Excel file, now using JExcelApi:</p>
<pre class="programlisting"><span class="hl-keyword">package</span> excel;

<span class="hl-comment">// imports omitted for brevity</span>

<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> HomePage <span class="hl-keyword">extends</span> AbstractJExcelView {

    <span class="hl-keyword">protected</span> <span class="hl-keyword">void</span> buildExcelDocument(Map model, WritableWorkbook wb,
            HttpServletRequest request, HttpServletResponse response) <span class="hl-keyword">throws</span> Exception {

        WritableSheet sheet = wb.createSheet(<span class="hl-string">"Spring"</span>, <span class="hl-number">0</span>);

        sheet.addCell(<span class="hl-keyword">new</span> Label(<span class="hl-number">0</span>, <span class="hl-number">0</span>, <span class="hl-string">"Spring-Excel test"</span>));

        List words = (List) model.get(<span class="hl-string">"wordList"</span>);
        <span class="hl-keyword">for</span> (<span class="hl-keyword">int</span> i = <span class="hl-number">0</span>; i &lt; words.size(); i++) {
            sheet.addCell(<span class="hl-keyword">new</span> Label(<span class="hl-number">2</span>+i, <span class="hl-number">0</span>, (String) words.get(i)));
        }
    }
}</pre>

<p>Note the differences between the APIs. We&#8217;ve found that the JExcelApi is somewhat more
intuitive, and furthermore, JExcelApi has slightly better image-handling capabilities.
There have been memory problems with large Excel files when using JExcelApi however.</p>
<p>If you now amend the controller such that it returns <code class="literal">xl</code> as the name of the view (
<code class="literal">return new ModelAndView("xl", map);</code>) and run your application again, you should find
that the Excel spreadsheet is created and downloaded automatically when you request the
same page as before.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="view-document-configsubclasspdf" href="#view-document-configsubclasspdf"></a>Subclassing for PDF views</h4></div></div></div>

<p>The PDF version of the word list is even simpler. This time, the class extends
<code class="literal">org.springframework.web.servlet.view.document.AbstractPdfView</code> and implements the
<code class="literal">buildPdfDocument()</code> method as follows:</p>
<pre class="programlisting"><span class="hl-keyword">package</span> pdf;

<span class="hl-comment">// imports omitted for brevity</span>

<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> PDFPage <span class="hl-keyword">extends</span> AbstractPdfView {

    <span class="hl-keyword">protected</span> <span class="hl-keyword">void</span> buildPdfDocument(Map model, Document doc, PdfWriter writer,
        HttpServletRequest req, HttpServletResponse resp) <span class="hl-keyword">throws</span> Exception {
        List words = (List) model.get(<span class="hl-string">"wordList"</span>);
        <span class="hl-keyword">for</span> (<span class="hl-keyword">int</span> i=<span class="hl-number">0</span>; i&lt;words.size(); i++) {
            doc.add( <span class="hl-keyword">new</span> Paragraph((String) words.get(i)));
        }
    }

}</pre>

<p>Once again, amend the controller to return the <code class="literal">pdf</code> view with <code class="literal">return new
ModelAndView("pdf", map);</code>, and reload the URL in your application. This time a PDF
document should appear listing each of the words in the model map.</p>
</div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="view-jasper-reports" href="#view-jasper-reports"></a>17.7&nbsp;JasperReports</h2></div></div></div>

<p>JasperReports ( <a class="ulink" href="http://jasperreports.sourceforge.net" target="_top">http://jasperreports.sourceforge.net</a>) is a powerful open-source
reporting engine that supports the creation of report designs using an easily understood
XML file format. JasperReports is capable of rendering reports in four different
formats: CSV, Excel, HTML and PDF.</p>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="view-jasper-reports-dependencies" href="#view-jasper-reports-dependencies"></a>17.7.1&nbsp;Dependencies</h3></div></div></div>

<p>Your application will need to include the latest release of JasperReports, which at the
time of writing was 0.6.1. JasperReports itself depends on the following projects:</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
BeanShell
</li><li class="listitem">
Commons BeanUtils
</li><li class="listitem">
Commons Collections
</li><li class="listitem">
Commons Digester
</li><li class="listitem">
Commons Logging
</li><li class="listitem">
iText
</li><li class="listitem">
POI
</li></ul></div>

<p>JasperReports also requires a JAXP compliant XML parser.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="view-jasper-reports-configuration" href="#view-jasper-reports-configuration"></a>17.7.2&nbsp;Configuration</h3></div></div></div>

<p>To configure JasperReports views in your Spring container configuration you need to
define a <code class="literal">ViewResolver</code> to map view names to the appropriate view class depending on
which format you want your report rendered in.</p>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="view-jasper-reports-configuration-resolver" href="#view-jasper-reports-configuration-resolver"></a>Configuring the ViewResolver</h4></div></div></div>

<p>Typically, you will use the <code class="literal">ResourceBundleViewResolver</code> to map view names to view
classes and files in a properties file.</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"viewResolver"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"org.springframework.web.servlet.view.ResourceBundleViewResolver"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"basename"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"views"</span><span class="hl-tag">/&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span></pre>

<p>Here we&#8217;ve configured an instance of the <code class="literal">ResourceBundleViewResolver</code> class that will
look for view mappings in the resource bundle with base name <code class="literal">views</code>. (The content of
this file is described in the next section.)</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="view-jasper-reports-configuration-views" href="#view-jasper-reports-configuration-views"></a>Configuring the Views</h4></div></div></div>

<p>The Spring Framework contains five different <code class="literal">View</code> implementations for JasperReports,
four of which correspond to one of the four output formats supported by JasperReports,
and one that allows for the format to be determined at runtime:</p>
<div class="table"><a name="view-jasper-reports-configuration-views-classes" href="#view-jasper-reports-configuration-views-classes"></a><p class="title"><b>Table&nbsp;17.2.&nbsp;JasperReports View classes</b></p><div class="table-contents">

  <table summary="JasperReports View classes" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="col_1"><col class="col_2"></colgroup><thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">Class Name</th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top">Render Format</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">JasperReportsCsvView</code></p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>CSV</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">JasperReportsHtmlView</code></p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>HTML</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">JasperReportsPdfView</code></p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>PDF</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">JasperReportsXlsView</code></p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Microsoft Excel</p></td></tr><tr><td style="border-right: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">JasperReportsMultiFormatView</code></p></td><td style="" align="left" valign="top"><p>The view is <a class="link" href="view.html#view-jasper-reports-configuration-multiformat-view" title="Using JasperReportsMultiFormatView">decided upon at
  runtime</a></p></td></tr></tbody></table>
</div></div><br class="table-break">

<p>Mapping one of these classes to a view name and a report file is a matter of adding the
appropriate entries in the resource bundle configured in the previous section as shown
here:</p>

<pre class="literallayout">simpleReport.(class)=org.springframework.web.servlet.view.jasperreports.JasperReportsPdfView
simpleReport.url=/WEB-INF/reports/DataSourceReport.jasper</pre>

<p>Here you can see that the view with name <code class="literal">simpleReport</code> is mapped to the
<code class="literal">JasperReportsPdfView</code> class, causing the output of this report to be rendered in PDF
format. The <code class="literal">url</code> property of the view is set to the location of the underlying report
file.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="view-jasper-reports-configuration-report-files" href="#view-jasper-reports-configuration-report-files"></a>About Report Files</h4></div></div></div>

<p>JasperReports has two distinct types of report file: the design file, which has a
<code class="literal">.jrxml</code> extension, and the compiled report file, which has a <code class="literal">.jasper</code> extension.
Typically, you use the JasperReports Ant task to compile your <code class="literal">.jrxml</code> design file into
a <code class="literal">.jasper</code> file before deploying it into your application. With the Spring Framework
you can map either of these files to your report file and the framework will take care
of compiling the <code class="literal">.jrxml</code> file on the fly for you. You should note that after a <code class="literal">.jrxml</code>
file is compiled by the Spring Framework, the compiled report is cached for the lifetime
of the application. Thus, to make changes to the file you will need to restart your
application.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="view-jasper-reports-configuration-multiformat-view" href="#view-jasper-reports-configuration-multiformat-view"></a>Using JasperReportsMultiFormatView</h4></div></div></div>

<p>The <code class="literal">JasperReportsMultiFormatView</code> allows for the report format to be specified at
runtime. The actual rendering of the report is delegated to one of the other
JasperReports view classes - the <code class="literal">JasperReportsMultiFormatView</code> class simply adds a
wrapper layer that allows for the exact implementation to be specified at runtime.</p>
<p>The <code class="literal">JasperReportsMultiFormatView</code> class introduces two concepts: the format key and the
discriminator key. The <code class="literal">JasperReportsMultiFormatView</code> class uses the mapping key to look
up the actual view implementation class, and it uses the format key to lookup up the
mapping key. From a coding perspective you add an entry to your model with the format
key as the key and the mapping key as the value, for example:</p>
<pre class="programlisting"><span class="hl-keyword">public</span> ModelAndView handleSimpleReportMulti(HttpServletRequest request,
HttpServletResponse response) <span class="hl-keyword">throws</span> Exception {

    String uri = request.getRequestURI();
    String format = uri.substring(uri.lastIndexOf(<span class="hl-string">"."</span>) + <span class="hl-number">1</span>);

    Map model = getModel();
    model.put(<span class="hl-string">"format"</span>, format);

    <span class="hl-keyword">return</span> <span class="hl-keyword">new</span> ModelAndView(<span class="hl-string">"simpleReportMulti"</span>, model);

}</pre>

<p>In this example, the mapping key is determined from the extension of the request URI and
is added to the model under the default format key: <code class="literal">format</code>. If you wish to use a
different format key then you can configure this using the <code class="literal">formatKey</code> property of the
<code class="literal">JasperReportsMultiFormatView</code> class.</p>
<p>By default the following mapping key mappings are configured in
<code class="literal">JasperReportsMultiFormatView</code>:</p>
<div class="table"><a name="view-jasper-reports-configuration-multiformat-view-mappings" href="#view-jasper-reports-configuration-multiformat-view-mappings"></a><p class="title"><b>Table&nbsp;17.3.&nbsp;JasperReportsMultiFormatView Default Mapping Key Mappings</b></p><div class="table-contents">

  <table summary="JasperReportsMultiFormatView Default Mapping Key Mappings" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="col_1"><col class="col_2"></colgroup><thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">Mapping Key</th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top">View Class</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>csv</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">JasperReportsCsvView</code></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>html</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">JasperReportsHtmlView</code></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>pdf</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">JasperReportsPdfView</code></p></td></tr><tr><td style="border-right: 0.5pt solid ; " align="left" valign="top"><p>xls</p></td><td style="" align="left" valign="top"><p><code class="literal">JasperReportsXlsView</code></p></td></tr></tbody></table>
</div></div><br class="table-break">

<p>So in the example above a request to URI /foo/myReport.pdf would be mapped to the
<code class="literal">JasperReportsPdfView</code> class. You can override the mapping key to view class mappings
using the <code class="literal">formatMappings</code> property of <code class="literal">JasperReportsMultiFormatView</code>.</p>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="view-jasper-reports-model" href="#view-jasper-reports-model"></a>17.7.3&nbsp;Populating the ModelAndView</h3></div></div></div>

<p>In order to render your report correctly in the format you have chosen, you must supply
Spring with all of the data needed to populate your report. For JasperReports this means
you must pass in all report parameters along with the report datasource. Report
parameters are simple name/value pairs and can be added to the <code class="literal">Map</code> for your model as
you would add any name/value pair.</p>
<p>When adding the datasource to the model you have two approaches to choose from. The
first approach is to add an instance of <code class="literal">JRDataSource</code> or a <code class="literal">Collection</code> type to the
model <code class="literal">Map</code> under any arbitrary key. Spring will then locate this object in the model
and treat it as the report datasource. For example, you may populate your model like so:</p>
<pre class="programlisting"><span class="hl-keyword">private</span> Map getModel() {
    Map model = <span class="hl-keyword">new</span> HashMap();
    Collection beanData = getBeanData();
    model.put(<span class="hl-string">"myBeanData"</span>, beanData);
    <span class="hl-keyword">return</span> model;
}</pre>

<p>The second approach is to add the instance of <code class="literal">JRDataSource</code> or <code class="literal">Collection</code> under a
specific key and then configure this key using the <code class="literal">reportDataKey</code> property of the view
class. In both cases Spring will wrap instances of <code class="literal">Collection</code> in a
<code class="literal">JRBeanCollectionDataSource</code> instance. For example:</p>
<pre class="programlisting"><span class="hl-keyword">private</span> Map getModel() {
    Map model = <span class="hl-keyword">new</span> HashMap();
    Collection beanData = getBeanData();
    Collection someData = getSomeData();
    model.put(<span class="hl-string">"myBeanData"</span>, beanData);
    model.put(<span class="hl-string">"someData"</span>, someData);
    <span class="hl-keyword">return</span> model;
}</pre>

<p>Here you can see that two <code class="literal">Collection</code> instances are being added to the model. To ensure
that the correct one is used, we simply modify our view configuration as appropriate:</p>

<pre class="literallayout">simpleReport.(class)=org.springframework.web.servlet.view.jasperreports.JasperReportsPdfView
simpleReport.url=/WEB-INF/reports/DataSourceReport.jasper
simpleReport.reportDataKey=myBeanData</pre>

<p>Be aware that when using the first approach, Spring will use the first instance of
<code class="literal">JRDataSource</code> or <code class="literal">Collection</code> that it encounters. If you need to place multiple
instances of <code class="literal">JRDataSource</code> or <code class="literal">Collection</code> into the model you need to use the second
approach.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="view-jasper-reports-subreports" href="#view-jasper-reports-subreports"></a>17.7.4&nbsp;Working with Sub-Reports</h3></div></div></div>

<p>JasperReports provides support for embedded sub-reports within your master report files.
There are a wide variety of mechanisms for including sub-reports in your report files.
The easiest way is to hard code the report path and the SQL query for the sub report
into your design files. The drawback of this approach is obvious: the values are
hard-coded into your report files reducing reusability and making it harder to modify
and update report designs. To overcome this you can configure sub-reports declaratively,
and you can include additional data for these sub-reports directly from your controllers.</p>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="view-jasper-reports-subreports-config-reports" href="#view-jasper-reports-subreports-config-reports"></a>Configuring Sub-Report Files</h4></div></div></div>

<p>To control which sub-report files are included in a master report using Spring, your
report file must be configured to accept sub-reports from an external source. To do this
you declare a parameter in your report file like so:</p>
<pre class="programlisting"><span class="hl-tag">&lt;parameter</span> <span class="hl-attribute">name</span>=<span class="hl-value">"ProductsSubReport"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"net.sf.jasperreports.engine.JasperReport"</span><span class="hl-tag">/&gt;</span></pre>

<p>Then, you define your sub-report to use this sub-report parameter:</p>
<pre class="programlisting"><span class="hl-tag">&lt;subreport&gt;</span>
    <span class="hl-tag">&lt;reportElement</span> <span class="hl-attribute">isPrintRepeatedValues</span>=<span class="hl-value">"false"</span> <span class="hl-attribute">x</span>=<span class="hl-value">"5"</span> <span class="hl-attribute">y</span>=<span class="hl-value">"25"</span> <span class="hl-attribute">width</span>=<span class="hl-value">"325"</span>
        <span class="hl-attribute">height</span>=<span class="hl-value">"20"</span> <span class="hl-attribute">isRemoveLineWhenBlank</span>=<span class="hl-value">"true"</span> <span class="hl-attribute">backcolor</span>=<span class="hl-value">"#ffcc99"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;subreportParameter</span> <span class="hl-attribute">name</span>=<span class="hl-value">"City"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;subreportParameterExpression&gt;</span><span class="hl-tag">&lt;![CDATA[</span>$F{city}<span class="hl-tag">]]&gt;</span><span class="hl-tag">&lt;/subreportParameterExpression&gt;</span>
    <span class="hl-tag">&lt;/subreportParameter&gt;</span>
    <span class="hl-tag">&lt;dataSourceExpression&gt;</span><span class="hl-tag">&lt;![CDATA[</span>$P{SubReportData}<span class="hl-tag">]]&gt;</span><span class="hl-tag">&lt;/dataSourceExpression&gt;</span>
    <span class="hl-tag">&lt;subreportExpression</span> <span class="hl-attribute">class</span>=<span class="hl-value">"net.sf.jasperreports.engine.JasperReport"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;![CDATA[</span>$P{ProductsSubReport}<span class="hl-tag">]]&gt;</span><span class="hl-tag">&lt;/subreportExpression&gt;</span>
<span class="hl-tag">&lt;/subreport&gt;</span></pre>

<p>This defines a master report file that expects the sub-report to be passed in as an
instance of <code class="literal">net.sf.jasperreports.engine.JasperReports</code> under the parameter
<code class="literal">ProductsSubReport</code>. When configuring your Jasper view class, you can instruct Spring to
load a report file and pass it into the JasperReports engine as a sub-report using the
<code class="literal">subReportUrls</code> property:</p>
<pre class="programlisting"><span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"subReportUrls"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;map&gt;</span>
        <span class="hl-tag">&lt;entry</span> <span class="hl-attribute">key</span>=<span class="hl-value">"ProductsSubReport"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"/WEB-INF/reports/subReportChild.jrxml"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;/map&gt;</span>
<span class="hl-tag">&lt;/property&gt;</span></pre>

<p>Here, the key of the <code class="literal">Map</code> corresponds to the name of the sub-report parameter in the
report design file, and the entry is the URL of the report file. Spring will load this
report file, compiling it if necessary, and pass it into the JasperReports engine under
the given key.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="view-jasper-reports-subreports-config-datasources" href="#view-jasper-reports-subreports-config-datasources"></a>Configuring Sub-Report Data Sources</h4></div></div></div>

<p>This step is entirely optional when using Spring to configure your sub-reports. If you
wish, you can still configure the data source for your sub-reports using static queries.
However, if you want Spring to convert data returned in your <code class="literal">ModelAndView</code> into
instances of <code class="literal">JRDataSource</code> then you need to specify which of the parameters in your
<code class="literal">ModelAndView</code> Spring should convert. To do this, configure the list of parameter names
using the <code class="literal">subReportDataKeys</code> property of your chosen view class:</p>
<pre class="programlisting"><span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"subReportDataKeys"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"SubReportData"</span><span class="hl-tag">/&gt;</span></pre>

<p>Here, the key you supply <span class="emphasis"><em>must</em></span> correspond to both the key used in your <code class="literal">ModelAndView</code>
and the key used in your report design file.</p>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="view-jasper-reports-exporter-parameters" href="#view-jasper-reports-exporter-parameters"></a>17.7.5&nbsp;Configuring Exporter Parameters</h3></div></div></div>

<p>If you have special requirements for exporter configuration&#8201;&#8212;&#8201;perhaps you want a
specific page size for your PDF report&#8201;&#8212;&#8201;you can configure these exporter parameters
declaratively in your Spring configuration file using the <code class="literal">exporterParameters</code> property
of the view class. The <code class="literal">exporterParameters</code> property is typed as a <code class="literal">Map</code>. In your
configuration the key of an entry should be the fully-qualified name of a static field
that contains the exporter parameter definition, and the value of an entry should be the
value you want to assign to the parameter. An example of this is shown below:</p>
<pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"htmlReport"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"org.springframework.web.servlet.view.jasperreports.JasperReportsHtmlView"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"url"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"/WEB-INF/reports/simpleReport.jrxml"</span><span class="hl-tag">/&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"exporterParameters"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;map&gt;</span>
            <span class="hl-tag">&lt;entry</span> <span class="hl-attribute">key</span>=<span class="hl-value">"net.sf.jasperreports.engine.export.JRHtmlExporterParameter.HTML_FOOTER"</span><span class="hl-tag">&gt;</span>
                <span class="hl-tag">&lt;value&gt;</span>Footer by Spring!
                    &amp;lt;/td&amp;gt;&amp;lt;td width="50%"&amp;gt;&amp;amp;nbsp; &amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
                    &amp;lt;/table&amp;gt;&amp;lt;/body&amp;gt;&amp;lt;/html&amp;gt;
                <span class="hl-tag">&lt;/value&gt;</span>
            <span class="hl-tag">&lt;/entry&gt;</span>
        <span class="hl-tag">&lt;/map&gt;</span>
    <span class="hl-tag">&lt;/property&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span></pre>

<p>Here you can see that the <code class="literal">JasperReportsHtmlView</code> is configured with an exporter
parameter for <code class="literal">net.sf.jasperreports.engine.export.JRHtmlExporterParameter.HTML_FOOTER</code>
which will output a footer in the resulting HTML.</p>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="view-feeds" href="#view-feeds"></a>17.8&nbsp;Feed Views</h2></div></div></div>

<p>Both <code class="literal">AbstractAtomFeedView</code> and <code class="literal">AbstractRssFeedView</code> inherit from the base class
<code class="literal">AbstractFeedView</code> and are used to provide Atom and RSS Feed views respectfully. They
are based on java.net&#8217;s <a class="ulink" href="https://rome.dev.java.net" target="_top">ROME</a> project and are located in the
package <code class="literal">org.springframework.web.servlet.view.feed</code>.</p>
<p><code class="literal">AbstractAtomFeedView</code> requires you to implement the <code class="literal">buildFeedEntries()</code> method and
optionally override the <code class="literal">buildFeedMetadata()</code> method (the default implementation is
empty), as shown below.</p>
<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> SampleContentAtomView <span class="hl-keyword">extends</span> AbstractAtomFeedView {

    <em><span class="hl-annotation" style="color: gray">@Override</span></em>
    <span class="hl-keyword">protected</span> <span class="hl-keyword">void</span> buildFeedMetadata(Map&lt;String, Object&gt; model,
            Feed feed, HttpServletRequest request) {
        <span class="hl-comment">// implementation omitted</span>
    }

    <em><span class="hl-annotation" style="color: gray">@Override</span></em>
    <span class="hl-keyword">protected</span> List&lt;Entry&gt; buildFeedEntries(Map&lt;String, Object&gt; model,
            HttpServletRequest request, HttpServletResponse response) <span class="hl-keyword">throws</span> Exception {
        <span class="hl-comment">// implementation omitted</span>
    }

}</pre>

<p>Similar requirements apply for implementing <code class="literal">AbstractRssFeedView</code>, as shown below.</p>
<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> SampleContentAtomView <span class="hl-keyword">extends</span> AbstractRssFeedView {

    <em><span class="hl-annotation" style="color: gray">@Override</span></em>
    <span class="hl-keyword">protected</span> <span class="hl-keyword">void</span> buildFeedMetadata(Map&lt;String, Object&gt; model,
            Channel feed, HttpServletRequest request) {
        <span class="hl-comment">// implementation omitted</span>
    }

    <em><span class="hl-annotation" style="color: gray">@Override</span></em>
    <span class="hl-keyword">protected</span> List&lt;Item&gt; buildFeedItems(Map&lt;String, Object&gt; model,
            HttpServletRequest request, HttpServletResponse response) <span class="hl-keyword">throws</span> Exception {
        <span class="hl-comment">// implementation omitted</span>
    }

}</pre>

<p>The <code class="literal">buildFeedItems()</code> and <code class="literal">buildFeedEntires()</code> methods pass in the HTTP request in case
you need to access the Locale. The HTTP response is passed in only for the setting of
cookies or other HTTP headers. The feed will automatically be written to the response
object after the method returns.</p>
<p>For an example of creating an Atom view please refer to Alef Arendsen&#8217;s Spring Team Blog
<a class="ulink" href="https://spring.io/blog/2009/03/16/adding-an-atom-view-to-an-application-using-spring-s-rest-support" target="_top">entry</a>.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="view-xml-marshalling" href="#view-xml-marshalling"></a>17.9&nbsp;XML Marshalling View</h2></div></div></div>

<p>The <code class="literal">MarshallingView</code> uses an XML <code class="literal">Marshaller</code> defined in the <code class="literal">org.springframework.oxm</code>
package to render the response content as XML. The object to be marshalled can be set
explicitly using <code class="literal">MarhsallingView</code>'s <code class="literal">modelKey</code> bean property. Alternatively, the view
will iterate over all model properties and marshal the first type that is supported
by the <code class="literal">Marshaller</code>. For more information on the functionality in the
<code class="literal">org.springframework.oxm</code> package refer to the chapter <a class="link" href="oxm.html" title="15.&nbsp;Marshalling XML using O/X Mappers">Marshalling XML using O/X
Mappers</a>.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="view-json-mapping" href="#view-json-mapping"></a>17.10&nbsp;JSON Mapping View</h2></div></div></div>

<p>The <code class="literal">MappingJackson2JsonView</code> uses the Jackson library&#8217;s <code class="literal">ObjectMapper</code> to render the response
content as JSON. By default, the entire contents of the model map (with the exception of
framework-specific classes) will be encoded as JSON. For cases where the contents of the
map need to be filtered, users may specify a specific set of model attributes to encode
via the <code class="literal">RenderedAttributes</code> property. The <code class="literal">extractValueFromSingleKeyModel</code> property may
also be used to have the value in single-key models extracted and serialized directly
rather than as a map of model attributes.</p>
<p>JSON mapping can be customized as needed through the use of Jackson&#8217;s provided
annotations. When further control is needed, a custom <code class="literal">ObjectMapper</code> can be injected
through the <code class="literal">ObjectMapper</code> property for cases where custom JSON
serializers/deserializers need to be provided for specific types.</p>
<p><a class="ulink" href="http://en.wikipedia.org/wiki/JSONP" target="_top">JSONP</a> is supported and automatically enabled when
the request has a query parameter named <code class="literal">jsonp</code> or <code class="literal">callback</code>. The JSONP query parameter
name(s) could be customized through the <code class="literal">jsonpParameterNames</code> property.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="view-xml-mapping" href="#view-xml-mapping"></a>17.11&nbsp;XML Mapping View</h2></div></div></div>

<p>The <code class="literal">MappingJackson2XmlView</code> uses the
<a class="ulink" href="https://github.com/FasterXML/jackson-dataformat-xml" target="_top">Jackson XML extension</a>'s <code class="literal">XmlMapper</code>
to render the response content as XML. If the model contains multiples entries, the
object to be serialized should be set explicitly using <code class="literal">MappingJackson2XmlView</code>'s
<code class="literal">modelKey</code> bean property. If the model contains a single entry, it will be serialized
automatically.</p>
<p>XML mapping can be customized as needed through the use of JAXB or Jackson&#8217;s provided
annotations. When further control is needed, a custom <code class="literal">XmlMapper</code> can be injected
through the <code class="literal">ObjectMapper</code> property for cases where custom XML
serializers/deserializers need to be provided for specific types.</p>
</div>
</div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="mvc.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="spring-web.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="web-integration.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">16.&nbsp;Web MVC &#26694;&#26550;&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;18.&nbsp;&#21516;&#20854;&#20182;web&#26694;&#26550;&#38598;&#25104;</td></tr></table></div></body></html>